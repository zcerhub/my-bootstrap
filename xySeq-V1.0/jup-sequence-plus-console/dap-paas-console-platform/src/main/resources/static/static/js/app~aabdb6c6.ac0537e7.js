(window["jsonpPaas4"]=window["jsonpPaas4"]||[]).push([["app~aabdb6c6"],{1649:function(t,e,i){"use strict";var a=i("9ab4"),n=i("3822"),s=i("8937");Object(n["l"])("circle",{options:{size:n["e"].defaultNode.size,style:{x:0,y:0,stroke:n["e"].defaultNode.style.stroke,fill:n["e"].defaultNode.style.fill,lineWidth:n["e"].defaultNode.style.lineWidth},labelCfg:{style:{fill:n["e"].nodeLabel.style.fill,fontSize:n["e"].nodeLabel.style.fontSize,fontFamily:n["e"].windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:n["e"].defaultNode.linkPoints.size,lineWidth:n["e"].defaultNode.linkPoints.lineWidth,fill:n["e"].defaultNode.linkPoints.fill,stroke:n["e"].defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:Object(a["__assign"])({},n["e"].nodeStateStyles)},shapeType:"circle",labelPosition:"center",drawShape:function(t,e){var i=(this.mergeStyle||this.getOptions(t)).icon,n=void 0===i?{}:i,o=this.getShapeStyle(t),r=Object(s["deepMix"])({},n,t.icon),l="".concat(this.type,"-keyShape"),c=e.addShape("circle",{attrs:o,className:l,name:l,draggable:!0});e["shapeMap"][l]=c;var h=r.width,p=r.height,d=r.show,g=r.text;if(d){var f="".concat(this.type,"-icon");e["shapeMap"][f]=g?e.addShape("text",{attrs:Object(a["__assign"])({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},r),className:f,name:f,draggable:!0}):e.addShape("image",{attrs:Object(a["__assign"])({x:-h/2,y:-p/2},r),className:f,name:f,draggable:!0})}return this.drawLinkPoints(t,e),c},drawLinkPoints:function(t,e){var i=(this.mergeStyle||this.getOptions(t)).linkPoints;if(i){var n=i||{},s=n.top,o=n.left,r=n.right,l=n.bottom,c=n.size,h=n.r,p=Object(a["__rest"])(n,["top","left","right","bottom","size","r"]),d=this.getSize(t),g=d[0]/2;if(o){var f="link-point-left";e["shapeMap"][f]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:-g,y:0,r:c/2||h||5}),className:f,name:f,isAnchorPoint:!0})}if(r){var y="link-point-right";e["shapeMap"][y]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:g,y:0,r:c/2||h||5}),className:y,name:y,isAnchorPoint:!0})}if(s){var m="link-point-top";e["shapeMap"][m]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:0,y:-g,r:c/2||h||5}),className:m,name:m,isAnchorPoint:!0})}if(l){var b="link-point-bottom";e["shapeMap"][b]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:0,y:g,r:c/2||h||5}),className:b,name:b,isAnchorPoint:!0})}}},getShapeStyle:function(t){var e=(this.mergeStyle||this.getOptions(t)).style,i={stroke:t.color},n=Object(s["deepMix"])({},e,i),o=this.getSize(t),r=o[0]/2,l=Object(a["__assign"])({x:0,y:0,r:r},n);return l},update:function(t,e,i){var n=e.getContainer(),s=this.getSize(t),o=Object(a["__assign"])({},t.style);void 0===t.style.stroke&&t.color&&(o.stroke=t.color),void 0!==t.style.r||isNaN(s[0])||(o.r=s[0]/2),this.updateShape(t,e,o,!0,i),this.updateLinkPoints(t,n)}},"single-node"),Object(n["l"])("rect",{options:{size:[100,30],style:{radius:0,stroke:n["e"].defaultNode.style.stroke,fill:n["e"].defaultNode.style.fill,lineWidth:n["e"].defaultNode.style.lineWidth},labelCfg:{style:{fill:n["e"].nodeLabel.style.fill,fontSize:n["e"].nodeLabel.style.fontSize,fontFamily:n["e"].windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:n["e"].defaultNode.linkPoints.size,lineWidth:n["e"].defaultNode.linkPoints.lineWidth,fill:n["e"].defaultNode.linkPoints.fill,stroke:n["e"].defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},anchorPoints:[[0,.5],[1,.5]],stateStyles:Object(a["__assign"])({},n["e"].nodeStateStyles)},shapeType:"rect",labelPosition:"center",drawShape:function(t,e){var i=this.getShapeStyle(t),a=e.addShape("rect",{attrs:i,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});return e["shapeMap"]["".concat(this.type,"-keyShape")]=a,this.drawLinkPoints(t,e),a},drawLinkPoints:function(t,e){var i=(this.mergeStyle||this.getOptions(t)).linkPoints,n=void 0===i?{}:i,s=n.top,o=n.left,r=n.right,l=n.bottom,c=n.size,h=n.r,p=Object(a["__rest"])(n,["top","left","right","bottom","size","r"]),d=this.getSize(t),g=d[0],f=d[1];o&&(e["shapeMap"]["link-point-left"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:-g/2,y:0,r:c/2||h||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),r&&(e["shapeMap"]["link-point-right"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:g/2,y:0,r:c/2||h||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),s&&(e["shapeMap"]["link-point-top"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:0,y:-f/2,r:c/2||h||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),l&&(e["shapeMap"]["link-point-bottom"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:0,y:f/2,r:c/2||h||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getShapeStyle:function(t){var e=(this.mergeStyle||this.getOptions(t)).style,i={stroke:t.color},n=Object(s["mix"])({},e,i),o=this.getSize(t),r=n.width||o[0],l=n.height||o[1],c=Object(a["__assign"])({x:-r/2,y:-l/2,width:r,height:l},n);return c},update:function(t,e,i){var a=e.getContainer(),n=this.getOptions({}).style,o=this.getSize(t),r=e.get("keyShape");t.size||(o[0]=r.attr("width")||n.width,o[1]=r.attr("height")||n.height);var l={stroke:t.color,x:-o[0]/2,y:-o[1]/2,width:o[0],height:o[1]},c=Object(s["mix"])({},n,r.attr(),l);c=Object(s["mix"])(c,t.style),this.updateShape(t,e,c,!1,i),this.updateLinkPoints(t,a)}},"single-node"),Object(n["l"])("ellipse",{options:{size:[80,40],style:{x:0,y:0,stroke:n["e"].defaultNode.style.stroke,fill:n["e"].defaultNode.style.fill,lineWidth:n["e"].defaultNode.style.lineWidth},labelCfg:{style:{fill:n["e"].nodeLabel.style.fill,fontSize:n["e"].nodeLabel.style.fontSize,fontFamily:n["e"].windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:n["e"].defaultNode.linkPoints.size,lineWidth:n["e"].defaultNode.linkPoints.lineWidth,fill:n["e"].defaultNode.linkPoints.fill,stroke:n["e"].defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:Object(a["__assign"])({},n["e"].nodeStateStyles)},shapeType:"ellipse",labelPosition:"center",drawShape:function(t,e){var i=(this.mergeStyle||this.getOptions(t)).icon,n=void 0===i?{}:i,s=this.getShapeStyle(t),o=e.addShape("ellipse",{attrs:s,className:"ellipse-keyShape",name:"ellipse-keyShape",draggable:!0});e["shapeMap"]["ellipse-keyShape"]=o;var r=n.width,l=n.height,c=n.show,h=n.text;return c&&(e["shapeMap"]["".concat(this.type,"-icon")]=h?e.addShape("text",{attrs:Object(a["__assign"])({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},n),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):e.addShape("image",{attrs:Object(a["__assign"])({x:-r/2,y:-l/2},n),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(t,e),o},drawLinkPoints:function(t,e){var i=(this.mergeStyle||this.getOptions(t)).linkPoints,n=void 0===i?{}:i,s=n.top,o=n.left,r=n.right,l=n.bottom,c=n.size,h=n.r,p=Object(a["__rest"])(n,["top","left","right","bottom","size","r"]),d=this.getSize(t),g=d[0]/2,f=d[1]/2;o&&(e["shapeMap"]["link-point-left"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:-g,y:0,r:c/2||h||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),r&&(e["shapeMap"]["link-point-right"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:g,y:0,r:c/2||h||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),s&&(e["shapeMap"]["link-point-top"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:0,y:-f,r:c/2||h||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),l&&(e["shapeMap"]["link-point-bottom"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:0,y:f,r:c/2||h||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getShapeStyle:function(t){var e=(this.mergeStyle||this.getOptions(t)).style,i={stroke:t.color},n=Object(s["mix"])({},e,i),o=this.getSize(t),r=o[0]/2,l=o[1]/2,c=Object(a["__assign"])({x:0,y:0,rx:r,ry:l},n);return c},update:function(t,e,i){var a=e.getContainer(),n=this.getOptions({}).style,o=this.getSize(t),r={stroke:t.color,rx:o[0]/2,ry:o[1]/2},l=e.get("keyShape"),c=Object(s["mix"])({},n,l.attr(),r);c=Object(s["mix"])(c,t.style),this.updateShape(t,e,c,!0,i),this.updateLinkPoints(t,a)}},"single-node"),Object(n["l"])("diamond",{options:{size:[80,80],style:{stroke:n["e"].defaultNode.style.stroke,fill:n["e"].defaultNode.style.fill,lineWidth:n["e"].defaultNode.style.lineWidth},labelCfg:{style:{fill:n["e"].nodeLabel.style.fill,fontSize:n["e"].nodeLabel.style.fontSize,fontFamily:n["e"].windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:n["e"].defaultNode.linkPoints.size,lineWidth:n["e"].defaultNode.linkPoints.lineWidth,fill:n["e"].defaultNode.linkPoints.fill,stroke:n["e"].defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:Object(a["__assign"])({},n["e"].nodeStateStyles)},shapeType:"diamond",labelPosition:"center",drawShape:function(t,e){var i=(this.mergeStyle||this.getOptions(t)).icon,n=void 0===i?{}:i,s=this.getShapeStyle(t),o=e.addShape("path",{attrs:s,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});e["shapeMap"]["".concat(this.type,"-keyShape")]=o;var r=n.width,l=n.height,c=n.show,h=n.text;return c&&(e["shapeMap"]["".concat(this.type,"-icon")]=h?e.addShape("text",{attrs:Object(a["__assign"])({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},n),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):e.addShape("image",{attrs:Object(a["__assign"])({x:-r/2,y:-l/2},n),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(t,e),o},drawLinkPoints:function(t,e){var i=(this.mergeStyle||this.getOptions(t)).linkPoints,n=void 0===i?{}:i,s=n.top,o=n.left,r=n.right,l=n.bottom,c=n.size,h=n.r,p=Object(a["__rest"])(n,["top","left","right","bottom","size","r"]),d=this.getSize(t),g=d[0],f=d[1];o&&(e["shapeMap"]["link-point-left"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:-g/2,y:0,r:c/2||h||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),r&&(e["shapeMap"]["link-point-right"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:g/2,y:0,r:c/2||h||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),s&&(e["shapeMap"]["link-point-top"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:0,y:-f/2,r:c/2||h||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),l&&(e["shapeMap"]["link-point-bottom"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:0,y:f/2,r:c/2||h||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getPath:function(t){var e=this.getSize(t),i=e[0],a=e[1],n=[["M",0,-a/2],["L",i/2,0],["L",0,a/2],["L",-i/2,0],["Z"]];return n},getShapeStyle:function(t){var e=(this.mergeStyle||this.getOptions(t)).style,i={stroke:t.color},n=Object(s["mix"])({},e,i),o=this.getPath(t),r=Object(a["__assign"])({path:o},n);return r},update:function(t,e,i){var a=e.getContainer(),n=this.getOptions({}).style,o=this.getPath(t),r={stroke:t.color,path:o},l=e.get("keyShape"),c=Object(s["mix"])({},n,l.attr(),r);c=Object(s["mix"])(c,t.style),this.updateShape(t,e,c,!0,i),this.updateLinkPoints(t,a)}},"single-node"),Object(n["l"])("triangle",{options:{size:40,direction:"up",style:{stroke:n["e"].defaultNode.style.stroke,fill:n["e"].defaultNode.style.fill,lineWidth:n["e"].defaultNode.style.lineWidth},labelCfg:{style:{fill:n["e"].nodeLabel.style.fill,fontSize:n["e"].nodeLabel.style.fontSize},offset:15},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:n["e"].defaultNode.linkPoints.size,lineWidth:n["e"].defaultNode.linkPoints.lineWidth,fill:n["e"].defaultNode.linkPoints.fill,stroke:n["e"].defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20,offset:6},stateStyles:Object(a["__assign"])({},n["e"].nodeStateStyles)},shapeType:"triangle",labelPosition:"bottom",drawShape:function(t,e){var i=this.mergeStyle||this.getOptions(t),n=i.icon,s=void 0===n?{}:n,o=i.direction,r=this.getShapeStyle(t),l=t.direction||o,c=e.addShape("path",{attrs:r,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});e["shapeMap"]["".concat(this.type,"-keyShape")]=c;var h=s.width,p=s.height,d=s.show,g=s.offset,f=s.text;if(d)if(f)e["shapeMap"]["".concat(this.type,"-icon")]=e.addShape("text",{attrs:Object(a["__assign"])({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},s),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0});else{var y=-h/2,m=-p/2;"up"!==l&&"down"!==l||(m+=g),"left"!==l&&"right"!==l||(y+=g),e["shapeMap"]["".concat(this.type,"-icon")]=e.addShape("image",{attrs:Object(a["__assign"])({x:y,y:m},s),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})}return this.drawLinkPoints(t,e),c},drawLinkPoints:function(t,e){var i=this.mergeStyle||this.getOptions(t),n=i.linkPoints,s=void 0===n?{}:n,o=i.direction,r=t.direction||o,l=s.top,c=s.left,h=s.right,p=s.bottom,d=s.size,g=s.r,f=Object(a["__rest"])(s,["top","left","right","bottom","size","r"]),y=this.getSize(t),m=y[0];if(c){var b=null,u=m*Math.sin(1/3*Math.PI),x=m*Math.sin(1/3*Math.PI);"up"===r?b=[-x,u]:"down"===r?b=[-x,-u]:"left"===r&&(b=[-x,x-u]),b&&(e["shapeMap"]["link-point-left"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},f),{x:b[0],y:b[1],r:d/2||g||5}),className:"link-point-left",name:"link-point-left"}))}if(h){var _=null;u=m*Math.sin(1/3*Math.PI),x=m*Math.sin(1/3*Math.PI);"up"===r?_=[x,u]:"down"===r?_=[x,-u]:"right"===r&&(_=[x,x-u]),_&&(e["shapeMap"]["link-point-right"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},f),{x:_[0],y:_[1],r:d/2||g||5}),className:"link-point-right",name:"link-point-right"}))}if(l){var k=null;u=m*Math.sin(1/3*Math.PI),x=m*Math.sin(1/3*Math.PI);"up"===r?k=[x-u,-u]:"left"===r?k=[x,-u]:"right"===r&&(k=[-x,-u]),k&&(e["shapeMap"]["link-point-top"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},f),{x:k[0],y:k[1],r:d/2||g||5}),className:"link-point-top",name:"link-point-top"}))}if(p){var v=null;u=m*Math.sin(1/3*Math.PI),x=m*Math.sin(1/3*Math.PI);"down"===r?v=[-x+u,u]:"left"===r?v=[x,u]:"right"===r&&(v=[-x,u]),v&&(e["shapeMap"]["link-point-bottom"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},f),{x:v[0],y:v[1],r:d/2||g||5}),className:"link-point-bottom",name:"link-point-bottom"}))}},getPath:function(t){var e=(this.mergeStyle||this.getOptions(t)).direction,i=t.direction||e,a=this.getSize(t),n=a[0],s=n*Math.sin(1/3*Math.PI),o=n*Math.sin(1/3*Math.PI),r=[["M",-o,s],["L",0,-s],["L",o,s],["Z"]];return"down"===i?r=[["M",-o,-s],["L",o,-s],["L",0,s],["Z"]]:"left"===i?r=[["M",-o,o-s],["L",o,-o],["L",o,o],["Z"]]:"right"===i&&(r=[["M",o,o-s],["L",-o,o],["L",-o,-o],["Z"]]),r},getShapeStyle:function(t){var e=(this.mergeStyle||this.getOptions(t)).style,i={stroke:t.color},n=Object(s["mix"])({},e,i),o=this.getPath(t),r=Object(a["__assign"])({path:o},n);return r},update:function(t,e,i){var a=e.getContainer(),n=this.getOptions({}).style,o=this.getPath(t),r={stroke:t.color,path:o},l=e.get("keyShape"),c=Object(s["mix"])({},n,l.attr(),r);c=Object(s["mix"])(c,t.style),this.updateShape(t,e,c,!0,i),this.updateLinkPoints(t,a)},updateLinkPoints:function(t,e){var i=this.getOptions({}),n=i.linkPoints,o=i.direction,r=t.direction||o,l=e["shapeMap"]["link-point-left"]||e.find((function(t){return"link-point-left"===t.get("className")})),c=e["shapeMap"]["link-point-right"]||e.find((function(t){return"link-point-right"===t.get("className")})),h=e["shapeMap"]["link-point-top"]||e.find((function(t){return"link-point-top"===t.get("className")})),p=e["shapeMap"]["link-point-bottom"]||e.find((function(t){return"link-point-bottom"===t.get("className")})),d=n,g=l||c||h||p;g&&(d=g.attr());var f=Object(s["mix"])({},d,t.linkPoints),y=f.fill,m=f.stroke,b=f.lineWidth,u=f.size/2;u||(u=f.r);var x=t.linkPoints?t.linkPoints:{left:void 0,right:void 0,top:void 0,bottom:void 0},_=x.left,k=x.right,v=x.top,S=x.bottom,O=this.getSize(t),j=O[0],M={r:u,fill:y,stroke:m,lineWidth:b},P=null,w=j*Math.sin(1/3*Math.PI),N=j*Math.sin(1/3*Math.PI);"up"===r?P=[-N,w]:"down"===r?P=[-N,-w]:"left"===r&&(P=[-N,N-w]),P&&(l?_||void 0===_?l.attr(Object(a["__assign"])(Object(a["__assign"])({},M),{x:P[0],y:P[1]})):(l.remove(),delete e["shapeMap"]["link-point-left"]):_&&(e["shapeMap"]["link-point-left"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},M),{x:P[0],y:P[1]}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})));var z=null;"up"===r?z=[N,w]:"down"===r?z=[N,-w]:"right"===r&&(z=[N,N-w]),z&&(c?k||void 0===k?c.attr(Object(a["__assign"])(Object(a["__assign"])({},M),{x:z[0],y:z[1]})):(c.remove(),delete e["shapeMap"]["link-point-right"]):k&&(e["shapeMap"]["link-point-right"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},M),{x:z[0],y:z[1]}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})));var L=null;"up"===r?L=[N-w,-w]:"left"===r?L=[N,-w]:"right"===r&&(L=[-N,-w]),L&&(h?v||void 0===v?h.attr(Object(a["__assign"])(Object(a["__assign"])({},M),{x:L[0],y:L[1]})):(h.remove(),delete e["shapeMap"]["link-point-top"]):v&&(e["shapeMap"]["link-point-top"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},M),{x:L[0],y:L[1]}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})));var X=null;"down"===r?X=[-N+w,w]:"left"===r?X=[N,w]:"right"===r&&(X=[-N,w]),X&&(p?S||void 0===S?p.attr(Object(a["__assign"])(Object(a["__assign"])({},M),{x:X[0],y:X[1]})):(p.remove(),delete e["shapeMap"]["link-point-bottom"]):S&&(e["shapeMap"]["link-point-bottom"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},M),{x:X[0],y:X[1]}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0})))}},"single-node"),Object(n["l"])("modelRect",{options:{size:[185,70],style:{radius:5,stroke:"#69c0ff",fill:"#ffffff",lineWidth:n["e"].defaultNode.style.lineWidth,fillOpacity:1},labelCfg:{style:{fill:"#595959",fontSize:14,fontFamily:n["e"].windowFontFamily},offset:30},descriptionCfg:{style:{fontSize:12,fill:"#bfbfbf",fontFamily:n["e"].windowFontFamily},paddingTop:0},preRect:{show:!0,width:4,fill:"#40a9ff",radius:2},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:10,lineWidth:1,fill:"#72CC4A",stroke:"#72CC4A"},logoIcon:{show:!0,x:0,y:0,img:"https://gw.alipayobjects.com/zos/basement_prod/4f81893c-1806-4de4-aff3-9a6b266bc8a2.svg",width:16,height:16,offset:0},stateIcon:{show:!0,x:0,y:0,img:"https://gw.alipayobjects.com/zos/basement_prod/300a2523-67e0-4cbf-9d4a-67c077b40395.svg",width:16,height:16,offset:-5},anchorPoints:[[0,.5],[1,.5]]},shapeType:"modelRect",drawShape:function(t,e){var i=(this.mergeStyle||this.getOptions(t)).preRect,n=void 0===i?{}:i,s=this.getShapeStyle(t),o=this.getSize(t),r=o[0],l=o[1],c=e.addShape("rect",{attrs:s,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});e["shapeMap"]["".concat(this.type,"-keyShape")]=c;var h=n.show,p=Object(a["__rest"])(n,["show"]);return h&&(e["shapeMap"]["pre-rect"]=e.addShape("rect",{attrs:Object(a["__assign"])({x:-r/2,y:-l/2,height:l},p),className:"pre-rect",name:"pre-rect",draggable:!0})),this.drawLogoIcon(t,e),this.drawStateIcon(t,e),this.drawLinkPoints(t,e),c},drawLogoIcon:function(t,e){var i=(this.mergeStyle||this.getOptions(t)).logoIcon,n=void 0===i?{}:i,s=this.getSize(t),o=s[0];if(n.show){var r=n.width,l=n.height,c=n.x,h=n.y,p=n.offset,d=n.text,g=Object(a["__rest"])(n,["width","height","x","y","offset","text"]);e["shapeMap"]["rect-logo-icon"]=d?e.addShape("text",{attrs:Object(a["__assign"])({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},g),className:"rect-logo-icon",name:"rect-logo-icon",draggable:!0}):e.addShape("image",{attrs:Object(a["__assign"])(Object(a["__assign"])({},g),{x:c||-o/2+r+p,y:h||-l/2,width:r,height:l}),className:"rect-logo-icon",name:"rect-logo-icon",draggable:!0})}},drawStateIcon:function(t,e){var i=(this.mergeStyle||this.getOptions(t)).stateIcon,n=void 0===i?{}:i,s=this.getSize(t),o=s[0];if(n.show){var r=n.width,l=n.height,c=n.x,h=n.y,p=n.offset,d=n.text,g=Object(a["__rest"])(n,["width","height","x","y","offset","text"]);e["shapeMap"]["rect-state-icon"]=d?e.addShape("text",{attrs:Object(a["__assign"])({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},g),className:"rect-state-icon",name:"rect-state-icon",draggable:!0}):e.addShape("image",{attrs:Object(a["__assign"])(Object(a["__assign"])({},g),{x:c||o/2-r+p,y:h||-l/2,width:r,height:l}),className:"rect-state-icon",name:"rect-state-icon",draggable:!0})}},drawLinkPoints:function(t,e){var i=(this.mergeStyle||this.getOptions(t)).linkPoints,n=void 0===i?{}:i,s=n.top,o=n.left,r=n.right,l=n.bottom,c=n.size,h=n.r,p=Object(a["__rest"])(n,["top","left","right","bottom","size","r"]),d=this.getSize(t),g=d[0],f=d[1];o&&(e["shapeMap"]["link-point-left"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:-g/2,y:0,r:c/2||h||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),r&&(e["shapeMap"]["link-point-right"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:g/2,y:0,r:c/2||h||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),s&&(e["shapeMap"]["link-point-top"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:0,y:-f/2,r:c/2||h||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),l&&(e["shapeMap"]["link-point-bottom"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},p),{x:0,y:f/2,r:c/2||h||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},drawLabel:function(t,e){var i=this.getOptions(t),n=i.labelCfg,o=void 0===n?{}:n,r=i.logoIcon,l=void 0===r?{}:r,c=i.descriptionCfg,h=void 0===c?{}:c,p=this.getSize(t),d=p[0],g=null,f=l.show,y=l.width,m=-d/2+o.offset;f&&(m=-d/2+y+o.offset);var b=o.style,u=h.style,x=h.paddingTop;return Object(s["isString"])(t.description)?(g=e.addShape("text",{attrs:Object(a["__assign"])(Object(a["__assign"])({},b),{x:m,y:-5,text:t.label}),className:"text-shape",name:"text-shape",draggable:!0,labelRelated:!0}),e["shapeMap"]["text-shape"]=g,e["shapeMap"]["rect-description"]=e.addShape("text",{attrs:Object(a["__assign"])(Object(a["__assign"])({},u),{x:m,y:17+(x||0),text:t.description}),className:"rect-description",name:"rect-description",draggable:!0,labelRelated:!0})):(g=e.addShape("text",{attrs:Object(a["__assign"])(Object(a["__assign"])({},b),{x:m,y:7,text:t.label}),className:"text-shape",name:"text-shape",draggable:!0,labelRelated:!0}),e["shapeMap"]["text-shape"]=g),g},getShapeStyle:function(t){var e=(this.mergeStyle||this.getOptions(t)).style,i={stroke:t.color},n=Object(s["mix"])({},e,i),o=this.getSize(t),r=n.width||o[0],l=n.height||o[1],c=Object(a["__assign"])({x:-r/2,y:-l/2,width:r,height:l},n);return c},update:function(t,e){var i=this.mergeStyle||this.getOptions(t),n=i.style,o=void 0===n?{}:n,r=i.labelCfg,l=void 0===r?{}:r,c=i.descriptionCfg,h=void 0===c?{}:c,p=this.getSize(t),d=p[0],g=p[1],f=e.get("keyShape");f.attr(Object(a["__assign"])(Object(a["__assign"])({},o),{x:-d/2,y:-g/2,width:d,height:g}));var y=e.getContainer(),m=y["shapeMap"]["rect-logo-icon"]||y.find((function(t){return"rect-logo-icon"===t.get("className")})),b=m?m.attr():{},u=Object(s["mix"])({},b,t.logoIcon),x=u.width;void 0===x&&(x=this.options.logoIcon.width);var _=t.logoIcon?t.logoIcon.show:void 0,k=l.offset,v=-d/2+x+k;_||void 0===_||(v=-d/2+k);var S=y["shapeMap"]["node-label"]||y.find((function(t){return"node-label"===t.get("className")})),O=y["shapeMap"]["rect-description"]||y.find((function(t){return"rect-description"===t.get("className")}));if(t.label)if(S){var j=t.labelCfg?t.labelCfg.style:{},M=Object(s["mix"])({},S.attr(),j);t.label&&(M.text=t.label),M.x=v,Object(s["isString"])(t.description)&&(M.y=-5),O&&(O.resetMatrix(),O.attr({x:v})),S.resetMatrix(),S.attr(M)}else y["shapeMap"]["node-label"]=y.addShape("text",{attrs:Object(a["__assign"])(Object(a["__assign"])({},l.style),{x:v,y:t.description?-5:7,text:t.label}),className:"node-label",name:"node-label",draggable:!0,labelRelated:!0});if(Object(s["isString"])(t.description)){var P=h.paddingTop;if(O){j=t.descriptionCfg?t.descriptionCfg.style:{};var w=Object(s["mix"])({},O.attr(),j);Object(s["isString"])(t.description)&&(w.text=t.description),w.x=v,O.resetMatrix(),O.attr(Object(a["__assign"])(Object(a["__assign"])({},w),{y:17+(P||0)}))}else y["shapeMap"]["rect-description"]=y.addShape("text",{attrs:Object(a["__assign"])(Object(a["__assign"])({},h.style),{x:v,y:17+(P||0),text:t.description}),className:"rect-description",name:"rect-description",draggable:!0,labelRelated:!0})}var N=y["shapeMap"]["pre-rect"]||y.find((function(t){return"pre-rect"===t.get("className")}));if(N&&!N.destroyed){var z=Object(s["mix"])({},N.attr(),t.preRect);N.attr(Object(a["__assign"])(Object(a["__assign"])({},z),{x:-d/2,y:-g/2,height:g}))}if(m&&!m.destroyed)if(_||void 0===_){var L=u.width,X=u.height,Y=u.x,I=u.y,A=u.offset,W=Object(a["__rest"])(u,["width","height","x","y","offset"]);m.attr(Object(a["__assign"])(Object(a["__assign"])({},W),{x:Y||-d/2+L+A,y:I||-X/2,width:L,height:X}))}else m.remove(),delete y["shapeMap"]["pre-rect"];else _&&this.drawLogoIcon(t,y);var C=y["shapeMap"]["rect-state-icon"]||y.find((function(t){return"rect-state-icon"===t.get("className")})),B=C?C.attr():{},F=Object(s["mix"])({},B,t.stateIcon);if(C){F.show||void 0===F.show||(C.remove(),delete y["shapeMap"]["rect-state-icon"]);var E=F.width,R=(X=F.height,Y=F.x,I=F.y,F.offset),T=Object(a["__rest"])(F,["width","height","x","y","offset"]);C.attr(Object(a["__assign"])(Object(a["__assign"])({},T),{x:Y||d/2-E+R,y:I||-X/2,width:E,height:X}))}else F.show&&this.drawStateIcon(t,y);this.updateLinkPoints(t,y)},getOptions:function(t,e){return"move"===e?t:Object(s["deepMix"])({},this.options,this.getCustomConfig(t)||{},t)}},"single-node"),Object(n["l"])("star",{options:{size:60,style:{stroke:n["e"].defaultNode.style.stroke,fill:n["e"].defaultNode.style.fill,lineWidth:n["e"].defaultNode.style.lineWidth},labelCfg:{style:{fill:n["e"].nodeLabel.style.fill,fontSize:n["e"].nodeLabel.style.fontSize,fontFamily:n["e"].windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:n["e"].defaultNode.linkPoints.size,lineWidth:n["e"].defaultNode.linkPoints.lineWidth,fill:n["e"].defaultNode.linkPoints.fill,stroke:n["e"].defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:Object(a["__assign"])({},n["e"].nodeStateStyles)},shapeType:"star",labelPosition:"center",drawShape:function(t,e){var i=(this.mergeStyle||this.getOptions(t)).icon,n=void 0===i?{}:i,s=this.getShapeStyle(t),o=e.addShape("path",{attrs:s,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});e["shapeMap"]["".concat(this.type,"-keyShape")]=o;var r=n.width,l=n.height,c=n.show,h=n.text;return c&&(e["shapeMap"]["".concat(this.type,"-icon")]=h?e.addShape("text",{attrs:Object(a["__assign"])({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},n),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):e.addShape("image",{attrs:Object(a["__assign"])({x:-r/2,y:-l/2},n),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(t,e),o},drawLinkPoints:function(t,e){var i=(this.mergeStyle||this.getOptions(t)).linkPoints,n=void 0===i?{}:i,s=n.top,o=n.left,r=n.right,l=n.leftBottom,c=n.rightBottom,h=n.size,p=n.r,d=Object(a["__rest"])(n,["top","left","right","leftBottom","rightBottom","size","r"]),g=this.getSize(t),f=g[0];if(r){var y=Math.cos(.1*Math.PI)*f,m=Math.sin(.1*Math.PI)*f;e["shapeMap"]["link-point-right"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},d),{x:y,y:-m,r:h/2||p||5}),className:"link-point-right",name:"link-point-right"})}if(s){y=Math.cos(.5*Math.PI)*f,m=Math.sin(.5*Math.PI)*f;e["shapeMap"]["link-point-top"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},d),{x:y,y:-m,r:h/2||p||5}),className:"link-point-top",name:"link-point-top"})}if(o){y=Math.cos(.9*Math.PI)*f,m=Math.sin(.9*Math.PI)*f;e["shapeMap"]["link-point-left"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},d),{x:y,y:-m,r:h/2||p||5}),className:"link-point-left",name:"link-point-left"})}if(l){y=Math.cos(1.3*Math.PI)*f,m=Math.sin(1.3*Math.PI)*f;e["shapeMap"]["link-point-bottom"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},d),{x:y,y:-m,r:h/2||p||5}),className:"link-point-left-bottom",name:"link-point-left-bottom"})}if(c){y=Math.cos(1.7*Math.PI)*f,m=Math.sin(1.7*Math.PI)*f;e["shapeMap"]["link-point-right-bottom"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},d),{x:y,y:-m,r:h/2||p||5}),className:"link-point-right-bottom",name:"link-point-right-bottom"})}},getPath:function(t){var e=this.getSize(t),i=e[0],a=3*i/8,s=t.innerR||a;return n["h"].getStarPath(i,s)},getShapeStyle:function(t){var e=(this.mergeStyle||this.getOptions(t)).style,i={stroke:t.color},n=Object(s["mix"])({},e,i),o=this.getPath(t),r=Object(a["__assign"])({path:o},n);return r},update:function(t,e,i){var a=e.getContainer(),n=this.getOptions({}).style,o=this.getPath(t),r={stroke:t.color,path:o},l=e.get("keyShape"),c=Object(s["mix"])({},n,l.attr(),r);c=Object(s["mix"])(c,t.style),this.updateShape(t,e,c,!0,i),this.updateLinkPoints(t,a)},updateLinkPoints:function(t,e){var i=this.getOptions({}).linkPoints,n=e["shapeMap"]["link-point-left"]||e.find((function(t){return"link-point-left"===t.get("className")})),o=e["shapeMap"]["link-point-right"]||e.find((function(t){return"link-point-right"===t.get("className")})),r=e["shapeMap"]["link-point-top"]||e.find((function(t){return"link-point-top"===t.get("className")})),l=e["shapeMap"]["link-point-left-bottom"]||e.find((function(t){return"link-point-left-bottom"===t.get("className")})),c=e["shapeMap"]["link-point-left-bottom"]||e.find((function(t){return"link-point-right-bottom"===t.get("className")})),h=i,p=n||o||r||l||c;p&&(h=p.attr());var d=Object(s["mix"])({},h,t.linkPoints),g=d.fill,f=d.stroke,y=d.lineWidth,m=d.size/2;m||(m=d.r);var b=t.linkPoints?t.linkPoints:{left:void 0,right:void 0,top:void 0,leftBottom:void 0,rightBottom:void 0},u=b.left,x=b.right,_=b.top,k=b.leftBottom,v=b.rightBottom,S=this.getSize(t),O=S[0],j={r:m,fill:g,stroke:f,lineWidth:y},M=Math.cos(.1*Math.PI)*O,P=Math.sin(.1*Math.PI)*O;o?x||void 0===x?o.attr(Object(a["__assign"])(Object(a["__assign"])({},j),{x:M,y:-P})):(o.remove(),delete e["shapeMap"]["link-point-right"]):x&&(e["shapeMap"]["link-point-right"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},j),{x:M,y:-P}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),M=Math.cos(.5*Math.PI)*O,P=Math.sin(.5*Math.PI)*O,r?_||void 0===_?r.attr(Object(a["__assign"])(Object(a["__assign"])({},j),{x:M,y:-P})):(r.remove(),delete e["shapeMap"]["link-point-top"]):_&&(e["shapeMap"]["link-point-top"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},j),{x:M,y:-P}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),M=Math.cos(.9*Math.PI)*O,P=Math.sin(.9*Math.PI)*O,n?u||void 0===u?n.attr(Object(a["__assign"])(Object(a["__assign"])({},j),{x:M,y:-P})):(n.remove(),delete e["shapeMap"]["link-point-left"]):u&&(e["shapeMap"]["link-point-left"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},j),{x:M,y:-P}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),M=Math.cos(1.3*Math.PI)*O,P=Math.sin(1.3*Math.PI)*O,l?k||void 0===k?l.attr(Object(a["__assign"])(Object(a["__assign"])({},j),{x:M,y:-P})):(l.remove(),delete e["shapeMap"]["link-point-left-bottom"]):k&&(e["shapeMap"]["link-point-left-bottom"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},j),{x:M,y:-P}),className:"link-point-left-bottom",name:"link-point-left-bottom",isAnchorPoint:!0})),M=Math.cos(1.7*Math.PI)*O,P=Math.sin(1.7*Math.PI)*O,c?v||void 0===v?c.attr(Object(a["__assign"])(Object(a["__assign"])({},j),{x:M,y:-P})):(c.remove(),delete e["shapeMap"]["link-point-right-bottom"]):v&&(e["shapeMap"]["link-point-right-bottom"]=e.addShape("circle",{attrs:Object(a["__assign"])(Object(a["__assign"])({},j),{x:M,y:-P}),className:"link-point-right-bottom",name:"link-point-right-bottom",isAnchorPoint:!0}))}},"single-node");var o=n["h"].defaultSubjectColors,r="fan-shape-";Object(n["l"])("donut",{options:{size:n["e"].defaultNode.size,style:{x:0,y:0,stroke:n["e"].defaultNode.style.stroke,fill:n["e"].defaultNode.style.fill,lineWidth:n["e"].defaultNode.style.lineWidth},labelCfg:{style:{fill:n["e"].nodeLabel.style.fill,fontSize:n["e"].nodeLabel.style.fontSize,fontFamily:n["e"].windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:n["e"].defaultNode.linkPoints.size,lineWidth:n["e"].defaultNode.linkPoints.lineWidth,fill:n["e"].defaultNode.linkPoints.fill,stroke:n["e"].defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:Object(a["__assign"])({},n["e"].nodeStateStyles)},shapeType:"circle",labelPosition:"center",drawShape:function(t,e){var i=(this.mergeStyle||this.getOptions(t)).icon,n=void 0===i?{}:i,o=this.getShapeStyle(t),r=Object(s["deepMix"])({},n,t.icon),c=e.addShape("circle",{attrs:o,className:"".concat(this.type,"-keyShape"),draggable:!0,name:"".concat(this.type,"-keyShape")});e["shapeMap"]["".concat(this.type,"-keyShape")]=c;var h=r.width,p=r.height,d=r.show,g=r.text;return d&&(e["shapeMap"]["".concat(this.type,"-icon")]=g?e.addShape("text",{attrs:Object(a["__assign"])({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},r),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):e.addShape("image",{attrs:Object(a["__assign"])({x:-h/2,y:-p/2},r),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),l(t,e,c),this.drawLinkPoints(t,e),c},updateShape:function(t,e,i,n,s){var o=e.get("keyShape");o.attr(Object(a["__assign"])({},i)),h(t,e,o),this.updateLabel(t,e,s),n&&this.updateIcon(t,e)}},"circle");var l=function(t,e,i){var a=t.donutAttrs,n=void 0===a?{}:a,s=t.donutColorMap,o=void 0===s?{}:s,r=Object.keys(n).length;if(n&&r>1){var l=p(n,o),h=l.configs,g=l.totalValue;if(g){var f=d(i),y=f.lineWidth,m=f.arcR,b=[m,0],u=0;if(1===r)return void c(e,{arcR:m,arcBegin:b,beginAngle:u,config:h[0],fanIndex:0,lineWidth:y,totalValue:g,drawWhole:!0});for(var x=0;x<h.length;x++){var _=c(e,{arcR:m,arcBegin:b,beginAngle:u,config:h[x],fanIndex:x,lineWidth:y,totalValue:g});if(_.shouldEnd)return;b=_.arcBegin,u=_.beginAngle}}}},c=function(t,e){var i,a,n,s=e.arcR,l=e.arcBegin,c=e.beginAngle,h=e.config,p=e.fanIndex,d=e.lineWidth,g=e.totalValue,f=e.drawWhole,y=void 0!==f&&f,m=e.updateShape,b=void 0===m?void 0:m,u=h.value/g;if(u<.001)return{beginAngle:c,arcBegin:l,shape:void 0,shouldEnd:!1};if(y||u>.999)i=[s,1e-4],n=1;else{var x=u*Math.PI*2;a=c+x,i=[s*Math.cos(a),-s*Math.sin(a)],n=x>Math.PI?1:0}var _={path:[["M",l[0],l[1]],["A",s,s,0,n,0,i[0],i[1]]],stroke:h.color||(null===b||void 0===b?void 0:b.attr("stroke"))||o[p%o.length],lineWidth:d};return b?b.attr(_):t["shapeMap"]["".concat(r).concat(p)]=t.addShape("path",{attrs:_,name:"".concat(r).concat(p),draggable:!0}),{beginAngle:a,arcBegin:i,shape:t["shapeMap"]["".concat(r).concat(p)],shouldEnd:y||u>.999}},h=function(t,e,i){var a=t.donutAttrs,n=t.donutColorMap,s=void 0===n?{}:n,o={},l=e.getContainer();if(a){var h=p(a,s),g=h.configs,f=h.totalValue;if(f)for(var y=d(i),m=y.lineWidth,b=y.arcR,u=[b,0],x=0,_=0;_<g.length;_++){var k="".concat(r).concat(_),v=c(l,{arcR:b,arcBegin:u,beginAngle:x,config:g[_],fanIndex:_,lineWidth:m,totalValue:f,drawWhole:1===g.length,updateShape:l["shapeMap"][k]});if(v.shape&&(o[k]=!0),v.shouldEnd)break;u=v.arcBegin,x=v.beginAngle}}var S=Object.keys(l["shapeMap"]).filter((function(t){return t.includes(r)}));S.forEach((function(t){o[t]||(l["shapeMap"][t].remove(!0),delete l["shapeMap"][t])}))},p=function(t,e){var i=0,a=[];return Object.keys(t).forEach((function(n){var s=+t[n];isNaN(s)||(a.push({key:n,value:s,color:e[n]}),i+=s)})),{totalValue:i,configs:a}},d=function(t){var e=t.attr("r"),i=.6*e,a=(e+i)/2,n=e-i;return{lineWidth:n,arcR:a}},g=function(t){var e=t.x,i=t.y;return{x:e,y:i,centerX:e,centerY:i,minX:e,minY:i,maxX:e,maxY:i,height:0,width:0}},f=function(t){void 0===t&&(t=[]);var e=[],i=[];t.forEach((function(t){e.push(t.x),i.push(t.y)}));var a=Math.min.apply(Math,e),n=Math.max.apply(Math,e),s=Math.min.apply(Math,i),o=Math.max.apply(Math,i);return{centerX:(a+n)/2,centerY:(s+o)/2,maxX:n,maxY:o,minX:a,minY:s,height:o-s,width:n-a}},y=function(t){for(var e=[],i={},a=t.length,n=a-1;n>=0;n--){var s=t[n];s.id="".concat(s.x,"|||").concat(s.y),i[s.id]||(i[s.id]=s,e.push(s))}return e},m=function(t){return y(t)},b=function(t,e){return t.width||t.height?{centerX:t.centerX,centerY:t.centerY,minX:t.minX-e,minY:t.minY-e,maxX:t.maxX+e,maxY:t.maxY+e,height:t.height+2*e,width:t.width+2*e}:t},u=function(t,e){var i=Math.abs(t.x-e.centerX),a=Math.abs(t.y-e.centerY);return 0===i&&0===a?0:i/e.width>a/e.height},x=function(t,e,i){var a=u(e,t);if(0===a){var n=t.centerX,s=t.centerY;return i.y<e.y?s=t.minY:i.x>e.x?n=t.maxX:i.x<e.x?n=t.minX:i.x===e.x&&(s=t.maxY),{x:n,y:s}}return a?{x:e.x>t.centerX?t.maxX:t.minX,y:e.y}:{x:e.x,y:e.y>t.centerY?t.maxY:t.minY}},_=function(t,e){var i=Math.min(t.minX,e.minX),a=Math.min(t.minY,e.minY),n=Math.max(t.maxX,e.maxX),s=Math.max(t.maxY,e.maxY);return{centerX:(i+n)/2,centerY:(a+s)/2,minX:i,minY:a,maxX:n,maxY:s,height:s-a,width:n-i}},k=function(t){return[{x:t.minX,y:t.minY},{x:t.maxX,y:t.minY},{x:t.maxX,y:t.maxY},{x:t.minX,y:t.maxY}]},v=function(t,e){var i=t.x,a=t.y;return i<e.minX||i>e.maxX||a<e.minY||a>e.maxY},S=function(t,e){return e<t.minX||e>t.maxX?[]:[{x:e,y:t.minY},{x:e,y:t.maxY}]},O=function(t,e){return e<t.minY||e>t.maxY?[]:[{x:t.minX,y:e},{x:t.maxX,y:e}]},j=function(t,e){return S(t,e.x).concat(O(t,e.y))},M=function(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)},P=function(t,e){var i=-2,a=0;return e.forEach((function(e){e&&(t.x===e.x&&(a+=i),t.y===e.y&&(a+=i))})),a},w=function(t,e,i,a,n){return M(t,e)+M(t,i)+P(t,[e,i,a,n])},N=function t(e,i,a,n,s){void 0===s&&(s=0),e.unshift(i[n]),a[n]&&a[n]!==n&&s<=100&&t(e,i,a,a[n],s+1)},z=function(t,e,i,a){var n=i.x-t.x,s=i.y-t.y,o=a.x-t.x,r=a.y-t.y,l=i.x-e.x,c=i.y-e.y,h=a.x-e.x,p=a.y-e.y,d=n*r-s*o,g=l*p-c*h,f=n*c-s*l,y=o*p-r*h;return d*g<=0&&f*y<=0},L=function(t,e,i){if(i.width||i.height){var a=k(i),n=a[0],s=a[1],o=a[2],r=a[3];return z(t,e,n,s)||z(t,e,n,r)||z(t,e,s,o)||z(t,e,o,r)}return!1},X=function(t,e,i,a){var n=[];return t.forEach((function(t){if(t!==e&&(t.x===e.x||t.y===e.y)){if(L(t,e,i)||L(t,e,a))return;n.push(t)}})),y(n)},Y=function(t,e,i,a,n,s,o){var r,l=[],c=(r={},r[e.id]=e,r),h={},p={},d={};p[e.id]=0,d[e.id]=w(e,i,e);var g=new F;g.add({id:e.id,value:d[e.id]});var f,y={};t.forEach((function(t){y[t.id]=t}));while(Object.keys(c).length){var m=g.minId(!1);if(!m)break;if(f=c[m],f===i){var b=[];return N(b,y,h,i.id),b}delete c[f.id],g.remove(f.id),l.push(f);var u=X(t,f,a,n),x=function(t){t.forEach((function(t){if(-1===l.indexOf(t)){var a=t.id;c[a]||(c[a]=t);var n=d[f.id]+M(f,t);p[a]&&n>=p[a]||(h[a]=f.id,p[a]=n,d[a]=p[a]+w(t,i,e,s,o)),g.add({id:a,value:d[a]})}}))};x(u)}return[e,i]},I=function(t,e,i){return!(t.x===e.x&&e.x===i.x||t.y===e.y&&e.y===i.y)},A=function(t,e,i,a){var n=M(t,e),s=M(i,e);n<a&&(a=n),s<a&&(a=s);var o={x:e.x-a/n*(e.x-t.x),y:e.y-a/n*(e.y-t.y)},r={x:e.x-a/s*(e.x-i.x),y:e.y-a/s*(e.y-i.y)};return[o,r]},W=function(t,e){var i=[],a=t[0];return i.push("M".concat(a.x," ").concat(a.y)),t.forEach((function(a,n){var s=t[n+1],o=t[n+2];if(s&&o)if(I(a,s,o)){var r=A(a,s,o,e),l=r[0],c=r[1];i.push("L".concat(l.x," ").concat(l.y)),i.push("Q".concat(s.x," ").concat(s.y," ").concat(c.x," ").concat(c.y)),i.push("L".concat(c.x," ").concat(c.y))}else i.push("L".concat(s.x," ").concat(s.y));else s&&i.push("L".concat(s.x," ").concat(s.y))})),i.join("")},C=function(t,e,i,a,n){var s,o;if(i&&i.getType())if("combo"===i.getType()){var r=i.getKeyShape().getBBox();if(r){var l=i.getModel(),c=l.x,h=l.y;s={x:c,y:h,width:r.width,height:r.height,minX:r.minX+c,maxX:r.maxX+c,minY:r.minY+h,maxY:r.maxY+h},s.centerX=(s.minX+s.maxX)/2,s.centerY=(s.minY+s.maxY)/2}else s=g(t)}else s=i&&i.getBBox();else s=g(t);if(a&&a.getType())if("combo"===a.getType()){var p=a.getKeyShape().getBBox();if(p){var d=a.getModel(),u=d.x,S=d.y;o={x:u,y:S,width:p.width,height:p.height,minX:p.minX+u,maxX:p.maxX+u,minY:p.minY+S,maxY:p.maxY+S},o.centerX=(o.minX+o.maxX)/2,o.centerY=(o.minY+o.maxY)/2}else o=g(e)}else o=a&&a.getBBox();else o=g(e);var O=b(s,n),M=b(o,n),P=x(O,t,e),w=x(M,e,t),N=f([P,w]),z=_(O,N),L=_(M,N),X=[];X=X.concat(k(z)).concat(k(L));var I={x:(t.x+e.x)/2,y:(t.y+e.y)/2};[N,z,L].forEach((function(t){X=X.concat(j(t,I).filter((function(t){return v(t,O)&&v(t,M)})))})),[{x:P.x,y:w.y},{x:w.x,y:P.y}].forEach((function(t){v(t,O)&&v(t,M)&&X.push(t)})),X.unshift(P),X.push(w),X=y(X);var A=Y(X,P,w,s,o,t,e);return A.unshift(t),A.push(e),m(A)},B=function(t){if(!(null===t||void 0===t?void 0:t.length))return t;for(var e=t[t.length-1],i={x:e.x,y:e.y},a=[e],n=[e],s=t.length-2;s>=0;s--){var o=t[s];if(o.x===i.x?a.push(o):(a=[o],i.x=o.x),o.y===i.y?n.push(o):(n=[o],i.y=o.y),a.length>2){var r=t.indexOf(a[1]);r>-1&&t.splice(r,1)}else if(n.length>2){r=t.indexOf(n[1]);r>-1&&t.splice(r,1)}}return t},F=function(){function t(){this.arr=[],this.map={},this.arr=[],this.map={}}return t.prototype._innerAdd=function(t,e){var i=[0,e-1];while(i[1]-i[0]>1){var a=Math.floor((i[0]+i[1])/2);if(this.arr[a].value>t.value)i[1]=a;else{if(!(this.arr[a].value<t.value))return this.arr.splice(a,0,t),void(this.map[t.id]=!0);i[0]=a}}this.arr.splice(i[1],0,t),this.map[t.id]=!0},t.prototype.add=function(t){delete this.map[t.id];var e=this.arr.length;return e?this.arr[e-1].value<t.value?(this.arr.push(t),void(this.map[t.id]=!0)):void this._innerAdd(t,e):(this.arr.push(t),void(this.map[t.id]=!0))},t.prototype.remove=function(t){this.map[t]&&delete this.map[t]},t.prototype._clearAndGetMinId=function(){for(var t,e=this.arr.length-1;e>=0;e--)this.map[this.arr[e].id]?t=this.arr[e].id:this.arr.splice(e,1);return t},t.prototype._findFirstId=function(){while(this.arr.length){var t=this.arr.shift();if(this.map[t.id])return t.id}},t.prototype.minId=function(t){return t?this._clearAndGetMinId():this._findFirstId()},t}(),E=function(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)},R=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},T=function(t,e){return[t,e]},V=function(t,e,i,a,n){return m(C(t,e,i,a,n.offset))},Z={offset:20,maxAllowedDirectionChange:Math.PI/2,maximumLoops:2e3,gridSize:10,directions:[{stepX:1,stepY:0},{stepX:-1,stepY:0},{stepX:0,stepY:1},{stepX:0,stepY:-1}],get penalties(){return{0:0,45:this.gridSize/2,90:this.gridSize/2}},distFunc:E,fallbackRoute:V},D=(Math.PI,function(t,e){var i=Math.round(Math.abs(t/e)),a=t<0?-1:1;return i<0?0:a*i}),K=function(t,e,i){var a={};return t.forEach((function(t){if(t)for(var n=b(t.getBBox(),i),s=D(n.minX,e);s<=D(n.maxX,e);s+=1)for(var o=D(n.minY,e);o<=D(n.maxY,e);o+=1)a["".concat(s,"|||").concat(o)]=!0})),a},G=function(t,e){var i=e.x-t.x,a=e.y-t.y;return i||a?Math.atan2(a,i):0},q=function(t,e){var i=Math.abs(t-e);return i>Math.PI?2*Math.PI-i:i},Q=function(t,e,i){for(var a=1/0,n=0,s=e.length;n<s;n++){var o=i(t,e[n]);o<a&&(a=o)}return a},H=function(t,e,i,a,s){var o=[];if(!i)return[t];var r=s.directions,l=s.offset,c=i.getBBox(),h=e.x>c.minX&&e.x<c.maxX&&e.y>c.minY&&e.y<c.maxY,p=b(c,l);for(var d in p)p[d]=D(p[d],s.gridSize);if(h){for(var g=0,f=r;g<f.length;g++){var y=f[g],m=[[{x:p.minX,y:p.minY},{x:p.maxX,y:p.minY}],[{x:p.minX,y:p.minY},{x:p.minX,y:p.maxY}],[{x:p.maxX,y:p.minY},{x:p.maxX,y:p.maxY}],[{x:p.minX,y:p.maxY},{x:p.maxX,y:p.maxY}]];for(d=0;d<4;d++){var u=m[d],_=n["h"].getLineIntersect(t,{x:t.x+y.stepX*p.width,y:t.y+y.stepY*p.height},u[0],u[1]);_&&!L(t,_,c)&&(_.id="".concat(_.x,"|||").concat(_.y),o.push(_))}}return o}var k=x(p,t,a);return k.id="".concat(k.x,"|||").concat(k.y),[k]},J=function(t,e,i,a){var n=G(t,e),s=i[t.id];if(!s){var o=G(a,t);return q(o,n)}var r=G({x:s.x,y:s.y},t);return q(r,n)},U=function(t,e,i,a,n,s,o){var r=[a],l=a,c=t.id,h=t.x,p=t.y,d={x:h,y:p,id:c};J(d,s,e,i)&&(l={x:s.x===a.x?a.x:d.x*o,y:s.y===a.y?a.y:d.y*o},r.unshift(l));var g=e[c];while(g&&g.id!==c){var f={x:h,y:p,id:c},y={x:g.x,y:g.y,id:g.id},m=J(y,f,e,i);m&&(l={x:y.x===f.x?l.x:y.x*o,y:y.y===f.y?l.y:y.y*o},r.unshift(l)),c=y.id,h=y.x,p=y.y,g=e[c]}return r[0].x=h===i.x?n.x:l.x,r[0].y=p===i.y?n.y:l.y,r.unshift(n),r},$=function(t,e,i,a,n){if(isNaN(t.x)||isNaN(e.x))return[];var o=Object(s["deepMix"])(Z,n);o.obstacles=o.obstacles||[];var r=o.penalties,l=o.gridSize,c=K(o.obstacles.concat([i,a]),l,o.offset),h={x:D(t.x,l),y:D(t.y,l)},p={x:D(e.x,l),y:D(e.y,l)};t.id="".concat(h.x,"|||").concat(h.y),e.id="".concat(p.x,"|||").concat(p.y);var d=H(h,t,i,p,o),g=H(p,e,a,h,o);d.forEach((function(t){delete c[t.id]})),g.forEach((function(t){delete c[t.id]}));for(var f={},y={},m={},b={},u={},x=new F,_=0;_<d.length;_++){var k=d[_];f[k.id]=k,b[k.id]=0,u[k.id]=Q(k,g,o.distFunc),x.add({id:k.id,value:u[k.id]})}var v,S,O,j,M,P,w=o.maximumLoops,N=1/0,z={};g.forEach((function(t){z["".concat(t.x,"|||").concat(t.y)]=!0})),Object.keys(f).forEach((function(t){var e=f[t].id;u[e]<=N&&(N=u[e],v=f[e])}));while(Object.keys(f).length>0&&w>0){var L=x.minId((w+1)%30===0);if(!L)break;if(v=f[L],z["".concat(v.x,"|||").concat(v.y)])return U(v,m,h,e,t,p,l);delete f[v.id],x.remove(v.id),y[v.id]=!0;for(_=0;_<o.directions.length;_++){S=o.directions[_];var X="".concat(Math.round(v.x)+S.stepX,"|||").concat(Math.round(v.y)+S.stepY);if(O={x:v.x+S.stepX,y:v.y+S.stepY,id:X},!y[X]&&(P=J(v,O,m,h),!(P>o.maxAllowedDirectionChange)&&!c[X])){f[X]||(f[X]=O);var Y=r[P];j=o.distFunc(v,O)+(isNaN(Y)?l:Y),M=b[v.id]+j;var I=b[X];I&&M>=I||(m[X]=v,b[X]=M,u[X]=M+Q(O,g,o.distFunc),x.add({id:X,value:u[X]}))}}w-=1}return o.fallbackRoute(t,e,i,a,o)};Object(n["k"])("polyline",{options:{color:n["e"].defaultEdge.color,size:n["e"].defaultEdge.size,style:{radius:0,offset:15,x:0,y:0,stroke:n["e"].defaultEdge.style.stroke,lineAppendWidth:n["e"].defaultEdge.style.lineAppendWidth},labelCfg:{style:{fill:n["e"].edgeLabel.style.fill,fontSize:n["e"].edgeLabel.style.fontSize,fontFamily:n["e"].windowFontFamily}},routeCfg:{obstacles:[],maxAllowedDirectionChange:Math.PI,maximumLoops:500,gridSize:10},stateStyles:Object(a["__assign"])({},n["e"].edgeStateStyles)},shapeType:"polyline",labelPosition:"center",drawShape:function(t,e){var i=this.getShapeStyle(t);0===i.radius&&delete i.radius;var a=e.addShape("path",{className:"edge-shape",name:"edge-shape",attrs:i});return e["shapeMap"]["edge-shape"]=a,a},getShapeStyle:function(t){var e=this.options.style,i={stroke:t.color},a=Object(s["mix"])({},e,i,t.style);t=this.getPathPoints(t),this.radius=a.radius,this.offset=a.offset;var o=t.startPoint,r=t.endPoint,l=this.getControlPoints(t),c=[o];l&&(c=c.concat(l)),c.push(r);var h=t.sourceNode,p=t.targetNode,d=a.radius,g=this.options.routeCfg,f=Object(s["mix"])({},g,t.routeCfg);f.offset=a.offset;var y=this.getPath(c,h,p,d,f,!Boolean(l));(Object(s["isArray"])(y)&&y.length<=1||Object(s["isString"])(y)&&-1===y.indexOf("L"))&&(y="M0 0, L0 0"),(isNaN(o.x)||isNaN(o.y)||isNaN(r.x)||isNaN(r.y))&&(y="M0 0, L0 0");var m=Object(s["mix"])({},n["e"].defaultEdge.style,a,{lineWidth:t.size,path:y});return m},updateShapeStyle:function(t,e){var i=e.getContainer();if(e.isVisible()){var a={stroke:t.color},n=i["shapeMap"]["edge-shape"]||i.find((function(t){return"edge-shape"===t.get("className")}))||e.getKeyShape(),o=t.size;t=this.getPathPoints(t);var r=t.startPoint,l=t.endPoint,c=this.getControlPoints(t),h=[r];c&&(h=h.concat(c)),h.push(l);var p=n.attr(),d=Object(s["mix"])({},a,p,t.style),g=t.sourceNode,f=t.targetNode,y=d.radius,m=this.options.routeCfg,b=Object(s["mix"])({},m,t.routeCfg);b.offset=d.offset;var u=this.getPath(h,g,f,y,b,!Boolean(c));(Object(s["isArray"])(u)&&u.length<=1||Object(s["isString"])(u)&&-1===u.indexOf("L"))&&(u="M0 0, L0 0"),(isNaN(r.x)||isNaN(r.y)||isNaN(l.x)||isNaN(l.y))&&(u="M0 0, L0 0"),p.endArrow&&!1===d.endArrow&&(t.style.endArrow={path:""}),p.startArrow&&!1===d.startArrow&&(t.style.startArrow={path:""});var x=Object(s["mix"])(a,n.attr(),{lineWidth:o,path:u},t.style);n&&n.attr(x)}},getPath:function(t,e,i,a,o,r){var l=o.offset,c=o.obstacles,h=o.simple;if(!l||t.length>2||!1===r){if(a)return W(t,a);var p=[];return Object(s["each"])(t,(function(t,e){0===e?p.push(["M",t.x,t.y]):p.push(["L",t.x,t.y])})),p}!1===h||(null===c||void 0===c?void 0:c.length)||(h=!0);var d=h?C(t[t.length-1],t[0],i,e,l):$(t[0],t[t.length-1],e,i,o);if(!d||!d.length)return"M0 0, L0 0";if(a){var g=W(d,a);return g}d=B(d);var f=n["h"].pointsToPolygon(d);return f}},"single-edge")}}]);