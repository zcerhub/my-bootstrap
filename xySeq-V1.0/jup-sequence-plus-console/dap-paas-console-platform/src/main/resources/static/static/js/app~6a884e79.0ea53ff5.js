(window["jsonpPaas4"]=window["jsonpPaas4"]||[]).push([["app~6a884e79"],{"061d":function(e,t,a){"use strict";a.r(t);a("99af"),a("b0c0");var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mode-page"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"main-content",attrs:{"element-loading-text":"加载中,请稍候......"}},[t("div",{staticClass:"main-left"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickAddNode}},[e._v("添加节点")]),t("el-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")]),!e.loading&&e.linksData.length>0?t("G6Dagre",{attrs:{chartData:e.chartData,height:"500px",width:"100%"},on:{"click-node":e.clickNode}}):t("el-empty",{attrs:{description:"暂无数据"}})],1),t("div",{staticClass:"main-right"},[t("el-descriptions",{staticClass:"margin-top",attrs:{title:e.baseInfo.name,column:2,size:"small"}},[t("template",{slot:"extra"},[t("el-button",{attrs:{type:"text",size:"small"},on:{click:e.refresh}},[e._v("刷新")])],1),t("el-descriptions-item",{attrs:{label:"数据中心"}},[e._v(" "+e._s(e.baseInfo.machineroomName)+" ")]),t("el-descriptions-item",{attrs:{label:"版本"}},[e._v(" "+e._s(e.baseInfo.softwareVersion)+" ")])],2),e.currentNode?[t("el-descriptions",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingNode,expression:"loadingNode"}],staticClass:"mt-10",staticStyle:{"padding-top":"15px","border-top":"1px solid #c6c6c6"},attrs:{title:"".concat(e.currentNode.value,":").concat(e.currentNode.port),column:2,size:"small"}},[t("el-descriptions-item",{attrs:{label:"角色"}},[t("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.currentNode.role,expression:"currentNode.role"}],attrs:{size:"mini"}},[e._v(e._s(e._f("F_register_zkRoleTypeOptions")(e.currentNode.role)))])],1),t("el-descriptions-item",{attrs:{label:"运行状态",span:2,labelStyle:{lineHeight:"28px"},contentStyle:{lineHeight:"28px"}}},[e._v(" "+e._s(e._f("F_registerInstanceStatusOptions")(e.currentNode.status))+" "),"1"===e.currentNode.status?t("el-button",{staticClass:"ml-10",attrs:{size:"mini",round:"",plain:"",type:"danger"},on:{click:function(t){return e.clickStop()}}},[e._v(" 停止 ")]):t("el-button",{staticClass:"ml-10",attrs:{type:"primary",size:"mini",round:"",plain:""},on:{click:function(t){return e.clickStart()}}},[e._v(" 启动 ")])],1),t("el-descriptions-item",{attrs:{label:"部署路径"}},[t("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.currentNode.deployPath,expression:"currentNode.deployPath"}],attrs:{size:"mini"}},[e._v(e._s(e.currentNode.deployPath))])],1)],1),t("el-divider"),t("button-list",{attrs:{data:e.buttonList}})]:e._e()],2)]),e.addmasternode?t("DialogAddNode",{attrs:{clusterId:e.clusterId,nodeType:e.nodeType_add,rowData:e.currentNode,refresh:e.refresh},model:{value:e.addmasternode,callback:function(t){e.addmasternode=t},expression:"addmasternode"}}):e._e()],1)},i=[],n=a("c7eb"),r=a("1da1"),s=a("5530"),c=a("ade3"),l=(a("14d9"),a("d3b7"),a("1bf2"),a("159b"),a("7686")),u=a("dd69"),d=a("172c"),f=a("d092"),m=a("4c3e"),p=a("ff51"),h=a("bc59"),g={filters:{F_registerInstanceStatusOptions:function(e){return Object(m["a"])(e,"registerInstanceStatusOptions")}},components:{G6Dagre:l["default"],DialogAddNode:f["default"]},data:function(){return Object(c["a"])(Object(c["a"])({baseInfo:{},loading:!1,loadingNode:!1,buttonList:[{label:"移除节点",click:this.clickNodeDelete}],chartData:{edges:[],nodes:[]},addmasternode:!1,currentNode:null,currentQueryNode:b(),linksData:[]},"loading",!1),"nodeType_add",0)},computed:{clusterId:function(){return this.$route.query.id},query:function(){return this.$route.query}},created:function(){this.getDetail(),this.baseInfo.name=this.query.name,this.baseInfo.machineroomName=this.query.machineroomName,this.baseInfo.softwareVersion=this.query.softwareVersion},methods:{clickStart:function(){var e=this;this.loadingNode=!0,Object(d["d"])(this.currentNode.id).then((function(t){200===t.code&&(e.refresh(),e.$message.success(t.data))})).finally((function(){e.loadingNode=!1}))},clickStop:function(){var e=this;this.loadingNode=!0,Object(d["f"])(this.currentNode.id).then((function(t){200===t.code&&(e.refresh(),e.$message.success(t.data))})).finally((function(){e.loadingNode=!1}))},getDetail:function(){var e=this;this.loading=!0,this.currentNode=null,Object(u["e"])(this.$route.query.id).then((function(t){if(t){var a=Object(p["a"])(null===t||void 0===t?void 0:t.data)?t.data:[];e.linksData=a;var o=[],i=[];a.forEach((function(e){var t=void 0;"1"===e.isMaster?t="main":"0"===e.isMaster&&(t="cong");var a=Object(m["a"])(e.status,"registerInstanceStatusOptions",["value","fill"]);o.push(Object(s["a"])(Object(s["a"])({},e),{},{value:e.ip,comboId:t,label:"".concat(e.ip,":").concat(e.port),style:{fill:a}}))})),e.chartData.nodes=o,e.chartData.edges=i}})).catch((function(e){})).finally((function(){e.loading=!1}))},clickAddNode:function(){this.nodeType_add=0,this.addmasternode=!0},clickNodeDelete:function(){var e=this;return Object(r["a"])(Object(n["a"])().mark((function t(){var a;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1!=e.currentNode.status){t.next=3;break}return e.clickConfirmDelete(),t.abrupt("return");case 3:return t.next=5,e.$confirm("确定要移除".concat(e.currentNode.ip,":").concat(e.currentNode.port,"吗?"),{type:"warning"}).catch((function(e){}));case 5:a=t.sent,"confirm"===a&&Object(u["a"])(e.currentNode.id).then((function(t){200==t.code&&(e.refresh(),e.$message.success("移除成功"))})).catch((function(t){e.$message.error(t)}));case 8:case"end":return t.stop()}}),t)})))()},clickConfirmDelete:function(){var e=this;return Object(r["a"])(Object(n["a"])().mark((function t(){var a;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$confirm("节点正在运行,确认删除吗?","提示",{type:"warning"}).catch((function(){}));case 2:a=t.sent,"confirm"===a&&Object(u["c"])(e.currentNode.id).then((function(t){200==t.code&&(e.refresh(),e.$message.success("移除成功"))})).catch((function(t){e.$message.error(t)}));case 4:case"end":return t.stop()}}),t)})))()},clickNode:function(e){this.currentNode=e},refresh:function(){this.getDetail()}}};function b(e){var t={pid:"",usedMemory:"",usedCpuSys:"",keys:"",clients:"",expires:"",flags:""};return e&&Reflect.ownKeys(t).forEach((function(a){Object(h["a"])(e,a)&&(t[a]=e[a])})),Object.assign(t,e)}var v=g,y=(a("b6d2"),a("2877")),C=Object(y["a"])(v,o,i,!1,null,"fedcc238",null);t["default"]=C.exports},"0acf":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"name-container"},[t("search-form",{attrs:{searchConfig:e.searchConfig},on:{onSearch:e.onSearch}}),t("comp-table",{ref:"compTable",attrs:{isMultiple:!1,loading:e.loading,"table-model":e.tableModel,"form-model":e.formModel,"search-model":e.searchModel},on:{submitHandle:e.submitAdd,editHandle:e.submitEdit,"delete-one":e.clickDelete,toPage:e.toPage,"click-edit-row":e.clickEditRow,changePage:e.changePage}},[t("span",{attrs:{slot:"dbUrl-label"},slot:"dbUrl-label"},[e._v(" url"),t("el-popover",{attrs:{placement:"top-start",title:"示例",width:"300",trigger:"hover",content:"jdbc:mysql://10.114.14.65:3306/nacosbackup?autoReconnect=true&useUnicode=true&characterEncoding=utf-8&useSSL=false&serverTimezone=GMT%2B8"}},[t("el-button",{attrs:{slot:"reference",type:"text",circle:"",icon:"el-icon-question"},slot:"reference"})],1)],1)])],1)},i=[],n=a("5530"),r=(a("14d9"),a("b0c0"),a("a9e3"),a("d3b7"),a("1b62")),s=a("ec41"),c=a("ff51"),l=a("f665"),u=r["a"].CommonSelectCreaterMix,d={filters:{},mixins:[u(["csMixCity","csMixMachineRoom"])],components:{},data:function(){return{loading:!1,tableModel:{tableData:[],rowData:[{prop:"name",label:"名称",align:"left"},{prop:"description",label:"描述"}],operateWidth:"220px",operateData:[{label:"节点管理",funName:"toPage",type:"manage"},{label:"编辑",type:"edit"},{label:"删除",type:"delete"}],pagination:{pageNo:1,pageSize:10,total:6,show:!0}},formModel:{formData:{id:"",name:"",clusterType:"",databaseUrl:"",databaseUsername:"",databasePassword:"",description:""},formLabelWidth:"130px",formFilds:[{label:"名称",prop:"name",type:"input",disabled:!1},{label:"数据库地址",prop:"databaseUrl",rows:4,type:"input"},{label:"数据库用户名",prop:"databaseUsername",type:"input"},{label:"数据库密码",prop:"databasePassword",type:"password"},{prop:"description",type:"textarea",label:"描述"}],btnData:[{type:"submit",style:"primary",label:"确定",handle:function(){}},{type:"cancle",label:"取消",style:"",handle:function(){}}],rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{max:20,message:"不能超过20个字符",trigger:"blur"}],databaseUrl:[{required:!0,message:"请输入数据库地址",trigger:"blur"}],databaseUsername:[{required:!0,message:"请输入数据库用户名",trigger:"blur"}],databasePassword:[{required:!0,message:"请输入数据库密码",trigger:"blur"}]}},searchModel:{btnGroup:[{type:"add",label:"新增"}]},roomOptions:[],searchConfig:{searchData:{databaseUsername:""},searchItem:[{prop:"databaseUsername",label:"名称",type:"input"}],rules:{}}}},created:function(){},mounted:function(){this.getList()},methods:{toPage:function(e){this.$router.push({path:"/register-center/register-sync-services/node-manage",query:{id:e.id,name:e.name}})},onSearch:function(e){this.tableModel.pagination.pageNo=1,this.getList()},getList:function(){var e=this,t={pageNo:this.tableModel.pagination.pageNo,pageSize:this.tableModel.pagination.pageSize,requestObject:this.searchConfig.searchData};this.loading=!0,Object(l["d"])(t).then((function(t){var a,o=Object(s["a"])(t,"data.data");e.tableModel.tableData=Object(c["a"])(o)?o:[],e.tableModel.pagination.total=Number(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.totalCount)||0})).finally((function(){e.loading=!1}))},submitAdd:function(e){var t=this,a=Object(n["a"])({},e);delete a.id,Object(l["b"])(a).then((function(e){200===e.code&&(t.$message.success("新增成功"),t.$refs.compTable.hideDialog(),t.getList())}))},submitEdit:function(e){var t=this;Object(l["e"])(e).then((function(e){200===e.code&&(t.$message.success("修改成功"),t.$refs.compTable.hideDialog(),t.getList())}))},clickDelete:function(e){var t=this;Object(l["a"])(e).then((function(e){200===e.code&&(t.$message.success("删除成功"),t.getList())}))},changePage:function(e,t){e&&(this.tableModel.pagination.pageNo=e),t&&(this.tableModel.pagination.pageNo=1,this.tableModel.pagination.pageSize=t),this.getList()},clickEditRow:function(e){this.csRepeatMachineRoom({cityId:e.cityId})}}},f=d,m=a("2877"),p=Object(m["a"])(f,o,i,!1,null,"7fd54df3",null);t["default"]=p.exports},"0ba1":function(e,t,a){},"170a":function(e,t,a){"use strict";a("a4e2")},"1dc4":function(e,t,a){},2281:function(e,t,a){"use strict";a.r(t);a("a4d3"),a("e01a"),a("498a");var o=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"定时详情",visible:e.visible,size:"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"120px",rules:e.rules,disabled:""}},[t("el-form-item",{attrs:{label:"当前集群",prop:"masterId"}},[e._v(" "+e._s(e.rowData.registryClusterName)+"("+e._s(e.rowData.cityName)+") ")]),t("el-form-item",{attrs:{label:"任务名称",prop:"jobName"}},[t("el-input",{staticClass:"form-item-width",model:{value:e.formData.jobName,callback:function(t){e.$set(e.formData,"jobName","string"===typeof t?t.trim():t)},expression:"formData.jobName"}})],1),t("el-form-item",{attrs:{label:"任务分组",prop:"jobGroup"}},[t("el-input",{staticClass:"form-item-width",model:{value:e.formData.jobGroup,callback:function(t){e.$set(e.formData,"jobGroup","string"===typeof t?t.trim():t)},expression:"formData.jobGroup"}})],1),t("el-form-item",{attrs:{label:"定时时间",prop:"jobCron"}},[t("el-input",{staticClass:"form-item-width",model:{value:e.formData.jobCron,callback:function(t){e.$set(e.formData,"jobCron","string"===typeof t?t.trim():t)},expression:"formData.jobCron"}})],1),t("el-form-item",{attrs:{label:"定时实现类",prop:"jobClassName"}},[t("el-input",{staticClass:"form-item-width",model:{value:e.formData.jobClassName,callback:function(t){e.$set(e.formData,"jobClassName","string"===typeof t?t.trim():t)},expression:"formData.jobClassName"}})],1),t("el-form-item",{attrs:{label:"目标集群",prop:"salveName"}},[t("el-input",{staticClass:"form-item-width",model:{value:e.formData.salveName,callback:function(t){e.$set(e.formData,"salveName","string"===typeof t?t.trim():t)},expression:"formData.salveName"}})],1),t("el-form-item",{attrs:{label:"任务描述",prop:"description"}},[t("el-input",{staticClass:"form-item-width",model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description","string"===typeof t?t.trim():t)},expression:"formData.description"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},i=[],n=a("ff32"),r=a("1b62"),s=a("9172"),c=r["a"].CommonSelectCreaterMix,l={components:{},mixins:[c(["csMixCity"])],model:{prop:"show",event:"change"},props:{show:Boolean,refresh:{type:Function,require:!0},rowData:{type:Object,default:function(){return{}}}},data:function(){return{registryClusterOptions:n["g"],configClusterRoleOptions:n["a"],formData:{jobName:"",jobGroup:"",jobCron:"",masterId:"",salveName:"",jobClassName:"",description:""},rules:{}}},computed:{visible:{get:function(){return this.show},set:function(e){this.$emit("change",!1)}},archId:function(){return this.$route.query.archId}},watch:{},created:function(){},mounted:function(){this.getDetailList()},methods:{getDetailList:function(){var e=this;Object(s["c"])({jobId:this.rowData.jobId}).then((function(t){200===t.code&&(e.formData=t.data)}))},clickCancel:function(){this.$emit("change",!1)},clickConfirm:function(){this.$emit("change",!1)}}},u=l,d=a("2877"),f=Object(d["a"])(u,o,i,!1,null,"0b6a29ff",null);t["default"]=f.exports},"2fe2":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e._self._c;return t("div",{style:{height:e.height,width:e.width},attrs:{id:"mountNode"}})},i=[],n=(a("cb29"),a("a15b"),a("7c3e")),r={name:"g6-dagre",components:{},mixins:[],props:{width:{type:String,default:"100%"},height:{type:String,default:"100%"},chartData:{type:Object,default:function(){return{nodes:[],edges:[]}}}},data:function(){return{graph:null}},computed:{},watch:{},created:function(){},mounted:function(){this.initDagre(),window.addEventListener("resize",this.resize)},destroyed:function(){window.removeEventListener("resize",this.resize),this.graph=null},methods:{initDagre:function(){var e=this,t=this.chartData;n["a"].registerNode("sql",{drawShape:function(e,t){var a=t.addShape("rect",{attrs:{x:-75,y:-25,width:150,height:50,radius:10,stroke:"#5B8FF9",lineWidth:1,fill:e.style.fill},name:"rect-shape"});return a}},"single-node");var a=1===t.nodes.length,o=new n["a"].Graph({container:"mountNode",fitView:!0,pixelRatio:2,maxZoom:a?3:10,layout:{type:"grid",begin:[20,20],nodeSize:150,preventOverlap:!0},animate:!0,defaultNode:{type:"sql",style:{stroke:"#C4E3B2",radius:7},labelCfg:{style:{fill:"#000",fontSize:14}}},comboStateStyles:{selected:{shadowBlur:1,lineWidth:1}},nodeStateStyles:{selected:{shadowColor:"#1d70f5",shadowBlur:10,lineWidth:2,cursor:"pointer"}},modes:{default:["drag-canvas","zoom-canvas","click-select",{type:"tooltip",formatText:function(e){var t=[];return t.join("\n")},offset:30}]}});o.data(t),o.render(),o.fitView(),this.graph=o,o.on("node:click",(function(t){t.target;var a=t.item,o=a.getModel();e.$emit("click-node",o)}))},resize:function(){var e=this.$el,t=e.offsetHeight,a=e.offsetWidth;this.graph.changeSize(a,t)}}},s=r,c=a("2877"),l=Object(c["a"])(s,o,i,!1,null,"eb2dfcd0",null);t["default"]=l.exports},"3e0c":function(e,t,a){"use strict";a.r(t);a("a4d3"),a("e01a"),a("99af"),a("498a");var o=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"定时备份库",visible:e.visible,size:"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"120px",rules:e.rules}},[t("el-form-item",{attrs:{label:"当前集群",prop:"masterId"}},[e._v(" "+e._s(e.rowData.registryClusterName)+"("+e._s(e.rowData.cityName)+") ")]),t("el-form-item",{attrs:{label:"任务名称",prop:"jobName"}},[t("el-input",{staticClass:"form-item-width",attrs:{placeholder:"请输入任务名称"},on:{change:e.changeJobName},model:{value:e.formData.jobName,callback:function(t){e.$set(e.formData,"jobName","string"===typeof t?t.trim():t)},expression:"formData.jobName"}})],1),t("el-form-item",{attrs:{label:"任务分组",prop:"jobGroup"}},[t("el-input",{staticClass:"form-item-width",attrs:{placeholder:"请输入任务分组"},model:{value:e.formData.jobGroup,callback:function(t){e.$set(e.formData,"jobGroup","string"===typeof t?t.trim():t)},expression:"formData.jobGroup"}})],1),t("el-form-item",{attrs:{label:"定时时间",prop:"jobCron"}},[t("CronGenerator",{attrs:{size:"small"},on:{change:e.changeCron,reset:e.resetCron},model:{value:e.formData.jobCron,callback:function(t){e.$set(e.formData,"jobCron",t)},expression:"formData.jobCron"}})],1),t("el-form-item",{attrs:{label:"定时实现类",prop:"jobClassName"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择定时实现类"},model:{value:e.formData.jobClassName,callback:function(t){e.$set(e.formData,"jobClassName",t)},expression:"formData.jobClassName"}},[t("el-option",{attrs:{value:"com.dap.paas.console.config.portal.datamigrate.JobImpl",label:"com.dap.paas.console.config.portal.datamigrate.JobImpl"}})],1)],1),t("el-form-item",{attrs:{label:"目标集群",prop:"salveId"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择目标集群",multiple:""},model:{value:e.formData.salveId,callback:function(t){e.$set(e.formData,"salveId",t)},expression:"formData.salveId"}},e._l(e.clusterList,(function(a){return t("el-option",{key:a.id,staticClass:"el-option-box",attrs:{disabled:a.id===e.rowData.id,value:a.id,label:"".concat(a.registryClusterName,"(").concat(a.cityName,")")}},[t("ul",{staticClass:"el-option-ul-between"},[t("li",[e._v(e._s(a.registryClusterName))]),t("li",[e._v(e._s(a.cityName))])])])})),1)],1),t("el-form-item",{attrs:{label:"任务描述",prop:"description"}},[t("el-input",{staticClass:"form-item-width",attrs:{placeholder:"请输入任务描述"},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description","string"===typeof t?t.trim():t)},expression:"formData.description"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},i=[],n=a("5530"),r=(a("d9e2"),a("a15b"),a("ff32")),s=a("1b62"),c=a("9172"),l=a("65ce"),u="0 0 12 * * ?",d=s["a"].CommonSelectCreaterMix,f={components:{CronGenerator:l["a"]},mixins:[d(["csMixCity"])],model:{prop:"show",event:"change"},props:{show:Boolean,refresh:{type:Function,require:!0},rowData:{type:Object,default:function(){return{}}},clusterList:{type:Array,default:function(){return[]}}},data:function(){var e=this,t=function(t,a,o){var i=e.formData,n=i.jobName,r=i.jobGroup;n&&r?Object(c["e"])({jobName:n,jobGroup:r}).then((function(e){1==e.data?o(new Error("该组定时器已经存在！！")):o()})).catch((function(e){o(e)})):o()};return{registryClusterOptions:r["g"],configClusterRoleOptions:r["a"],formData:{jobName:"",jobGroup:"",jobCron:u,masterId:"",salveId:"",jobClassName:"",description:""},rules:{jobName:[{required:!0,trigger:"blur",message:"请输入任务名称"}],jobGroup:[{required:!0,trigger:"blur",message:"请输入任务分组"},{validator:t,trigger:"blur"}],jobCron:[{required:!0,trigger:"blur",message:"请输入定时时间"}],salveId:[{required:!0,trigger:"change",message:"请选择目标集群"}],jobClassName:[{required:!0,trigger:"change",message:"请选择定时实现类"}]}}},computed:{visible:{get:function(){return this.show},set:function(e){this.$emit("change",!1)}},archId:function(){return this.$route.query.archId}},watch:{},created:function(){},mounted:function(){},methods:{changeJobName:function(){this.$refs.formRef.validateField("jobGroup")},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){var a=Object(n["a"])(Object(n["a"])({},e.formData),{},{multicenteClusterId:e.rowData.id,masterId:e.rowData.id});a.salveId=a.salveId.join(","),Object(c["b"])(a).then((function(t){t&&200===t.code&&(e.$message.success("定时配置成功"),e.$emit("change",!1),e.refresh())}))}}))},changeCron:function(e){this.formData.jobCron=e},resetCron:function(e){this.formData.jobCron=u}}},m=f,p=a("2877"),h=Object(p["a"])(m,o,i,!1,null,"796bb795",null);t["default"]=h.exports},"46c7":function(e,t,a){"use strict";a.r(t);a("99af"),a("caad"),a("b0c0");var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mode-page"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"main-content",attrs:{"element-loading-text":"加载中,请稍候......"}},[t("div",{staticClass:"main-left"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickAddNode}},[e._v("添加节点")]),t("el-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")]),!e.loading&&e.linksData.length>0?t("G6Dagre",{attrs:{chartData:e.chartData,height:"500px",width:"100%"},on:{"click-node":e.clickNode}}):t("el-empty",{attrs:{description:"暂无数据"}})],1),t("div",{staticClass:"main-right"},[t("el-descriptions",{staticClass:"margin-top",attrs:{title:e.baseInfo.name,column:2,size:"small"}},[t("template",{slot:"extra"},[t("el-button",{attrs:{type:"text",size:"small"},on:{click:e.refresh}},[e._v("刷新")])],1),t("el-descriptions-item",{attrs:{label:"名称"}},[e._v(" "+e._s(e.baseInfo.name)+" ")])],2),e.currentNode?[t("el-descriptions",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingNode,expression:"loadingNode"}],staticClass:"mt-10",staticStyle:{"padding-top":"15px","border-top":"1px solid #c6c6c6"},attrs:{title:"".concat(e.currentNode.value,":").concat(e.currentNode.port),column:1,size:"small"}},[t("el-descriptions-item",{attrs:{label:"数据中心名称"}},[e._v(" "+e._s(e.currentNode.idcName)+" ")]),t("el-descriptions-item",{attrs:{label:"运行状态",labelStyle:{lineHeight:"28px"},contentStyle:{lineHeight:"28px"}}},[e._v(" "+e._s(e._f("F_registerClusterStatusOptions")(e.currentNode.status))+" "),"2"===e.currentNode.status?t("el-button",{staticClass:"ml-10",attrs:{size:"mini",round:"",plain:"",type:"danger"},on:{click:function(t){return e.clickStop()}}},[e._v(" 停止 ")]):["1","3"].includes(e.currentNode.status)?t("el-button",{staticClass:"ml-10",attrs:{type:"primary",size:"mini",round:"",plain:""},on:{click:function(t){return e.clickStart()}}},[e._v(" 启动 ")]):e._e()],1),t("el-descriptions-item",{attrs:{label:"部署路径"}},[t("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.currentNode.deployPath,expression:"currentNode.deployPath"}],attrs:{size:"mini"}},[e._v(e._s(e.currentNode.deployPath))])],1)],1),t("div",{staticClass:"button-diliver"}),t("button-list",{attrs:{data:e.buttonList}})]:e._e()],2)]),e.addmasternode?t("DialogAddNode",{attrs:{clusterId:e.clusterId,nodeType:e.nodeType_add,rowData:e.currentNode,refresh:e.refresh},model:{value:e.addmasternode,callback:function(t){e.addmasternode=t},expression:"addmasternode"}}):e._e()],1)},i=[],n=a("c7eb"),r=a("1da1"),s=a("5530"),c=a("ade3"),l=(a("14d9"),a("d3b7"),a("1bf2"),a("159b"),a("2fe2")),u=(a("dd69"),a("172c"),a("8802")),d=a("8341"),f=a("4c3e"),m=a("ff51"),p=a("bc59"),h={filters:{F_registerClusterStatusOptions:function(e){return Object(f["a"])(e,"registerClusterStatusOptions")}},components:{G6Dagre:l["default"],DialogAddNode:d["default"]},data:function(){return Object(c["a"])(Object(c["a"])({baseInfo:{},loading:!1,loadingNode:!1,buttonList:[{label:"移除节点",click:this.clickNodeDelete},{label:"端口检测",click:this.clickCheckPort},{label:"部署",click:this.clickDeployment}],chartData:{edges:[],nodes:[]},addmasternode:!1,currentNode:null,currentQueryNode:g(),linksData:[]},"loading",!1),"nodeType_add",0)},computed:{clusterId:function(){return this.$route.query.id},query:function(){return this.$route.query}},created:function(){this.getDetail(),this.baseInfo.name=this.query.name,this.baseInfo.machineroomName=this.query.machineroomName,this.baseInfo.softwareVersion=this.query.softwareVersion},methods:{clickStart:function(){var e=this;this.loadingNode=!0,Object(u["f"])(this.currentNode.id).then((function(t){200===t.code&&(e.refresh(),e.$message.success(t.msg))})).finally((function(){e.loadingNode=!1}))},clickStop:function(){var e=this;this.loadingNode=!0,Object(u["g"])(this.currentNode.id).then((function(t){200===t.code&&(e.refresh(),e.$message.success(t.msg))})).finally((function(){e.loadingNode=!1}))},clickCheckPort:function(){var e=this;this.loading=!0,Object(u["a"])(this.currentNode.id).then((function(t){200==t.code&&(e.refresh(),e.$message.success("检测通过"))})).finally((function(){e.loading=!1})).catch((function(e){}))},clickDeployment:function(){var e=this;this.loading=!0,Object(u["c"])(this.currentNode.id).then((function(t){200==t.code&&(e.refresh(),e.$message.success("部署完成"))})).finally((function(){e.loading=!1})).catch((function(e){}))},getDetail:function(){var e=this;this.currentNode=null,this.loading=!0,Object(u["e"])(this.$route.query.id).then((function(t){if(t){var a=Object(m["a"])(null===t||void 0===t?void 0:t.data)?t.data:[];e.linksData=a;var o=[],i=[];a.forEach((function(e){var t=void 0;e.ip=e.machineIp,"1"===e.isMaster?t="main":"0"===e.isMaster&&(t="cong");var a=Object(f["a"])(e.status,"registerClusterStatusOptions",["value","fill"]);o.push(Object(s["a"])(Object(s["a"])({},e),{},{value:e.ip,comboId:t,label:"".concat(e.ip,":").concat(e.port),style:{fill:a}}))})),e.chartData.nodes=o,e.chartData.edges=i}})).catch((function(e){})).finally((function(){e.loading=!1}))},clickAddNode:function(){this.nodeType_add=0,this.addmasternode=!0},clickNodeDelete:function(){var e=this;return Object(r["a"])(Object(n["a"])().mark((function t(){var a;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(2!=e.currentNode.status){t.next=3;break}return e.$confirm("节点正在运行,不能删除","提示",{type:"warning",showConfirmButton:!1}).catch((function(){})),t.abrupt("return");case 3:return t.next=5,e.$confirm("确定要移除".concat(e.currentNode.ip,":").concat(e.currentNode.port,"吗?"),{type:"warning"}).catch((function(e){}));case 5:a=t.sent,"confirm"===a&&Object(u["b"])(e.currentNode.id).then((function(t){200==t.code&&(e.refresh(),e.$message.success("移除成功"))})).catch((function(t){e.$message.error(t)}));case 8:case"end":return t.stop()}}),t)})))()},clickNode:function(e){this.currentNode=e},refresh:function(){this.getDetail()}}};function g(e){var t={pid:"",usedMemory:"",usedCpuSys:"",keys:"",clients:"",expires:"",flags:""};return e&&Reflect.ownKeys(t).forEach((function(a){Object(p["a"])(e,a)&&(t[a]=e[a])})),Object.assign(t,e)}var b=h,v=(a("701e"),a("2877")),y=Object(v["a"])(b,o,i,!1,null,"432806b4",null);t["default"]=y.exports},4862:function(e,t,a){},"52ce":function(e,t,a){"use strict";a.r(t);a("99af");var o=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"数据迁移",visible:e.visible,size:"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"120px",rules:e.rules}},[t("el-form-item",{attrs:{label:"当前集群"}},[e._v(" "+e._s(e.rowData.registryClusterName)+"("+e._s(e.rowData.cityName)+") ")]),t("el-form-item",{attrs:{label:"目标集群",prop:"targetMoveId"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择目标集群",multiple:""},model:{value:e.formData.targetMoveId,callback:function(t){e.$set(e.formData,"targetMoveId",t)},expression:"formData.targetMoveId"}},e._l(e.clusterList,(function(a){return t("el-option",{key:a.id,staticClass:"el-option-box",attrs:{disabled:a.id===e.rowData.id,value:a.id,label:"".concat(a.registryClusterName,"(").concat(a.cityName,")")}},[t("ul",{staticClass:"el-option-ul-between"},[t("li",[e._v(e._s(a.registryClusterName))]),t("li",[e._v(e._s(a.cityName))])])])})),1)],1),t("el-form-item",{attrs:{label:"迁移类型",prop:"dataMoveType"}},[t("el-radio-group",{model:{value:e.formData.dataMoveType,callback:function(t){e.$set(e.formData,"dataMoveType",t)},expression:"formData.dataMoveType"}},e._l(e.dataMoveTypeOptions,(function(a){return t("el-radio",{key:a.value,attrs:{label:a.value}},[e._v(e._s(a.label))])})),1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{loading:e.loadingConfirm,type:"primary"},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},i=[],n=(a("a15b"),a("d3b7"),a("ff32")),r=a("9172"),s={components:{},mixins:[],model:{prop:"show",event:"change"},props:{show:Boolean,refresh:{type:Function,require:!0},rowData:{type:Object,default:function(){return{}}},clusterList:{type:Array,default:function(){return[]}}},data:function(){return{dataMoveTypeOptions:n["d"],formData:{targetMoveId:"",dataMoveType:"2"},rules:{targetMoveId:[{required:!0,trigger:"blur",message:"请选择目标集群"}],dataMoveType:[{required:!0,trigger:"blur",message:"请选择数据迁移类型"}]},loadingConfirm:!1}},computed:{visible:{get:function(){return this.show},set:function(e){this.$emit("change",!1)}}},watch:{},created:function(){},mounted:function(){},methods:{clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){var a={masterId:e.rowData.id,slaveId:e.formData.targetMoveId.join(","),dataMoveType:e.formData.dataMoveType};e.loadingConfirm=!0,Object(r["a"])(a).then((function(t){t&&200===t.code&&(e.$message.success("迁移成功"),e.$emit("change",!1),e.refresh())})).finally((function(){e.loadingConfirm=!1}))}}))}}},c=s,l=(a("a1f9"),a("2877")),u=Object(l["a"])(c,o,i,!1,null,"00f7a808",null);t["default"]=u.exports},"554e":function(e,t,a){"use strict";a("0ba1")},"5bf8":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"添加集群",visible:e.visible,size:"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"120px",rules:e.rules}},[t("el-form-item",{attrs:{label:"地区",prop:"cityId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择地区"},on:{change:e.changeCityId},model:{value:e.formData.cityId,callback:function(t){e.$set(e.formData,"cityId",t)},expression:"formData.cityId"}},e._l(e.csMixCity,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"数据中心",prop:"machineRoomId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择数据中心"},on:{change:e.changeMachineRoomId},model:{value:e.formData.machineRoomId,callback:function(t){e.$set(e.formData,"machineRoomId",t)},expression:"formData.machineRoomId"}},e._l(e.csMixMachineRoom,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"注册中心类型",prop:"clusterType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择注册中心类型"},on:{change:e.changeClusterType},model:{value:e.formData.clusterType,callback:function(t){e.$set(e.formData,"clusterType",t)},expression:"formData.clusterType"}},e._l(e.registryClusterOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"注册中心",prop:"clusterId"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择注册中心"},model:{value:e.formData.clusterId,callback:function(t){e.$set(e.formData,"clusterId",t)},expression:"formData.clusterId"}},e._l(e.opts_registerCenter,(function(e){return t("el-option",{key:e.id,attrs:{label:e.clusterName,value:e.id}})})),1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},i=[],n=a("c7eb"),r=a("1da1"),s=(a("4de4"),a("d3b7"),a("ff32")),c=a("1b62"),l=a("97e7"),u=a("58db"),d=a("070e"),f=a("73c0"),m=a("ff51"),p=c["a"].CommonSelectCreaterMix,h={components:{},mixins:[p(["csMixCity","csMixMachineRoom"])],model:{prop:"show",event:"change"},props:{show:Boolean,refresh:{type:Function,require:!0}},data:function(){return{loading:!1,registryClusterOptions:s["g"].filter((function(e){return"2"!==e.value})),opts_registerCenter:[],formData:{cityId:"",machineRoomId:"",clusterType:"",clusterId:""},rules:{cityId:[{required:!0,trigger:"change",message:"请选择地区"}],clusterType:[{required:!0,trigger:"change",message:"请选择注册中心类型"}],machineRoomId:[{required:!0,trigger:"change",message:"请选择数据中心"}],clusterId:[{required:!0,trigger:"change",message:"请选择注册中心"}]}}},computed:{visible:{get:function(){return this.show},set:function(e){this.$emit("change",!1)}},multiConfigId:function(){return this.$route.query.archId}},watch:{},created:function(){},mounted:function(){},methods:{changeCityId:function(e){this.csMixMachineRoom=[],this.formData.machineRoomId="",e&&this.csRepeatMachineRoom({cityId:e}),this.getRegisterCenter()},changeMachineRoomId:function(){this.getRegisterCenter()},changeClusterType:function(){this.getRegisterCenter()},getRegisterCenter:function(){var e=this;return Object(r["a"])(Object(n["a"])().mark((function t(){var a,o,i,r;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.opts_registerCenter=[],e.formData.clusterId="",a=Object(d["a"])(e.formData,["cityId","machineRoomId","clusterType"]),o=Object(f["a"])(a,(function(e){return Boolean(e)})),o){t.next=6;break}return t.abrupt("return");case 6:return i=[],t.prev=7,t.next=10,Object(u["c"])(a);case 10:r=t.sent,i=Object(m["a"])(null===r||void 0===r?void 0:r.data)?r.data:[],i.length>0&&e.$refs.formRef.clearValidate("clusterId"),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](7);case 18:e.opts_registerCenter=i;case 19:case"end":return t.stop()}}),t,null,[[7,15]])})))()},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;return Object(r["a"])(Object(n["a"])().mark((function t(){var a,o,i;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=4,e.$refs.formRef.validate();case 4:if(a=t.sent,a){t.next=7;break}return t.abrupt("return");case 7:return o={clusterId:e.formData.clusterId,multiConfigId:e.multiConfigId},t.next=10,Object(l["c"])(o);case 10:i=t.sent,i&&200===i.code&&(e.$message.success("新增成功"),e.$emit("change",!1),e.refresh()),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](0);case 17:e.loading=!1;case 18:case"end":return t.stop()}}),t,null,[[0,14]])})))()}}},g=h,b=a("2877"),v=Object(b["a"])(g,o,i,!1,null,"3d3d8f5a",null);t["default"]=v.exports},"5f16":function(e,t,a){},"701e":function(e,t,a){"use strict";a("4862")},7686:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e._self._c;return t("div",{style:{height:e.height,width:e.width},attrs:{id:"mountNode"}})},i=[],n=(a("cb29"),a("a15b"),a("7c3e")),r={name:"g6-dagre",components:{},mixins:[],props:{width:{type:String,default:"100%"},height:{type:String,default:"100%"},chartData:{type:Object,default:function(){return{nodes:[],edges:[]}}}},data:function(){return{graph:null}},computed:{},watch:{},created:function(){},mounted:function(){this.initDagre(),window.addEventListener("resize",this.resize)},destroyed:function(){window.removeEventListener("resize",this.resize),this.graph=null},methods:{initDagre:function(){var e=this,t=this.chartData;n["a"].registerNode("sql",{drawShape:function(e,t){var a=t.addShape("rect",{attrs:{x:-75,y:-25,width:150,height:50,radius:10,stroke:"#5B8FF9",lineWidth:1,fill:e.style.fill},name:"rect-shape"});return a}},"single-node");var a=1===t.nodes.length,o=new n["a"].Graph({container:"mountNode",fitView:!0,pixelRatio:2,maxZoom:a?3:10,layout:{type:"grid",begin:[20,20],nodeSize:150,preventOverlap:!0},animate:!0,defaultNode:{type:"sql",style:{stroke:"#C4E3B2",radius:7},labelCfg:{style:{fill:"#000",fontSize:14}}},comboStateStyles:{selected:{shadowBlur:1,lineWidth:1}},nodeStateStyles:{selected:{shadowColor:"#1d70f5",shadowBlur:10,lineWidth:2,cursor:"pointer"}},modes:{default:["drag-canvas","zoom-canvas","click-select",{type:"tooltip",formatText:function(e){var t=[];return t.join("\n")},offset:30}]}});o.data(t),o.render(),o.fitView(),this.graph=o,o.on("node:click",(function(t){t.target;var a=t.item,o=a.getModel();e.$emit("click-node",o)}))},resize:function(){var e=this.$el,t=e.offsetHeight,a=e.offsetWidth;this.graph.changeSize(a,t)}}},s=r,c=a("2877"),l=Object(c["a"])(s,o,i,!1,null,"5b8c92e0",null);t["default"]=l.exports},8341:function(e,t,a){"use strict";a.r(t);a("99af"),a("498a");var o=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"添加节点",visible:e.visible,loading:e.loading,size:"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"120px",rules:e.rules}},[t("el-form-item",{attrs:{label:"数据中心",prop:"idcId"}},[t("el-select",{staticClass:"w-100",attrs:{size:"mini",placeholder:"请选择数据中心"},on:{change:e.getIps},model:{value:e.formData.idcId,callback:function(t){e.$set(e.formData,"idcId",t)},expression:"formData.idcId"}},e._l(e.opts_idcId,(function(e){return t("el-option",{key:e.id,staticClass:"el-option-box",attrs:{label:e.machineRoomName,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"机器",prop:"machineId"}},[t("el-select",{staticClass:"w-100",attrs:{size:"mini",placeholder:"请选择机器"},on:{change:e.changeIp},model:{value:e.formData.machineId,callback:function(t){e.$set(e.formData,"machineId",t)},expression:"formData.machineId"}},e._l(e.machineList,(function(a){return t("el-option",{key:a.id,staticClass:"el-option-box",attrs:{label:"".concat(a.hostIp,"(").concat(a.hostSshAccount,")"),value:a.id}},[t("ul",{staticClass:"el-option-ul-between"},[t("li",[e._v(e._s(a.hostIp))]),t("li",[e._v(e._s(a.hostSshAccount))])])])})),1)],1),t("el-form-item",{attrs:{label:"部署路径"}},[t("el-input",{staticClass:"w-100",attrs:{placeholder:"请输入部署路径",size:"mini"},model:{value:e.formData.deployPath,callback:function(t){e.$set(e.formData,"deployPath","string"===typeof t?t.trim():t)},expression:"formData.deployPath"}})],1),t("el-form-item",{attrs:{label:"启动端口",prop:"port"}},[t("el-input-number",{staticClass:"w-100",attrs:{size:"mini","controls-position":"right",min:1e3,max:65535,placeholder:"端口"},model:{value:e.formData.port,callback:function(t){e.$set(e.formData,"port",t)},expression:"formData.port"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},i=[],n=a("5530"),r=(a("7db0"),a("a9e3"),a("d3b7"),a("4c3e")),s=a("dd69"),c=a("8802"),l=a("a63c"),u=a("ff51"),d={components:{},model:{prop:"show",event:"change"},props:{show:Boolean,refresh:Function,rowData:{type:Object,default:function(){return{}}},clusterId:{type:String,default:void 0},nodeType:{type:Number,default:void 0}},data:function(){return{zkRoleTypeOptions:r["h"],opts_idcId:[],formData:{machineId:"",deployPath:"",port:1e3},machineList:[],rules:{machineId:[{required:!0,trigger:"blur",message:"请选择节点"}],deployPath:[{required:!0,trigger:"blur",message:"请选择部署路径"}],port:[{required:!0,trigger:"blur",message:"请输入端口"}],role:[{required:!0,trigger:"blur",message:"请角色类型"}]},options:[],loading:!1}},computed:{visible:{get:function(){return this.show},set:function(e){this.$emit("change",!1)}},machineRoomId:function(){return this.$route.query.machineRoomId},clusterType:function(){return this.$route.query.clusterType}},watch:{},created:function(){this.getOpts_idcId()},mounted:function(){},methods:{getOpts_idcId:function(){var e=this,t={};Object(l["a"])(t).then((function(t){e.opts_idcId=Object(u["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).catch((function(e){}))},getIps:function(){var e=this;Object(s["d"])(this.formData.idcId).then((function(t){e.machineList=Object(u["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).catch((function(e){}))},changeIp:function(e){var t=this.machineList.find((function(t){return t.id===e})),a="";t&&t.deploymentPath&&(a=t.deploymentPath),this.formData.deployPath=a},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){var a=Object(n["a"])({serverId:e.$route.query.id},e.formData);e.loading=!0,Object(c["d"])(a).then((function(t){t&&200===t.code&&(e.$message.success("新增成功"),e.$emit("change",!1),e.refresh())})).finally((function(){e.loading=!1}))}}))}}},f=d,m=(a("554e"),a("2877")),p=Object(m["a"])(f,o,i,!1,null,"42a1865e",null);t["default"]=p.exports},9631:function(e,t,a){"use strict";a("5f16")},a1f9:function(e,t,a){"use strict";a("1dc4")},a4e2:function(e,t,a){},b6d2:function(e,t,a){"use strict";a("f192")},ce5a8:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e._self._c;return t("div",[t("header",[t("el-button",{attrs:{type:"primary"},on:{click:e.clickAddCluster}},[e._v("添加集群")]),t("el-button",{on:{click:e.clickRefresh}},[e._v("刷新")])],1),t("main",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[e.clusterData.length>0?t("el-row",{staticClass:"mt-15",attrs:{gutter:10}},e._l(e.clusterData,(function(a){return t("el-col",{key:a.id,attrs:{span:8}},[t("div",{staticClass:"multiple-card p-10"},[t("el-descriptions",{attrs:{column:1}},[t("span",{staticStyle:{"font-size":"14px"},attrs:{slot:"title"},slot:"title"},[e._v(e._s(a.clusterName))]),a.clusterRole?t("div",{attrs:{slot:"extra"},slot:"extra"},[t("el-tag",{attrs:{size:"small",type:e.dictTagType(a.clusterRole),effect:"dark"}},[e._v(e._s(e._f("F_config_clusterRole")(a.clusterRole)))])],1):e._e(),t("el-descriptions-item",{attrs:{label:"注册中心版本"}},[e._v(e._s(a.softwareVersion))]),t("el-descriptions-item",{attrs:{label:"注册中心状态"}},[e.dictReg_status.has(a.status)?t("span",[t("hubary-dot",{attrs:{status:e.dictReg_status.getItem(a.status).status}},[e._v(e._s(e.dictReg_status.get(a.status)))])],1):e._e()]),t("el-descriptions-item",{attrs:{label:"注册中心类型"}},[e._v(e._s(e._f("F_config_registryCluster")(a.clusterType)))])],1),t("footer",[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.clickBackFooter("delete",a)}}},[e._v("删除")])],1)],1)])})),1):t("el-empty")],1),e.visible?t("ClusterAdd",{attrs:{refresh:e.getList},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}}):e._e()],1)},i=[],n=a("c7eb"),r=a("1da1"),s=a("ff32"),c=a("98ab"),l=a("4c3e"),u=(a("ca9d"),a("97e7")),d=a("ff51"),f=a("5bf8"),m=(a("52ce"),a("3e0c"),a("2281"),{name:"ComponentName",filters:{F_config_clusterRole:function(e){return Object(s["e"])(e,"configClusterRoleOptions")},F_config_registryCluster:function(e){return Object(s["e"])(e,"registryClusterOptions")}},components:{ClusterAdd:f["default"]},mixins:[],props:{},data:function(){return{visible:!1,visibleMove:!1,visibleTimer:!1,visibleDetail:!1,loading:!1,clusterData:[],rowData:null,params:"",dictReg_status:c["a"]}},computed:{multiConfigId:function(){return this.$route.query.archId}},watch:{},created:function(){},mounted:function(){this.getList()},methods:{clickRefresh:function(){this.getList()},dictTagType:function(e){return Object(s["e"])(e,"configClusterRoleOptions",["value","type"])},dictRegisterStatus:function(e){return Object(s["e"])(e,l["c"])},dictRegisterStatusTag:function(e){return Object(s["e"])(e,l["c"],["value","status"])},dictRegisterTimeStatus:function(e){return Object(s["e"])(e,l["e"])},dictRegisterTimeStatusTag:function(e){return Object(s["e"])(e,l["e"],["value","status"])},dictRegisterRevStopStatus:function(e){return Object(s["e"])(e,l["d"])},dictRegisterStatusRevStopTag:function(e){return Object(s["e"])(e,l["d"],["value","status"])},getList:function(){var e=this;return Object(r["a"])(Object(n["a"])().mark((function t(){var a,o,i;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={multiConfigId:e.multiConfigId},e.loading=!0,o=[],t.prev=3,t.next=6,Object(u["a"])(a);case 6:i=t.sent,o=Object(d["a"])(null===i||void 0===i?void 0:i.data)?i.data:[],t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](3);case 13:e.clusterData=o,e.loading=!1;case 15:case"end":return t.stop()}}),t,null,[[3,10]])})))()},clickAddCluster:function(){this.visible=!0},clickBackFooter:function(e,t){var a=this;switch(e){case"delete":this.$confirm("确定要删除【".concat(t.clusterName,"】吗"),{type:"warning"}).then((function(){Object(u["b"])(t.id).then((function(e){200===e.code&&(a.$message.success("删除成功"),a.clickRefresh())})).catch((function(e){}))}));break}}}}),p=m,h=(a("170a"),a("2877")),g=Object(h["a"])(p,o,i,!1,null,"721a3d7e",null);t["default"]=g.exports},d092:function(e,t,a){"use strict";a.r(t);a("99af"),a("498a");var o=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"添加节点",visible:e.visible,loading:e.loading,size:"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"120px",rules:e.rules}},[1===e.nodeType?t("el-form-item",{attrs:{label:"父节点"}},[e._v(" "+e._s("".concat(e.rowData.ip,":").concat(e.rowData.port))+" ")]):e._e(),"1"===e.clusterType?t("el-form-item",{attrs:{label:"角色类型",prop:"role"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择角色类型"},model:{value:e.formData.role,callback:function(t){e.$set(e.formData,"role",t)},expression:"formData.role"}},e._l(e.zkRoleTypeOptions,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),t("el-form-item",{attrs:{label:"机器",prop:"machineId"}},[t("el-select",{staticClass:"w-100",attrs:{size:"mini",placeholder:"请选择机器"},on:{change:e.changeIp},model:{value:e.formData.machineId,callback:function(t){e.$set(e.formData,"machineId",t)},expression:"formData.machineId"}},e._l(e.machineList,(function(a){return t("el-option",{key:a.id,staticClass:"el-option-box",attrs:{label:"".concat(a.hostIp,"(").concat(a.hostSshAccount,")"),value:a.id}},[t("ul",{staticClass:"el-option-ul-between"},[t("li",[e._v(e._s(a.hostIp))]),t("li",[e._v(e._s(a.hostSshAccount))])])])})),1)],1),t("el-form-item",{attrs:{label:"节点端口",prop:"port"}},[t("el-input-number",{staticClass:"w-100",attrs:{size:"mini","controls-position":"right",min:1e3,max:65535,placeholder:"端口"},model:{value:e.formData.port,callback:function(t){e.$set(e.formData,"port",t)},expression:"formData.port"}})],1),t("el-form-item",{attrs:{label:"部署路径"}},[t("el-input",{staticClass:"w-100",attrs:{placeholder:"请输入部署路径",size:"mini"},model:{value:e.formData.deployPath,callback:function(t){e.$set(e.formData,"deployPath","string"===typeof t?t.trim():t)},expression:"formData.deployPath"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},i=[],n=a("5530"),r=(a("7db0"),a("a9e3"),a("d3b7"),a("4c3e")),s=a("dd69"),c=a("ff51"),l={components:{},model:{prop:"show",event:"change"},props:{show:Boolean,refresh:Function,rowData:{type:Object,default:function(){return{}}},clusterId:{type:String,default:void 0},nodeType:{type:Number,default:void 0}},data:function(){return{zkRoleTypeOptions:r["h"],formData:{machineId:"",deployPath:"",port:1e3,role:""},machineList:[],rules:{machineId:[{required:!0,trigger:"blur",message:"请选择节点"}],port:[{required:!0,trigger:"blur",message:"请输入端口"}],role:[{required:!0,trigger:"blur",message:"请角色类型"}]},options:[],loading:!1}},computed:{visible:{get:function(){return this.show},set:function(e){this.$emit("change",!1)}},machineRoomId:function(){return this.$route.query.machineRoomId},clusterType:function(){return this.$route.query.clusterType}},watch:{},created:function(){},mounted:function(){this.getIps()},methods:{getIps:function(){var e=this;Object(s["d"])(this.machineRoomId).then((function(t){e.machineList=Object(c["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).catch((function(e){}))},changeIp:function(e){var t=this.machineList.find((function(t){return t.id===e})),a="";t&&t.deploymentPath&&(a=t.deploymentPath),this.formData.deployPath=a},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){var a=Object(n["a"])({clusterId:e.clusterId},e.formData);e.loading=!0,Object(s["b"])(a).then((function(t){t&&200===t.code&&(e.$message.success("新增成功"),e.$emit("change",!1),e.refresh())})).finally((function(){e.loading=!1}))}}))}}},u=l,d=(a("9631"),a("2877")),f=Object(d["a"])(u,o,i,!1,null,"e5f2cf80",null);t["default"]=f.exports},d1b1:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"name-container"},[t("search-form",{attrs:{searchConfig:e.searchConfig},on:{onSearch:e.onSearch}}),t("comp-table",{ref:"compTable",attrs:{isMultiple:!1,loading:e.loading,"table-model":e.tableModel,"form-model":e.formModel,"search-model":e.searchModel},on:{submitHandle:e.submitAdd,editHandle:e.submitEdit,"delete-one":e.clickDelete,toPage:e.toPage,fast_deploy:e.fast_deploy,fast_stop:e.fast_stop,fast_start:e.fast_start,check_ip_port:e.check_ip_port,"click-edit-row":e.clickEditRow,changePage:e.changePage}},[t("span",{attrs:{slot:"dbUrl-label"},slot:"dbUrl-label"},[e._v(" url"),t("el-popover",{attrs:{placement:"top-start",title:"示例",width:"300",trigger:"hover",content:"jdbc:mysql://10.114.14.65:3306/nacosbackup?autoReconnect=true&useUnicode=true&characterEncoding=utf-8&useSSL=false&serverTimezone=GMT%2B8"}},[t("el-button",{attrs:{slot:"reference",type:"text",circle:"",icon:"el-icon-question"},slot:"reference"})],1)],1)])],1)},i=[],n=a("5530"),r=(a("caad"),a("14d9"),a("a9e3"),a("d3b7"),a("159b"),a("58db")),s=a("1b62"),c=a("ec41"),l=a("ff51"),u=a("172c"),d=a("4c3e"),f=a("fbd2"),m=s["a"].CommonSelectCreaterMix,p={filters:{},mixins:[m(["csMixCity","csMixMachineRoom"])],components:{},data:function(){var e=this,t=(this.$createElement,this);return{loading:!1,tableModel:{tableData:[],rowData:[{prop:"clusterName",label:"名称",align:"left"},{prop:"cityName",label:"地区"},{prop:"machineName",label:"数据中心",align:"left"},{prop:"clusterType",label:"类型",format:function(e){return Object(d["a"])(e,"linkProtocolOptions")}},{prop:"softwareVersion",label:"版本"},{prop:"status",label:"状态",align:"left",render:function(e,t){var a=t.row,o=Object(d["a"])(a.status,"registerClusterStatusOptions",[],!0);return o?e("hubaryDot",{attrs:{status:o.status,text:o.label}}):e("span")}}],operateWidth:"220px",operateData:[{label:"节点管理",funName:"toPage",type:"manage"},{label:"编辑",type:"edit"},{label:"一键部署",type:"fast_deploy",funName:"fast_deploy",isShow:function(e){return["0","3"].includes(e.status)}},{label:"一键停止",type:"fast_stop",funName:"fast_stop",isShow:function(e){return["1","2"].includes(e.status)}},{label:"一键启动",type:"fast_start",funName:"fast_start",isShow:function(e){return["1","3"].includes(e.status)}},{label:"IP和端口检测",type:"check_ip_port",funName:"check_ip_port",isShow:function(e){return"0"===e.status}},{label:"删除",type:"delete"}],pagination:{pageNo:1,pageSize:10,total:6,show:!0}},formModel:{formData:{id:"",clusterName:"",clusterType:"",dbUrl:"",dbUser:"",dbPassword:"",softwareVersion:"",cityId:"",machineRoomId:"",communicatePort:1e3,electPort:1e3},formLabelWidth:"130px",formFilds:[{label:"名称",prop:"clusterName",type:"input",disabled:!1},{label:"类型",prop:"clusterType",type:"select",disabled:!1,options:d["b"],change:function(t){e.formModel.formData.softwareVersion=""}},{label:"通讯端口",prop:"communicatePort",type:"number-el",computedShow:function(){return 1==e.formModel.formData.clusterType},width:"100%",attrs:{min:1e3,max:65535}},{label:"选举端口",prop:"electPort",type:"number-el",computedShow:function(){return 1==e.formModel.formData.clusterType},width:"100%",attrs:{min:1e3,max:65535}},{label:"版本",prop:"softwareVersion",type:"select",disabled:!1,get options(){var e=t.formModel.formData.clusterType,a=[];switch(e){case"3":a=d["f"];break;case"1":a=d["g"];break}return a}},{label:"url",prop:"dbUrl",rows:4,type:"textarea",computedShow:function(){return 3==e.formModel.formData.clusterType}},{label:"user",prop:"dbUser",type:"input",computedShow:function(){return 3==e.formModel.formData.clusterType}},{label:"password",prop:"dbPassword",type:"password",computedShow:function(){return 3==e.formModel.formData.clusterType}},{label:"地区",prop:"cityId",type:"select",disabled:!1,get options(){return t.csMixCity},change:function(t){e.csMixMachineRoom=[],e.formModel.formData.machineRoomId="",t&&e.csRepeatMachineRoom({cityId:t})}},{label:"数据中心",prop:"machineRoomId",type:"select",disabled:!1,get options(){return t.csMixMachineRoom}},{prop:"description",type:"textarea",label:"描述"}],btnData:[{type:"submit",style:"primary",label:"确定",handle:function(){}},{type:"cancle",label:"取消",style:"",handle:function(){}}],rules:{clusterName:[{required:!0,message:"请输入名称",trigger:"blur"},{max:20,message:"不能超过20个字符",trigger:"blur"}],clusterType:[{required:!0,message:"请选择类型",trigger:"change"}],softwareVersion:[{required:!0,message:"请选择版本",trigger:"change"}],communicatePort:[{required:!0,message:"请输入通讯端口",trigger:"change"}],electPort:[{required:!0,message:"请输入选举端口",trigger:"change"}],machineRoomId:[{required:!0,message:"请选择机房",trigger:"change"}],cityId:[{required:!0,message:"请选择地区",trigger:"change"}],dbUrl:[{required:!0,message:"请输入url",trigger:"blur"}],dbUser:[{required:!0,message:"请输入user",trigger:"blur"}],dbPassword:[{required:!0,message:"请输入password",trigger:"blur"}]}},searchModel:{btnGroup:[{type:"add",label:"新增"}]},roomOptions:[],searchConfig:{searchData:{clusterName:"",machineRoomId:"",cityId:""},searchItem:[{prop:"clusterName",label:"名称",type:"input"},{prop:"cityId",label:"地区",type:"select",get options(){return t.csMixCity},change:function(t){e.roomOptions=[],e.searchConfig.searchData.machineRoomId="",e.getRoom()}},{prop:"machineRoomId",type:"select",label:"机房",get options(){return t.roomOptions}}],rules:{}}}},created:function(){},mounted:function(){this.getList()},methods:{toPage:function(e){this.$router.push({path:"/register-center/node-manage",query:{id:e.id,name:e.clusterName,clusterType:e.clusterType,machineroomName:e.machineName,machineRoomId:e.machineRoomId,softwareVersion:e.softwareVersion}})},onSearch:function(e){this.tableModel.pagination.pageNo=1,this.getList()},getList:function(){var e=this,t={pageNo:this.tableModel.pagination.pageNo,pageSize:this.tableModel.pagination.pageSize,requestObject:this.searchConfig.searchData};this.loading=!0,Object(r["d"])(t).then((function(t){var a,o=Object(c["a"])(t,"data.data");e.tableModel.tableData=Object(l["a"])(o)?o:[],e.tableModel.pagination.total=Number(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.totalCount)||0})).finally((function(){e.loading=!1}))},submitAdd:function(e){var t=this,a=Object(n["a"])({},e);delete a.id,Object(r["b"])(a).then((function(e){200===e.code&&(t.$message.success("新增成功"),t.$refs.compTable.hideDialog(),t.getList())}))},submitEdit:function(e){var t=this;Object(r["e"])(e).then((function(e){200===e.code&&(t.$message.success("修改成功"),t.$refs.compTable.hideDialog(),t.getList())}))},clickDelete:function(e){var t=this;Object(r["a"])(e).then((function(e){200===e.code&&(t.$message.success("删除成功"),t.getList())}))},getRoom:function(){var e=this,t=this.searchConfig.searchData.cityId;this.searchConfig.searchData.machineRoomId="",this.roomOptions=[],t&&Object(f["d"])({cityId:t}).then((function(t){var a=Object(l["a"])(t.data)?t.data:[];a.forEach((function(e){e.label=e.machineRoomName,e.value=e.id})),e.roomOptions=a})).catch((function(e){}))},changePage:function(e,t){e&&(this.tableModel.pagination.pageNo=e),t&&(this.tableModel.pagination.pageNo=1,this.tableModel.pagination.pageSize=t),this.getList()},clickEditRow:function(e){this.csRepeatMachineRoom({cityId:e.cityId})},fast_deploy:function(e){var t=this,a=this.$createElement;this.$msgbox({title:"提示",message:a("p",null,[a("span",null,"确定要一键部署【".concat(e.clusterName,"】吗??")),a("i",{style:"color: teal"})]),showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:function(a,o,i){"confirm"===a?(o.confirmButtonLoading=!0,o.confirmButtonText="执行中...",Object(u["b"])(e.id).then((function(e){t.$message.success("一键部署成功"),t.getList()})).catch((function(e){})).finally((function(){i(),o.confirmButtonLoading=!1}))):i()}})},fast_stop:function(e){var t=this,a=this.$createElement;this.$msgbox({title:"提示",message:a("p",null,[a("span",null,"确定要一键停止【".concat(e.clusterName,"】吗??")),a("i",{style:"color: teal"})]),showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:function(a,o,i){"confirm"===a?(o.confirmButtonLoading=!0,o.confirmButtonText="执行中...",Object(u["e"])(e.id).then((function(e){t.$message.success("一键停止成功"),t.getList()})).catch((function(e){})).finally((function(){i(),o.confirmButtonLoading=!1}))):i()}})},fast_start:function(e){var t=this,a=this.$createElement;this.$msgbox({title:"提示",message:a("p",null,[a("span",null,"确定要一键启动【".concat(e.clusterName,"】吗??")),a("i",{style:"color: teal"})]),showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:function(a,o,i){"confirm"===a?(o.confirmButtonLoading=!0,o.confirmButtonText="执行中...",Object(u["c"])(e.id).then((function(e){t.$message.success("一键启动成功"),t.getList()})).catch((function(e){})).finally((function(){i(),o.confirmButtonLoading=!1}))):i()}})},check_ip_port:function(e){var t=this;this.loading=!0,Object(u["a"])(e.id).then((function(e){200==e.code&&t.$message.success("检测通过")})).finally((function(){t.loading=!1})).catch((function(e){}))}}},h=p,g=a("2877"),b=Object(g["a"])(h,o,i,!1,null,"5349d808",null);t["default"]=b.exports},e6a3:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"g-page"},[t("search-form",{attrs:{searchConfig:e.searchConfig},on:{onSearch:e.onSearch}}),t("div",{staticClass:"flex-inline-between"},[t("el-button",{attrs:{type:"primary"},on:{click:e.openAdd}},[e._v("新增")])],1),t("tableView",{attrs:{loading:e.tableConfig.loading,operateObj:e.tableConfig.operate,columns:e.tableConfig.columns,tableData:e.tableConfig.tableData,isPage:e.tableConfig.isPage,total:e.tableConfig.pagination.totalCount,rowKey:"id",operateSlice:3,currentPage:e.tableConfig.pagination.pageNo,pageSize:e.tableConfig.pagination.pageSize},on:{"update:currentPage":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:current-page":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},changePage:e.changePage,operate:e.getIndex}}),e.visible?t("DialogOrgAdd",{attrs:{rowData:e.rowData,refresh:e.getList},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}}):e._e()],1)},i=[],n=a("5530"),r=(a("14d9"),a("b0c0"),a("d3b7"),a("a4d3"),a("e01a"),a("498a"),function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:e.isEdit?"编辑":"新增",visible:e.visible,size:"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"120px",rules:e.rules}},[t("el-form-item",{attrs:{label:"名称",prop:"name"}},[t("el-input",{staticClass:"w-100",attrs:{placeholder:"请输入名称"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name","string"===typeof t?t.trim():t)},expression:"formData.name"}})],1),t("el-form-item",{attrs:{label:"同步服务",prop:"serverId"}},[t("el-select",{staticClass:"w-100",attrs:{size:"mini",placeholder:"请选择同步服务"},model:{value:e.formData.serverId,callback:function(t){e.$set(e.formData,"serverId",t)},expression:"formData.serverId"}},e._l(e.opts_serverId,(function(e){return t("el-option",{key:e.id,staticClass:"el-option-box",attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"备注",prop:"description"}},[t("el-input",{staticClass:"w-100",attrs:{placeholder:"请输入描述",type:"textarea"},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description","string"===typeof t?t.trim():t)},expression:"formData.description"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)}),s=[],c=(a("b64b"),a("159b"),a("e8b2")),l=a("b3a1"),u=a("f665"),d={name:"dialog-org-add",components:{},mixins:[],model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:function(){return{}}},refresh:{type:Function,required:!0,default:function(){}}},data:function(){return{formData:f(),loading:!1,opts_serverId:[],rules:{name:[{required:!0,trigger:"blur",message:"请输入名称"},{max:20,message:"不能超过20个字符",trigger:"blur"}],serverId:[{required:!0,trigger:"change",message:"请选择同步服务"}]}}},computed:{visible:{get:function(){return this.show},set:function(e){this.$emit("change",!1)}},isEdit:function(){var e;return Boolean(null===(e=this.rowData)||void 0===e?void 0:e.id)}},watch:{},created:function(){this.getOpts_serverId()},mounted:function(){var e;null!==(e=this.rowData)&&void 0!==e&&e.id&&(this.formData=f(this.rowData))},methods:{getOpts_serverId:function(){var e=this,t={};Object(u["c"])(t).then((function(t){e.opts_serverId=t.data}))},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){var a=Object(n["a"])({},e.formData);if(e.loading=!0,e.isEdit)return void Object(l["d"])(a).then((function(t){t&&200===t.code&&(e.$message.success("修改成功"),e.$emit("change",!1),e.refresh())})).finally((function(){e.loading=!1}));delete a.id,Object(l["b"])(a).then((function(t){t&&200===t.code&&(e.$message.success("新增成功"),e.refresh(),e.$emit("change",!1))})).finally((function(){e.loading=!1}))}}))}}};function f(e){var t={id:"",name:"",serverId:"",description:""};return Object(c["a"])(e)&&Object.keys(t).forEach((function(a){e.hasOwnProperty(a)&&(t[a]=e[a])})),t}var m=d,p=a("2877"),h=Object(p["a"])(m,r,s,!1,null,"3cbfcfee",null),g=h.exports,b=a("ec41"),v=a("ff51"),y={name:"config-multiple-center-settings",components:{DialogOrgAdd:g},mixins:[],props:{},data:function(){return{visible:!1,tableConfig:{loading:!1,pagination:{pageNo:1,pageSize:10,totalCount:0},tableData:[],columns:[{prop:"name",label:"名称"},{prop:"serverName",label:"同步服务"},{prop:"description",label:"描述"}],operate:{width:220,list:[{label:"集群管理",id:"manage"},{label:"编辑",id:"edit"},{label:"删除",id:"delete"}]}},searchConfig:{searchData:{name:""},searchItem:[{type:"input",label:"名称",prop:"name"}],rules:{}},rowData:null}},computed:{},watch:{},created:function(){this.getList()},mounted:function(){},methods:{onSearch:function(){this.tableConfig.pagination.currentPage=1,this.getList()},getList:function(){var e=this,t={pageNo:this.tableConfig.pagination.pageNo,pageSize:this.tableConfig.pagination.pageSize,requestObject:Object(n["a"])({},this.searchConfig.searchData)};this.tableConfig.loading=!0,Object(l["c"])(t).then((function(t){var a=Object(b["a"])(t,"data.data");e.tableConfig.tableData=Object(v["a"])(a)?a:[],e.tableConfig.pagination.totalCount=Object(b["a"])(t,"data.totalCount")||0})).catch((function(e){})).finally((function(){e.tableConfig.loading=!1}))},getIndex:function(e){var t=this,a=(e.index,e.row),o=e.operate;"delete"===o.id?this.$confirm("确定要删除【".concat(a.name,"】吗?"),{type:"warning"}).then((function(){Object(l["a"])(a.id).then((function(e){200===e.code&&(t.$message.success("删除成功"),t.getList())})).catch((function(e){}))})).catch((function(e){})):"edit"===o.id?(this.rowData=a,this.visible=!0):"manage"===o.id&&this.$router.push({path:"/register-center/config-multi-cluster-manage",query:{archId:a.id}})},openAdd:function(){this.rowData=null,this.visible=!0},changePage:function(e,t){e&&(this.tableConfig.pagination.pageNo=e),t&&(this.tableConfig.pagination.pageNo=1,this.tableConfig.pagination.pageSize=t),this.getList()}}},C=y,D=Object(p["a"])(C,o,i,!1,null,"f95ece98",null);t["default"]=D.exports},f192:function(e,t,a){}}]);