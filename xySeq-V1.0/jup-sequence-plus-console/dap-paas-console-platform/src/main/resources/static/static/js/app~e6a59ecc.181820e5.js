(window["jsonpPaas4"]=window["jsonpPaas4"]||[]).push([["app~e6a59ecc"],{"0ef0":function(e,t,a){"use strict";a("8fdd")},"10cb":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"g-page"},[t("search-form",{attrs:{searchConfig:e.searchConfig},on:{onSearch:e.onSearch}}),t("div",{staticClass:"flex-inline-between"},[t("el-button",{attrs:{type:"primary"},on:{click:e.openAdd}},[e._v("新增")])],1),t("tableView",{attrs:{loading:e.tableConfig.loading,operateObj:e.tableConfig.operate,columns:e.tableConfig.columns,tableData:e.tableConfig.tableData,isPage:e.tableConfig.isPage,total:e.tableConfig.pagination.totalCount,rowKey:"id",operateSlice:3,currentPage:e.tableConfig.pagination.pageNo,pageSize:e.tableConfig.pagination.pageSize},on:{"update:currentPage":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:current-page":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},changePage:e.changePage,operate:e.getIndex}}),e.visible?t("DialogOrgAdd",{attrs:{rowData:e.rowData,refresh:e.getList},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}}):e._e()],1)},n=[],o=a("5530"),l=(a("14d9"),a("b0c0"),a("d3b7"),a("a4d3"),a("e01a"),a("498a"),function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:e.isEdit?"编辑":"新增",visible:e.visible,size:"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"120px",rules:e.rules}},[t("el-form-item",{attrs:{label:"名称",prop:"name"}},[t("el-input",{staticClass:"w-100",attrs:{placeholder:"请输入名称"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name","string"===typeof t?t.trim():t)},expression:"formData.name"}})],1),t("el-form-item",{attrs:{label:"描述",prop:"description"}},[t("el-input",{staticClass:"w-100",attrs:{placeholder:"请输入描述",type:"textarea"},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description","string"===typeof t?t.trim():t)},expression:"formData.description"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)}),s=[],r=(a("b64b"),a("159b"),a("e8b2")),c=a("e99a"),u={name:"dialog-org-add",components:{},mixins:[],model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:function(){return{}}},refresh:{type:Function,required:!0,default:function(){}}},data:function(){return{formData:d(),rules:{name:[{required:!0,trigger:"blur",message:"请输入名称"}],version:[{required:!0,trigger:"change",message:"请选择版本"}]},versionOptions:[]}},computed:{visible:{get:function(){return this.show},set:function(e){this.$emit("change",!1)}},isEdit:function(){var e;return Boolean(null===(e=this.rowData)||void 0===e?void 0:e.id)}},watch:{},created:function(){},mounted:function(){var e;null!==(e=this.rowData)&&void 0!==e&&e.id&&(this.formData=d(this.rowData))},methods:{clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){var a=Object(o["a"])({},e.formData);e.isEdit?Object(c["d"])(a).then((function(t){t&&200===t.code&&(e.$message.success("修改成功"),e.$emit("change",!1),e.refresh())})):(delete a.id,Object(c["b"])(a).then((function(t){t&&200===t.code&&(e.$message.success("新增成功"),e.refresh(),e.$emit("change",!1))})))}}))}}};function d(e){var t={id:"",name:"",description:""};return Object(r["a"])(e)&&Object.keys(t).forEach((function(a){e.hasOwnProperty(a)&&(t[a]=e[a])})),t}var f=u,p=a("2877"),g=Object(p["a"])(f,l,s,!1,null,"1e97fd22",null),b=g.exports,m=a("ec41"),h=a("ff51"),v={name:"cache-multiple-center-settings",components:{DialogOrgAdd:b},mixins:[],props:{},data:function(){return{visible:!1,tableConfig:{loading:!1,pagination:{pageNo:1,pageSize:10,totalCount:0},tableData:[],columns:[{prop:"name",label:"名称",align:"center"},{prop:"node",label:"集群数",align:"center"},{prop:"description",label:"描述",align:"center"}],operate:{width:220,list:[{label:"中心管理",id:"manage"},{label:"编辑",id:"edit"},{label:"删除",id:"delete"}]}},searchConfig:{searchData:{name:""},searchItem:[{type:"input",label:"名称",prop:"name"}],rules:{}},rowData:null}},computed:{},watch:{},created:function(){this.getList()},mounted:function(){},methods:{onSearch:function(){this.tableConfig.pagination.currentPage=1,this.getList()},getList:function(){var e=this,t={pageNo:this.tableConfig.pagination.pageNo,pageSize:this.tableConfig.pagination.pageSize,requestObject:Object(o["a"])({},this.searchConfig.searchData)};this.tableConfig.loading=!0,Object(c["c"])(t).then((function(t){var a=Object(m["a"])(t,"data.data");e.tableConfig.tableData=Object(h["a"])(a)?a:[],e.tableConfig.pagination.totalCount=Object(m["a"])(t,"data.totalCount")||0})).catch((function(e){})).finally((function(){e.tableConfig.loading=!1}))},getIndex:function(e){var t=this,a=(e.index,e.row),i=e.operate;"delete"===i.id?this.$confirm("确定要删除【".concat(a.name,"】吗?"),{type:"warning"}).then((function(){Object(c["a"])(a.id).then((function(e){200===e.code&&(t.$message.success("删除成功"),t.getList())})).catch((function(e){}))})).catch((function(e){})):"edit"===i.id?(this.rowData=a,this.visible=!0):"manage"===i.id&&this.$router.push({path:"/sequence-multi-center/multi-center-manage",query:{multiClusterId:a.id}})},openAdd:function(){this.rowData=null,this.visible=!0},changePage:function(e,t){e&&(this.tableConfig.pagination.pageNo=e),t&&(this.tableConfig.pagination.pageNo=1,this.tableConfig.pagination.pageSize=t),this.getList()}}},w=v,C=Object(p["a"])(w,i,n,!1,null,"ffd9793e",null);t["default"]=C.exports},1762:function(e,t,a){},"1b58":function(e,t,a){"use strict";a("1762")},"299e":function(e,t,a){"use strict";a.r(t);a("b0c0");var i=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"formRef",attrs:{model:e.formData,rules:e.rules,inline:!0}},[t("el-form-item",{attrs:{prop:"groupId",label:"架构"}},[t("el-select",{on:{change:e.changeGroupId},model:{value:e.formData.groupId,callback:function(t){e.$set(e.formData,"groupId",t)},expression:"formData.groupId"}},e._l(e.archList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",[t("el-button",{on:{click:e.clickSearch}},[e._v("刷新")])],1)],1),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[e.linksData.length>0?t("G6Dagre",{attrs:{chartData:e.chartData,height:"500px",width:"100%"},on:{"click-node":e.clickNode}}):t("el-empty")],1)],1)},n=[],o=a("5530"),l=(a("14d9"),a("d3b7"),a("07ac"),a("159b"),a("0aac")),s=a("04bb"),r=a("ff51"),c=a("ec41"),u=a("bc59"),d=a("88b7"),f=a("cfcc"),p={components:{G6Dagre:d["default"]},data:function(){return{formData:{groupId:""},rules:{groupId:[{required:!0,message:"请选择架构",trigger:"change"}]},archList:[],chartData:{edges:[],nodes:[],combos:[]},linksData:[],loading:!1}},created:function(){},methods:{getArch:function(){var e=this;Object(s["c"])({}).then((function(t){e.archList=Object(r["a"])(Object(c["a"])(t,"data"))?t.data:[]})).catch((function(e){}))},changeGroupId:function(e){e&&this.clickSearch()},clickSearch:function(){var e=this;this.$refs.formRef.validate((function(t){t&&e.getData()}))},getData:function(){var e=this;this.loading=!0,this.linksData=[],this.chartData.combos=[],this.chartData.nodes=[],this.chartData.edges=[],Object(l["d"])(this.formData.groupId).then((function(t){if(t){var a=Object(r["a"])(null===t||void 0===t?void 0:t.data)?t.data:[];e.linksData=a;var i={},n={fill:"#fff",stroke:"#C4E3B2",lineWidth:1,shadowBlur:0,radius:7},l=[],s=[];a.forEach((function(e){e.cityId&&!Object(u["a"])(i,e.cityId)&&(i[e.cityId]={id:e.cityId,label:e.cityName,style:n});var t="",a="gray",r=Object(f["f"])(e.syncMethod,"syncMethodOptions");e.status&&(t=Object(f["f"])(e.status,"dataMigrationStatus"),a=Object(f["f"])(e.status,"dataMigrationStatus",["value","color"])),l.push(Object(o["a"])(Object(o["a"])({},e),{},{id:e.clusterId,value:e.clusterName,label:e.clusterName,comboId:e.cityId,statusLabel:t,syncMethodLabel:r})),e.parentClusterId&&"-"!==e.parentClusterId&&s.push({source:e.parentClusterId,target:e.clusterId,label:r,style:{stroke:a}})})),e.chartData.nodes=l,e.chartData.edges=s,e.chartData.combos=Object.values(i)}})).catch((function(e){})).finally((function(){e.loading=!1}))},clickNode:function(e){}}},g=p,b=a("2877"),m=Object(b["a"])(g,i,n,!1,null,"2de8c3c9",null);t["default"]=m.exports},"355c":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"name-container"},[t("search-form",{attrs:{searchConfig:e.searchModel},on:{onSearch:e.onSearch}}),t("tableView",{ref:"tableView",attrs:{loading:e.tableConfig.loading,columns:e.tableConfig.columns,tableData:e.tableConfig.tableData,isPage:e.tableConfig.isPage,operateObj:e.tableConfig.operate,total:e.tableConfig.pagination.total,rowKey:"id",currentPage:e.tableConfig.pagination.pageNo,pageSize:e.tableConfig.pagination.pageSize},on:{"update:currentPage":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:current-page":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},changePage:e.changePage,operate:e.getIndex}}),e.showDetail?t("SequenceUsageDetail",{attrs:{rowData:e.rowData,refresh:e.getList},model:{value:e.showDetail,callback:function(t){e.showDetail=t},expression:"showDetail"}}):e._e()],1)},n=[],o=a("5530"),l=(a("d3b7"),a("3778")),s=a("0ec5"),r=a("ec41"),c={filters:{},components:{SequenceUsageDetail:l["default"]},data:function(){return{rowData:null,showDetail:!1,tableConfig:{loading:!1,pagination:{pageNo:1,pageSize:10,total:0},tableData:[],columns:[{prop:"seqName",label:"序列名称",align:"center"},{prop:"serverInfo",label:"服务端信息",align:"center"},{prop:"clientInfo",label:"客户端信息",align:"center"},{prop:"numberStart",label:"起始序列",align:"center"},{prop:"numberEnd",label:"终止序列",align:"center"},{prop:"seqNo",label:"生成数量",align:"center"},{prop:"createDate",label:"生成时间",align:"center"}],operate:{width:120,list:[{label:"规则详情",id:"usage_detail"}]}},searchModel:{searchData:{seqName:""},searchItem:[{type:"input",label:"序列名称",prop:"seqName"}],rules:{}}}},mounted:function(){this.getList()},methods:{changePage:function(e,t){e&&(this.tableConfig.pagination.pageNo=e),t&&(this.tableConfig.pagination.pageNo=1,this.tableConfig.pagination.pageSize=t),this.getList()},onSearch:function(){this.tableConfig.pagination.currentPage=1,this.getList()},getList:function(){var e=this,t={pageNo:this.tableConfig.pagination.pageNo,pageSize:this.tableConfig.pagination.pageSize,requestObject:Object(o["a"])({},this.searchModel.searchData)};this.tableConfig.loading=!0,Object(s["a"])(t).then((function(t){var a=Object(r["a"])(t,"data.data");e.tableConfig.tableData=a,e.tableConfig.pagination.total=Object(r["a"])(t,"data.totalCount")||0})).finally((function(){e.tableConfig.loading=!1}))},getIndex:function(e){var t=e.row,a=e.operate;"usage_detail"===a.id&&(this.rowData=t,this.showDetail=!0)}}},u=c,d=a("2877"),f=Object(d["a"])(u,i,n,!1,null,"a49f20ac",null);t["default"]=f.exports},3778:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"规则详情",visible:e.show,size:"medium","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("button-list",{attrs:{data:e.buttonList}}),t("tableView",{ref:"tableView",attrs:{isOrder:!1,loading:e.tableConfig.loading,columns:e.tableConfig.columns,tableData:e.tableConfig.tableData,isPage:e.tableConfig.isPage,total:e.tableConfig.pagination.total,currentPage:e.tableConfig.pagination.pageNo,pageSize:e.tableConfig.pagination.pageSize,rowKey:"id"},on:{"update:currentPage":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:current-page":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},changePage:e.changePage}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},n=[],o=a("ade3"),l=(a("d3b7"),a("6562")),s=a("ec41"),r=a("ff51"),c=a("1f97"),u={components:{},model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:null},refresh:Function},data:function(){return Object(o["a"])(Object(o["a"])({labelPosition:"right",loading:!1,rules:{},buttonList:[{type:"usage_detail",label:"刷新",btnType:"primary",click:this.getList}]},"loading",!1),"tableConfig",{isPage:!1,loading:!1,pagination:{pageNo:1,pageSize:100,total:0},tableData:[],columns:[{prop:"sortNo",label:"排序号",align:"center"},{prop:"instanceRuleName",label:"规则名称",align:"center"},{prop:"instanceRuleType",label:"规则类型",align:"center",format:function(e){return Object(c["c"])(e,"ruleTypeOptions")}}]})},computed:{seqDesignId:function(){var e;return null===(e=this.rowData)||void 0===e?void 0:e.designId}},watch:{},created:function(){},mounted:function(){this.getList()},methods:{getList:function(){var e,t=this,a={pageNo:this.tableConfig.pagination.pageNo,pageSize:this.tableConfig.pagination.pageSize,requestObject:{seqDesignId:null===(e=this.rowData)||void 0===e?void 0:e.designId}};this.tableConfig.loading=!0,this.tableConfig.tableData=[],Object(l["c"])(a).then((function(e){var a=Object(s["a"])(e,"data.data"),i=Object(s["a"])(e,"data.totalCount");t.tableConfig.tableData=Object(r["a"])(a)?a:[],t.tableConfig.pagination.total=i})).finally((function(){t.tableConfig.loading=!1}))},clickCancel:function(){this.$emit("change",!1)},onSearch:function(){},changePage:function(e,t){e&&(this.tableConfig.pagination.pageNo=e),t&&(this.tableConfig.pagination.pageNo=1,this.tableConfig.pagination.pageSize=t),this.getList()}}},d=u,f=a("2877"),p=Object(f["a"])(d,i,n,!1,null,"e505222a",null);t["default"]=p.exports},"38e5":function(e,t,a){"use strict";a("cb34")},"3b9e":function(e,t,a){},"5eaf":function(e,t,a){},"66f0":function(e,t,a){},"7b91":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"缓冲",visible:e.show,size:"medium","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[e.bufferDataList.length>0?t("div",e._l(e.bufferDataList,(function(a,i){return t("el-card",{key:i,staticStyle:{"margin-bottom":"25px"}},[t("el-descriptions",{attrs:{title:"",column:4}},[t("el-descriptions-item",{attrs:{label:"序列编号"}},[e._v(e._s(a.seqCode.split("###")[0]))]),t("el-descriptions-item",{attrs:{label:"类型"}},[e._v(e._s("base"===a.seqCode.split("###")[1]?"基础序列":"日切"+a.seqCode.split("###")[1]))]),t("el-descriptions-item",{attrs:{label:"序列剩余总数"}},[e._v(e._s(a.seqTotal))]),t("el-descriptions-item",{attrs:{label:"最后一次获取时间"}},[e._v(e._s(e.getTime(a.lastGetTime,"yyyy-MM-dd HH:mm:ss")))])],1),t("tableView",{ref:"tableView",refInFor:!0,attrs:{loading:e.tableConfig.loading,operateObj:e.tableConfig.operate,columns:e.tableConfig.columns,tableData:a.queueList,rowKey:"id",isPage:!1}})],1)})),1):t("el-empty")],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)])},n=[],o=(a("d3b7"),a("0bf8")),l=a("f926"),s={name:"BufferArea",components:{},model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:null},refresh:Function},data:function(){this.$createElement;return{bufferDataList:[],loading:!1,tableConfig:{loading:!1,pagination:{pageNo:1,pageSize:10,total:0},tableData:[],columns:[{prop:"startSeq",label:"开始序列",align:"center"},{prop:"endSeq",label:"最后序列",align:"center"},{prop:"size",label:"大小",align:"center"},{prop:"used",label:"状态",align:"center",render:function(e,t){var a=t.row;return e("span",[a.used?"在用":"备用"])}}],operate:{width:220,list:[]}}}},computed:{},watch:{},created:function(){},mounted:function(){this.getSequenceAppName()},methods:{getTime:function(e,t){return Object(l["a"])(e,t)},getSequenceAppName:function(){var e=this;this.loading=!0,Object(o["a"])(this.rowData.id).then((function(t){200===t.code&&(e.bufferDataList=t.data)})).finally((function(){e.loading=!1}))},clickCancel:function(){this.$emit("change",!1)},clickConfirm:function(){this.$emit("change",!1)}}},r=s,c=(a("9014"),a("2877")),u=Object(c["a"])(r,i,n,!1,null,"d703452a",null);t["default"]=u.exports},"88b7":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{style:{height:e.height,width:e.width},attrs:{id:"mountNode"}})},n=[],o=(a("99af"),a("a15b"),a("7c3e")),l={name:"g6-dagre",components:{},mixins:[],props:{width:{type:String,default:"100%"},height:{type:String,default:"100%"},chartData:{type:Object,default:function(){return{nodes:[],edges:[]}}}},data:function(){return{graph:null}},computed:{},watch:{},created:function(){},mounted:function(){this.initDagre(),window.addEventListener("resize",this.resize)},destroyed:function(){window.removeEventListener("resize",this.resize),this.graph=null},methods:{initDagre:function(){var e=this,t=this.chartData;o["a"].registerNode("card-node",{draw:function(e,t){var a=2,i="#5B8FF9",n="green",o=e.size[0],l=e.size[1],s=t.addShape("rect",{attrs:{x:-o/2+20,y:-l/2,width:o,height:l,stroke:i,radius:a,fill:"#fff"},name:"main-box",draggable:!0}),r=0===e.dataType;return t.addShape("rect",{attrs:{x:-o/2+20,y:-l/2,width:o,height:30,fill:r?n:i,radius:[a,a,0,0]},name:"title-box",draggable:!0}),t.addShape("text",{attrs:{textBaseline:"top",x:-o/2+20+2,y:-l/2+10,lineHeight:30,text:"[".concat(r?"主":"备","] ").concat(e.clusterName),fill:"#fff"},name:"title"}),t.addShape("text",{attrs:{textBaseline:"top",x:-o/2+20,y:-l/2+40,lineHeight:20,text:" 状态：".concat(e.statusLabel),fill:"rgba(0,0,0, 1)"},name:"statusLabel"}),t.addShape("text",{attrs:{textBaseline:"top",x:-o/2+20,y:-l/2+60,lineHeight:20,text:" 机房：".concat(e.machineRoomName),fill:"rgba(0,0,0, 1)"},name:"machineRoomName"}),t.addShape("text",{attrs:{textBaseline:"top",x:-o/2+20,y:-l/2+80,lineHeight:20,text:" 总节点数：".concat(e.totalNodes||""),fill:"rgba(0,0,0, 1)"},name:"totalNodes"}),s}});var a=new o["a"].Graph({container:"mountNode",fitView:!0,pixelRatio:2,groupByTypes:!1,layout:{type:"dagre",ranksep:25,nodesep:25,controlPoints:!0,align:"UL",sortByCombo:!0},defaultNode:{type:"card-node",size:[200,120],style:{stroke:"#C4E3B2",radius:7}},defaultCombo:{type:"rect",labelCfg:{position:"top",padding:[20,10],style:{fill:"#666",fontSize:14}}},defaultEdge:{type:"cubic-vertical",style:{endArrow:!0,lineWidth:2,stroke:"#C2C8D5"}},comboStateStyles:{selected:{shadowBlur:1,lineWidth:1}},nodeStateStyles:{selected:{shadowColor:"#1d70f5",shadowBlur:10,lineWidth:2,cursor:"pointer"}},modes:{default:["drag-canvas","zoom-canvas","click-select",{type:"tooltip",formatText:function(e){var t=[];return t.join("\n")},offset:30}]}});a.data(t),a.render(),a.fitView(),this.graph=a,a.on("node:click",(function(t){t.target;var a=t.item,i=a.getModel();e.$emit("click-node",i)}))},resize:function(){var e=this.$el,t=e.offsetHeight,a=e.offsetWidth;this.graph.changeSize(a,t)}}},s=l,r=(a("e4f4"),a("2877")),c=Object(r["a"])(s,i,n,!1,null,"57acd22c",null);t["default"]=c.exports},"8fdd":function(e,t,a){},9014:function(e,t,a){"use strict";a("3b9e")},"9fb8":function(e,t,a){"use strict";a.r(t);a("b0c0");var i=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"添加主中心",visible:e.visible,size:"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"120px",rules:e.rules}},[t("el-form-item",{attrs:{label:"地区",prop:"cityId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择地区"},on:{change:e.getMachineRoomOptions},model:{value:e.formData.cityId,callback:function(t){e.$set(e.formData,"cityId",t)},expression:"formData.cityId"}},e._l(e.csMixCity,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"机房",prop:"machineRoomId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择机房"},model:{value:e.formData.machineRoomId,callback:function(t){e.$set(e.formData,"machineRoomId",t)},expression:"formData.machineRoomId"}},e._l(e.MachineRoomOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.machineRoomName,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"集群",prop:"seqClusterId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择集群"},on:{change:e.getClusterOptions},model:{value:e.formData.seqClusterId,callback:function(t){e.$set(e.formData,"seqClusterId",t)},expression:"formData.seqClusterId"}},e._l(e.clusterIdOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},n=[],o=a("5530"),l=(a("d3b7"),a("1b62")),s=a("fbd2"),r=a("ff51"),c=a("2143"),u=a("7e51"),d=l["a"].CommonSelectCreaterMix,f={components:{},mixins:[d(["csMixCity","csMixMachineRoom"])],model:{prop:"show",event:"change"},props:{show:Boolean,refresh:{type:Function,require:!0}},data:function(){return{clusterList:[],MachineRoomOptions:[],clusterIdOptions:[],loading:!1,formData:{cityId:"",machineRoomId:"",seqClusterId:""},rules:{cityId:[{required:!0,trigger:"change",message:"请选择地区"}],machineRoomId:[{required:!0,trigger:"change",message:"请选择机房"}],seqClusterId:[{required:!0,trigger:"change",message:"请选择集群"}]}}},computed:{visible:{get:function(){return this.show},set:function(e){this.$emit("change",!1)}},multiClusterId:function(){return this.$route.query.multiClusterId}},watch:{},created:function(){},mounted:function(){this.getClusterIdOptions()},methods:{getMachineRoomOptions:function(){var e=this,t={cityId:this.formData.cityId};Object(s["d"])(t).then((function(t){e.MachineRoomOptions=t.data}))},getClusterIdOptions:function(){var e=this;Object(c["a"])().then((function(t){var a=Object(r["a"])(null===t||void 0===t?void 0:t.data)?t.data:[];e.clusterIdOptions=a})).catch((function(e){}))},getClusterOptions:function(){},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){var a=Object(o["a"])(Object(o["a"])({},e.formData),{},{multiClusterId:e.$route.query.multiClusterId});e.loading=!0,Object(u["b"])(a).then((function(t){200===t.code&&(e.$message.success("新增成功"),e.$emit("change",!1),e.refresh())})).finally((function(){e.loading=!1}))}}))}}},p=f,g=a("2877"),b=Object(g["a"])(p,i,n,!1,null,"6055751c",null);t["default"]=b.exports},a40f:function(e,t,a){"use strict";a("e365")},bca8:function(e,t,a){"use strict";a.r(t);a("b0c0");var i=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"关联备中心",visible:e.visible,size:"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"120px",rules:e.rules}},[t("el-form-item",{attrs:{label:"地区",prop:"cityId"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择地区"},on:{change:e.getMachineRoomOptions},model:{value:e.formData.cityId,callback:function(t){e.$set(e.formData,"cityId",t)},expression:"formData.cityId"}},e._l(e.csMixCity,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"数据中心",prop:"machineRoomId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择数据中心"},model:{value:e.formData.machineRoomId,callback:function(t){e.$set(e.formData,"machineRoomId",t)},expression:"formData.machineRoomId"}},e._l(e.MachineRoomOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.machineRoomName,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"集群",prop:"seqClusterId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择集群"},model:{value:e.formData.seqClusterId,callback:function(t){e.$set(e.formData,"seqClusterId",t)},expression:"formData.seqClusterId"}},e._l(e.clusterIdOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"同步方式",prop:"syncMethod"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择同步方式"},model:{value:e.formData.syncMethod,callback:function(t){e.$set(e.formData,"syncMethod",t)},expression:"formData.syncMethod"}},[t("el-option",{attrs:{label:"冷备",value:0}}),t("el-option",{attrs:{label:"热备",value:1}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},n=[],o=a("5530"),l=(a("4de4"),a("d3b7"),a("ff32")),s=a("fbd2"),r=a("59b0"),c=a("7e51"),u=a("1b62"),d=a("ff51"),f=u["a"].CommonSelectCreaterMix,p={components:{},mixins:[f(["csMixCity","csMixMachineRoom"])],model:{prop:"show",event:"change"},props:{show:Boolean,refresh:{type:Function,require:!0},rowData:{type:Object,default:function(){return{}}},clusterList:{type:Array,default:function(){return[]}}},data:function(){return{dataMoveTypeOptions:l["d"],MachineRoomOptions:[],clusterIdOptions:[],loading:!1,formData:{cityId:"",machineRoomId:"",seqClusterId:"",syncMethod:""},rules:{cityId:[{required:!0,trigger:"change",message:"请选择地区"}],machineRoomId:[{required:!0,trigger:"change",message:"请选择机房"}],seqClusterId:[{required:!0,trigger:"change",message:"请选择集群"}],syncMethod:[{required:!0,trigger:"change",message:"请选择同步方式"}]}}},computed:{visible:{get:function(){return this.show},set:function(e){this.$emit("change",!1)}},multiClusterId:function(){return this.$route.query.multiClusterId}},watch:{},created:function(){},mounted:function(){this.getClusterIdOptions()},methods:{clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){var a=Object(o["a"])(Object(o["a"])({},e.formData),{},{multiClusterId:e.multiClusterId});e.loading=!0,Object(c["b"])(a).then((function(t){200===t.code&&(e.$message.success("关联成功"),e.$emit("change",!1),e.refresh())})).finally((function(){e.loading=!1}))}}))},getMachineRoomOptions:function(e){var t=this,a={cityId:e};Object(s["d"])(a).then((function(e){t.MachineRoomOptions=e.data}))},getClusterIdOptions:function(){var e=this,t=this.multiClusterId;Object(r["f"])(t).then((function(t){var a=[];Object(d["a"])(null===t||void 0===t?void 0:t.data)&&(a=t.data.filter((function(t){return e.rowData.seqClusterId!==t.id}))),e.clusterIdOptions=a}))}}},g=p,b=(a("38e5"),a("2877")),m=Object(b["a"])(g,i,n,!1,null,"bee61c0e",null);t["default"]=m.exports},c63a:function(e,t,a){"use strict";a("f250")},c692:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",[t("search-form",{attrs:{searchConfig:e.searchConfig},on:{"enter-search":e.onEnterSearch,onSearch:e.onSearch}}),t("button-list",{attrs:{data:e.buttonList}}),t("tableView",{ref:"tableView",attrs:{loading:e.tableConfig.loading,operateObj:e.tableConfig.operate,columns:e.tableConfig.columns,tableData:e.tableConfig.tableData,total:e.tableConfig.pagination.total,rowKey:"id",isPage:e.tableConfig.isPage,isCheckbox:!0,currentPage:e.tableConfig.pagination.pageNo,pageSize:e.tableConfig.pagination.pageSize},on:{"update:currentPage":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:current-page":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},changePage:e.changePage,operate:e.getIndex,getChildSelectionList:e.getChildSelectionList}}),e.showAddDialog?t("AddAndEdit",{attrs:{rowData:e.rowData,refresh:e.getList},model:{value:e.showAddDialog,callback:function(t){e.showAddDialog=t},expression:"showAddDialog"}}):e._e(),e.usageDialog?t("DialogUseinfo",{attrs:{rowData:e.rowData,refresh:e.getList},model:{value:e.usageDialog,callback:function(t){e.usageDialog=t},expression:"usageDialog"}}):e._e(),e.seqArrangeDialog?t("DialogRuleArrange",{attrs:{rowData:e.rowData,refresh:e.getList},model:{value:e.seqArrangeDialog,callback:function(t){e.seqArrangeDialog=t},expression:"seqArrangeDialog"}}):e._e(),e.detailsDialog?t("DialogDetails",{attrs:{rowData:e.rowData,refresh:e.getList},model:{value:e.detailsDialog,callback:function(t){e.detailsDialog=t},expression:"detailsDialog"}}):e._e(),e.showImportDialog?t("DialogImport",{attrs:{refresh:e.getList},model:{value:e.showImportDialog,callback:function(t){e.showImportDialog=t},expression:"showImportDialog"}}):e._e()],1)},n=[],o=a("c7eb"),l=a("1da1"),s=a("5530"),r=(a("99af"),a("4de4"),a("d81d"),a("d3b7"),function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"使用情况",visible:e.show,size:"medium","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("tableView",{ref:"tableView",attrs:{loading:e.tableConfig.loading,columns:e.tableConfig.columns,tableData:e.tableConfig.tableData,isPage:e.tableConfig.isPage,total:e.tableConfig.pagination.total,currentPage:e.tableConfig.pagination.pageNo,pageSize:e.tableConfig.pagination.pageSize,rowKey:"id"},on:{"update:currentPage":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:current-page":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},changePage:e.changePage,operate:e.getIndex}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)}),c=[],u=a("ec41"),d=a("ff51"),f=a("cb3f"),p={computed:{isEdit:function(){return Boolean(this.rowData)}},model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:null},refresh:Function},data:function(){return{labelPosition:"right",title:"",rules:{},buttonList:[{label:"新增",type:"add",click:this.addInfo}],tableConfig:{loading:!1,pagination:{pageNo:1,pageSize:10,total:0},tableData:[],columns:[{prop:"inDay",label:"序列日切",align:"center"},{prop:"instanceRuleName",label:"序列名称",align:"center"},{prop:"seqLock",label:"执行次数",align:"center"},{prop:"curVal",label:"当前号段",align:"center"},{prop:"updateDate",label:"更新时间",align:"center"}],operate:{width:220,list:[{label:"编辑",id:"edit"}]}}}},watch:{},created:function(){},mounted:function(){this.getList()},methods:{addInfo:function(){},getIndex:function(e){e.index,e.row,e.operate},getList:function(){var e=this,t={pageNo:this.tableConfig.pagination.pageNo,pageSize:this.tableConfig.pagination.pageSize,requestObject:{id:this.rowData.id}};this.tableConfig.loading=!0,Object(f["a"])(t).then((function(t){var a=Object(u["a"])(t,"data.data"),i=Object(u["a"])(t,"data.totalCount");e.tableConfig.pagination.total=i,e.tableConfig.tableData=Object(d["a"])(a)?a:[]})).finally((function(){e.tableConfig.loading=!1}))},clickCancel:function(){this.$emit("change",!1)},clickConfirm:function(){this.$emit("change",!1)},changePage:function(e,t){e&&(this.tableConfig.pagination.pageNo=e),t&&(this.tableConfig.pagination.pageNo=1,this.tableConfig.pagination.pageSize=t),this.getList()}}},g=p,b=a("2877"),m=Object(b["a"])(g,r,c,!1,null,"7e51c16e",null),h=m.exports,v=(a("498a"),function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:e.title,visible:e.show,size:"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",staticClass:"cluster-form",attrs:{"label-position":e.labelPosition,"label-width":"140px",model:e.form,rules:e.rules}},[t("el-form-item",{attrs:{label:"序列名称",prop:"sequenceName"}},[t("el-input",{attrs:{size:"mini",maxlength:"30",disabled:e.disabled,"show-word-limit":""},model:{value:e.form.sequenceName,callback:function(t){e.$set(e.form,"sequenceName",t)},expression:"form.sequenceName"}})],1),t("el-form-item",{attrs:{label:"序列编号",prop:"sequenceCode"}},[t("el-input",{attrs:{size:"mini",maxlength:"30",disabled:e.disabled,"show-word-limit":""},model:{value:e.form.sequenceCode,callback:function(t){e.$set(e.form,"sequenceCode",t)},expression:"form.sequenceCode"}})],1),t("el-form-item",{attrs:{label:"应用名称",prop:"sequenceApplicationName"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini",placeholder:"",loading:e.sequenceAppLoading},model:{value:e.form.sequenceApplicationName,callback:function(t){e.$set(e.form,"sequenceApplicationName",t)},expression:"form.sequenceApplicationName"}},e._l(e.sequenceApplicationList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.applicationName,value:e.applicationName}})})),1)],1),t("el-form-item",{attrs:{label:"服务端缓存数量",prop:"sequenceNumber"}},[t("template",{slot:"label"},[t("span",[e._v("服务端缓存数量")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 服务端缓存池中缓存的序号数量 "),t("br"),e._v(" 严格递增序列需要把服务端缓存数量配置为0，客户端获取数量配置为1 ")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"mini",type:"number",max:5e4,step:1,maxlength:"30","controls-position":"right","show-word-limit":"",disabled:e.disabled},model:{value:e.form.sequenceNumber,callback:function(t){e.$set(e.form,"sequenceNumber",e._n(t))},expression:"form.sequenceNumber"}})],2),t("el-form-item",{attrs:{label:"客户端获取数量",prop:"requestNumber"}},[t("template",{slot:"label"},[t("span",[e._v("客户端获取数量")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("客户端每次从服务端获取的序号数量")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"mini",type:"number",max:5e4,step:1,maxlength:"30","controls-position":"right","show-word-limit":"",disabled:e.disabled},model:{value:e.form.requestNumber,callback:function(t){e.$set(e.form,"requestNumber",e._n(t))},expression:"form.requestNumber"}})],2),t("el-form-item",{attrs:{label:"服务端补充阈值",prop:"serverCacheThreshold"}},[t("template",{slot:"label"},[t("span",[e._v("服务端补充阈值")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("服务端缓存剩余数量比例")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{attrs:{disabled:e.disabled,size:"mini"},model:{value:e.form.serverCacheThreshold,callback:function(t){e.$set(e.form,"serverCacheThreshold",t)},expression:"form.serverCacheThreshold"}})],2),t("el-form-item",{attrs:{label:"客户端补充阈值",prop:"clientCacheThreshold"}},[t("template",{slot:"label"},[t("span",[e._v("客户端补充阈值")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("客户端缓存剩余数量比例")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{attrs:{disabled:e.disabled,size:"mini"},model:{value:e.form.clientCacheThreshold,callback:function(t){e.$set(e.form,"clientCacheThreshold",t)},expression:"form.clientCacheThreshold"}})],2),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"服务端缓存回收",prop:"serverRecoverySwitch"}},[t("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.form.serverRecoverySwitch,callback:function(t){e.$set(e.form,"serverRecoverySwitch",t)},expression:"form.serverRecoverySwitch"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"客户端缓存回收",prop:"clientRecoverySwitch"}},[t("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.form.clientRecoverySwitch,callback:function(t){e.$set(e.form,"clientRecoverySwitch",t)},expression:"form.clientRecoverySwitch"}})],1)],1)],1),t("el-form-item",{attrs:{label:"序列生成类型",prop:"sequenceProdType"}},[t("el-radio-group",{model:{value:e.form.sequenceProdType,callback:function(t){e.$set(e.form,"sequenceProdType",t)},expression:"form.sequenceProdType"}},e._l(e.createSeqTypeOptions,(function(a){return t("el-radio",{key:a.value,attrs:{label:a.value}},[e._v(" "+e._s(a.label)+" ")])})),1)],1),t("el-form-item",{attrs:{label:"回拨模式",prop:"callbackMode"}},[t("el-radio-group",{attrs:{disabled:e.disabled},model:{value:e.form.callbackMode,callback:function(t){e.$set(e.form,"callbackMode",t)},expression:"form.callbackMode"}},e._l(e.dict_callbackMode,(function(a,i){return t("el-radio",{key:i,attrs:{label:a.value}},["全局序列"!==a.label?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"到【".concat(a.label,"】时序号中数字从头开始"),placement:"top"}},[t("span",[e._v(e._s(a.label))])]):t("span",[e._v(e._s(a.label))])],1)})),1)],1),t("el-form-item",{attrs:{label:"描述",prop:"sequenceDesc"}},[t("el-input",{staticClass:"w-100",attrs:{disabled:e.disabled,placeholder:"请输入描述",type:"textarea",maxlength:"200","show-word-limit":"",rows:"5",resize:"none"},model:{value:e.form.sequenceDesc,callback:function(t){e.$set(e.form,"sequenceDesc","string"===typeof t?t.trim():t)},expression:"form.sequenceDesc"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.disabled?e._e():t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)}),w=[],C=(a("b64b"),a("159b"),a("0eed")),D=a("5d8b"),y=a("49bb"),k=a("bc59"),O=a("4807");function S(e){var t={id:"",sequenceName:"",sequenceCode:"",sequenceApplicationId:"",sequenceApplicationName:"",sequenceNumber:3e3,requestNumber:1e3,sequenceDesc:"",callbackMode:"0",sequenceProdType:"0",serverCacheThreshold:"10",clientCacheThreshold:"10",serverRecoverySwitch:"0",clientRecoverySwitch:"0"};return e&&Object.keys(t).forEach((function(a){Object(k["a"])(e,a)&&(t[a]=e[a])})),t}var _={name:"AddAndEdit",components:{},model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:null},refresh:Function},data:function(){return{isStrictIncreasing:!1,loading:!1,sequenceAppLoading:!1,permOptions:y["j"],clusterList:[],sequenceApplicationList:[],labelPosition:"right",disabled:!1,title:"新增",dict_callbackMode:O["a"].options,createSeqTypeOptions:[{label:"服务端生成",value:"0"},{label:"客户端本地生成",value:"1"}],form:S(),rules:{sequenceName:[{required:!0,message:"请输入序列名称",trigger:"blur"}],sequenceCode:[{required:!0,message:"请输入序列编号",trigger:"blur"}],sequenceNumber:[{required:!0,message:"请输入服务端服务端缓存数量",trigger:"blur"}],requestNumber:[{required:!0,message:"请输入客户端获取数量",trigger:"blur"}],callbackMode:[{required:!0,message:"请选择回拨模式",trigger:"blur"}],serverCacheThreshold:[{required:!0,message:"请输入服务端补充阈值",trigger:"blur"}],clientCacheThreshold:[{required:!0,message:"请输入客户端补充阈值",trigger:"blur"}]}}},watch:{},created:function(){},mounted:function(){var e,t=this;(this.getSequenceAppName(),this.rowData)&&(Object.keys(this.form).forEach((function(e){t.form[e]=t.rowData[e]})),"2"===(null===(e=this.rowData)||void 0===e?void 0:e.sequenceStatus)?(this.disabled=!0,this.title="查看"):(this.disabled=!1,this.title="编辑"))},methods:{changeIncreaseCheck:function(e){e&&(this.form.sequenceNumber=0,this.form.requestNumber=1)},getSequenceAppName:function(){var e=this;this.sequenceAppLoading=!0,Object(C["a"])().then((function(t){200===t.code&&(e.sequenceApplicationList=t.data)})).finally((function(){e.sequenceAppLoading=!1}))},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate(function(){var t=Object(l["a"])(Object(o["a"])().mark((function t(a){var i,n;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:i="",e.sequenceApplicationList.forEach((function(t){e.form.sequenceApplicationName==t.applicationName&&(i=t.id)})),a&&(n=Object(s["a"])(Object(s["a"])({},e.form),{},{sequenceApplicationId:i}),e.loading=!0,e.rowData?Object(D["f"])(n).then((function(t){"S2001"===t.code&&(e.$message({type:"success",message:t.msg}),e.$emit("change",!1),e.refresh())})):(delete n.id,Object(D["c"])(n).then((function(t){"S2001"===t.code&&(e.$message({type:"success",message:t.msg}),e.$emit("change",!1),e.refresh())})).catch((function(e){})).finally((function(){e.loading=!1}))));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},q=_,j=(a("1b58"),Object(b["a"])(q,v,w,!1,null,"3ed6e284",null)),I=j.exports,x=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"规则编排",visible:e.show,size:"medium","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("button-list",{attrs:{data:e.buttonList}},[t("span",{attrs:{slot:"testCode"},slot:"testCode"},[e._v(e._s(e.testCode))])]),t("tableView",{ref:"tableView",attrs:{isOrder:!1,loading:e.tableConfig.loading,columns:e.tableConfig.columns,tableData:e.tableConfig.tableData,operateObj:e.tableConfig.operate,operateSlice:4,isPage:e.tableConfig.isPage,total:e.tableConfig.pagination.total,currentPage:e.tableConfig.pagination.pageNo,pageSize:e.tableConfig.pagination.pageSize,rowKey:"id"},on:{"update:currentPage":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:current-page":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},changePage:e.changePage,operate:e.getIndex}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["1"===e.rowData.sequenceStatus?t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.clickUpdateSort()}}},[e._v(" 保存排序 ")]):e._e(),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1),e.showAdd?t("DialogRuleAdd",{attrs:{refresh:e.getList,refreshMain:e.refresh,rowData:e.rowDataRule,fatherRow:e.rowData,seqDesignId:e.seqDesignId,total:e.tableConfig.pagination.total,disabledIsOptional:e.disabledIsOptional},model:{value:e.showAdd,callback:function(t){e.showAdd=t},expression:"showAdd"}}):e._e()],1)},$=[],N=a("ade3"),R=(a("7db0"),a("14d9"),a("a434"),a("6562")),z=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"".concat(e.idView?"编辑":"新增","序列规则"),visible:e.show,size:"medium","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",staticClass:"cluster-form",attrs:{"label-position":e.labelPosition,"label-width":"120px",model:e.formData,rules:e.rules}},[t("el-row",[e.idView?e._e():[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"规则类型",prop:"ruleType"}},[t("el-select",{staticClass:"w-100",attrs:{size:"mini",placeholder:"请选择规则类型"},on:{change:e.changeRuleType},model:{value:e.ruleType,callback:function(t){e.ruleType=t},expression:"ruleType"}},e._l(e.ruleTypeOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"规则模板"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择规则模板","value-key":"id"},on:{change:e.changeRuleTemplate},model:{value:e.ruleTemplate,callback:function(t){e.ruleTemplate=t},expression:"ruleTemplate"}},e._l(e.ruleTemplateList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.ruleName,value:e}})})),1)],1)],1)],t("el-col",{attrs:{span:24}},[e.hasOwnKey("initData")?t("el-form-item",{attrs:{label:"初始值",prop:"initData"}},[t("el-input",{staticClass:"w-100",attrs:{disabled:e.disabled,size:"mini",type:e.formData&&"1"===e.formData.ruleType?"textarea":"",maxlength:"200","show-word-limit":"",rows:5,resize:"none"},model:{value:e.formData.initData,callback:function(t){e.$set(e.formData,"initData",t)},expression:"formData.initData"}})],1):e._e()],1),t("el-col",{attrs:{span:12}},[e.hasOwnKey("numberStart")?t("el-form-item",{attrs:{label:"数字起始值",prop:"numberStart"}},[t("template",{slot:"label"},[t("span",[e._v("数字起始值")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("起始值从1开始，不能大于或者等于结束值")]),t("i",{staticClass:"el-icon-question table-msg"})])],1),t("el-input",{staticClass:"w-100",attrs:{disabled:e.disabled,size:"mini"},model:{value:e.formData.numberStart,callback:function(t){e.$set(e.formData,"numberStart",t)},expression:"formData.numberStart"}})],2):e._e()],1),t("el-col",{attrs:{span:12}},[e.hasOwnKey("numberEnd")?t("el-form-item",{attrs:{label:"数字最大值",prop:"numberEnd"}},[t("template",{slot:"label"},[t("span",[e._v("数字最大值")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 数字最大值不能超过999999999999999999，不能小于起始值 ")]),t("i",{staticClass:"el-icon-question table-msg"})])],1),t("el-input",{staticClass:"w-100",attrs:{disabled:e.disabled,size:"mini"},model:{value:e.formData.numberEnd,callback:function(t){e.$set(e.formData,"numberEnd",t)},expression:"formData.numberEnd"}})],2):e._e()],1),t("el-col",{attrs:{span:24}},[e.hasOwnKey("enumStore")?t("el-form-item",{attrs:{label:"枚举库(英文逗号隔开)",prop:"enumStore"}},[t("el-input",{staticClass:"w-100",attrs:{disabled:e.disabled,size:"mini",type:"textarea",maxlength:"200","show-word-limit":"",rows:"5",resize:"none"},model:{value:e.formData.enumStore,callback:function(t){e.$set(e.formData,"enumStore",t)},expression:"formData.enumStore"}})],1):e._e()],1),t("el-col",{attrs:{span:12}},[e.hasOwnKey("numberStep")?t("el-form-item",{attrs:{label:"步长",prop:"numberStep"}},[t("el-input-number",{staticClass:"w-100",attrs:{disabled:e.disabled,size:"mini","controls-position":"right",step:1,min:1,"step-strictly":""},model:{value:e.formData.numberStep,callback:function(t){e.$set(e.formData,"numberStep",t)},expression:"formData.numberStep"}})],1):e._e()],1),t("el-col",{attrs:{span:12}},[e.hasOwnKey("numberFormat")?t("el-form-item",{attrs:{prop:"numberFormat"}},[t("template",{slot:"label"},[t("span",[e._v("数字格式")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 使用NumberFormat格式化序号，00000:表示固定长度5位不够时补0，#####:表示纯数字如果不存在就显示为空 ")]),t("i",{staticClass:"el-icon-question table-msg"})])],1),t("el-input",{staticClass:"w-100",attrs:{disabled:e.disabled,size:"mini"},model:{value:e.formData.numberFormat,callback:function(t){e.$set(e.formData,"numberFormat",t)},expression:"formData.numberFormat"}})],2):e._e()],1),t("el-col",{attrs:{span:24}},[e.hasOwnKey("numberCircle")?t("el-form-item",{attrs:{label:"达到最大时",prop:"numberCircle"}},[t("el-radio-group",{attrs:{disabled:e.disabled},model:{value:e.formData.numberCircle,callback:function(t){e.$set(e.formData,"numberCircle",t)},expression:"formData.numberCircle"}},e._l(e.dict_numberCircle,(function(a,i){return t("el-radio",{key:i,attrs:{label:a.value}},[a.tip?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:a.tip,placement:"top"}},[t("span",[e._v(e._s(a.label))])]):t("span",[e._v(e._s(a.label))])],1)})),1)],1):e._e()],1),e.hasOwnKey("isOptional")?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"开启自选"}},[t("el-switch",{attrs:{disabled:e.disabledIsOptional||e.disabled},model:{value:e.formData.isOptional,callback:function(t){e.$set(e.formData,"isOptional",t)},expression:"formData.isOptional"}}),e.disabledIsOptional?t("span",{staticClass:"form-item-extra ml-10"},[e._v("已有数字规则开启自选")]):e._e()],1)],1):e._e(),t("el-col",{attrs:{span:12}},[e.hasOwnKey("dateFormat")?t("el-form-item",{attrs:{label:"日期格式",prop:"dateFormat"}},[t("el-input",{staticClass:"w-100",attrs:{disabled:e.disabled,size:"mini"},model:{value:e.formData.dateFormat,callback:function(t){e.$set(e.formData,"dateFormat",t)},expression:"formData.dateFormat"}})],1):e._e()],1),t("el-col",{attrs:{span:12}},[e.hasOwnKey("placeholderRule")?t("el-form-item",{attrs:{label:"占位规则",prop:"placeholderRule"}},[t("el-radio-group",{attrs:{disabled:e.disabled},model:{value:e.formData.placeholderRule,callback:function(t){e.$set(e.formData,"placeholderRule",t)},expression:"formData.placeholderRule"}},e._l(e.dict_placeholderRule,(function(a,i){return t("el-radio",{key:i,attrs:{label:a.value}},[e._v(" "+e._s(a.label)+" ")])})),1)],1):e._e()],1),t("el-col",{attrs:{span:12}},[e.hasOwnKey("placeholderLength")&&"1"===e.formData.placeholderRule?t("el-form-item",{attrs:{label:"占位长度",prop:"placeholderLength"}},[t("el-input-number",{staticClass:"w-100",attrs:{disabled:e.disabled,size:"mini","controls-position":"right",step:1,min:1,"step-strictly":""},model:{value:e.formData.placeholderLength,callback:function(t){e.$set(e.formData,"placeholderLength",t)},expression:"formData.placeholderLength"}})],1):e._e()],1),t("el-col",{attrs:{span:12}},[e.hasOwnKey("optionalBit")?t("el-form-item",{attrs:{label:"自选位数",prop:"optionalBit"}},[t("el-input-number",{staticClass:"w-100",attrs:{disabled:e.disabled,size:"mini","controls-position":"right",step:1,min:1,"step-strictly":""},model:{value:e.formData.optionalBit,callback:function(t){e.$set(e.formData,"optionalBit",t)},expression:"formData.optionalBit"}})],1):e._e()],1),t("el-col",{attrs:{span:24}},[e.hasOwnKey("paddindStategy")?t("el-form-item",{attrs:{label:"少位补位策略",prop:"paddindStategy"}},e._l(e.paddindStategyOptions,(function(a,i){return t("el-radio",{key:i,attrs:{label:a.value}},[e._v(" "+e._s(a.label)+" ")])})),1):e._e()],1),t("el-col",{attrs:{span:12}},["3"===e.formData.paddindStategy?t("el-form-item",{attrs:{label:"补位参数",prop:"padValue"}},[t("el-input-number",{staticClass:"w-100",attrs:{disabled:e.isEdit,size:"mini","controls-position":"right",step:1,min:0,"step-strictly":""},model:{value:e.formData.padValue,callback:function(t){e.$set(e.formData,"padValue",e._n(t))},expression:"formData.padValue"}})],1):e._e()],1),t("el-col",{attrs:{span:12}},[e.hasOwnKey("checkLength")?t("el-form-item",{attrs:{label:"位数",prop:"checkLength"}},[t("el-input-number",{staticClass:"w-100",attrs:{disabled:e.disabled,size:"mini","controls-position":"right",step:1,min:1,"step-strictly":""},model:{value:e.formData.checkLength,callback:function(t){e.$set(e.formData,"checkLength",t)},expression:"formData.checkLength"}})],1):e._e()],1),t("el-col",{attrs:{span:24}},[e.hasOwnKey("checkPosition")?t("el-form-item",{attrs:{label:"补位规则",prop:"checkPosition"}},[t("el-radio-group",{attrs:{disabled:e.disabled},model:{value:e.formData.checkPosition,callback:function(t){e.$set(e.formData,"checkPosition",t)},expression:"formData.checkPosition"}},e._l(e.checkPositionOptions,(function(a,i){return t("el-radio",{key:i,attrs:{label:a.value}},[e._v(" "+e._s(a.label)+" ")])})),1)],1):e._e()],1)],2)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.idView&&"1"!==e.fatherRow.sequenceStatus?e._e():t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},L=[],A=a("15fd"),T=(a("d9e2"),a("caad"),a("e9c4"),a("a9e3"),a("2532"),a("7b83")),P=a("e8b2"),M=a("5c8a"),B=a("9bc4"),E=a("1f97"),F=["instanceRuleType"];function V(e){var t={};if(null!==e&&void 0!==e&&e.ruleType){switch(t.ruleType=e.ruleType,e.ruleType){case"1":t.initData="";break;case"2":t.initData="",t.numberStep="",t.enumStore="";break;case"3":t.dateFormat="";break;case"4":t.numberStep="",t.numberStart="",t.numberEnd="",t.numberCircle="3",t.numberFormat="",t.isThreshold=!1,t.threshold="",t.isOptional=!1;break;case"5":t.placeholderRule="0",t.placeholderLength="";break;case"6":t.optionalBit="1",t.paddindStategy="1",t.padValue="";break;case"7":t.checkLength="1",t.checkPosition="1";break}var a=Object(u["a"])(e,"ruleInfo");if(a||(a=Object(u["a"])(e,"instanceRuleInfo")),a)try{var i=JSON.parse(a);Object(P["a"])(i)&&Object.keys(t).forEach((function(e){Object(k["a"])(i,e)&&(t[e]=i[e])}))}catch(n){}}return t}var K={model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:null},fatherRow:{type:Object,default:function(){return{}}},refresh:Function,refreshMain:Function,seqDesignId:{type:String,default:""},total:{type:Number,default:1},disabledIsOptional:{type:Boolean,default:!1}},data:function(){var e=this,t=function(t,a,i){if(""!==a){var n=a.split(",").length;n<=e.formData.numberStep?i(new Error("请输入正确长度的枚举库")):i()}else i(new Error("请输入枚举库"))},a=function(t,a,i){""!==a?"0"!==a?Number(a)>Number(e.formData.numberEnd)?i(new Error("起始值不能大于最大值")):i():i(new Error("请输入大于1的值")):i(new Error("请输入数字起始值"))},i=function(t,a,i){""!==a?"0"!==a?Number(a)<Number(e.formData.numberStart)?i(new Error("起始值不能大于最大值")):i():i(new Error("请输入大于1的值")):i(new Error("请输入数字起始值"))};return{checkPositionOptions:E["a"],paddindStategyOptions:E["d"],labelPosition:"right",formData:V(),dict_numberCircle:O["b"].options,dict_placeholderRule:O["c"].options,ruleTypeOptions:E["f"],ruleTemplateList:[],ruleType:"",ruleTemplate:null,loading:!1,rules:{initData:[{required:!0,message:"请输入初始值",trigger:"blur"}],numberStep:[{required:!0,message:"请输入步长",trigger:"blur"}],enumStore:[{required:!0,message:"请输入枚举库",trigger:"blur"},{validator:t,trigger:"blur"}],dateFormat:[{required:!0,message:"请输入日期格式",trigger:"blur"}],numberStart:[{required:!0,message:"请输入数字起始值",trigger:"blur"},{pattern:/^[0-9]{1,17}$/,message:"请输入正确值",trigger:"blur"},{validator:a,trigger:"blur"}],numberEnd:[{required:!0,message:"请输入数字最大值",trigger:"blur"},{pattern:/^[0-9]{1,18}$/,message:"请输入正确值",trigger:"blur"},{validator:i,trigger:"blur"}],numberCircle:[{required:!0,message:"请选择达到最大时",trigger:"change"}],numberFormat:[{required:!0,message:"请输入数字格式",trigger:"blur"},{pattern:/^[0#]+$/,trigger:"blur",message:"只能输入0或者#"}],padValue:[{required:!0,message:"请选择少位补位策略",trigger:"blur"},{pattern:/^\d*$/,message:"只能输入数字"}]}}},computed:{idView:function(){var e;return Boolean(null===(e=this.rowData)||void 0===e?void 0:e.id)},disabled:function(){var e;return Boolean(null===(e=this.rowData)||void 0===e?void 0:e.id)&&"2"===this.fatherRow.sequenceStatus}},created:function(){},mounted:function(){if(this.idView){var e=this.rowData,t=e.instanceRuleType,a=Object(A["a"])(e,F);this.formData=V(Object(s["a"])(Object(s["a"])({},a),{},{ruleType:t}))}},methods:{changeRuleType:function(e){var t=this;this.ruleTemplateList=[],this.ruleTemplate=null,this.formData=V(),e&&Object(T["d"])(e).then((function(e){t.ruleTemplateList=Object(d["a"])(null===e||void 0===e?void 0:e.data)?e.data:[]})).catch((function(e){})).finally((function(){}))},changeRuleTemplate:function(e){this.formData=V(e)},hasOwnKey:function(e){return Object(k["a"])(this.formData,e)},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate(function(){var t=Object(l["a"])(Object(o["a"])().mark((function t(a){var i,n,l,s,r,c;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:if(i=Object(M["a"])(e.formData),"3"!=i.paddindStategy&&(i=Object(B["a"])(i,"padValue")),"0"===i.placeholderRule&&(i=Object(B["a"])(i,"placeholderLength")),!e.idView){t.next=11;break}return e.loading=!0,n={instanceRuleInfo:JSON.stringify(e.formData),id:e.rowData.id,instanceRuleType:e.rowData.instanceRuleType,seqDesignId:e.seqDesignId},Object(R["e"])(n).then((function(t){"S2001"===t.code&&(e.$message.success("编辑成功"),e.$emit("change",!1),e.refresh())})).finally((function(){e.loading=!1})),t.abrupt("return");case 11:if(e.ruleTemplate){t.next=13;break}return t.abrupt("return");case 13:if(l=e.ruleTemplate,s=l.ruleName,r=l.ruleType,"6"!==r||!e.rowData.instanceRuleTypeArr.includes("5")){t.next=17;break}return e.$message.error("当前规则列表已存在占位符规则"),t.abrupt("return",!1);case 17:if(!("6"===r&&e.rowData.instanceRuleTypeArr.includes("6")||"5"===r&&e.rowData.instanceRuleTypeArr.includes("6"))){t.next=20;break}return e.$message.error("当前规则列表已存在自选规则"),t.abrupt("return",!1);case 20:c={seqDesignId:e.seqDesignId,instanceRuleInfo:JSON.stringify(i),instanceRuleName:s,instanceRuleType:r,sortNo:e.total+1},e.loading=!0,Object(R["b"])(c).then((function(t){"$2001"===t.code&&(e.$message({type:"success",message:t.msg}),e.$emit("change",!1),e.refresh(),e.refreshMain())})).finally((function(){e.loading=!1}));case 24:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},U=K,H=(a("a40f"),Object(b["a"])(U,z,L,!1,null,"8eb2d64e",null)),G=H.exports,W={components:{DialogRuleAdd:G},model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:null},refresh:Function},data:function(){var e=this;return Object(N["a"])(Object(N["a"])(Object(N["a"])(Object(N["a"])(Object(N["a"])(Object(N["a"])({labelPosition:"right",loading:!1,rules:{},buttonList:[{label:"添加",type:"seqArrange-add",hidden:"2"===e.rowData.sequenceStatus,click:this.clickAdd},{label:"刷新",type:"seqArrange-refresh",btnType:"",click:this.getList},{label:"测试",type:"seqArrange-test",click:this.clickTest,get loading(){return e.loadingTest}},{type:"slot",slot:"testCode"}]},"loading",!1),"tableConfig",{isPage:!1,loading:!1,pagination:{pageNo:1,pageSize:100,total:0},tableData:[],columns:[{prop:"instanceRuleName",label:"规则名称",align:"center"},{prop:"instanceRuleType",label:"规则类型",align:"center",format:function(e){return Object(E["c"])(e,"ruleTypeOptions")}},{prop:"sortNo",label:"排序号",align:"center"}],operate:{width:300,list:[{label:"置顶",id:"seqArrange-top",isShow:function(){return"1"===e.rowData.sequenceStatus}},{label:"上移",id:"seqArrange-moveUp",isShow:function(){return"1"===e.rowData.sequenceStatus}},{label:"下移",id:"seqArrange-moveDown",isShow:function(){return"1"===e.rowData.sequenceStatus}},{label:"置底",id:"seqArrange-bottom",isShow:function(){return"1"===e.rowData.sequenceStatus}},{label:"编辑",id:"seqArrange-edit",isShow:function(){return"1"===e.rowData.sequenceStatus}},{label:"查看",id:"seqArrange-edit",isShow:function(){return"2"===e.rowData.sequenceStatus}},{label:"删除",id:"seqArrange-delete",isShow:function(){return"1"===e.rowData.sequenceStatus}}]}}),"showAdd",!1),"rowDataRule",null),"loadingTest",!1),"testCode","")},computed:{isEdit:function(){return Boolean(this.rowData)},seqDesignId:function(){var e;return null===(e=this.rowData)||void 0===e?void 0:e.id},disabledIsOptional:function(){var e,t=this.tableConfig.tableData.filter((function(e){return"4"===e.instanceRuleType})),a=t.find((function(e){return J(e.instanceRuleInfo)}));return!!a&&a.id!==(null===(e=this.rowDataRule)||void 0===e?void 0:e.id)}},watch:{},created:function(){},mounted:function(){this.getList()},methods:{clickTest:function(){var e,t=this;null!==(e=this.rowData)&&void 0!==e&&e.sequenceCode&&(this.loadingTest=!0,Object(R["d"])(this.rowData.sequenceCode).then((function(e){var a;"S2001"===e.code&&(t.testCode=null!==(a=null===e||void 0===e?void 0:e.data)&&void 0!==a?a:"")})).catch((function(e){})).finally((function(){t.loadingTest=!1})))},clickAdd:function(){var e=this.tableConfig.tableData.map((function(e){return e.instanceRuleType}));this.rowDataRule={instanceRuleTypeArr:e},this.showAdd=!0},getList:function(){var e,t=this,a={pageNo:this.tableConfig.pagination.pageNo,pageSize:this.tableConfig.pagination.pageSize,requestObject:{seqDesignId:null===(e=this.rowData)||void 0===e?void 0:e.id}};this.tableConfig.loading=!0,this.tableConfig.tableData=[],Object(R["c"])(a).then((function(e){var a=Object(u["a"])(e,"data.data"),i=Object(u["a"])(e,"data.totalCount");t.tableConfig.tableData=Object(d["a"])(a)?a:[],t.tableConfig.pagination.total=i})).finally((function(){t.tableConfig.loading=!1}))},getIndex:function(e){var t=this,a=e.index,i=e.row,n=e.operate;if("delete"===n.id)this.$confirm("确定要删除【".concat(i.instanceRuleName,"】吗?"),{type:"warning"}).then((function(){Object(R["a"])(i.id).then((function(e){"S2001"===e.code&&(t.$message.success("删除成功"),t.tableConfig.tableData.splice(a,1),t.clickUpdateSort(!0),t.refresh())})).catch((function(e){}))})).catch((function(e){}));else if("seqArrange-edit"===n.id||"seqArrange-view"===n.id)this.rowDataRule=i,this.showAdd=!0;else if("seqArrange-top"===n.id){if(0!==a){var o=this.tableConfig.tableData;o.splice(a,1),o.unshift(i)}}else if("seqArrange-bottom"===n.id){var l=this.tableConfig.pagination.total;if(a+1!==l){var s=this.tableConfig.tableData;s.splice(a,1),s.push(i)}}else if("seqArrange-moveUp"==n.id){if(0!==a){var r=this.tableConfig.tableData,c=r[a-1];this.$set(r,a-1,i),this.$set(r,a,c)}}else if("seqArrange-moveDown"==n.id){var u=this.tableConfig.pagination.total;if(a+1!==u){var d=this.tableConfig.tableData,f=d[a+1];this.$set(d,a+1,i),this.$set(d,a,f)}}},clickCancel:function(){this.$emit("change",!1)},clickUpdateSort:function(e){var t=this,a=this.tableConfig.tableData.map((function(e,t){return{id:e.id,sortNo:t+1,seqDesignId:e.seqDesignId}}));this.loading=!0,Object(R["f"])({instanceRuleList:a}).then((function(a){"S2001"!==a.code||e||t.$message.success("已保存排序")})).catch((function(e){})).finally((function(){t.loading=!1,t.getList()}))},onSearch:function(){},changePage:function(e,t){e&&(this.tableConfig.pagination.pageNo=e),t&&(this.tableConfig.pagination.pageNo=1,this.tableConfig.pagination.pageSize=t),this.getList()}}};function J(e){var t={};try{t=JSON.parse(e)}catch(a){}return t.isOptional}var Q=W,X=Object(b["a"])(Q,x,$,!1,null,null,null),Y=X.exports,Z=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"回收详情",visible:e.show,size:"medium","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("search-form",{attrs:{searchConfig:e.searchConfig},on:{"enter-search":e.onEnterSearch,onSearch:e.onSearch}}),t("tableView",{ref:"tableView",attrs:{loading:e.tableConfig.loading,columns:e.tableConfig.columns,tableData:e.tableConfig.tableData,isPage:e.tableConfig.isPage,total:e.tableConfig.pagination.total,currentPage:e.tableConfig.pagination.pageNo,pageSize:e.tableConfig.pagination.pageSize,rowKey:"id"},on:{"update:currentPage":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:current-page":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},changePage:e.changePage,operate:e.getIndex}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},ee=[],te=a("3241"),ae={computed:{isEdit:function(){return Boolean(this.rowData)}},model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:null},refresh:Function},data:function(){return{labelPosition:"right",title:"",rules:{},buttonList:[{label:"新增",type:"add",click:this.addInfo}],searchConfig:{searchData:{ip:"",recycleCode:"",createDate:""},searchItem:[{type:"input",label:"客户端IP",prop:"ip"},{type:"input",label:"回收编号",prop:"recycleCode"},{type:"time",label:"回收时间",prop:"createDate",valueFormat:"yyyy-MM-dd HH:mm:ss"}],rules:{}},tableConfig:{loading:!1,pagination:{pageNo:1,pageSize:10,total:0},tableData:[],columns:[{prop:"ip",label:"客户端IP",align:"center"},{prop:"rqDay",label:"序列日切",align:"center"},{prop:"recycleCode",label:"回收编号",align:"center"},{prop:"createDate",label:"回收时间",align:"center"}],operate:{width:220,list:[{label:"编辑",id:"edit"}]}}}},watch:{},created:function(){},mounted:function(){this.getList()},methods:{addInfo:function(){},onEnterSearch:function(e,t){},onSearch:function(e){this.tableConfig.pagination.pageNo=1,this.getList()},getIndex:function(e){e.index,e.row,e.operate},getList:function(){var e=this,t=this.searchConfig.searchData,a=t.ip,i=t.recycleCode,n=t.createDate,o={pageNo:this.tableConfig.pagination.pageNo,pageSize:this.tableConfig.pagination.pageSize,requestObject:{ip:a,recycleCode:i,seqDesignId:this.rowData.id,startTime:n[0],endTime:n[1]}};this.tableConfig.loading=!0,Object(te["a"])(o).then((function(t){var a=Object(u["a"])(t,"data.data"),i=Object(u["a"])(t,"data.totalCount");e.tableConfig.pagination.total=i,e.tableConfig.tableData=Object(d["a"])(a)?a:[]})).finally((function(){e.tableConfig.loading=!1}))},clickCancel:function(){this.$emit("change",!1)},clickConfirm:function(){this.$emit("change",!1)},changePage:function(e,t){e&&(this.tableConfig.pagination.pageNo=e),t&&(this.tableConfig.pagination.pageNo=1,this.tableConfig.pagination.pageSize=t),this.getList()}}},ie=ae,ne=Object(b["a"])(ie,Z,ee,!1,null,"bbf95be6",null),oe=ne.exports,le=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"导入",visible:e.show,size:"small",loading:e.loading,"append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"120px",rules:e.rules}},[t("el-form-item",{attrs:{label:"选择文件",prop:""}},[t("upload-button",{ref:"unpackUpload",attrs:{action:"/v1/seq/design/import",fileList:e.fileList,listType:"",accept:".xls",data:e.formData,name:"file",autoUpload:!0,showFileList:!0,buttonText:"选择文件",beforeUpload:e.beforeUpload,multiple:"true"},on:{success:e.uploadSuccess},model:{value:e.fileData,callback:function(t){e.fileData=t},expression:"fileData"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.clickCancel}},[e._v("关闭")])],1)],1)},se=[],re={name:"main-config-add",components:{},mixins:[],model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:function(){return{}}},refresh:Function},data:function(){return{envOptions:[],loading:!1,fileData:"",fileList:[],formData:{},rules:{}}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{beforeUpload:function(){this.loading=!0},uploadSuccess:function(e){var t=this;return Object(l["a"])(Object(o["a"])().mark((function a(){var i;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:i=e.response,e.file,e.fileList,t.loading=!1;try{200===i.code?(t.$message.success(i.msg),t.$emit("change",!1),t.refresh()):t.$message({type:"warning",message:i.msg,duration:3e3})}catch(n){}case 4:case"end":return a.stop()}}),a)})))()},clickCancel:function(){this.$emit("change",!1)}}},ce=re,ue=Object(b["a"])(ce,le,se,!1,null,"18d2ebfc",null),de=ue.exports,fe=a("ade8"),pe=a("bc48"),ge=a("cf45"),be={name:"rocketmq-topic-manage",components:{AddAndEdit:I,DialogRuleArrange:Y,DialogUseinfo:h,DialogDetails:oe,DialogImport:de},data:function(){var e=this,t=(this.$createElement,this);return{sequenceStatusOptions:E["g"],rowData:null,showAddDialog:!1,seqArrangeDialog:!1,usageDialog:!1,detailsDialog:!1,showImportDialog:!1,checkedRows:[],buttonList:[{label:"新增",type:"add",click:this.addInfo},{label:"导入",type:"import",click:this.clickImport},{label:"导出",type:"export",click:this.clickExport},{label:"批量发布",type:"publish",click:this.clickPublish,loading:!1},{label:"批量下线",type:"offline",click:this.clickOffline,loading:!1}],tableConfig:{loading:!1,pagination:{pageNo:1,pageSize:10,total:0},tableData:[],columns:[{prop:"sequenceName",label:"序列名称",align:"left"},{prop:"sequenceCode",label:"序列编号",align:"center"},{prop:"sequenceNumber",label:"服务端缓存数量",align:"center"},{prop:"requestNumber",label:"客户端获取数量",align:"center"},{prop:"callbackMode",label:"回拨模式",align:"center",width:100,format:function(e){return O["a"].get(e)}},{prop:"sequenceStatus",label:"状态",align:"center",render:function(t,a){var i=a.row;return t("el-switch",{attrs:{value:i.sequenceStatus,"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"2","inactive-value":"1"},on:{change:function(t){return e.onChangeStatus(t,i)}}})}},{prop:"sequenceRule",label:"规则",align:"left"}],operate:{width:220,columnAlign:"center",list:[{label:"规则编排",id:"seqArrange"},{label:"查看",id:"view",isShow:function(e){return"2"===e.sequenceStatus}},{label:"编辑",id:"edit",isShow:function(e){return"1"===e.sequenceStatus}},{label:"删除",id:"delete",isShow:function(e){return"1"===e.sequenceStatus}},{label:"使用情况",id:"usage"},{label:"回收详情",id:"details"}]}},searchConfig:{searchData:{sequenceApplicationName:"",sequenceName:"",sequenceStatus:""},searchItem:[{type:"input",label:"应用名称",prop:"sequenceApplicationName"},{type:"input",label:"序列名称",prop:"sequenceName"},{type:"select",label:"状态",prop:"sequenceStatus",get options(){return t.sequenceStatusOptions}}],rules:{}}}},computed:{},watch:{},mounted:function(){this.getList()},methods:{onEnterSearch:function(e,t){},getList:function(){var e=this,t={pageNo:this.tableConfig.pagination.pageNo,pageSize:this.tableConfig.pagination.pageSize,requestObject:Object(s["a"])({},this.searchConfig.searchData)};this.tableConfig.loading=!0,Object(D["e"])(t).then((function(t){Object(d["a"])(null===t||void 0===t?void 0:t.data.data)&&(e.tableConfig.tableData=t.data.data),e.tableConfig.pagination.total=Object(u["a"])(t,"data.totalCount")||0})).finally((function(){e.tableConfig.loading=!1}))},addInfo:function(){this.rowData=null,this.showAddDialog=!0},onSearch:function(e){this.tableConfig.pagination.pageNo=1,this.getList()},changePage:function(e,t){e&&(this.tableConfig.pagination.pageNo=e),t&&(this.tableConfig.pagination.pageNo=1,this.tableConfig.pagination.pageSize=t),this.getList()},getIndex:function(e){var t=this,a=(e.index,e.row),i=e.operate;this.rowData=a,"delete"===i.id?this.$confirm("确定要删除序列名称:【".concat(a.sequenceName,"】吗?"),{type:"warning"}).then((function(){Object(D["b"])(a.id).then((function(e){t.$message.success("删除成功"),t.getList()})).catch((function(e){}))})).catch((function(e){})):"edit"===i.id||"view"===i.id?(this.rowData=a,this.showAddDialog=!0):"seqArrange"===i.id?this.seqArrangeDialog=!0:"usage"===i.id?this.usageDialog=!0:"details"===i.id&&(this.detailsDialog=!0)},clickImport:function(){this.showImportDialog=!0},clickExport:function(){var e=this;return Object(l["a"])(Object(o["a"])().mark((function t(){var a,i;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!=(null===(a=e.checkedRows)||void 0===a?void 0:a.length)){t.next=3;break}return e.$message.info("请选择数据"),t.abrupt("return");case 3:try{e.tableConfig.loading=!0,i=e.checkedRows.map((function(e){return e.id})),Object(fe["b"])(i).then((function(t){Object(ge["b"])(t,"序列设计管理","xls"),e.$message.success("导出成功"),e.tableConfig.loading=!1}))}catch(n){e.tableConfig.loading=!1}case 4:case"end":return t.stop()}}),t)})))()},clickPublish:function(){var e=this;return Object(l["a"])(Object(o["a"])().mark((function t(){var a,i,n,l;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,0!=(null===(a=e.checkedRows)||void 0===a?void 0:a.length)){t.next=4;break}return e.$message.info("请选择数据"),t.abrupt("return");case 4:if(i=e.checkedRows.filter((function(e){return"1"!==e.sequenceStatus})),!(i.length>0)){t.next=8;break}return t.abrupt("return",e.$message.warning("请选择未发布的数据"));case 8:return t.next=10,e.$confirm("确定要发布数据吗?",{type:"warning"});case 10:if(n=t.sent,"confirm"===n){t.next=13;break}return t.abrupt("return");case 13:return Object(pe["a"])(e.buttonList[3],"loading",!0),l=e.checkedRows.map((function(e){return{id:e.id,sequenceStatus:"2",sequenceCode:e.sequenceCode,sequenceApplicationId:e.sequenceApplicationId}})),t.next=17,Object(D["a"])(l);case 17:e.$message.success("发布成功"),e.getList(),Object(pe["a"])(e.buttonList[3],"loading",!1),t.next=26;break;case 22:t.prev=22,t.t0=t["catch"](0),Object(pe["a"])(e.buttonList[3],"loading",!1);case 26:case"end":return t.stop()}}),t,null,[[0,22]])})))()},clickOffline:function(){var e=this;return Object(l["a"])(Object(o["a"])().mark((function t(){var a,i,n,l;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,0!=(null===(a=e.checkedRows)||void 0===a?void 0:a.length)){t.next=4;break}return e.$message.info("请选择数据"),t.abrupt("return");case 4:if(i=e.checkedRows.filter((function(e){return"2"!==e.sequenceStatus})),!(i.length>0)){t.next=8;break}return t.abrupt("return",e.$message.warning("请选择已发布的数据"));case 8:return t.next=10,e.$confirm("确定要下线数据吗?",{type:"warning"});case 10:if(n=t.sent,"confirm"===n){t.next=13;break}return t.abrupt("return");case 13:return Object(pe["a"])(e.buttonList[4],"loading",!0),l=e.checkedRows.map((function(e){return{id:e.id,sequenceStatus:"1",sequenceCode:e.sequenceCode,sequenceApplicationId:e.sequenceApplicationId}})),t.next=17,Object(D["a"])(l);case 17:e.$message.success("下线成功"),e.getList(),Object(pe["a"])(e.buttonList[4],"loading",!1),t.next=26;break;case 22:t.prev=22,t.t0=t["catch"](0),Object(pe["a"])(e.buttonList[4],"loading",!1);case 26:case"end":return t.stop()}}),t,null,[[0,22]])})))()},getChildSelectionList:function(e){this.checkedRows=e},onChangeStatus:function(e,t){var a=this,i=2==e?"发布":"下线",n=2==e?"2":"1";this.$confirm("确定要".concat(i,"【").concat(t.sequenceName,"】吗?"),{type:"warning"}).then((function(){var e={id:t.id,sequenceStatus:n,sequenceCode:t.sequenceCode,sequenceApplicationId:t.sequenceApplicationId};Object(D["d"])(e).then((function(e){a.$message.success("".concat(i,"成功")),a.getList()})).catch((function(e){}))})).catch((function(e){}))}}},me=be,he=(a("0ef0"),Object(b["a"])(me,i,n,!1,null,"036dd5fb",null));t["default"]=he.exports},cb34:function(e,t,a){},d366:function(e,t,a){"use strict";a.r(t);a("caad"),a("b0c0"),a("2532");var i=function(){var e=this,t=e._self._c;return t("div",[t("div",{key:"consume",staticClass:"page-box"},[t("el-form",{attrs:{model:e.searchData,rules:e.rules}},[t("el-form-item",{attrs:{label:"集群"}},[t("el-select",{attrs:{placeholder:"请选择集群"},on:{change:e.changeClusterId},model:{value:e.searchData.clusterId,callback:function(t){e.$set(e.searchData,"clusterId",t)},expression:"searchData.clusterId"}},e._l(e.clusterList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[e.cardData&&e.cardData.length>0?t("el-row",{attrs:{gutter:20}},e._l(e.cardData,(function(a,i){return t("el-col",{key:i,attrs:{span:6}},[t("div",{staticClass:"card-box",attrs:{id:"node-item-".concat(i+1)}},[e.clusterStatusArr.includes(a.status)?t("div",{staticClass:"card-status-tag"},[t("el-tag",{attrs:{size:"small",type:e.getTagType(a.status)}},[e._v(e._s(e._f("F_clusterStatusOptions")(a.status)))])],1):e._e(),t("ul",[t("li",[t("span",{staticClass:"card-li-label"},[e._v("集群名称")]),t("span",[e._v(" "+e._s(a.serviceName)+" ")])]),t("li",[t("span",{staticClass:"card-li-label"},[e._v("应用名称")]),t("span",[e._v(" "+e._s(a.sdkName)+" ")])]),t("li",[t("span",{staticClass:"card-li-label"},[e._v("IP")]),t("span",[e._v(" "+e._s(a.hostIp)+" ")])]),t("li",[t("span",{staticClass:"card-li-label"},[e._v("端口")]),t("span",[e._v(" "+e._s(a.port)+" ")])])]),"1"==a.status?t("el-button",{staticClass:"card-bottom-text",attrs:{type:"text",size:"mini"},on:{click:function(t){return e.openBuffer(a)}}},[e._v("缓冲区")]):e._e()],1)])})),1):t("el-empty",{attrs:{"image-size":220}})],1)],1),e.showDialog?t("BufferArea",{attrs:{rowData:e.rowData},model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}}):e._e()],1)},n=[],o=(a("d9e2"),a("d81d"),a("d3b7"),a("7b91")),l=a("ff51"),s=a("2143"),r=a("0bf8"),c=a("1f97"),u={name:"sdk-topology-monitor",components:{BufferArea:o["default"]},mixins:[],filters:{F_clusterStatusOptions:function(e){return Object(c["c"])(e,"clusterStatusOptions")}},props:{},data:function(){return{showDialog:!1,rowData:null,cardData:[],loading:!1,searchData:{clusterId:""},rules:{},clusterList:[]}},computed:{clusterStatusArr:function(){return c["b"].map((function(e){return e.value}))}},watch:{},created:function(){this.getCluster()},mounted:function(){},methods:{openBuffer:function(e){this.showDialog=!0,this.rowData=e},getCluster:function(){var e=this;Object(s["a"])().then((function(t){var a=Object(l["a"])(null===t||void 0===t?void 0:t.data)?t.data:[];e.clusterList=a,a.length>0&&(e.changeClusterId(a[0].id),e.searchData.clusterId=a[0].id)})).catch((function(e){}))},changeClusterId:function(e){e&&(this.cardData=[],this.getData(e))},getData:function(e){var t=this;if(!e)throw Error("集群ID不存在");this.loading=!0,Object(r["b"])(e).then((function(e){Object(l["a"])(null===e||void 0===e?void 0:e.data)&&(t.cardData=e.data)})).catch((function(e){})).finally((function(){t.loading=!1}))},getTagType:function(e){return Object(c["c"])(e,"clusterStatusOptions",["value","type"])}}},d=u,f=(a("db3a9"),a("2877")),p=Object(f["a"])(d,i,n,!1,null,"1ba79232",null);t["default"]=p.exports},d86a:function(e,t,a){"use strict";a.r(t);a("b0c0");var i=function(){var e=this,t=e._self._c;return t("div",[t("header",[e.isAddMain?t("el-button",{attrs:{type:"primary"},on:{click:e.clickAddCluster}},[e._v("添加主中心")]):e._e(),t("el-button",{attrs:{type:"primary"},on:{click:e.clickRefresh}},[e._v("刷新")]),t("el-button",{attrs:{type:""},on:{click:e.goBack}},[e._v("返回")])],1),t("main",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[e.clusterData.length>0?t("el-row",{staticClass:"mt-15",attrs:{gutter:10}},e._l(e.clusterData,(function(a){return t("el-col",{key:a.id,attrs:{span:8}},[t("div",{staticClass:"multiple-card p-10"},[t("el-descriptions",{attrs:{column:2,title:a.name}},[t("div",{attrs:{slot:"extra"},slot:"extra"},[t("el-tag",{attrs:{size:"small",type:e.dictTagType(a.syncMethod),effect:"dark"}},[e._v(e._s(e._f("F_config_clusterRole")(a.syncMethod)))])],1),t("el-descriptions-item",{attrs:{label:"集群名称"}},[e._v(" "+e._s(a.name)+" ")]),t("el-descriptions-item",{attrs:{label:"数据源名称"}},[e._v(" "+e._s(a.currentDbName)+" ")]),t("el-descriptions-item",{attrs:{label:"机房",span:1}},[e._v(" "+e._s(a.machineName)+" ")]),t("el-descriptions-item",{attrs:{label:"状态",span:1}},[e.getStatusItem(a.status)?t("span",[t("hubary-dot",{attrs:{status:e.getStatusItem(a.status).status}},[e._v(e._s(e.getStatusItem(a.status).label))])],1):e._e()]),t("el-descriptions-item",{attrs:{label:"地区",span:2}},[e._v(e._s(a.cityName))]),t("el-descriptions-item",{attrs:{label:"总节点数",span:1}},[e._v(" "+e._s(a.node)+" ")]),t("el-descriptions-item",{attrs:{label:"运行节点数",span:1}},[e._v(" "+e._s(a.healthy)+" ")]),a.parentClusterId?[t("el-descriptions-item",{attrs:{label:"同步集群",span:1}},[e._v(e._s(a.parentClusterName))]),t("el-descriptions-item",{attrs:{label:"同步方式",span:1}},[e._v(e._s(e._f("F_config_syncMethodOptions")(a.syncMethod)))])]:e._e()],2),t("footer",[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.clickBackFooter("switch_dataUrl",a)}}},[e._v("切换数据源")]),t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.clickBackFooter("move",a)}}},[e._v("关联备中心")]),t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.clickBackFooter("delete",a)}}},[e._v("删除")])],1)],1)])})),1):t("el-empty")],1),e.visible?t("ClusterAdd",{attrs:{refresh:e.getList},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}}):e._e(),e.visibleMove?t("DataMove",{attrs:{rowData:e.rowData,clusterList:e.clusterData,refresh:e.getList},model:{value:e.visibleMove,callback:function(t){e.visibleMove=t},expression:"visibleMove"}}):e._e(),e.showSwitch?t("el-dialog-limit",{attrs:{size:"mini",title:"切换数据源",visible:e.showSwitch,width:"30%"},on:{"update:visible":function(t){e.showSwitch=t}}},[t("el-form",{ref:"formSwitchRef",attrs:{model:e.formData}},[t("el-form-item",{attrs:{label:"数据源集群",required:!0,prop:"switchId"}},[t("el-select",{attrs:{placeholder:"请选择数据源集群"},model:{value:e.formData.switchId,callback:function(t){e.$set(e.formData,"switchId",t)},expression:"formData.switchId"}},e._l(e.clusterData,(function(a){return t("el-option",{key:a.seqClusterId,attrs:{label:a.name,value:a.seqClusterId,disabled:e.rowData.currentDb===a.seqClusterId}})})),1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.showSwitch=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.loadingSwitch},on:{click:e.clickSwitchData}},[e._v("确定")])],1)],1):e._e()],1)},n=[],o=(a("7db0"),a("d3b7"),a("cfcc")),l=a("1f97"),s=a("ff51"),r=a("9fb8"),c=a("bca8"),u=(a("e99a"),a("59b0")),d=a("7e51"),f=a("2143"),p={filters:{F_config_clusterRole:function(e){return Object(l["c"])(null!==e&&void 0!==e?e:"main","dict_multiType")},F_config_syncMethodOptions:function(e){return Object(o["f"])(e,"syncMethodOptions")}},components:{ClusterAdd:r["default"],DataMove:c["default"]},mixins:[],props:{},data:function(){return{isAddMain:"",visible:!1,visibleMove:!1,loading:!1,clusterData:[],status:"STOP",rowData:null,clusterOptions:[],showSwitch:!1,formData:{switchId:""},loadingSwitch:!1,clusterIdOptions:[]}},computed:{multiClusterId:function(){return this.$route.query.multiClusterId}},watch:{clusterData:function(){var e="";e=!(this.clusterData.length>0)||!this.clusterData.find((function(e){return!e.parentClusterId})),this.isAddMain=e}},created:function(){},mounted:function(){this.getList()},methods:{goBack:function(){this.$router.go(-1)},getClusterIdOptions:function(){var e=this;Object(u["h"])({}).then((function(t){e.clusterIdOptions=Object(s["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]}))},clickSwitchData:function(){var e=this;this.$refs.formSwitchRef.validate((function(t){t&&(e.loadingSwitch=!0,Object(d["d"])({id:e.rowData.id,currentId:e.rowData.currentDb,switchId:e.formData.switchId}).then((function(t){200===t.code&&(e.$message.success("切换成功"),e.showSwitch=!1,e.getList())})).catch((function(e){})).finally((function(){e.loadingSwitch=!1})))}))},getCluster:function(){var e=this;Object(f["a"])().then((function(t){var a=Object(s["a"])(null===t||void 0===t?void 0:t.data)?t.data:[];e.clusterList=a,a.length>0&&(e.changeClusterId(a[0].id),e.searchData.clusterId=a[0].id)})).catch((function(e){}))},filterInfo:function(e,t){return Object(o["f"])(e,this.clusterOptions,["id",t])},clickRefresh:function(){this.getList()},dictTagType:function(e){return Object(l["c"])(null!==e&&void 0!==e?e:"main","dict_multiType",["value","type"])},getStatusItem:function(e){return Object(l["c"])(e,"dict_multiCenterStatus",[],!0)},getList:function(){var e=this,t=this.$route.query.multiClusterId;this.loading=!0,Object(d["c"])(t).then((function(t){var a=Object(s["a"])(null===t||void 0===t?void 0:t.data)?t.data:[];e.clusterData=a})).catch((function(e){})).finally((function(){e.loading=!1}))},clickAddCluster:function(){this.visible=!0},clickSync:function(e){e.id},clickBackFooter:function(e,t){var a=this;switch(this.rowData=t,e){case"move":this.visibleMove=!0;break;case"delete":this.$confirm("确定要删除【".concat(t.name,"】吗"),{type:"warning"}).then((function(){Object(d["a"])(t.id).then((function(e){200===e.code&&(a.$message.success("删除成功"),a.clickRefresh())})).catch((function(e){}))}));break;case"start":t.id;this.loading=!0;break;case"stop":t.id;this.loading=!0;break;case"switch_dataUrl":this.formData.switchId="",this.showSwitch=!0;break}}}},g=p,b=(a("c63a"),a("2877")),m=Object(b["a"])(g,i,n,!1,null,"2f44665b",null);t["default"]=m.exports},db3a9:function(e,t,a){"use strict";a("66f0")},e365:function(e,t,a){},e4f4:function(e,t,a){"use strict";a("5eaf")},f250:function(e,t,a){}}]);