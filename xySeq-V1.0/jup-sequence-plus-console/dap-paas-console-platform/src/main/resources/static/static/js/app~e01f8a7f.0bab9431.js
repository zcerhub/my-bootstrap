(window["jsonpPaas4"]=window["jsonpPaas4"]||[]).push([["app~e01f8a7f"],{"01c7":function(e,t,a){"use strict";a.r(t);a("99af");var n=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"添加节点",visible:e.visible,loading:e.loading,size:"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"120px",rules:e.rules}},[1===e.nodeType?t("el-form-item",{attrs:{label:"父节点"}},[e._v(" "+e._s("".concat(e.rowData.ip,":").concat(e.rowData.port))+" ")]):e._e(),t("el-form-item",{attrs:{label:"节点",prop:"machineId"}},[t("el-select",{staticClass:"w-100",attrs:{size:"mini",placeholder:"请选择节点",filterable:""},on:{change:e.changeIp},model:{value:e.formData.machineId,callback:function(t){e.$set(e.formData,"machineId",t)},expression:"formData.machineId"}},e._l(e.machineList,(function(a){return t("el-option",{key:a.value,staticClass:"el-option-box",attrs:{label:a.label,value:a.value}},[t("ul",{staticClass:"el-option-ul-between"},[t("li",[e._v(e._s(a.label))]),t("li",[e._v(e._s(a.hostSshAccount))])])])})),1)],1),t("el-form-item",{attrs:{label:"节点端口",prop:"port"}},[t("el-input-number",{staticClass:"w-100",attrs:{size:"mini","controls-position":"right",min:0,max:65535,placeholder:"端口"},model:{value:e.formData.port,callback:function(t){e.$set(e.formData,"port",t)},expression:"formData.port"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},i=[],o=a("5530"),r=(a("a9e3"),a("d3b7"),a("c853")),s=a("ff51"),l={components:{},mixins:[],model:{prop:"show",event:"change"},props:{show:Boolean,refresh:Function,rowData:{type:Object,default:function(){return{}}},clusterId:{type:String,default:void 0},nodeType:{type:Number,default:void 0}},data:function(){return{formData:{machineId:"",port:0},machineList:[],rules:{machineId:[{required:!0,trigger:"blur",message:"请选择节点"}],port:[{required:!0,trigger:"blur",message:"请输入端口"}]},options:[],loading:!1}},computed:{visible:{get:function(){return this.show},set:function(e){this.$emit("change",!1)}}},watch:{},created:function(){},mounted:function(){this.getIps()},methods:{getIps:function(){var e=this;Object(r["b"])(this.clusterId).then((function(t){e.machineList=Object(s["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).catch((function(e){}))},changeIp:function(e){},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){var a=Object(o["a"])({clusterId:e.clusterId},e.formData);e.loading=!0,Object(r["c"])(a).then((function(t){t&&200===t.code&&(e.$message.success("新增成功"),e.$emit("change",!1),e.refresh())})).finally((function(){e.loading=!1}))}}))}}},c=l,d=(a("b875"),a("2877")),u=Object(d["a"])(c,n,i,!1,null,"3e28dbb9",null);t["default"]=u.exports},3874:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"name-container"},[t("search-form",{attrs:{searchConfig:e.searchConfig},on:{onSearch:e.onSearch}}),t("comp-table",{ref:"compTable",attrs:{isMultiple:!1,isDialog:!1,loading:e.tableModel.loading,"table-model":e.tableModel,"search-model":e.searchModel},on:{openConfig:e.openConfig,openEdit:e.openEdit,clickConnectTest:e.clickConnectTest,"delete-one":e.clickDelete,changePage:e.changePage}}),e.dialogVisible?t("EnvConfigAdd",{attrs:{rowData:e.rowData,refresh:e.getList},model:{value:e.dialogVisible,callback:function(t){e.dialogVisible=t},expression:"dialogVisible"}}):e._e()],1)},i=[],o=(a("d81d"),a("a9e3"),a("d3b7"),a("51f9")),r=a("8a80"),s=a("ec41"),l=a("ff51"),c=a("ed08"),d=a("ff32"),u={filters:{},components:{EnvConfigAdd:o["default"]},data:function(){return{coordinatorTypeOpitons:d["c"],rowData:{},dialogVisible:!1,tableModel:{loading:!1,tableData:[],rowData:[{prop:"order",label:"序号",align:"center"},{prop:"envCode",label:"环境编号",align:"center"},{prop:"description",label:"环境描述",align:"center"},{prop:"updateDate",label:"最后修改时间",align:"center",format:function(e){return Object(c["d"])(e)}}],operateWidth:"220px",operateData:[{label:"编辑",type:"openEdit",funName:"openEdit"},{label:"删除",type:"delete",funName:"clickDelete"}],pagination:{pageNo:1,pageSize:10,total:0}},searchModel:{btnGroup:[{type:"openConfig",style:"primary",funName:"openConfig",label:"新增"}],formModel:{cluster:""},searchFild:[]},deployOptions:[],searchConfig:{searchData:{envCode:""},searchItem:[{prop:"envCode",label:"环境编号",type:"input"}],rules:{}}}},created:function(){},mounted:function(){this.getList()},methods:{onSearch:function(e){this.tableModel.pagination.pageNo=1,this.getList()},getList:function(){var e=this,t=this.tableModel.pagination,a=t.pageNo,n=t.pageSize,i={pageNo:a,pageSize:n,requestObject:this.searchConfig.searchData};this.tableModel.loading=!0;var o=[];Object(r["e"])(i).then((function(t){var i=Object(s["a"])(t,"data.data"),r=Object(s["a"])(t,"data.totalCount");Object(l["a"])(i)&&(i.map((function(e,t){e.order=n*(a-1)+t+1})),o=i),e.tableModel.tableData=o,e.tableModel.pagination.total=Number(r)||0})).catch((function(e){})).finally((function(){e.tableModel.loading=!1}))},openConfig:function(){this.rowData=null,this.dialogVisible=!0},openEdit:function(e){this.rowData=e,this.dialogVisible=!0},clickConnectTest:function(e){var t=this;ApiEnvConfigTest({id:e.id}).then((function(e){200===e.code&&t.$message.success("连接测试成功")})).catch((function(e){}))},clickDelete:function(e){var t=this;Object(r["a"])(e).then((function(e){200===e.code&&(t.$message.success("删除成功"),t.getList())})).catch((function(e){}))},getDeploy:function(e){var t=this,a={linkProtocol:""},n=this.searchConfig.searchData.linkProtocol;e&&n&&(a.linkProtocol=n),Object(r["b"])(a).then((function(e){e&&(t.deployOptions=e.data)})).catch((function(e){}))},changePage:function(e,t){e&&(this.tableModel.pagination.pageNo=e),t&&(this.tableModel.pagination.pageNo=1,this.tableModel.pagination.pageSize=t),this.getList()}}},f=u,p=a("2877"),g=Object(p["a"])(f,n,i,!1,null,"735b08d3",null);t["default"]=g.exports},"3a2c":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{style:{height:e.height,width:e.width},attrs:{id:"mountNode"}})},i=[],o=(a("cb29"),a("a15b"),a("7c3e")),r={name:"g6-dagre",components:{},mixins:[],props:{width:{type:String,default:"100%"},height:{type:String,default:"100%"},chartData:{type:Object,default:function(){return{nodes:[],edges:[]}}}},data:function(){return{graph:null}},computed:{},watch:{},created:function(){},mounted:function(){this.initDagre(),window.addEventListener("resize",this.resize)},destroyed:function(){window.removeEventListener("resize",this.resize),this.graph=null},methods:{initDagre:function(){var e=this,t=this.chartData;o["a"].registerNode("sql",{drawShape:function(e,t){var a=t.addShape("rect",{attrs:{x:-75,y:-25,width:150,height:50,radius:10,stroke:"#5B8FF9",lineWidth:1,fill:e.style.fill},name:"rect-shape"});return a}},"single-node");var a=new o["a"].Graph({container:"mountNode",fitView:!0,pixelRatio:2,layout:{type:"grid",begin:[20,20],nodeSize:150,preventOverlap:!0},animate:!0,defaultNode:{type:"sql",style:{stroke:"#C4E3B2",radius:7},labelCfg:{style:{fill:"#000",fontSize:14}}},comboStateStyles:{selected:{shadowBlur:1,lineWidth:1}},nodeStateStyles:{selected:{shadowColor:"#1d70f5",shadowBlur:10,lineWidth:2,cursor:"pointer"}},modes:{default:["drag-canvas","zoom-canvas","click-select",{type:"tooltip",formatText:function(e){var t=[];return t.join("\n")},offset:30}]}});a.data(t),a.render(),a.fitView(),this.graph=a,a.on("node:click",(function(t){t.target;var a=t.item,n=a.getModel();e.$emit("click-node",n)}))},resize:function(){var e=this.$el,t=e.offsetHeight,a=e.offsetWidth;this.graph.changeSize(a,t)}}},s=r,l=a("2877"),c=Object(l["a"])(s,n,i,!1,null,"01b352f0",null);t["default"]=c.exports},"3b28":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"name-container"},[t("search-form",{attrs:{searchConfig:e.searchModel},on:{onSearch:e.onSearch}}),t("tableView",{ref:"tableView",attrs:{loading:e.tableConfig.loading,columns:e.tableConfig.columns,tableData:e.tableConfig.tableData,isPage:e.tableConfig.isPage,total:e.tableConfig.pagination.total,rowKey:"id",currentPage:e.tableConfig.pagination.pageNo,pageSize:e.tableConfig.pagination.pageSize},on:{"update:currentPage":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:current-page":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},changePage:e.changePage}})],1)},i=[],o=a("5530"),r=(a("d3b7"),a("bd5d")),s=a("ff51"),l=a("ec41"),c={filters:{},components:{},data:function(){return{showDialog:!1,rowData:null,tableConfig:{loading:!1,pagination:{pageNo:1,pageSize:10,total:0},tableData:[],columns:[{prop:"userName",label:"用户",align:"center"},{prop:"ip",label:"访问IP",width:200},{prop:"functions",label:"功能"},{prop:"updateDate",label:"操作时间",align:"center",width:180}]},searchModel:{searchData:{userName:"",functions:""},searchItem:[{type:"input",label:"用户",prop:"userName"},{type:"input",label:"功能",prop:"functions"}],rules:{}}}},mounted:function(){this.getList()},methods:{changePage:function(e,t){e&&(this.tableConfig.pagination.pageNo=e),t&&(this.tableConfig.pagination.pageNo=1,this.tableConfig.pagination.pageSize=t),this.getList()},onSearch:function(){this.tableConfig.pagination.currentPage=1,this.getList()},getList:function(){var e=this,t={pageNo:this.tableConfig.pagination.pageNo,pageSize:this.tableConfig.pagination.pageSize,requestObject:Object(o["a"])({},this.searchModel.searchData)};this.tableConfig.loading=!0,Object(r["a"])(t).then((function(t){Object(s["a"])(null===t||void 0===t?void 0:t.data.data)&&(e.tableConfig.tableData=t.data.data),e.tableConfig.pagination.total=Object(l["a"])(t,"data.totalCount")||0})).finally((function(){e.tableConfig.loading=!1}))}}},d=c,u=a("2877"),f=Object(u["a"])(d,n,i,!1,null,"6c476696",null);t["default"]=f.exports},4406:function(e,t,a){"use strict";a.r(t);a("498a");var n=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"白名单",visible:e.show,size:"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[t("el-form-item",{attrs:{label:"应用",prop:"appId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:function(t){e.getConfigOptions(t,!0)}},model:{value:e.form.appId,callback:function(t){e.$set(e.form,"appId",t)},expression:"form.appId"}},e._l(e.appOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"环境",prop:"envId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择环境"},on:{change:function(t){e.getConfigOptions(t,!0)}},model:{value:e.form.envId,callback:function(t){e.$set(e.form,"envId",t)},expression:"form.envId"}},e._l(e.envOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"单元",prop:"unitCode"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.form.unitCode,callback:function(t){e.$set(e.form,"unitCode",t)},expression:"form.unitCode"}},e._l(e.unitCodeOptions,(function(e){return t("el-option",{key:e.unitCode,attrs:{label:e.unitCode,value:e.unitCode}})})),1)],1),t("el-form-item",{attrs:{label:"配置",prop:"configId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",loading:e.loading},model:{value:e.form.configId,callback:function(t){e.$set(e.form,"configId",t)},expression:"form.configId"}},e._l(e.configOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"白名单",prop:"whiteIp"}},[t("el-input",{attrs:{placeholder:"请输入",type:"textarea"},model:{value:e.form.whiteIp,callback:function(t){e.$set(e.form,"whiteIp","string"===typeof t?t.trim():t)},expression:"form.whiteIp"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},i=[],o=a("5530"),r=a("ade3"),s=(a("d9e2"),a("7db0"),a("b64b"),a("d3b7"),a("159b"),a("c43b")),l=a("934b"),c=a("ff51"),d={name:"white-list-add",components:{},mixins:[],model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:function(){return{}}},refresh:Function},data:function(){var e=this,t=function(t,a,n){var i=e.form,o=i.appId,r=i.envId,l=i.id;if(o&&r){var c={appId:o,envId:r,configId:a,id:l};Object(s["k"])(c).then((function(e){200===e.code&&n()})).catch((function(e){n(new Error(e))}))}else n()};return Object(r["a"])(Object(r["a"])({form:u(),configOptions:[],appOptions:[],envOptions:[],unitCodeOptions:[],unitName:"",loading:!1},"form",{appId:"",configId:"",envId:"",whiteIp:""}),"rules",{appId:[{required:!0,trigger:"change",message:"请选择应用"}],configId:[{required:!0,trigger:"blur",message:"请选择配置"},{validator:t,trigger:"change"}],envId:[{required:!0,trigger:"change",message:"请选择环境"}],unitCode:[{required:!1,trigger:"change",message:"请选择单元"}]})},computed:{isEdit:function(){var e;return Boolean(null===(e=this.rowData)||void 0===e?void 0:e.id)},currentUnitName:function(){var e=this,t=this.unitCodeOptions.find((function(t){return t.unitCode===e.form.unitCode}));return t?t.unitName:""}},watch:{},created:function(){this.getConfigOptions()},mounted:function(){this.isEdit&&(this.form=u(this.rowData)),this.getOptions()},methods:{getOptions:function(){var e=this;Object(s["f"])().then((function(t){e.envOptions=Object(c["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).catch((function(e){})),Object(s["e"])().then((function(t){e.appOptions=Object(c["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).catch((function(e){})),Object(l["c"])({}).then((function(t){e.unitCodeOptions=Object(c["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).catch((function(e){}))},getConfigOptions:function(e,t){var a=this;this.form.configId="";var n={appId:"",envId:""},i=this.form,o=i.appId,r=i.envId;t&&o&&r&&(n.appId=o,n.envId=r),this.loading=!0,Object(s["d"])(n).then((function(e){a.configOptions=Object(c["a"])(null===e||void 0===e?void 0:e.data)?e.data:[]})).finally((function(){a.loading=!1})).catch((function(e){}))},clickCancel:function(){this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){var a=Object(o["a"])(Object(o["a"])({},e.form),{},{unitName:e.currentUnitName});e.isEdit?Object(s["c"])(a).then((function(t){200===t.code&&(e.$message.success("修改成功"),e.$emit("change",!1),e.refresh())})).catch((function(e){})):Object(s["a"])(e.form).then((function(t){200===t.code&&(e.$message.success("新增成功"),e.$emit("change",!1),e.refresh())})).catch((function(e){}))}}))}}};function u(e){var t={id:"",appId:"",configId:"",envId:"",whiteIp:"",unitCode:"",unitName:""};return e&&Object.keys(t).forEach((function(a){t[a]=e[a]})),t}var f=d,p=a("2877"),g=Object(p["a"])(f,n,i,!1,null,"4fea1f68",null);t["default"]=g.exports},"51f9":function(e,t,a){"use strict";a.r(t);a("a4d3"),a("e01a"),a("caad"),a("b0c0"),a("2532"),a("498a");var n=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"环境配置",visible:e.show,size:"medium","append-to-body":!0,"close-on-click-modal":!1,loading:e.loading},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"120px",rules:e.rules}},[t("el-form-item",{attrs:{label:"配置数据",prop:"configDataType"}},[t("el-radio-group",{model:{value:e.formData.configDataType,callback:function(t){e.$set(e.formData,"configDataType",t)},expression:"formData.configDataType"}},[t("el-radio",{attrs:{label:"1"}},[e._v(" 多中心独享 "),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"},scopedSlots:e._u([{key:"content",fn:function(){return[t("div",{staticStyle:{padding:"0 3px 2px","text-align":"center"}},[e._v(" 多个数据中心，配置文件的数据不一致，每个主中心每个环境都需要发布 ")])]},proxy:!0}])},[t("span",[t("i",{staticClass:"el-icon-info"})])])],1),t("el-radio",{attrs:{label:"2"}},[e._v("多中心共享 "),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"},scopedSlots:e._u([{key:"content",fn:function(){return[t("div",{staticStyle:{padding:"0 3px 2px","text-align":"center"}},[e._v(" 多个数据中心，配置文件的数据完全一致，只需主中心发布 ")])]},proxy:!0}])},[t("span",[t("i",{staticClass:"el-icon-info"})])])],1)],1)],1),t("el-form-item",{attrs:{label:"环境编号",prop:"envCode"}},[t("el-input",{attrs:{placeholder:"请输入环境编号"},model:{value:e.formData.envCode,callback:function(t){e.$set(e.formData,"envCode","string"===typeof t?t.trim():t)},expression:"formData.envCode"}})],1),"1"===e.formData.configDataType?t("div",[t("el-form-item",{attrs:{label:"服务集群名称",prop:"_serviceClusterId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择服务集群名称"},model:{value:e.formData._serviceClusterId,callback:function(t){e.$set(e.formData,"_serviceClusterId",t)},expression:"formData._serviceClusterId"}},e._l(e.serviceClusterList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"地区",prop:"cityName"}},[t("el-input",{staticClass:"w-100",attrs:{disabled:""},model:{value:e.formData.cityName,callback:function(t){e.$set(e.formData,"cityName",t)},expression:"formData.cityName"}})],1),t("el-form-item",{attrs:{label:"数据中心",prop:"machineName"}},[t("el-input",{staticClass:"w-100",attrs:{disabled:""},model:{value:e.formData.machineName,callback:function(t){e.$set(e.formData,"machineName",t)},expression:"formData.machineName"}})],1)],1):e._e(),"2"===e.formData.configDataType?t("div",{staticStyle:{"margin-bottom":"20px"}},[t("el-table",{staticClass:"w-100 ruler-table table-class",attrs:{data:e.formData.infos,"cell-style":{padding:"5px 5px"}}},[t("el-table-column",{attrs:{prop:"clusterCoordinatorId",label:"服务集群名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.row,i=a.$index;return[t("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"","label-width":"0",prop:"infos.".concat(i,".clusterCoordinatorId"),rules:e.rules.clusterCoordinatorId,"show-message":!1,"status-icon":!0}},[t("el-select",{attrs:{clearable:""},model:{value:n.clusterCoordinatorId,callback:function(t){e.$set(n,"clusterCoordinatorId",t)},expression:"row.clusterCoordinatorId"}},e._l(e.serviceClusterList,(function(a){return t("el-option",{key:a.id,attrs:{label:a.name,value:a.id,disabled:e.selectedClusterCoord.includes(a.id)}})})),1)],1)]}}],null,!1,618168466)}),t("el-table-column",{attrs:{prop:"cityName",label:"地区",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.row,i=a.$index;return[t("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"","label-width":"0",prop:"infos.".concat(i,".cityName"),rules:e.rules.cityName,"show-message":!1,"status-icon":!0}},[e.opts_clusterCoordMap.get(n.clusterCoordinatorId)?t("span",[e._v(" "+e._s(e.opts_clusterCoordMap.get(n.clusterCoordinatorId).cityName))]):e._e()])]}}],null,!1,2343313139)}),t("el-table-column",{attrs:{prop:"machineName",label:"数据中心",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.row,i=a.$index;return[t("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"","label-width":"0",prop:"infos.".concat(i,".machineName"),rules:e.rules.machineName,"show-message":!1,"status-icon":!0}},[e.opts_clusterCoordMap.get(n.clusterCoordinatorId)?t("span",[e._v(" "+e._s(e.opts_clusterCoordMap.get(n.clusterCoordinatorId).machineName))]):e._e()])]}}],null,!1,4040704689)}),t("el-table-column",{attrs:{prop:"actions",label:"操作",width:"100"},scopedSlots:e._u([{key:"header",fn:function(){return[t("el-button",{attrs:{type:"text"},on:{click:e.clickInfosAdd}},[e._v("+添加")])]},proxy:!0},{key:"default",fn:function(a){var n=a.$index;a.row;return[t("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"","label-width":"0","show-message":!1,"status-icon":!0}},[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.clickDelete(n,e.formData.infos)}}},[e._v("删除")])],1)]}}],null,!1,2331228907)})],1)],1):e._e(),t("el-form-item",{attrs:{label:"环境描述",prop:"description"}},[t("el-input",{attrs:{placeholder:"请输入环境描述",type:"textarea"},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description","string"===typeof t?t.trim():t)},expression:"formData.description"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},i=[],o=a("5530"),r=a("c7eb"),s=a("1da1"),l=a("b85c"),c=(a("7db0"),a("d81d"),a("14d9"),a("a434"),a("4ec9"),a("b64b"),a("d3b7"),a("3ca3"),a("159b"),a("ddb0"),a("8a80")),d=a("3739"),u=a("ff32"),f=a("ff51"),p=a("ec41");function g(e){var t={id:"",configDataType:"1",clusterId:[],infos:[],description:"",envCode:"",_serviceClusterId:""};return e&&Object.keys(t).forEach((function(a){"infos"===a?"2"===e.configDataType&&(t["infos"]=e[a]):t[a]=e[a]})),t}var m={components:{},mixins:[],model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:function(){return{}}},refresh:Function},data:function(){return{loading:!1,coordinatorTypeOpitons:u["c"],linkProtocolOptions:u["f"],deployOptions:[],serviceClusterList:[],formData:g(),rules:{_serviceClusterId:[{required:!0,trigger:"change",message:"请选择服务集群名称"}],multiArchId:[{required:!0,trigger:"change",message:"请选择多中心架构"}],coordinatorType:[{required:!0,trigger:"change",message:"请选择协调器类型"}],envCode:[{required:!0,trigger:"blur",message:"请输入环境编号"},{max:20,message:"不能超过20个字符",trigger:"blur"},{pattern:/^((?!-).)*$/,message:"不允许包含中划线"}],linkProtocol:[{required:!0,trigger:"blur",message:"请选择连接协议"}],clusterCoordinatorId:[{required:!0,trigger:"change",message:"请选择服务集群名称"}]}}},computed:{isEdit:function(){var e;return Boolean(null===(e=this.rowData)||void 0===e?void 0:e.id)},opts_clusterCoordMap:function(){var e,t=new Map,a=Object(l["a"])(this.serviceClusterList);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.set(n.id,n)}}catch(i){a.e(i)}finally{a.f()}return t},selectedClusterCoord:function(){return this.formData.infos.map((function(e){return e.clusterCoordinatorId}))}},watch:{"formData._serviceClusterId":{handler:function(e){var t=this.serviceClusterList.find((function(t){return t.id===e}));this.formData.cityName=null===t||void 0===t?void 0:t.cityName,this.formData.machineName=null===t||void 0===t?void 0:t.machineName},immediate:!0}},created:function(){this.getServiceClusterOptions()},mounted:function(){},methods:{clickInfosAdd:function(){this.formData.infos.push({clusterCoordinatorId:""})},clickDelete:function(e,t){t.splice(e,1)},getServiceClusterOptions:function(){var e=this;return Object(s["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:Object(d["h"])().then((function(t){e.serviceClusterList=Object(f["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).then((function(t){e.isEdit&&e.getDetail()})).catch((function(e){}));case 1:case"end":return t.stop()}}),t)})))()},getDetail:function(){var e=this;return Object(s["a"])(Object(r["a"])().mark((function t(){var a,n;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(c["d"])(e.rowData.id);case 3:a=t.sent,e.formData=g(a.data),n=Object(p["a"])(a,"data.clusterId",[]),"1"===e.formData.configDataType?e.formData._serviceClusterId=Object(p["a"])(n,"0"):e.formData.infos=n.map((function(e){return{clusterCoordinatorId:e}})),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},validateCoordinatorEvnCode:function(){var e=this;this.$nextTick((function(){e.$refs.formRef.validateField("envCode")}))},getDeploy:function(e,t){var a=this;this.formData._serviceClusterId="";var n={linkProtocol:"",coordinatorType:this.formData.coordinatorType},i=this.formData.linkProtocol;t&&i&&(n.linkProtocol=i),this.validateCoordinatorEvnCode(),Object(c["b"])(n).then((function(e){e&&(a.deployOptions=e.data)})).catch((function(e){}))},clickCancel:function(){this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){var a=Object(o["a"])({},e.formData);"2"===e.formData.configDataType?a.clusterId=e.formData.infos.map((function(e){return e.clusterCoordinatorId})):a.clusterId=[e.formData._serviceClusterId],delete a._serviceClusterId,delete a.infos,e.loading=!0,Object(c["g"])(a).then((function(t){200===t.code&&(e.addEdit(a),e.loading=!1)})).catch((function(e){})).finally((function(t){e.loading=!1}))}}))},addEdit:function(e){var t=this;this.isEdit?Object(c["f"])(e).then((function(e){200===e.code&&(t.$message.success("修改成功"),t.$emit("change",!1),t.refresh())})).catch((function(e){})).finally((function(){})):(delete e.id,Object(c["c"])(e).then((function(e){200===e.code&&(t.$message.success("新增成功"),t.$emit("change",!1),t.refresh())})).catch((function(e){})).finally((function(){})))}}},h=m,b=a("2877"),v=Object(b["a"])(h,n,i,!1,null,"2dd80ca7",null);t["default"]=v.exports},"538c":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"name-container"},[t("search-form",{attrs:{searchConfig:e.searchConfig},on:{onSearch:e.onSearch}}),t("comp-table",{ref:"compTable",attrs:{loading:e.loading,"table-model":e.tableModel,"form-model":e.formModel,"search-model":e.searchModel},on:{submitHandle:e.submitAdd,editHandle:e.submitEdit,"delete-one":e.clickDelete,toPage:e.toPage,changePage:e.changePage}})],1)},i=[],o=(a("d9e2"),a("14d9"),a("b0c0"),a("a9e3"),a("d3b7"),a("23a6")),r=a("ec41"),s=a("ff51"),l={filters:{},components:{},data:function(){var e=this,t=this,a=function(t,a,n){var i=e.formModel.formData,r=i.clusterType,s=i.name,l=i.id;if(r&&s){var c={clusterType:r,version:a,name:s,id:l};Object(o["g"])(c).then((function(e){200===e.code&&n()})).catch((function(e){n(new Error(e))}))}else n()};return{loading:!1,tableModel:{tableData:[],rowData:[{prop:"name",label:"名称"},{prop:"machineroomName",label:"机房"},{prop:"version",label:"版本"},{prop:"runNum",label:"运行节点"},{prop:"exceptionNum",label:"异常节点"},{prop:"nodeNum",label:"节点数"}],operateWidth:"220px",operateData:[{label:"节点管理",funName:"toPage",type:"manage"},{label:"编辑",type:"edit"},{label:"删除",type:"delete"}],pagination:{pageNo:1,pageSize:10,total:6,show:!0}},formModel:{formData:{id:"",name:"",clusterType:"",version:"",machineroomId:""},formLabelWidth:"130px",formFilds:[{label:"名称",prop:"name",type:"input",disabled:!1},{label:"类型",prop:"clusterType",type:"select",disabled:!1,options:[{value:"1",label:"zookeeper"},{value:"2",label:"server"},{value:"3",label:"nacos"}]},{label:"版本",prop:"version",type:"select",disabled:!1,options:[{value:"3.0",label:"3.0"},{value:"4.0",label:"4.0"}]},{label:"机房",prop:"machineroomId",type:"select",disabled:!1,get options(){return t.roomOptions}}],btnData:[{type:"submit",style:"primary",label:"确定",handle:function(){}},{type:"cancle",label:"取消",style:"",handle:function(){}}],rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{pattern:/^((?!-).)*$/,message:"不允许包含中划线"}],clusterType:[{required:!0,message:"请选择类型",trigger:"change"}],version:[{required:!0,message:"请选择版本",trigger:"change"},{validator:a,trigger:"change"}],machineroomId:[{required:!0,message:"请选择机房",trigger:"change"}]}},searchModel:{btnGroup:[{type:"add",label:"新增"}]},roomOptions:[],searchConfig:{searchData:{name:"",machineroomId:"",clusterId:""},searchItem:[{prop:"name",label:"名称",type:"input"},{prop:"machineroomId",type:"select",label:"机房",get options(){return t.roomOptions}}],rules:{}}}},created:function(){this.getRoom()},mounted:function(){this.getList()},methods:{toPage:function(e){this.$router.push({path:"/environmentManagement/node-manage",query:{id:e.id,name:e.name,machineroomName:e.machineroomName}})},onSearch:function(e){this.tableModel.pagination.pageNo=1,this.getList()},getList:function(){var e=this,t={pageNo:this.tableModel.pagination.pageNo,pageSize:this.tableModel.pagination.pageSize,requestObject:this.searchConfig.searchData};this.loading=!0,Object(o["d"])(t).then((function(t){var a,n=Object(r["a"])(t,"data.data");e.tableModel.tableData=Object(s["a"])(n)?n:[],e.tableModel.pagination.total=Number(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.totalCount)||0})).finally((function(){e.loading=!1}))},submitAdd:function(e){var t=this;Object(o["a"])(e).then((function(e){200===e.code&&(t.$message.success("新增成功"),t.$refs.compTable.hideDialog(),t.getList())}))},submitEdit:function(e){var t=this;Object(o["c"])(e).then((function(e){200===e.code&&(t.$message.success("修改成功"),t.$refs.compTable.hideDialog(),t.getList())}))},clickDelete:function(e){var t=this;Object(o["b"])(e).then((function(e){200===e.code&&(t.$message.success("删除成功"),t.getList())}))},getRoom:function(){var e=this;Object(o["e"])().then((function(t){e.roomOptions=Object(s["a"])(t.data)?t.data:[]})).catch((function(e){}))},changePage:function(e,t){e&&(this.tableModel.pagination.pageNo=e),t&&(this.tableModel.pagination.pageNo=1,this.tableModel.pagination.pageSize=t),this.getList()}}},c=l,d=a("2877"),u=Object(d["a"])(c,n,i,!1,null,"ed316af4",null);t["default"]=u.exports},"5d62":function(e,t,a){"use strict";a("881c")},"654d":function(e,t,a){"use strict";a.r(t);a("99af"),a("b0c0");var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mode-page"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"main-content",attrs:{"element-loading-text":"加载中,请稍候......"}},[t("div",{staticClass:"main-left"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickAddNode}},[e._v("添加节点")]),t("el-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")]),!e.loading&&e.linksData.length>0?t("G6Dagre",{attrs:{chartData:e.chartData,height:"500px",width:"100%"},on:{"click-node":e.clickNode}}):t("el-empty",{attrs:{description:"暂无数据"}})],1),t("div",{staticClass:"main-right"},[t("el-descriptions",{staticClass:"margin-top",attrs:{title:e.baseInfo.name,column:2,size:"small"}},[t("template",{slot:"extra"},[t("el-button",{attrs:{type:"text",size:"small"},on:{click:e.refresh}},[e._v("刷新")])],1),t("el-descriptions-item",{attrs:{label:"机房"}},[e._v(" "+e._s(e.baseInfo.machineroomName)+" ")])],2),e.currentNode?[t("el-descriptions",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingNode,expression:"loadingNode"}],staticClass:"mt-10",staticStyle:{"padding-top":"15px","border-top":"1px solid #c6c6c6"},attrs:{title:"".concat(e.currentNode.value,":").concat(e.currentNode.port),column:2,size:"small"}},[t("el-descriptions-item",{attrs:{label:"角色"}},[t("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.currentNode.isMaster,expression:"currentNode.isMaster"}],attrs:{size:"mini"}},[e._v(e._s("1"===e.currentNode.isMaster?"主节点":"从节点"))])],1),t("el-descriptions-item",{attrs:{label:"运行状态",span:2,labelStyle:{lineHeight:"28px"},contentStyle:{lineHeight:"28px"}}},[e._v(" "+e._s("1"===e.currentNode.status?"正常":"异常")+" "),"1"===e.currentNode.status?t("el-button",{staticClass:"ml-10",attrs:{size:"mini",round:"",plain:"",type:"danger"}},[e._v(" 停止 ")]):"0"===e.currentNode.status?t("el-button",{staticClass:"ml-10",attrs:{type:"primary",size:"mini",round:"",plain:""}},[e._v(" 启动 ")]):e._e()],1)],1),t("el-divider"),t("button-list",{attrs:{data:e.buttonList}})]:e._e()],2)]),e.addmasternode?t("DialogAddNode",{attrs:{clusterId:e.clusterId,nodeType:e.nodeType_add,rowData:e.currentNode,refresh:e.refresh},model:{value:e.addmasternode,callback:function(t){e.addmasternode=t},expression:"addmasternode"}}):e._e()],1)},i=[],o=a("5530"),r=a("ade3"),s=(a("14d9"),a("d3b7"),a("1bf2"),a("159b"),a("3a2c")),l=a("c853"),c=a("01c7"),d=a("ff51"),u=a("bc59"),f={components:{G6Dagre:s["default"],DialogAddNode:c["default"]},data:function(){return Object(r["a"])(Object(r["a"])({baseInfo:{},loading:!1,loadingNode:!1,buttonList:[{label:"移除节点",click:this.clickNodeDelete}],chartData:{edges:[],nodes:[]},addmasternode:!1,currentNode:null,currentQueryNode:p(),linksData:[]},"loading",!1),"nodeType_add",0)},computed:{clusterId:function(){return this.$route.query.id},query:function(){return this.$route.query}},created:function(){this.getDetail(),this.baseInfo.name=this.query.name,this.baseInfo.machineroomName=this.query.machineroomName},methods:{getDetail:function(){var e=this;this.loading=!0,this.currentNode=null,Object(l["d"])({clusterId:this.$route.query.id}).then((function(t){if(t){var a=Object(d["a"])(null===t||void 0===t?void 0:t.data)?t.data:[];e.linksData=a;var n=[],i=[];a.forEach((function(e){var t=void 0;"1"===e.isMaster?t="main":"0"===e.isMaster&&(t="cong"),n.push(Object(o["a"])(Object(o["a"])({},e),{},{value:e.ip,comboId:t,label:"".concat(e.ip,":").concat(e.port),style:{fill:"1"===e.status?"#67C23A":"#F56C6C"}}))})),e.chartData.nodes=n,e.chartData.edges=i}})).catch((function(e){})).finally((function(){e.loading=!1}))},clickAddNode:function(){this.nodeType_add=0,this.addmasternode=!0},clickNodeDelete:function(){var e=this;this.$confirm("确定要移除".concat(this.currentNode.ip,":").concat(this.currentNode.port,"吗?"),{type:"warning"}).then((function(t){Object(l["a"])(e.currentNode.id).then((function(t){200===t.code&&(e.refresh(),e.$message.success("移除成功"))})).catch((function(e){}))})).catch((function(e){}))},clickNode:function(e){this.currentNode=e},refresh:function(){this.getDetail()}}};function p(e){var t={pid:"",usedMemory:"",usedCpuSys:"",keys:"",clients:"",expires:"",flags:""};return e&&Reflect.ownKeys(t).forEach((function(a){Object(u["a"])(e,a)&&(t[a]=e[a])})),Object.assign(t,e)}var g=f,m=(a("bd7b"),a("2877")),h=Object(m["a"])(g,n,i,!1,null,"d00c78b6",null);t["default"]=h.exports},"6c41":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{key:"consume"},[t("search-form",{attrs:{searchConfig:e.searchConfig},on:{onSearch:e.onSearch}}),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"page-box"},[e.cardData.length>0?t("div",[t("div",{staticClass:"row-fuzai"},[t("div",{staticClass:"row-fuzai-title",attrs:{id:"node-root"}},[e._v(" "+e._s(e.configName)+" ")])]),t("el-row",{attrs:{gutter:80}},e._l(e.cardData,(function(a,n){return t("el-col",{key:n,attrs:{span:6}},[t("div",{staticClass:"card-box mb-20",attrs:{id:"node-item-".concat(n+1)}},[e.getTextByKeyValue(a.status)?t("div",{staticClass:"card-status-tag"},[t("el-tag",{attrs:{type:e.filtersGetType(a.status),effect:"dark"}},[e._v(e._s(e.getTextByKeyValue(a.status)))])],1):e._e(),t("ul",[t("li",[t("span",{staticClass:"card-li-label"},[e._v("IP")]),t("span",[e._v(" "+e._s(a.ip)+" ")])]),t("li",[t("span",{staticClass:"card-li-label"},[e._v("端口")]),t("span",[e._v(" "+e._s(a.port)+" ")])]),t("li",[t("span",{staticClass:"card-li-label"},[e._v("使用配置")]),t("span",[e._v(" "+e._s(e._f("F_configGrayStatus")(a.configGrayStatus))+" ")])]),t("li",[t("span",{staticClass:"card-li-label"},[e._v("白名单信息")]),t("span",[e._v(" "+e._s(e._f("F_configWhiteManageStatus")(a.configWhiteManageStatus))+" ")])])])])])})),1)],1):t("el-empty")],1)],1)},i=[],o=a("b85c"),r=a("5530"),s=(a("cb29"),a("7db0"),a("d81d"),a("d3b7"),a("feb8")),l=a("2f7b"),c=a("c43b"),d=a("9360"),u=a("934b"),f=a("ff51"),p={name:"CentralizedSdk",filters:{F_configGrayStatus:function(e){switch(String(e)){case"-1":return"主版本";case"0":return"主版本";case"1":return"灰度版本";default:return""}},F_configWhiteManageStatus:function(e){switch(String(e)){case"-1":return"无白名单";case"0":return"无该IP地址";case"1":return"有该IP地址";default:return""}}},components:{},mixins:[],props:{},data:function(){var e=this,t=this;return{searchModel:{btnGroup:[]},configOptions:[],appOptions:[],envOptions:[],unitCodeOptions:[],searchConfig:{searchData:{appName:"",appId:"",configName:"",configId:"",envId:"",envName:"",unitCode:""},searchItem:[{prop:"appId",label:"应用",type:"select",width:"180px",get options(){return t.appOptions},change:function(t){var a,n=e.appOptions.find((function(e){return e.value===t}));e.searchConfig.searchData.appName=null!==(a=null===n||void 0===n?void 0:n.label)&&void 0!==a?a:"",e.searchConfig.searchData.configId="",t&&e.getConfigOptions(!0)}},{prop:"envId",label:"环境",type:"select",width:"180px",get options(){return t.envOptions},change:function(t){var a,n=e.envOptions.find((function(e){return e.value===t}));e.searchConfig.searchData.envName=null!==(a=null===n||void 0===n?void 0:n.label)&&void 0!==a?a:"",e.searchConfig.searchData.configId="",t&&e.getConfigOptions(!0)}},{prop:"unitCode",label:"单元",type:"select",width:"180px",get options(){return t.unitCodeOptions}},{prop:"configId",label:"配置",type:"select",width:"180px",get options(){return t.configOptions},change:function(t){var a,n=e.configOptions.find((function(e){return e.value===t}));e.searchConfig.searchData.configName=null!==(a=null===n||void 0===n?void 0:n.label)&&void 0!==a?a:""}}],rules:{appId:[{required:!0,message:"请选择应用",trigger:"change"}],envId:[{required:!0,message:"请选择环境",trigger:"change"}],configId:[{required:!0,message:"请选择配置",trigger:"change"}]}},cardData:[],jsp:null,loading:!1,timer:null,open:!0,appName:"",envirName:"",configName:""}},computed:{},watch:{},created:function(){},mounted:function(){this.$el&&Object(l["a"])(this.$el,this.handleResize),this.getOptions(),this.getConfigOptions()},beforeDestroy:function(){this.$el&&Object(l["b"])(this.$el,this.handleResize)},destroyed:function(){this.jsp&&(this.jsp.reset(),this.jsp=null),this.timerClear()},methods:{onSearch:function(e){e?(this.jsp&&(this.jsp.destroy(),this.configName="",this.cardData=[],this.jsp=null),this.getConfigOptions()):this.getData()},getConfigOptions:function(e){var t=this,a={appId:"",envId:""},n=this.searchConfig.searchData,i=n.appId,o=n.envId;e&&i&&o&&(a.appId=i,a.envId=o),Object(c["d"])(a).then((function(e){t.configOptions=Object(f["a"])(null===e||void 0===e?void 0:e.data)?e.data:[]})).catch((function(e){}))},getOptions:function(){var e=this;Object(c["f"])().then((function(t){e.envOptions=Object(f["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).catch((function(e){})),Object(c["e"])().then((function(t){e.appOptions=Object(f["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).catch((function(e){})),Object(u["c"])({}).then((function(t){var a=Object(f["a"])(null===t||void 0===t?void 0:t.data)?t.data:[];e.unitCodeOptions=a.map((function(e){return{label:e.unitCode,value:e.unitCode}}))})).catch((function(e){}))},getData:function(){var e=this;this.loading=!0;var t=Object(r["a"])({},this.searchConfig.searchData);this.searchConfig.searchData.configName&&(this.configName=this.searchConfig.searchData.configName),Object(d["a"])(t).then((function(t){Object(f["a"])(null===t||void 0===t?void 0:t.data)&&(e.cardData=t.data,e.$nextTick((function(){e.initJsplumb(t.data.length)})))})).catch((function(e){})).finally((function(){e.loading=!1}))},getTextByKeyValue:function(e){var t=[{label:"异常",value:"false"},{label:"正常",value:"true"}],a=t.find((function(t){return t.value===e}));return a?a.label:""},handleResize:function(){var e;null!==(e=this.jsp)&&void 0!==e&&e.repaintEverything&&this.jsp.repaintEverything()},initJsplumb:function(e){var t=this,a=[];e>0&&(a=new Array(e).fill(0).map((function(e,t){return["node-root","node-item-".concat(t+1)]})));var n=this.jsp?this.jsp:s["jsPlumb"].getInstance();n.reset();var i={anchor:["Bottom","Top"],connector:["Flowchart",{alwaysRespectStubs:!1,stub:20,customEnd:!0,customEndHeight:20}],endpoint:"Blank",paintStyle:{stroke:"#999",strokeWidth:2},overlays:[["Arrow",{width:8,length:8,location:1}]]};n.ready((function(){var e,r=Object(o["a"])(a);try{for(r.s();!(e=r.n()).done;){var s=e.value;n.connect({source:s[0],target:s[1]},i)}}catch(l){r.e(l)}finally{r.f()}t.jsp=n}))},filtersGetType:function(e){return"false"===e?"danger":"true"===e?"success":"info"},timerInit:function(e){var t=this;this.timer&&clearInterval(this.timer),this.open=!0,this.timer=setInterval((function(){t[e]()}),1e4)},timerClear:function(){this.open=!1,this.timer&&(clearInterval(this.timer),this.timer=null)},clickOpen:function(){this.open?this.timerClear():this.timerInit("getData")}}},g=p,m=(a("5d62"),a("2877")),h=Object(m["a"])(g,n,i,!1,null,"73ab6b25",null);t["default"]=h.exports},"881c":function(e,t,a){},"946b":function(e,t,a){},b875:function(e,t,a){"use strict";a("946b")},bd7b:function(e,t,a){"use strict";a("cdc1")},c25a:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"配置权限",visible:e.show,size:"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[t("el-form-item",{attrs:{label:"用户名"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}},[t("el-option",{attrs:{label:"redis",value:"admin"}}),t("el-option",{attrs:{label:"usert",value:"usert"}})],1)],1),t("el-form-item",{attrs:{label:"应用"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.form.appname,callback:function(t){e.$set(e.form,"appname",t)},expression:"form.appname"}},[t("el-option",{attrs:{label:"DemoApp1",value:"DemoApp1"}}),t("el-option",{attrs:{label:"DemoApp2",value:"DemoApp2"}})],1)],1),t("el-form-item",{attrs:{label:"环境"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.form.environment,callback:function(t){e.$set(e.form,"environment",t)},expression:"form.environment"}},e._l(e.depOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"配置"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.form.config,callback:function(t){e.$set(e.form,"config",t)},expression:"form.config"}},[t("el-option",{attrs:{label:"配置1",value:"zookeeper"}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},i=[];a("b64b"),a("d3b7"),a("159b");function o(e){var t={username:"",appname:"",environment:"",config:""};return e&&Object.keys(t).forEach((function(a){t[a]=e[a]})),t}var r={name:"DialogUpdateIcon",components:{},mixins:[],model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:function(){return{}}},refresh:Function},data:function(){return{depOptions:[{label:"dev",value:"1"},{label:"prod",value:"2"}],form:o(),rules:{file:[{required:!0,trigger:"blur",message:"请选择图标文件"}]}}},computed:{},watch:{},created:function(){},mounted:function(){var e;null!==(e=this.rowData)&&void 0!==e&&e.username&&(this.form=o(this.rowData))},methods:{clickCancel:function(){this.$emit("change",!1)},clickConfirm:function(){var e,t=this;Boolean(null===(e=this.rowData)||void 0===e?void 0:e.id)?this.$refs.formRef.validate((function(e){if(e){var a=t.rowData.id;t.formSubmitData.set("id",a)}})):this.$emit("change",!1)}}},s=r,l=a("2877"),c=Object(l["a"])(s,n,i,!1,null,"7c1a501f",null);t["default"]=c.exports},cdc1:function(e,t,a){},d802:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"name-container"},[t("search-form",{attrs:{searchConfig:e.searchConfig},on:{onSearch:e.onSearch}}),t("comp-table",{ref:"compTable",attrs:{isDialog:!1,loading:e.loading,"table-model":e.tableModel,operateSlice:4,"search-model":e.searchModel},on:{submitHandle:e.submitInfo,editHandle:e.editInfo,openAdd:e.openAdd,openEdit:e.openEdit,changePage:e.changePage,clickDelete:e.clickDelete,clickPublish:e.clickPublish,clickOffline:e.clickOffline}}),e.dialogVisible?t("WhiteListAdd",{attrs:{rowData:e.rowData,refresh:e.getList},model:{value:e.dialogVisible,callback:function(t){e.dialogVisible=t},expression:"dialogVisible"}}):e._e()],1)},i=[],o=a("c7eb"),r=a("1da1"),s=(a("caad"),a("d81d"),a("d3b7"),a("4406")),l=a("c43b"),c=a("934b"),d=a("ec41"),u=a("ff51"),f=a("ff32"),p={name:"white-list",components:{WhiteListAdd:s["default"]},data:function(){var e=this,t=(this.$createElement,this);return{rowData:{},dialogVisible:!1,loading:!1,tableModel:{tableData:[],rowData:[{prop:"appName",label:"应用"},{prop:"envName",label:"环境"},{prop:"unitCode",label:"单元"},{prop:"configName",label:"配置"},{prop:"issueStatus",label:"发布状态",render:function(e,t){var a=t.row,n=Object(f["e"])(a.issueStatus,"issueStatusOptions",[],!0);return n?e("hubaryDot",{attrs:{status:n.status,text:n.label}}):e("span")}},{prop:"whiteIp",label:"白名单"}],operateWidth:"220px",operateData:[{label:"编辑",type:"openEdit",funName:"openEdit",btnPermCode:"edit"},{label:"发布",type:"publish",funName:"clickPublish",btnPermCode:"publish"},{label:"删除",type:"delete-row",funName:"clickDelete",btnPermCode:"delete"},{label:"下线",type:"offline",funName:"clickOffline",btnPermCode:"back",isShow:function(e){return!["0","3"].includes(e.issueStatus)}}],pagination:{pageNo:1,pageSize:10,total:0}},searchModel:{btnGroup:[{type:"openAdd",label:"新增",funName:"openAdd",btnPermCode:"add"}]},configOptions:[],appOptions:[],envOptions:[],unitCodeOptions:[],searchConfig:{searchData:{appId:"",configId:"",envId:"",unitCode:""},searchItem:[{prop:"appId",label:"应用",type:"select",get options(){return t.appOptions},change:function(t){t&&e.getConfigOptions(!0)}},{prop:"envId",label:"环境",type:"select",get options(){return t.envOptions},change:function(t){t&&e.getConfigOptions(!0)}},{prop:"unitCode",label:"单元",type:"select",clearable:!0,get options(){return t.unitCodeOptions}},{prop:"configId",label:"配置",type:"select",get options(){return t.configOptions}}],rules:{}}}},created:function(){this.getOptions(),this.getConfigOptions(),this.getList()},mounted:function(){},methods:{onSearch:function(e){e&&this.getConfigOptions(),this.tableModel.pagination.pageNo=1,this.getList()},getList:function(){var e=this,t={pageNo:this.tableModel.pagination.pageNo,pageSize:this.tableModel.pagination.pageSize,requestObject:this.searchConfig.searchData};this.loading=!0,Object(l["g"])(t).then((function(t){var a,n=Object(d["a"])(t,"data.data");e.tableModel.tableData=Object(u["a"])(n)?n:[],e.tableModel.pagination.total=(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.totalCount)||0})).catch((function(e){})).finally((function(){e.loading=!1}))},openAdd:function(){this.dialogVisible=!0,this.rowData=null},openEdit:function(e){this.rowData=e,this.dialogVisible=!0},submitInfo:function(e){},editInfo:function(e){},getConfigOptions:function(e){var t=this,a={appId:"",envId:""},n=this.searchConfig.searchData,i=n.appId,o=n.envId;e&&i&&o&&(a.appId=i,a.envId=o),Object(l["d"])(a).then((function(e){t.configOptions=Object(u["a"])(null===e||void 0===e?void 0:e.data)?e.data:[]})).catch((function(e){}))},getOptions:function(){var e=this;Object(l["f"])().then((function(t){e.envOptions=Object(u["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).catch((function(e){})),Object(l["e"])().then((function(t){e.appOptions=Object(u["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).catch((function(e){})),Object(c["c"])({}).then((function(t){var a=Object(u["a"])(null===t||void 0===t?void 0:t.data)?t.data:[];e.unitCodeOptions=a.map((function(e){return{label:e.unitCode,value:e.unitCode}}))})).catch((function(e){}))},changePage:function(e,t){e&&(this.tableModel.pagination.pageNo=e),t&&(this.tableModel.pagination.pageNo=1,this.tableModel.pagination.pageSize=t),this.getList()},clickPublish:function(e){var t=this;return Object(r["a"])(Object(o["a"])().mark((function a(){var n,i;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$confirm("确认发布吗?",{type:"warning"});case 3:if(n=a.sent,i=null,"confirm"!==n){a.next=12;break}return t.loading=!0,a.next=9,Object(l["j"])(e);case 9:i=a.sent,t.loading=!1,200===i.code&&(t.$message.success("发布成功"),t.getList());case 12:a.next=18;break;case 14:a.prev=14,a.t0=a["catch"](0),t.loading=!1;case 18:case"end":return a.stop()}}),a,null,[[0,14]])})))()},clickOffline:function(e){var t=this;this.$confirm("确认下线吗?",{type:"warning"}).then((function(){Object(l["i"])(e).then((function(e){200===e.code&&(t.$message.success("下线成功"),t.getList())}))}))},clickDelete:function(e){var t=this;this.$confirm("确认删除吗?",{type:"warning"}).then((function(){Object(l["b"])(e).then((function(e){200===e.code&&(t.$message.success("删除成功"),t.getList())}))}))}}},g=p,m=a("2877"),h=Object(m["a"])(g,n,i,!1,null,"74d85a90",null);t["default"]=h.exports},e625:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"name-container"},[t("comp-table",{ref:"compTable",attrs:{"table-model":e.tableModel,"form-model":e.formModel,"search-model":e.searchModel},on:{submitHandle:e.submitInfo,editHandle:e.editInfo,delInfo:e.delInfo,addConfig:e.addConfig,editRow:e.editRow}}),e.dialogVisible?t("CreatePermissions",{attrs:{rowData:e.rowData},model:{value:e.dialogVisible,callback:function(t){e.dialogVisible=t},expression:"dialogVisible"}}):e._e()],1)},i=[],o=a("c25a"),r={filters:{},components:{CreatePermissions:o["default"]},data:function(){return{rowData:{},dialogVisible:!1,tableModel:{tableData:[{username:"redis",appname:"DemoApp1",environment:"dev",config:""},{username:"usert",appname:"DemoApp2",environment:"dev",config:""}],rowData:[{prop:"username",label:"用户名"},{prop:"appname",label:"应用"},{prop:"environment",label:"环境"},{prop:"config",label:"配置"}],operateData:[{label:"编辑",type:"editRow",funName:"editRow"},{label:"删除",type:"delete",url:""}],pagination:{pageNo:1,pageSize:10,total:2,show:!0}},formModel:{formData:{},formLabelWidth:"80px",formFilds:[],btnData:[{type:"submit",style:"primary",label:"确定",handle:function(){}},{type:"cancle",label:"取消",style:"",handle:function(){}}],rules:{}},searchModel:{btnGroup:[{type:"addConfig",style:"primary",funName:"addConfig",label:"新增"}],formModel:{cluster:""},searchFild:[]}}},mounted:function(){},methods:{addConfig:function(){this.dialogVisible=!0,this.rowData=null},editRow:function(e){this.dialogVisible=!0,this.rowData=e},submitInfo:function(e){},editInfo:function(e){},delInfo:function(e){}}},s=r,l=a("2877"),c=Object(l["a"])(s,n,i,!1,null,"e9f49a8c",null);t["default"]=c.exports},ed2a:function(e,t,a){"use strict";a.r(t);a("498a");var n=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"集群协调器",visible:e.show,size:"medium","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"120px",rules:e.rules}},[t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"协调器名称",prop:"coordinatorName"}},[t("el-input",{attrs:{placeholder:"请输入协调器名称"},model:{value:e.formData.coordinatorName,callback:function(t){e.$set(e.formData,"coordinatorName","string"===typeof t?t.trim():t)},expression:"formData.coordinatorName"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"协调器类型",prop:"coordinatorType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择协调器类型"},on:{change:e.validateCoordinatorName},model:{value:e.formData.coordinatorType,callback:function(t){e.$set(e.formData,"coordinatorType",t)},expression:"formData.coordinatorType"}},e._l(e.coordinatorTypeOpitons,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"地区",prop:"cityId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择地区"},on:{change:e.changeCityId},model:{value:e.formData.cityId,callback:function(t){e.$set(e.formData,"cityId",t)},expression:"formData.cityId"}},e._l(e.csMixCity,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"注册中心类型",prop:"registryClusterType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择注册中心类型"},on:{change:e.changeClusterType},model:{value:e.formData.registryClusterType,callback:function(t){e.$set(e.formData,"registryClusterType",t)},expression:"formData.registryClusterType"}},e._l(e.registryClusterOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"注册中心",prop:"registryClusterId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择注册中心"},on:{change:e.validateCoordinatorName},model:{value:e.formData.registryClusterId,callback:function(t){e.$set(e.formData,"registryClusterId",t)},expression:"formData.registryClusterId"}},e._l(e.clusterOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.clusterName,value:e.id}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"数据库类型",prop:"dataBaseType"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请输入数据库类型"},model:{value:e.formData.dataBaseType,callback:function(t){e.$set(e.formData,"dataBaseType",t)},expression:"formData.dataBaseType"}},e._l(e.dict_dataBaseType,(function(e,a){return t("el-option",{key:a,attrs:{value:e.value,label:e.label}})})),1)],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"数据库驱动",prop:"dataBaseDrive"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择"},model:{value:e.formData.dataBaseDrive,callback:function(t){e.$set(e.formData,"dataBaseDrive",t)},expression:"formData.dataBaseDrive"}},e._l(e.dictcommon_dbDriver,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"数据库地址",prop:"databaseAddress"}},[t("el-input",{attrs:{placeholder:"请输入数据库地址"},model:{value:e.formData.databaseAddress,callback:function(t){e.$set(e.formData,"databaseAddress","string"===typeof t?t.trim():t)},expression:"formData.databaseAddress"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"数据库用户名",prop:"databaseUsername"}},[t("el-input",{attrs:{placeholder:"请输入数据库用户名"},model:{value:e.formData.databaseUsername,callback:function(t){e.$set(e.formData,"databaseUsername","string"===typeof t?t.trim():t)},expression:"formData.databaseUsername"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"数据库密码",prop:"dataBasePassword"}},[t("el-input",{attrs:{"show-password":!0,type:"password",placeholder:"请输入数据库密码",autocomplete:"new-password"},model:{value:e.formData.dataBasePassword,callback:function(t){e.$set(e.formData,"dataBasePassword","string"===typeof t?t.trim():t)},expression:"formData.dataBasePassword"}})],1)],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},i=[],o=a("5530"),r=(a("d9e2"),a("b64b"),a("d3b7"),a("159b"),a("ab6c")),s=a("ff32"),l=a("212b"),c=a("80f3"),d=a("1b62"),u=d["a"].CommonSelectCreaterMix,f={components:{},mixins:[u(["csMixCity"])],model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:function(){return{}}},refresh:Function},data:function(){var e=this,t=function(t,a,n){var i=e.formData,o=i.coordinatorName,s=i.coordinatorType,l=i.registryClusterId;if(""!==a)if(a&&s&&l){var c,d={coordinatorName:o,coordinatorType:s,registryClusterId:l,id:(null===(c=e.rowData)||void 0===c?void 0:c.id)||""};Object(r["a"])(d).then((function(e){"该数据已存在"===e.msg?n(new Error(e.msg)):n()})).catch((function(e){n(e)}))}else n();else n(new Error("请输入协调器名称"))};return{loading:!1,coordinatorTypeOpitons:s["c"],dictcommon_dbDriver:c["b"].options,dict_dataBaseType:l["b"].options,clusterOptions:[],registryClusterOptions:s["g"],deployOptions:[],formData:p(),rules:{coordinatorName:[{required:!0,trigger:"blur",message:"请输入协调器名称"},{validator:t,trigger:"blur"},{max:20,message:"不能超过20个字符",trigger:"blur"}],coordinatorType:[{required:!0,trigger:"change",message:"请选择协调器类型"}],cityId:[{required:!0,trigger:"change",message:"请选择地区"}],registryClusterType:[{required:!0,trigger:"change",message:"请选择注册中心类型"}],registryClusterId:[{required:!0,trigger:"change",message:"请选择注册中心"}],databaseAddress:[{required:!0,trigger:"blur",message:"请输入数据库地址"}],databaseUsername:[{required:!0,trigger:"blur",message:"请输入数据库用户名"}],dataBasePassword:[{required:!0,trigger:"blur",message:"请输入数据库密码"}],dataBaseType:[{required:!0,trigger:"change",message:"请选择数据库类型"}],dataBaseDrive:[{required:!0,trigger:"change",message:"请选择数据库驱动"}]}}},computed:{isEdit:function(){var e;return Boolean(null===(e=this.rowData)||void 0===e?void 0:e.id)}},watch:{"formData.registryClusterType":{handler:function(e){var t=!0;"2"===e&&(t=!1),this.$set(this.rules.registryClusterId[0],"required",t),this.$set(this.rules.dataBaseType[0],"required",t),this.$set(this.rules.dataBaseDrive[0],"required",t),this.$set(this.rules.databaseAddress[0],"required",t),this.$set(this.rules.databaseUsername[0],"required",t),this.$set(this.rules.dataBasePassword[0],"required",t)},immediate:!0}},created:function(){},mounted:function(){var e;null!==(e=this.rowData)&&void 0!==e&&e.id&&(this.formData=p(this.rowData),this.getClusterOptions())},methods:{validateCoordinatorName:function(){this.$refs.formRef.validateField("coordinatorName")},changeCityId:function(e){this.formData.registryClusterId="",this.getClusterOptions()},changeClusterType:function(e){this.formData.registryClusterId="",this.getClusterOptions()},getClusterOptions:function(){var e=this,t=this.formData,a=t.cityId,n=t.registryClusterType;[a,n].every((function(e){return Boolean(e)}))&&Object(r["e"])({clusterType:n,cityId:a}).then((function(t){e.clusterOptions=t.data}))},clickCancel:function(){this.$emit("change",!1)},clickConfirm:function(){var e=this,t=Object(o["a"])({},this.formData);this.$refs.formRef.validate((function(a){a&&(e.loading=!0,e.isEdit?Object(r["g"])(t).then((function(t){200===t.code&&(e.$message.success("修改成功"),e.$emit("change",!1),e.refresh())})).catch((function(e){})).finally((function(){e.loading=!1})):(delete t.id,Object(r["b"])(t).then((function(t){200===t.code&&(e.$message.success("新增成功"),e.$emit("change",!1),e.refresh())})).catch((function(e){})).finally((function(){e.loading=!1}))))}))}}};function p(e){var t={coordinatorName:"",coordinatorType:"",dataBasePassword:"",databaseAddress:"",databaseUsername:"",dataBaseDrive:"",dataBaseType:"",id:"",registryClusterId:"",registryClusterType:"",cityId:""};return e&&Object.keys(t).forEach((function(a){t[a]=e[a]})),t}var g=f,m=a("2877"),h=Object(m["a"])(g,n,i,!1,null,"3e720c67",null);t["default"]=h.exports},ef4a:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"name-container"},[t("search-form",{attrs:{searchConfig:e.searchConfig},on:{onSearch:e.onSearch}}),t("button-list",{attrs:{data:e.buttonList}}),t("tableView",{attrs:{loading:e.tableConfig.loading,operateObj:e.tableConfig.operate,columns:e.tableConfig.columns,tableData:e.tableConfig.tableData,isPage:e.tableConfig.isPage,total:e.tableConfig.pagination.totalCount,rowKey:"id",operateSlice:2,currentPage:e.tableConfig.pagination.pageNo,pageSize:e.tableConfig.pagination.pageSize},on:{"update:currentPage":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:current-page":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},changePage:e.changePage,operate:e.getIndex}}),e.dialogVisible?t("ClusterCoordinatorAdd",{attrs:{rowData:e.rowData,refresh:e.getList},model:{value:e.dialogVisible,callback:function(t){e.dialogVisible=t},expression:"dialogVisible"}}):e._e()],1)},i=[],o=a("5530"),r=a("c7eb"),s=a("1da1"),l=(a("d3b7"),a("159b"),a("ab6c")),c=a("ec41"),d=a("ff51"),u=a("ed2a"),f=a("212b"),p=a("ff32"),g={filters:{},components:{ClusterCoordinatorAdd:u["default"]},data:function(){var e=this,t=(this.$createElement,this);return{coordinatorTypeOpitons:p["c"],registryClusterOptions:p["g"],dialogVisible:!1,rowData:null,loading:!1,buttonList:[{label:"新增",type:"add",click:this.clickOpen,btnPermCode:"add"}],searchConfig:{searchData:{coordinatorName:"",registryClusterType:""},searchItem:[{prop:"coordinatorName",label:"名称",labelWidth:"50px",type:"input"},{prop:"registryClusterType",label:"注册中心类型",type:"select",get options(){return t.registryClusterOptions}}],rules:{}},tableConfig:{loading:!1,pagination:{pageNo:1,pageSize:10,total:0},tableData:[],columns:[{prop:"coordinatorName",label:"协调器名称"},{prop:"coordinatorType",label:"协调器类型",render:function(e,t){var a=t.row,n=Object(p["e"])(a.coordinatorType,p["c"]);return e("span",[n])}},{prop:"cityName",label:"地区",width:80},{prop:"registryClusterType",label:"注册中心类型",render:function(e,t){var a=t.row,n=Object(p["e"])(a.registryClusterType,p["g"]);return e("span",[n])}},{prop:"registryClusterName",label:"注册中心"},{prop:"dataBaseType",label:"数据库类型",width:90,format:function(e){return f["b"].get(e)}},{prop:"databaseAddress",label:"数据库地址"},{prop:"ceshi",label:"测试连接",align:"left",width:100,render:function(t,a){var n=a.row;return t("span",[t("el-button",{attrs:{loading:n.loadingTest,type:"text"},on:{click:function(){return e.clickConnectTest(n)}}},[n.loadingTest?"测试中":"测试"]),n.testStatus?t("span",{style:"color:green",class:"ml-10"},[t("i",{class:"el-icon-check"})]):""])}}],operate:{width:100,list:[{label:"编辑",id:"edit",btnPermCode:"edit"},{label:"删除",id:"delete",btnPermCode:"delete"}]}}}},created:function(){},mounted:function(){this.getList()},methods:{clickOpen:function(){this.dialogVisible=!0,this.rowData=null},onSearch:function(e){this.tableConfig.pagination.pageNo=1,this.getList()},getIndex:function(e){var t=this;return Object(s["a"])(Object(r["a"])().mark((function a(){var n,i,o,s,c;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.index,n=e.row,i=e.operate,o=void 0,t.rowData=n,s=null,a.t0=i.id,a.next="edit"===a.t0?8:"delete"===a.t0?10:25;break;case 8:return t.dialogVisible=!0,a.abrupt("break",26);case 10:return a.prev=10,a.next=13,t.$confirm("确定要删除【".concat(n.coordinatorName,"】吗?"),{type:"warning"});case 13:if(o=a.sent,"confirm"!==o){a.next=19;break}return a.next=17,Object(l["c"])(n.id);case 17:s=a.sent,200===(null===(c=s)||void 0===c?void 0:c.code)&&(t.$message.success("删除成功"),t.getList());case 19:a.next=24;break;case 21:a.prev=21,a.t1=a["catch"](10);case 24:return a.abrupt("break",26);case 25:case 26:case"end":return a.stop()}}),a,null,[[10,21]])})))()},getList:function(){var e=this,t={pageNo:this.tableConfig.pagination.pageNo,pageSize:this.tableConfig.pagination.pageSize,requestObject:this.searchConfig.searchData};this.tableConfig.loading=!0,Object(l["d"])(t).then((function(t){var a=Object(c["a"])(t,"data.data"),n=Object(d["a"])(a)?a:[];a.forEach((function(e){e.loadingTest=!1,e.testStatus=""})),e.tableConfig.tableData=n,e.tableConfig.pagination.totalCount=Object(c["a"])(t,"data.totalCount")})).finally((function(){e.tableConfig.loading=!1}))},clickConnectTest:function(e){var t=this;return Object(s["a"])(Object(r["a"])().mark((function a(){return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$set(e,"testStatus",""),t.$set(e,"loadingTest",!0),Object(l["f"])(Object(o["a"])({},e)).then((function(a){200===a.code?(t.$message.success("连接测试成功"),t.$set(e,"testStatus","成功")):(t.$set(e,"loadingTest",!1),t.$set(e,"testStatus",""),t.$message.error(a.msg))})).catch((function(a){t.$set(e,"testStatus",""),t.$set(e,"loadingTest",!1)})).finally((function(){t.$set(e,"loadingTest",!1)}));case 3:case"end":return a.stop()}}),a)})))()},changePage:function(e,t){e&&(this.tableConfig.pagination.pageNo=e),t&&(this.tableConfig.pagination.pageNo=1,this.tableConfig.pagination.pageSize=t),this.getList()}}},m=g,h=a("2877"),b=Object(h["a"])(m,n,i,!1,null,"08e125ec",null);t["default"]=b.exports}}]);