(window["jsonpPaas4"]=window["jsonpPaas4"]||[]).push([["app~6faafe9b"],{"2f70":function(e,t,a){"use strict";a("d693")},"3dc9":function(e,t,a){"use strict";a.r(t);a("caad");var o=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"配置-".concat(e.rowData.limitFrame),visible:e.show,size:"small",loading:e.loading,"append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",staticClass:"cluster-form",attrs:{"label-position":e.labelPosition,"label-width":"SENTINEL"===e.rowData.limitFrame?"140px":"170px",model:e.formData,rules:e.rules}},["SENTINEL"===e.rowData.limitFrame?t("div",[t("el-form-item",{attrs:{label:"限流方式",prop:"senGrade"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择"},model:{value:e.formData.senGrade,callback:function(t){e.$set(e.formData,"senGrade",t)},expression:"formData.senGrade"}},e._l(e.dict_limitWay,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{prop:"senCount"}},[t("template",{slot:"label"},[t("span",[e._v("限流阈值")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" "+e._s(e.formData.senGrade?"集群允许最高QPS数":"集群允许最大并发线程数")+" ")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.formData.senCount,callback:function(t){e.$set(e.formData,"senCount",e._n(t))},expression:"formData.senCount"}})],2),1==e.formData.senGrade?[t("el-form-item",{attrs:{label:"QPS限流策略",prop:"senControlBehavior"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择QPS限流策略"},model:{value:e.formData.senControlBehavior,callback:function(t){e.$set(e.formData,"senControlBehavior",t)},expression:"formData.senControlBehavior"}},e._l(e.dict_QPSlimitStrategy,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),[2,4].includes(e.formData.senControlBehavior)?t("el-form-item",{attrs:{label:"预热时长(s)",prop:"senWarmUpPeriodSec"}},[t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.formData.senWarmUpPeriodSec,callback:function(t){e.$set(e.formData,"senWarmUpPeriodSec",e._n(t))},expression:"formData.senWarmUpPeriodSec"}})],1):e._e(),[3,4].includes(e.formData.senControlBehavior)?t("el-form-item",{attrs:{label:"队列超时时间(ms)",prop:"senMaxQueueingTimes"}},[t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.formData.senMaxQueueingTimes,callback:function(t){e.$set(e.formData,"senMaxQueueingTimes",e._n(t))},expression:"formData.senMaxQueueingTimes"}})],1):e._e()]:e._e()],2):e._e(),"RESILIENCE4J"===e.rowData.limitFrame?t("div",[t("el-form-item",{attrs:{label:"策略",prop:"protocol"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择策略"},model:{value:e.formData.resStrategy,callback:function(t){e.$set(e.formData,"resStrategy",t)},expression:"formData.resStrategy"}},e._l(e.dict_resilience4jStrategy,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),[1,"1"].includes(e.formData.resStrategy)?[t("el-form-item",{attrs:{label:"频次阈值",prop:"resLimitPeriod"}},[t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.formData.resLimitPeriod,callback:function(t){e.$set(e.formData,"resLimitPeriod",e._n(t))},expression:"formData.resLimitPeriod"}})],1),t("el-form-item",{attrs:{label:"阈值刷新时间(ms)",prop:"resLimitRefreshPeriod"}},[t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.formData.resLimitRefreshPeriod,callback:function(t){e.$set(e.formData,"resLimitRefreshPeriod",e._n(t))},expression:"formData.resLimitRefreshPeriod"}})],1),t("el-form-item",{attrs:{label:"限流后的冷却时间(ms)",prop:"resTimeoutDuration"}},[t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.formData.resTimeoutDuration,callback:function(t){e.$set(e.formData,"resTimeoutDuration",e._n(t))},expression:"formData.resTimeoutDuration"}})],1)]:e._e(),[2,"2"].includes(e.formData.resStrategy)?[t("el-form-item",{attrs:{label:"最大并发数",prop:"resMaxConcurrentCalls"}},[t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.formData.resMaxConcurrentCalls,callback:function(t){e.$set(e.formData,"resMaxConcurrentCalls",e._n(t))},expression:"formData.resMaxConcurrentCalls"}})],1),t("el-form-item",{attrs:{prop:"resMaxWaitDuration"}},[t("template",{slot:"label"},[t("span",[e._v("饱和等待时间(ms)")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("等待线程释放时间")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.formData.resMaxWaitDuration,callback:function(t){e.$set(e.formData,"resMaxWaitDuration",e._n(t))},expression:"formData.resMaxWaitDuration"}})],2)]:e._e(),[3,"3"].includes(e.formData.resStrategy)?[t("el-form-item",{attrs:{label:"最大线程数",prop:"resMaxThreadPoolSize"}},[t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.formData.resMaxThreadPoolSize,callback:function(t){e.$set(e.formData,"resMaxThreadPoolSize",e._n(t))},expression:"formData.resMaxThreadPoolSize"}})],1),t("el-form-item",{attrs:{prop:"resKeepAliveTime"}},[t("template",{slot:"label"},[t("span",[e._v("等待时间(ms)")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("等待线程释放时间")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.formData.resKeepAliveTime,callback:function(t){e.$set(e.formData,"resKeepAliveTime",e._n(t))},expression:"formData.resKeepAliveTime"}})],2)]:e._e()],2):e._e(),t("el-form-item",{attrs:{prop:"fallbackStrategy",label:"降级策略"}},[t("el-radio-group",{model:{value:e.formData.fallbackStrategy,callback:function(t){e.$set(e.formData,"fallbackStrategy",t)},expression:"formData.fallbackStrategy"}},e._l(e.dict_fallback_strategy,(function(a){return t("el-radio",{key:a.value,attrs:{label:a.value}},[e._v(e._s(a.label))])})),1)],1),t("el-form-item",{attrs:{prop:"fallbackMethod"}},[t("template",{slot:"label"},[t("span",[e._v("降级方法")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 降级方法的全类名。如：com.example.service.FallbackService.fallBack ")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{attrs:{type:"textarea"},model:{value:e.formData.fallbackMethod,callback:function(t){e.$set(e.formData,"fallbackMethod",t)},expression:"formData.fallbackMethod"}})],2)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},r=[],n=a("c7eb"),i=a("5530"),s=a("1da1"),l=(a("b64b"),a("d3b7"),a("159b"),a("ec41")),c=a("bc59"),m=a("d1cd"),u=a("555f"),f=a("5307"),p={name:"StateConfig",components:{},model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:null},refresh:Function},data:function(){return{dict_fallback_strategy:f["a"].options,loading:!1,dict_limitWay:m["e"],dict_QPSlimitStrategy:m["a"],dict_resilience4jStrategy:m["f"],clusterList:[],labelPosition:"right",formData:d(),rules:{senGrade:[{required:!0,message:"请选择限流方式",trigger:"change"}],senCount:[{required:!0,message:"请输入限流阈值",trigger:"blur"}],fallbackMethod:[{required:!0,message:"请输入降级方法",trigger:"blur"}],senControlBehavior:[{required:!0,message:"请选择限流策略",trigger:"change"}],senMaxQueueingTimes:[{required:!0,message:"请输入队列超时时间",trigger:"blur"}],resStrategy:[{required:!0,message:"请选择策略",trigger:"change"}],resMaxConcurrentCalls:[{required:!0,message:"请输入最大并发数",trigger:"blur"}],resMaxWaitDuration:[{required:!0,message:"请输入饱和等待时间",trigger:"blur"}],resLimitPeriod:[{required:!0,message:"请输入频次阈值",trigger:"blur"}],resLimitRefreshPeriod:[{required:!0,message:"请输入阀值刷新时间",trigger:"blur"}],resTimeoutDuration:[{required:!0,message:"请输入限流后的冷却时间",trigger:"blur"}],fallbackStrategy:[{required:!0,message:"降级策略",trigger:"blur"}]},detailData:null}},computed:{isEdit:function(){var e;return Boolean(null===(e=this.rowData)||void 0===e?void 0:e.id)}},watch:{},created:function(){},mounted:function(){this.getDetail()},methods:{getDetail:function(){var e,t=this;null!==(e=this.rowData)&&void 0!==e&&e.id&&(this.loading=!0,Object(u["a"])(this.rowData.id).then((function(e){Object(l["a"])(e,"data.id")?(t.detailData=e.data,t.formData=d(e.data,t.rowData.limitFrame)):t.formData=d(null,t.rowData.limitFrame)})).catch((function(e){})).finally((function(){t.loading=!1})))},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate(function(){var t=Object(s["a"])(Object(n["a"])().mark((function t(a){var o,r,s;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=8;break}if(r=Object(i["a"])(Object(i["a"])({},e.formData),{},{targetId:e.rowData.id,resCoreThreadPoolSize:1,resQueueCapacity:1}),e.loading=!0,null===(o=e.detailData)||void 0===o||!o.id){t.next=7;break}return r.id=null===(s=e.detailData)||void 0===s?void 0:s.id,Object(u["c"])(r).then((function(t){e.$message({type:"success",message:"配置更新成功"}),e.$emit("change",!1),e.refresh()})).catch((function(e){})).finally((function(){e.loading=!1})),t.abrupt("return");case 7:Object(u["b"])(r).then((function(t){200===t.code&&(e.$message({type:"success",message:"配置添加成功"}),e.$emit("change",!1),e.refresh())})).catch((function(e){})).finally((function(){e.loading=!1}));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}};function d(e,t){var a={fallbackStrategy:"1",fallbackMethod:""};switch(t){case"SENTINEL":a.senGrade=0,a.senCount="",a.senControlBehavior="",a.senWarmUpPeriodSec="",a.senMaxQueueingTimes="";break;case"RESILIENCE4J":a.resStrategy="",a.resMaxConcurrentCalls="",a.resMaxWaitDuration="",a.resLimitPeriod="",a.resLimitRefreshPeriod="",a.resTimeoutDuration="",a.resMaxThreadPoolSize="",a.resKeepAliveTime="";break}return e&&Object.keys(a).forEach((function(t){Object(c["a"])(e,t)&&(a[t]=e[t])})),a}var g=p,b=(a("530d"),a("2877")),h=Object(b["a"])(g,o,r,!1,null,"01e4ee44",null);t["default"]=h.exports},"44a4":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"配置熔断",visible:e.show,size:"SENTINEL"==e.rowData.limitFrame?"small":"medium",loading:e.loading,"append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",staticClass:"cluster-form",attrs:{"label-position":e.labelPosition,"label-width":"SENTINEL"==e.rowData.limitFrame?"140px":"250px",model:e.form,rules:e.rules}},["SENTINEL"==e.rowData.limitFrame?t("div",[t("el-form-item",{attrs:{label:"熔断策略",prop:"senGrade"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("span",[e._v("熔断策略")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.toolTips.senGrade))]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择熔断策略"},model:{value:e.form.senGrade,callback:function(t){e.$set(e.form,"senGrade",t)},expression:"form.senGrade"}},e._l(e.fusingStrategyOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),0===e.form.senGrade?[t("el-form-item",{attrs:{prop:"senSlowRatioThreshold"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("span",[e._v("慢调用比例阈值")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.toolTips.senSlowRatioThreshold))]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input-number",{attrs:{precision:2,step:.01,min:0,max:1},model:{value:e.form.senSlowRatioThreshold,callback:function(t){e.$set(e.form,"senSlowRatioThreshold",t)},expression:"form.senSlowRatioThreshold"}})],1),t("el-form-item",{attrs:{label:"临界值(RT)",prop:"senCount"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("span",[e._v("临界值(RT)")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.toolTips.senCount))]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.form.senCount,callback:function(t){e.$set(e.form,"senCount",e._n(t))},expression:"form.senCount"}})],1)]:1===e.form.senGrade?[t("el-form-item",{attrs:{prop:"senCount",label:"异常比例阈值"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("span",[e._v("异常比例阈值")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.toolTips.senCount))]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input-number",{attrs:{precision:2,step:.01,min:0,max:1},model:{value:e.form.senCount,callback:function(t){e.$set(e.form,"senCount",t)},expression:"form.senCount"}})],1)]:2===e.form.senGrade?[t("el-form-item",{attrs:{label:"熔断阈值",prop:"senCount"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("span",[e._v("熔断阈值")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.toolTips.senCount))]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.form.senCount,callback:function(t){e.$set(e.form,"senCount",e._n(t))},expression:"form.senCount"}})],1)]:e._e(),t("el-form-item",{attrs:{label:"熔断恢复时间(S)",prop:"senTimeWindow"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("span",[e._v("熔断恢复时间(S)")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.toolTips.senTimeWindow))]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.form.senTimeWindow,callback:function(t){e.$set(e.form,"senTimeWindow",e._n(t))},expression:"form.senTimeWindow"}})],1),t("el-form-item",{attrs:{label:"最小请求数",prop:"senMinRequestAmount"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("span",[e._v("最小请求数")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(e.toolTips.senMinRequestAmount))]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.form.senMinRequestAmount,callback:function(t){e.$set(e.form,"senMinRequestAmount",e._n(t))},expression:"form.senMinRequestAmount"}})],1),t("el-form-item",{attrs:{label:"统计时长(ms)",prop:"senStatIntervalMs"}},[t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.form.senStatIntervalMs,callback:function(t){e.$set(e.form,"senStatIntervalMs",e._n(t))},expression:"form.senStatIntervalMs"}})],1)],2):e._e(),"RESILIENCE4J"==e.rowData.limitFrame?t("div",[t("el-form-item",{attrs:{prop:"resFailureRate"}},[t("template",{slot:"label"},[t("span",[e._v("故障率阈值")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 默认值:50。熔断器关闭状态和半开状态使⽤的是同⼀个故障率阈值 ")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.form.resFailureRate,callback:function(t){e.$set(e.form,"resFailureRate",t)},expression:"form.resFailureRate"}})],2),t("el-form-item",{attrs:{prop:"resAutomaticOpenHalfOpen"}},[t("template",{slot:"label"},[t("span",[e._v("是否从自动状态到半自动状态")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 如果置为是，当等待时间结束会⾃动由打开变为半开，若置为否，则需要⼀个请求进⼊来触发熔断器状态转换。 ")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-radio",{attrs:{label:!0},model:{value:e.form.resAutomaticOpenHalfOpen,callback:function(t){e.$set(e.form,"resAutomaticOpenHalfOpen",t)},expression:"form.resAutomaticOpenHalfOpen"}},[e._v("是")]),t("el-radio",{attrs:{label:!1},model:{value:e.form.resAutomaticOpenHalfOpen,callback:function(t){e.$set(e.form,"resAutomaticOpenHalfOpen",t)},expression:"form.resAutomaticOpenHalfOpen"}},[e._v("否")])],2),t("el-form-item",{attrs:{label:"关闭时缓冲区大小",prop:"resBufferSizeClosedState"}},[t("template",{slot:"label"},[t("span",[e._v("关闭时缓冲区大小")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 并发请求总数。熔断器关闭状态的缓冲区⼤⼩，不会限制线程的并发量，在熔断器发⽣状态转换前所有请求都会调⽤后端服务 ")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.form.resBufferSizeClosedState,callback:function(t){e.$set(e.form,"resBufferSizeClosedState",e._n(t))},expression:"form.resBufferSizeClosedState"}})],2),t("el-form-item",{attrs:{label:"半开时缓冲区大小",prop:"resBufferSizeOpenState"}},[t("template",{slot:"label"},[t("span",[e._v("半开时缓冲区大小")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 并发请求总数。熔断器半开状态的缓冲区⼤⼩，会限制线程的并发量，例如缓冲区为10，则每次只会允许10个请求调⽤后端服务 ")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.form.resBufferSizeOpenState,callback:function(t){e.$set(e.form,"resBufferSizeOpenState",e._n(t))},expression:"form.resBufferSizeOpenState"}})],2),t("el-form-item",{attrs:{prop:"resWaitDurationOpenState"}},[t("template",{slot:"label"},[t("span",[e._v("从打开到半打开之前等待时间(ms)")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("熔断器从打开状态转变为半开状态等待的时间")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{attrs:{type:"number",min:"0"},model:{value:e.form.resWaitDurationOpenState,callback:function(t){e.$set(e.form,"resWaitDurationOpenState",e._n(t))},expression:"form.resWaitDurationOpenState"}})],2),t("el-form-item",{attrs:{label:"失败异常列表",prop:"resRecordExceptions"}},[t("template",{slot:"label"},[t("span",[e._v("失败异常列表")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("需要记录为失败的异常列表")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{attrs:{type:"textarea"},model:{value:e.form.resRecordExceptions,callback:function(t){e.$set(e.form,"resRecordExceptions",t)},expression:"form.resRecordExceptions"}})],2),t("el-form-item",{attrs:{label:"忽略异常列表",prop:"resIgnoreExceptions"}},[t("template",{slot:"label"},[t("span",[e._v("忽略异常列表")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("需要忽略的异常列表")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{attrs:{type:"textarea"},model:{value:e.form.resIgnoreExceptions,callback:function(t){e.$set(e.form,"resIgnoreExceptions",t)},expression:"form.resIgnoreExceptions"}})],2)],1):e._e(),t("el-form-item",{attrs:{prop:"fallbackStrategy",label:"降级策略"}},[t("el-radio-group",{model:{value:e.form.fallbackStrategy,callback:function(t){e.$set(e.form,"fallbackStrategy",t)},expression:"form.fallbackStrategy"}},e._l(e.dict_fallback_strategy,(function(a){return t("el-radio",{key:a.value,attrs:{label:a.value}},[e._v(e._s(a.label))])})),1)],1),t("el-form-item",{attrs:{prop:"fallbackMethod"}},[t("template",{slot:"label"},[t("span",[e._v("降级方法")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 降级方法的全类名。如：com.example.service.FallbackService.fallBack ")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{model:{value:e.form.fallbackMethod,callback:function(t){e.$set(e.form,"fallbackMethod",t)},expression:"form.fallbackMethod"}})],2)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},r=[],n=a("c7eb"),i=a("5530"),s=a("1da1"),l=(a("dca8"),a("b64b"),a("d3b7"),a("159b"),a("77d3")),c=a("d1cd"),m=a("bc59"),u=a("5307"),f={name:"FrameConfig",components:{},model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:null},refresh:Function},data:function(){var e=Object.freeze({senGrade:" 熔断策略，支持慢调用比例/异常比例/异常数策略 ",senCount:"慢调用比例模式下为慢调用临界 RT（超出该值计为慢调用）；异常比例/异常数模式下为对应的阈值 ",senTimeWindow:"熔断时长，单位为 s ",senMinRequestAmount:"熔断触发的最小请求数，请求数小于该值时即使异常比率超出阈值也不会熔断 ",senStatIntervalMs:"统计时长（单位为 ms），如 60*1000 代表分钟级",senSlowRatioThreshold:"慢调用比例阈值，仅慢调用比例模式有效"});return{toolTips:e,loading:!1,fusingStrategyOptions:c["h"],dict_fallback_strategy:u["a"].options,clusterList:[],labelPosition:"right",form:p(),rules:{senGrade:[{required:!0,message:"请选择熔断策略",trigger:"change"}],senCount:[{required:!0,message:"请输入值",trigger:"blur"}],senTimeWindow:[{required:!0,message:"请输入熔断恢复时间",trigger:"blur"}],resFailureRate:[{required:!0,message:"请输入故障率阈值",trigger:"blur"}],resAutomaticOpenHalfOpen:[{required:!0,message:"请选择是否从自动状态到半自动状态",trigger:"change"}],resBufferSizeClosedState:[{required:!0,message:"请输入关闭时缓冲区大小",trigger:"blur"}],resBufferSizeOpenState:[{required:!0,message:"请输入半开时缓冲区大小",trigger:"blur"}],resWaitDurationOpenState:[{required:!0,message:"请输入从打开到半打开之前等待时间",trigger:"blur"}],resRecordExceptions:[{required:!0,message:"请输入失败异常",trigger:"blur"}],resIgnoreExceptions:[{required:!0,message:"请输入忽略异常",trigger:"blur"}],senMinRequestAmount:[{required:!0,message:"请输入最小请求数",trigger:"blur"}],senStatIntervalMs:[{required:!0,message:"请输入统计时长",trigger:"blur"}],senSlowRatioThreshold:[{required:!0,message:"请输入慢调用比例阈值",trigger:"blur"}],fallbackStrategy:[{required:!0,message:"降级策略",trigger:"blur"}]}}},computed:{isEdit:function(){var e;return Boolean(null===(e=this.rowData)||void 0===e?void 0:e.id)},senCountLabel:function(){return this.form.senGrade?"熔断阈值":"临界值(RT)"}},watch:{},created:function(){},mounted:function(){this.getConfigDetail()},methods:{getConfigDetail:function(){var e=this;Object(l["a"])(this.rowData.id).then((function(t){e.form=p(t.data)}))},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate(function(){var t=Object(s["a"])(Object(n["a"])().mark((function t(a){var o;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a&&(o=Object(i["a"])(Object(i["a"])({},e.form),{},{targetId:e.rowData.id}),e.loading=!0,Object(l["b"])(o).then((function(t){200===t.code&&(e.$message({type:"success",message:t.msg}),e.$emit("change",!1))})).catch((function(e){})).finally((function(){e.loading=!1})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}};function p(e){var t={senGrade:0,fallbackStrategy:"1",senCount:"",senTimeWindow:"",fallbackMethod:"",resFailureRate:"",resAutomaticOpenHalfOpen:!1,resBufferSizeClosedState:"",resBufferSizeOpenState:"",resWaitDurationOpenState:"",resRecordExceptions:"",resIgnoreExceptions:"",senMinRequestAmount:"",senStatIntervalMs:1e3,senSlowRatioThreshold:""};return e&&Object.keys(t).forEach((function(a){Object(m["a"])(e,a)&&(t[a]=e[a])})),t}var d=f,g=(a("cd97"),a("2877")),b=Object(g["a"])(d,o,r,!1,null,"41a231f3",null);t["default"]=b.exports},"530d":function(e,t,a){"use strict";a("78c5")},"56f2":function(e,t,a){},7848:function(e,t,a){},"78c5":function(e,t,a){},a584:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"flow-minitoring-page"},[t("el-row",{staticStyle:{"margin-bottom":"10px"},attrs:{gutter:20}},[t("el-col",{attrs:{span:5}},[t("el-input",{attrs:{disabled:""},model:{value:e.rowData.resourceName,callback:function(t){e.$set(e.rowData,"resourceName",t)},expression:"rowData.resourceName"}})],1),t("el-col",{attrs:{span:5}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择"},on:{change:e.getServiceDetail},model:{value:e.serviceName,callback:function(t){e.serviceName=t},expression:"serviceName"}},e._l(e.serviceOptions,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),t("el-col",{attrs:{span:5}},[t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")])],1)],1),t("el-card",[t("div",{staticClass:"header-section"},[t("span",[e._v("实时监控")]),t("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.getServiceDetail(e.serviceName)}}},[e._v("刷新")])],1),t("el-card",{staticClass:"content-section"},[t("div",{attrs:{slot:"header"},slot:"header"},[t("span",[e._v(e._s(e.chartResName))])]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("LineCharts",{directives:[{name:"loading",rawName:"v-loading",value:e.chartsLoading,expression:"chartsLoading"}],attrs:{height:"350px",lineData:e.dataPut}})],1),t("el-col",{attrs:{span:12}},[t("tableView",{ref:"tableView",staticClass:"tableView",attrs:{loading:e.tableConfig.loading,columns:e.tableConfig.columns,tableData:e.tableConfig.tableData,rowKey:"id",height:"320px",isPage:e.tableConfig.isPage}})],1)],1)],1)],1)],1)},r=[],n=(a("d81d"),a("fb6a"),a("4e82"),a("d3b7"),a("2a0d")),i=a("9e25"),s=a("ec41"),l=a("ff51"),c=a("5c8a"),m=a("f926"),u={components:{LineCharts:n["default"]},data:function(){this.$createElement;return{chartResName:"",serviceResult:{},serviceName:"",serviceOptions:[],chartsLoading:!1,dataPut:{name:"",legend:{data:["通过QPS","拒绝QPS"],left:"center",top:5},xAxisData:[],data:[],color:["rgba(18,61,172,0.5)"]},tableConfig:{loading:!1,isPage:!1,pagination:{pageNo:1,pageSize:10,total:0},tableData:[],columns:[{prop:"date",label:"时间",align:"center",render:function(e,t){var a=t.row;return e("span",[a.passedQPS&&a.blockedQPS?Object(m["a"])(a.date,"HH:mm:ss"):"-"])}},{prop:"passedQPS",label:"通过QPS",align:"center",render:function(e,t){var a=t.row;return e("span",[a.passedQPS&&a.blockedQPS?a.passedQPS:"-"])}},{prop:"blockedQPS",label:"拒绝QPS",align:"center",render:function(e,t){var a=t.row;return e("span",[a.passedQPS&&a.blockedQPS?a.blockedQPS:"-"])}},{prop:"rt",label:"响应时间",align:"center",render:function(e,t){var a=t.row;return e("span",[a.passedQPS&&a.blockedQPS?a.rt:"-"])}}],operate:{width:220,list:[]}}}},computed:{rowData:function(){return this.$route.query}},mounted:function(){this.getServiceOptions()},methods:{getServiceOptions:function(){var e=this;Object(i["c"])({id:this.rowData.id,appCode:this.rowData.appCode,resourceName:this.rowData.resourceName}).then((function(t){e.serviceResult=Object(s["a"])(t,"data");var a=[];for(var o in e.serviceResult)a.unshift(o);e.serviceOptions=a,e.serviceName=e.serviceOptions[0],e.getServiceDetail(e.serviceName)}))},getServiceDetail:function(e){var t=this;this.tableConfig.loading=!0,this.chartsLoading=!0;var a=this.serviceResult[e];Object(i["a"])(a).then((function(e){var a;t.$message.success(e.msg);var o=Object(s["a"])(e,"data"),r=Object(l["a"])(o)?Object(c["a"])(o):[],n=r.slice().sort((function(e,t){return new Date(t.date)-new Date(e.date)}));t.dataPut.xAxisData=r.map((function(e){return Object(m["a"])(e.date,"HH:mm:ss")}));var i=r.map((function(e){return e.passedQPS})),u=r.map((function(e){return e.blockedQPS})),f=[{name:"通过QPS",value:i},{name:"拒绝QPS",value:u}];t.dataPut.data=f,t.chartResName=(null===(a=r[0])||void 0===a?void 0:a.resourceName)||"",t.tableConfig.tableData=n.slice(0,6)})).finally((function(){t.tableConfig.loading=!1,t.chartsLoading=!1}))}}},f=u,p=(a("dbd7"),a("2877")),d=Object(p["a"])(f,o,r,!1,null,"a0a7f15e",null);t["default"]=d.exports},c095:function(e,t,a){},cd97:function(e,t,a){"use strict";a("56f2")},d35d:function(e,t,a){"use strict";a("7848")},d5c6:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e._self._c;return t("div",[t("search-form",{attrs:{searchConfig:e.searchConfig},on:{onSearch:e.onSearch}}),t("button-list",{attrs:{data:e.buttonList}}),t("tableView",{ref:"tableView",attrs:{loading:e.tableConfig.loading,operateObj:e.tableConfig.operate,columns:e.tableConfig.columns,tableData:e.tableConfig.tableData,total:e.tableConfig.pagination.total,operateSlice:2,rowKey:"id",isPage:e.tableConfig.isPage,currentPage:e.tableConfig.pagination.pageNo,pageSize:e.tableConfig.pagination.pageSize},on:{"update:currentPage":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:current-page":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},changePage:e.changePage,operate:e.getIndex}}),e.showAddDialog?t("AddAndEdit",{attrs:{rowData:e.rowData,refresh:e.getList},model:{value:e.showAddDialog,callback:function(t){e.showAddDialog=t},expression:"showAddDialog"}}):e._e(),e.showConfigDialog?t("FrameConfig",{attrs:{rowData:e.rowData,refresh:e.getList},model:{value:e.showConfigDialog,callback:function(t){e.showConfigDialog=t},expression:"showConfigDialog"}}):e._e(),e.showStateDialog?t("StateConfig",{attrs:{rowData:e.rowData,refresh:e.getList},model:{value:e.showStateDialog,callback:function(t){e.showStateDialog=t},expression:"showStateDialog"}}):e._e(),e.showMatchDialog?t("ParamsMatching",{attrs:{rowData:e.rowData,refresh:e.getList},model:{value:e.showMatchDialog,callback:function(t){e.showMatchDialog=t},expression:"showMatchDialog"}}):e._e(),e.showResourceDialog?t("ResourceMatching",{attrs:{rowData:e.rowData,refresh:e.getList},model:{value:e.showResourceDialog,callback:function(t){e.showResourceDialog=t},expression:"showResourceDialog"}}):e._e()],1)},r=[],n=a("5530"),i=(a("7db0"),a("d81d"),a("14d9"),a("d3b7"),a("caad"),function(){var e=this,t=e._self._c;return t("div",[t("el-dialog-limit",{attrs:{title:e.isEdit?"编辑":"新增",visible:e.show,size:"small",loading:e.loading,"append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",staticClass:"cluster-form",attrs:{"label-position":e.labelPosition,"label-width":"100px",model:e.form,rules:e.rules}},[t("el-form-item",{attrs:{label:"匹配方式",prop:"matchType"}},[t("el-radio-group",{on:{change:e.changeMatchType},model:{value:e.form.matchType,callback:function(t){e.$set(e.form,"matchType",t)},expression:"form.matchType"}},[t("el-radio",{attrs:{label:0}},[e._v("类")]),t("el-radio",{attrs:{label:1}},[e._v("方法/数据")]),t("el-radio",{attrs:{label:2}},[e._v("自定义")])],1)],1),t("el-form-item",{attrs:{label:"所属应用",prop:"baseId"}},[t("el-select",{staticClass:"w-100",attrs:{disabled:e.isEdit,placeholder:"请选择"},on:{change:e.appChange},model:{value:e.form.baseId,callback:function(t){e.$set(e.form,"baseId",t)},expression:"form.baseId"}},e._l(e.appOptions,(function(e){return t("el-option",{key:e.id,attrs:{label:e.appName,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"流控框架",prop:"limitFrame"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择",disabled:""},model:{value:e.form.limitFrame,callback:function(t){e.$set(e.form,"limitFrame",t)},expression:"form.limitFrame"}},e._l(e.dict_flowFrame,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1),2==e.form.matchType?t("el-form-item",{attrs:{label:"匹配引擎",prop:"customizeEngine"}},[t("el-input",{attrs:{placeholder:"请输入匹配引擎全路径名"},model:{value:e.form.customizeEngine,callback:function(t){e.$set(e.form,"customizeEngine",t)},expression:"form.customizeEngine"}})],1):e._e(),t("el-form-item",{attrs:{prop:"className"}},[t("template",{slot:"label"},[t("span",[e._v("类名")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 全类名。如：org.springframework.boot.logging.LogFile ")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{model:{value:e.form.className,callback:function(t){e.$set(e.form,"className",t)},expression:"form.className"}})],2),1==e.form.matchType||2==e.form.matchType?t("el-form-item",{attrs:{prop:"methodName"}},[t("template",{slot:"label"},[t("span",[e._v("方法名")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v("类中方法名。如：applyTo")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("el-input",{model:{value:e.form.methodName,callback:function(t){e.$set(e.form,"methodName",t)},expression:"form.methodName"}})],2):e._e(),[1,2].includes(e.form.matchType)?t("el-form-item",{attrs:{prop:"typeList_form"}},[t("template",{slot:"label"},[t("span",[e._v("参数类型")]),t("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 1、参数顺序同方法中参数顺序一致 "),t("br"),e._v(" 2、自定义参数需要填写参数的全类名，如：com.xxx.po.Person ")]),t("i",{staticClass:"el-icon-info table-msg"})])],1),t("FlowParamsType",{model:{value:e.typeList_form,callback:function(t){e.typeList_form=t},expression:"typeList_form"}})],2):e._e()],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)],1)}),s=[],l=a("c7eb"),c=a("1da1"),m=(a("99af"),a("b64b"),a("159b"),a("cba0")),u=a("dcf6"),f=a("bc59"),p=a("5c8a"),d=a("ec41"),g=a("d1cd"),b=a("f14a"),h=a("aee7");function v(e,t){var a={id:"",matchType:0,baseId:"",limitFrame:"SENTINEL",methodName:"",className:"",consumerProviderFlag:0,fuseState:0,resAppFlag:0,customizeEngine:""};return e&&Object.keys(a).forEach((function(t){Object(f["a"])(e,t)&&(a[t]=e[t])})),a}var w={name:"AddAndEdit",components:{FlowParamsType:b["default"]},model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:null},refresh:Function},data:function(){return{edit_old_matchType:null,edit_old_typeList_form:[],typeList_form:[],typeList_hiddenExtra:null,appOptions:[],showDialog:!1,dict_flowFrame:g["c"],loading:!1,labelPosition:"right",form:v(),rules:{matchType:[{required:!0,message:"请选择匹配方式",trigger:"change"}],baseId:[{required:!0,message:"请选择所属应用",trigger:"change"}],limitFrame:[{required:!0,message:"请选择流控框架",trigger:"change"}],customizeEngine:[{required:!0,message:"请输入匹配引擎全路径名",trigger:"blur"}],className:[{required:!0,message:"请填写类型",trigger:"blur"}],methodName:[{required:!0,message:"请填写方法名",trigger:"blur"}]}}},computed:{isEdit:function(){var e;return Boolean(null===(e=this.rowData)||void 0===e?void 0:e.id)}},watch:{},created:function(){this.getDetail()},mounted:function(){this.isEdit&&(this.form=v(this.rowData,this.rowData.matchType),this.form.className=this.rowData.resourceName.split("|")[0],this.form.methodName=this.rowData.resourceName.split("|")[1]||""),this.getAppOptions()},methods:{changeMatchType:function(e){this.isEdit&&(this.edit_old_matchType==e?this.typeList_form=Object(p["a"])(this.edit_old_typeList_form):this.typeList_form=[])},getDetail:function(){var e=this;return Object(c["a"])(Object(l["a"])().mark((function t(){var a,o,r,n;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null!==(a=e.rowData)&&void 0!==a&&a.id){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Object(u["b"])(e.rowData.id);case 4:o=t.sent,r=Object(d["a"])(o,"data.typeList"),e.typeList_hiddenExtra=Object(h["b"])(r),n=Object(h["a"])(r).map((function(e){return{states:e.states,parameterType:e.parameterType}})),e.edit_old_matchType=Object(d["a"])(o,"data.govAppConfigPo.matchType"),e.edit_old_typeList_form=Object(p["a"])(n),e.typeList_form=n;case 11:case"end":return t.stop()}}),t)})))()},appChange:function(e){var t=this.appOptions.find((function(t){return t.id===e}));this.form.limitFrame=t.limitFrame},getAppOptions:function(){var e=this;Object(m["c"])().then((function(t){e.appOptions=Object(d["a"])(t,"data")}))},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate(function(){var t=Object(c["a"])(Object(l["a"])().mark((function t(a){var o,r;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a&&(o=Object(n["a"])({resourceName:"".concat(e.form.className).concat(""!==e.form.methodName?"|"+e.form.methodName:"")},e.form),delete o.methodName,delete o.className,r={govAppConfigPo:o,typeList:[]},[1,2].includes(e.form.matchType)&&(r.typeList=e.typeList_form.map((function(e,t){return Object(n["a"])(Object(n["a"])({},e),{},{paramNo:t+1})}))),e.loading=!0,e.isEdit?(e.typeList_hiddenExtra&&r.typeList.unshift(e.typeList_hiddenExtra),Object(u["h"])(r).then((function(t){200===t.code&&(e.$message.success("编辑成功"),e.$emit("change",!1),e.refresh())})).catch((function(e){})).finally((function(){e.loading=!1}))):Object(u["e"])(r).then((function(t){200===t.code&&(e.$message.success("新增成功"),e.$emit("change",!1),e.refresh())})).catch((function(e){})).finally((function(){e.loading=!1})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},D=w,C=(a("2f70"),a("2877")),_=Object(C["a"])(D,i,s,!1,null,"7ede80b2",null),k=_.exports,S=a("44a4"),y=a("3dc9"),x=a("61e0"),O=a("7c2b"),T=a("ff51"),P=[{label:"类",value:0},{label:"方法/数据",value:1},{label:"自定义",value:2}],N={name:"flow-control-client",components:{AddAndEdit:k,FrameConfig:S["default"],ParamsMatching:x["default"],ResourceMatching:O["default"],StateConfig:y["default"]},mixins:[],props:{},data:function(){var e=this,t=(this.$createElement,this);return{appList:[],showStateDialog:!1,showResourceDialog:!1,showMatchDialog:!1,showAddDialog:!1,showConfigDialog:!1,rowData:null,buttonList:[{label:"新增",type:"add",click:this.addInfo}],tableConfig:{loading:!1,pagination:{pageNo:1,pageSize:10,total:0},tableData:[],columns:[{prop:"resourceName",label:"资源名称",fixed:"left"},{prop:"matchType",label:"匹配方式",width:100,align:"center",render:function(e,t){var a=t.row,o=P.find((function(e){return e.value===a.matchType}));return e("span",[o.label])}},{prop:"appName",label:"所属应用"},{prop:"appCode",label:"应用编码"},{prop:"limitFrame",label:"限流框架",width:100},{prop:"partitionCount",label:"启用熔断",align:"center",width:100,render:function(t,a){var o=a.row;return t("div",[t("el-button",{attrs:{type:"text"},on:{click:function(){return e.openConfig(o)}}},["配置"]),t("el-button",{attrs:{type:"text"},on:{click:function(){return e.startConfig(o)}}},[o.fuseState?"暂停":"启动"])])}},{prop:"flowState",label:"限流状态",align:"center",width:100,render:function(t,a){var o=a.row;return t("div",[t("el-button",{attrs:{type:"text"},on:{click:function(){return e.openFlowState(o)}}},["配置"]),t("el-button",{attrs:{type:"text"},on:{click:function(){return e.clickRowStart(o,"flowState")}}},[o.flowState?"暂停":"启动"])])}},{prop:"",label:"监控",align:"center",width:100,render:function(t,a){var o=a.row;return"SENTINEL"===o.limitFrame?t("el-button",{attrs:{type:"text"},on:{click:function(){return e.$router.push({path:"/govern-flow-control-client/app-flow-monitoring",query:{id:o.id,appCode:o.appCode,resourceName:o.resourceName}})}}},["实时查看"]):t("span",["-"])}}],operate:{width:220,columnAlign:"left",list:[{label:"资源匹配",id:"resource"},{label:"参数匹配",id:"matching",isShow:function(e){return 1==e.matchType}},{label:"编辑",id:"edit"},{label:"删除",id:"delete"}]}},searchConfig:{searchData:{baseId:"",consumerProviderFlag:0},searchItem:[{type:"select",label:"应用名称",prop:"baseId",get options(){return t.appList}}],rules:{}}}},computed:{},watch:{},created:function(){},mounted:function(){this.getList(),this.getAppOptions()},methods:{clickRowStart:function(e,t){var a=this,o={baseId:e.baseId,id:e.id};switch(t){case"blackWhiteState":o.blackWhiteState=+!e.blackWhiteState;break;case"flowState":o.flowState=+!e.flowState;break}this.tableConfig.loading=!0,Object(u["f"])(o).then((function(e){a.$message.success(e.msg),a.getList()})).finally((function(){a.tableConfig.loading=!1}))},startConfig:function(e){var t=this;this.tableConfig.loading=!0,Object(u["f"])({baseId:e.baseId,fuseState:+!e.fuseState,id:e.id}).then((function(e){t.$message.success(e.msg),t.getList()})).finally((function(){t.tableConfig.loading=!1}))},getAppOptions:function(){var e=this;Object(m["c"])().then((function(t){var a=Object(d["a"])(t,"data");e.appList=a.map((function(e){return{label:e.appName,value:e.id}}))}))},getList:function(){var e=this,t={pageNo:this.tableConfig.pagination.pageNo,pageSize:this.tableConfig.pagination.pageSize,requestObject:Object(n["a"])({},this.searchConfig.searchData)};this.tableConfig.loading=!0,Object(u["c"])(t).then((function(t){Object(T["a"])(null===t||void 0===t?void 0:t.data.data)&&(e.tableConfig.tableData=t.data.data,e.tableConfig.pagination.total=Object(d["a"])(t,"data.totalCount")||0)})).finally((function(){e.tableConfig.loading=!1}))},addInfo:function(){this.showAddDialog=!0,this.rowData=null},openConfig:function(e){this.showConfigDialog=!0,this.rowData=e},openFlowState:function(e){this.rowData=e,this.showStateDialog=!0},onSearch:function(e){this.tableConfig.pagination.pageNo=1,this.getList()},changePage:function(e,t){e&&(this.tableConfig.pagination.pageNo=e),t&&(this.tableConfig.pagination.pageNo=1,this.tableConfig.pagination.pageSize=t),this.getList()},getIndex:function(e){var t=this,a=(e.index,e.row),o=e.operate;switch(this.rowData=a,o.id){case"delete":var r=this.$createElement;this.$msgbox({title:"提示",message:r("div",{class:{"msgbox-delete-div":!0}},["确定要删除【".concat(a.resourceName,"】吗")]),type:"warning",showCancelButton:!0}).then((function(){t.tableConfig.loading=!0,Object(u["a"])(a.id).then((function(e){t.$message.success("删除成功"),t.getList()})).catch((function(e){})).finally((function(){t.tableConfig.loading=!1}))})).catch((function(e){}));break;case"edit":1==a.matchType?this.$confirm("编辑后,已配置的参数匹配将被清空","确认信息",{type:"warning",confirmButtonText:"继续"}).then((function(){t.showAddDialog=!0})):this.showAddDialog=!0;break;case"matching":this.showMatchDialog=!0;break;case"resource":this.showResourceDialog=!0;break;default:}}}},$=N,j=(a("d35d"),Object(C["a"])($,o,r,!1,null,"b613b450",null));t["default"]=j.exports},d693:function(e,t,a){},dbd7:function(e,t,a){"use strict";a("c095")}}]);