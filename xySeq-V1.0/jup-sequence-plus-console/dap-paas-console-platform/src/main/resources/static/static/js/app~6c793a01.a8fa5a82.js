(window["jsonpPaas4"]=window["jsonpPaas4"]||[]).push([["app~6c793a01"],{"0cad":function(t,e,i){"use strict";i("1649")},"59b2":function(t,e,i){"use strict";var o=i("8937"),n=i("3822"),a=i("0e20"),r=a["a"].cloneEvent,s=a["a"].isNaN,d=Math.abs,c=10,l=["shift","ctrl","alt","control"],h={getDefaultCfg:function(){return{direction:"both",enableOptimize:!1,scalableRange:0,allowDragOnItem:!1}},getEvents:function(){return{mousedown:"onMouseDown",drag:"onDragMove",dragend:"onMouseUp","canvas:click":"onMouseUp",keyup:"onKeyUp",focus:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onMouseUp"}},updateViewport:function(t){var e=this.origin,i=+t.clientX,o=+t.clientY;if(!s(i)&&!s(o)){var n=i-e.x,a=o-e.y;"x"===this.get("direction")?a=0:"y"===this.get("direction")&&(n=0),this.origin={x:i,y:o};var r=this.graph.get("width"),d=this.graph.get("height"),c=this.graph.get("canvas").getCanvasBBox(),l=this.scalableRange,h=this.scalableRange;l<1&&l>-1&&(l*=r,h*=d),(c.minX<=r+l&&c.minX+n>r+l||c.maxX+l>=0&&c.maxX+l+n<0)&&(n=0),(c.minY<=d+h&&c.minY+a>d+h||c.maxY+h>=0&&c.maxY+h+a<0)&&(a=0),this.graph.translate(n,a)}},onTouchStart:function(t){var e=this,i=t.originalEvent.touches,o=i[0],n=i[1];o&&n||(t.preventDefault(),this.mousedown=!0,e.onDragStart(t))},onMouseDown:function(t){this.mousedown=!0},onDragMove:function(t){this.mousedown&&(this.dragstart?this.onDrag(t):(this.dragstart=!0,this.onDragStart(t)))},onDragStart:function(t){var e=this,i=t.originalEvent;if((!i||"touchstart"===t.name||0===i.button)&&("touchstart"===t.name||"undefined"===typeof window||!window.event||window.event.buttons||window.event.button)&&this.shouldBegin(t,this)&&!e.keydown&&this.allowDrag(t)){if(e.origin={x:t.clientX,y:t.clientY},e.dragging=!1,this.enableOptimize){for(var o=this.graph,n=o.getEdges(),a=0,r=n.length;a<r;a++){var s=n[a].get("group").get("children");s&&s.forEach((function(t){t.set("ori-visibility",t.get("ori-visibility")||t.get("visible")),t.hide()}))}for(var d=o.getNodes(),c=0,l=d.length;c<l;c++)for(var h=d[c].getContainer(),g=h.get("children"),u=0,f=g;u<f.length;u++){var v=f[u],m=v.get("isKeyShape");m||(v.set("ori-visibility",v.get("ori-visibility")||v.get("visible")),v.hide())}}if("undefined"!==typeof window){var p=this;this.handleDOMContextMenu=function(t){return p.onMouseUp(t)},document.body.addEventListener("contextmenu",this.handleDOMContextMenu)}}},onTouchMove:function(t){var e=this,i=t.originalEvent.touches,o=i[0],n=i[1];o&&n?this.onMouseUp(t):(t.preventDefault(),e.onDrag(t))},onDrag:function(t){if(this.mousedown){var e=this.graph;if(!this.keydown&&this.allowDrag(t)&&(t=r(t),this.origin)){if(this.dragging)t.type="drag",e.emit("canvas:drag",t);else{if(d(this.origin.x-t.clientX)+d(this.origin.y-t.clientY)<c)return;this.shouldBegin(t,this)&&(t.type="dragstart",e.emit("canvas:dragstart",t),this.originPosition={x:t.clientX,y:t.clientY},this.dragging=!0)}this.shouldUpdate(t,this)&&this.updateViewport(t)}}},onMouseUp:function(t){var e,i;this.mousedown=!1,this.dragstart=!1;var o=this.graph;if(!this.keydown){var n=o.getZoom(),a=o.get("modeController"),s=null===(i=null===(e=null===a||void 0===a?void 0:a.modes[a.mode])||void 0===e?void 0:e.filter((function(t){return"zoom-canvas"===t.type})))||void 0===i?void 0:i[0],d=s?s.optimizeZoom||.1:0;if(this.enableOptimize){for(var c=o.getEdges(),l=0,h=c.length;l<h;l++){var g=c[l].get("group").get("children");g&&g.forEach((function(t){var e=t.get("ori-visibility");t.set("ori-visibility",void 0),e&&t.show()}))}if(n>d)for(var u=o.getNodes(),f=0,v=u.length;f<v;f++)for(var m=u[f].getContainer(),p=m.get("children"),y=0,b=p;y<b.length;y++){var w=b[y],S=w.get("isKeyShape");if(!S){var x=w.get("ori-visibility");w.set("ori-visibility",void 0),x&&w.show()}}}this.dragging?(t=r(t),this.shouldEnd(t,this)&&this.updateViewport(t),t.type="dragend",t.dx=t.clientX-this.originPosition.x,t.dy=t.clientY-this.originPosition.y,o.emit("canvas:dragend",t),this.endDrag(),"undefined"!==typeof window&&document.body.removeEventListener("contextmenu",this.handleDOMContextMenu)):this.origin=null}},endDrag:function(){this.origin=null,this.dragging=!1,this.dragbegin=!1,this.mousedown=!1,this.dragstart=!1},onKeyDown:function(t){var e=this,i=t.key;i&&(l.indexOf(i.toLowerCase())>-1?e.keydown=!0:e.keydown=!1)},onKeyUp:function(){this.keydown=!1,this.origin=null,this.dragging=!1,this.dragbegin=!1},allowDrag:function(t){var e,i,n=t.target,a=n&&n.isCanvas&&n.isCanvas();if(Object(o["isBoolean"])(this.allowDragOnItem)&&!this.allowDragOnItem&&!a)return!1;if(Object(o["isObject"])(this.allowDragOnItem)){var r=this.allowDragOnItem,s=r.node,d=r.edge,c=r.combo,l=null===(i=null===(e=t.item)||void 0===e?void 0:e.getType)||void 0===i?void 0:i.call(e);if(!s&&"node"===l)return!1;if(!d&&"edge"===l)return!1;if(!c&&"combo"===l)return!1}return!0}},g=i("9ab4"),u=i("6d1e"),f={getDefaultCfg:function(){return{updateEdge:!0,delegateStyle:{},enableDelegate:!1,onlyChangeComboSize:!1,comboActiveState:"",selectedState:"selected",enableOptimize:!1,enableDebounce:!1,enableStack:!0}},getEvents:function(){return{"node:mousedown":"onMouseDown",drag:"onDragMove",dragend:"onDragEnd","combo:dragenter":"onDragEnter","combo:dragleave":"onDragLeave","combo:drop":"onDropCombo","node:drop":"onDropNode","canvas:drop":"onDropCanvas",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onDragEnd",afterchangedata:"onDragEnd"}},validationCombo:function(t){if(!this.origin||!t||t.destroyed)return!1;var e=t.getType();return"combo"===e},onTouchStart:function(t){if(t.item){var e=this;try{var i=t.originalEvent.touches,o=i[0],n=i[1];if(o&&n)return;t.preventDefault()}catch(a){}this.mousedown={item:t.item,target:t.target,origin:{x:t.x,y:t.y}},this.dragstart=!0,e.onDragStart(t)}},onTouchMove:function(t){var e=this;try{var i=t.originalEvent.touches,o=i[0],n=i[1];if(o&&n)return void e.onDragEnd(t);t.preventDefault()}catch(t){}e.onDrag(t)},onMouseDown:function(t){this.mousedown={item:t.item,target:t.target,origin:{x:t.x,y:t.y}},"undefined"===typeof window||this.windowEventBinded||(this.windowEventBinded=!0,document.body.addEventListener("contextmenu",this.onDragEnd.bind(this)),document.body.addEventListener("mouseup",this.onDragEnd.bind(this)))},onDragMove:function(t){var e,i;"node"===(null===(i=null===(e=t.item)||void 0===e?void 0:e.getType)||void 0===i?void 0:i.call(e))?this.mousedown&&(this.dragstart?this.onDrag(Object(g["__assign"])(Object(g["__assign"])({},t),this.mousedown)):(this.dragstart=!0,this.onDragStart(t))):this.onDragEnd()},onDragStart:function(t){var e=this;if(this.currentShouldEnd=!0,this.shouldBegin(Object(g["__assign"])(Object(g["__assign"])({},t),this.mousedown),this)){var i=this.mousedown,o=i.item,n=i.target;if(o&&!o.destroyed&&!o.hasLocked()){var a=o.getContainer();if(a.set("capture",!1),this.cachedCaptureItems||(this.cachedCaptureItems=[]),this.cachedCaptureItems.push(o),n){var r=n.get("isAnchorPoint");if(r)return}var s=this.graph;this.targets=[],this.targetCombo=null;var d=s.findAllByState("node",this.selectedState),c=o.get("id"),l=d.filter((function(t){var e=t.get("id");return c===e}));if(0===l.length?this.targets.push(o):d.length>1?d.forEach((function(t){var i=t.hasLocked();i||e.targets.push(t)})):this.targets.push(o),this.graph.get("enabledStack")&&this.enableStack){var h=[];this.targets.forEach((function(t){var e=t.getModel(),i=e.x,o=e.y,n=e.id;h.push({x:i,y:o,id:n})})),this.set("beforeDragNodes",h)}this.hidenEdge={},this.get("updateEdge")&&this.enableOptimize&&!this.enableDelegate&&this.targets.forEach((function(t){var i=t.getEdges();i.forEach((function(t){t.isVisible()&&(e.hidenEdge[t.getID()]=!0,t.hide())}))})),this.origin=this.mousedown.origin,this.point={},this.originPoint={}}}},onDrag:function(t){var e=this;if(this.mousedown&&this.origin&&this.shouldUpdate(t,this))if(this.get("enableDelegate"))this.updateDelegate(t);else if(this.enableDebounce)this.debounceUpdate({targets:this.targets,graph:this.graph,point:this.point,origin:this.origin,evt:t,updateEdge:this.get("updateEdge"),onlyChangeComboSize:this.onlyChangeComboSize,updateParentCombos:this.updateParentCombos});else{var i={};this.targets.map((function(o){e.update(o,t);var n=o.getModel().comboId;n&&(i[n]=e.graph.findById(n))})),this.onlyChangeComboSize&&this.updateParentCombos()}},onDragEnd:function(t){var e,i=this;if(this.mousedown=!1,this.dragstart=!1,"undefined"!==typeof window&&this.windowEventBinded&&(this.windowEventBinded=!1,document.body.removeEventListener("contextmenu",this.onDragEnd.bind(this)),document.body.removeEventListener("mouseup",this.onDragEnd.bind(this))),this.origin){null===(e=this.cachedCaptureItems)||void 0===e||e.forEach((function(t){var e=t.getContainer();e.set("capture",!0)})),this.cachedCaptureItems=[],this.delegateRect&&(this.delegateRect.remove(),this.delegateRect=null),this.get("updateEdge")&&this.enableOptimize&&!this.enableDelegate&&this.targets.forEach((function(t){var e=t.getEdges();e.forEach((function(t){i.hidenEdge[t.getID()]&&t.show(),t.refresh()}))})),this.hidenEdge={};var n=this.graph;if(n.get("enabledStack")&&this.enableStack){var a={before:{nodes:[],edges:[],combos:[]},after:{nodes:[],edges:[],combos:[]}};this.get("beforeDragNodes").forEach((function(t){a.before.nodes.push(t)})),this.targets.forEach((function(t){var e=t.getModel(),i=e.x,o=e.y,n=e.id;a.after.nodes.push({x:i,y:o,id:n})})),n.pushStack("update",Object(o["clone"])(a))}n.emit("dragnodeend",{items:this.targets,targetItem:null}),this.point={},this.origin=null,this.originPoint={},this.targets.length=0,this.targetCombo=null}},onDropCombo:function(t){var e=t.item;if(this.currentShouldEnd=this.shouldEnd(t,e,this),this.updatePositions(t,!this.currentShouldEnd),this.currentShouldEnd&&this.validationCombo(e)){var i=this.graph;if(this.comboActiveState&&i.setItemState(e,this.comboActiveState,!1),this.targetCombo=e,this.onlyChangeComboSize)i.updateCombos();else{var o=e.getModel();this.targets.map((function(t){var e=t.getModel();e.comboId!==o.id&&i.updateComboTree(t,o.id)})),i.updateCombo(e)}i.emit("dragnodeend",{items:this.targets,targetItem:this.targetCombo})}},onDropCanvas:function(t){var e=this.graph;this.currentShouldEnd=this.shouldEnd(t,void 0,this),this.updatePositions(t,!this.currentShouldEnd),this.targets&&0!==this.targets.length&&this.currentShouldEnd&&(this.onlyChangeComboSize?this.updateParentCombos():this.targets.map((function(t){var i=t.getModel();i.comboId&&e.updateComboTree(t)})))},onDropNode:function(t){if(this.targets&&0!==this.targets.length){var e=this,i=t.item,o=e.graph,n=i.getModel().comboId,a=n?o.findById(n):void 0;if(this.currentShouldEnd=this.shouldEnd(t,a,this),this.updatePositions(t,!this.currentShouldEnd),this.currentShouldEnd){if(this.onlyChangeComboSize)this.updateParentCombos();else if(n){var r=o.findById(n);e.comboActiveState&&o.setItemState(r,e.comboActiveState,!1),this.targets.map((function(t){var e=t.getModel();n!==e.comboId&&o.updateComboTree(t,n)})),o.updateCombo(r)}else this.targets.map((function(t){var e=t.getModel();e.comboId&&o.updateComboTree(t)}));o.emit("dragnodeend",{items:this.targets,targetItem:i})}}},onDragEnter:function(t){var e=t.item;if(this.validationCombo(e)){var i=this.graph;this.comboActiveState&&i.setItemState(e,this.comboActiveState,!0)}},onDragLeave:function(t){var e=t.item;if(this.validationCombo(e)){var i=this.graph;this.comboActiveState&&i.setItemState(e,this.comboActiveState,!1)}},updatePositions:function(t,e){var i=this;this.targets&&0!==this.targets.length&&(this.get("enableDelegate")?this.enableDebounce?this.debounceUpdate({targets:this.targets,graph:this.graph,point:this.point,origin:this.origin,evt:t,updateEdge:this.get("updateEdge"),onlyChangeComboSize:this.onlyChangeComboSize,updateParentCombos:this.updateParentCombos}):e||this.targets.map((function(e){return i.update(e,t)})):this.targets.map((function(o){return i.update(o,t,e)})))},update:function(t,e,i){var o=this.origin,n=t.get("model"),a=t.get("id");this.point[a]||(this.point[a]={x:n.x||0,y:n.y||0});var r=e.x-o.x+this.point[a].x,s=e.y-o.y+this.point[a].y;i&&(r+=o.x-e.x,s+=o.y-e.y);var d={x:r,y:s};this.get("updateEdge")?this.graph.updateItem(t,d,!1):t.updatePosition(d)},debounceUpdate:Object(o["debounce"])((function(t){var e=t.targets,i=t.graph,o=t.point,n=t.origin,a=t.evt,r=t.updateEdge,s=t.onlyChangeComboSize,d=t.updateParentCombos;e.map((function(t){var e=t.get("model"),s=t.get("id");o[s]||(o[s]={x:e.x||0,y:e.y||0});var d=a.x-n.x+o[s].x,c=a.y-n.y+o[s].y,l={x:d,y:c};r?i.updateItem(t,l,!1):t.updatePosition(l)})),s&&d(i,e)}),50,!0),updateDelegate:function(t){var e=this.graph;if(this.delegateRect){var i=t.x-this.origin.x+this.originPoint.minX,n=t.y-this.origin.y+this.originPoint.minY;this.delegateRect.attr({x:i,y:n})}else{var a=e.get("group"),r=Object(o["deepMix"])({},u["a"].delegateStyle,this.delegateStyle),s=this.calculationGroupPosition(t),d=s.x,c=s.y,l=s.width,h=s.height,f=s.minX,v=s.minY;this.originPoint={x:d,y:c,width:l,height:h,minX:f,minY:v},this.delegateRect=a.addShape("rect",{attrs:Object(g["__assign"])({width:l,height:h,x:d,y:c},r),name:"rect-delegate-shape"}),this.delegate=this.delegateRect,this.delegateRect.set("capture",!1)}},calculationGroupPosition:function(t){var e=this.targets;0===e.length&&e.push(t.item);for(var i=1/0,o=-1/0,n=1/0,a=-1/0,r=0;r<e.length;r++){var s=e[r],d=s.getBBox(),c=d.minX,l=d.minY,h=d.maxX,g=d.maxY;c<i&&(i=c),l<n&&(n=l),h>o&&(o=h),g>a&&(a=g)}var u=Math.floor(i),f=Math.floor(n),v=Math.ceil(o)-Math.floor(i),m=Math.ceil(a)-Math.floor(n);return{x:u,y:f,width:v,height:m,minX:i,minY:n}},updateParentCombos:function(t,e){var i=t||this.graph,o=e||this.targets,n={};null===o||void 0===o||o.forEach((function(t){var e=t.getModel().comboId;e&&(n[e]=i.findById(e))})),Object.values(n).forEach((function(t){t&&i.updateCombo(t)}))}},v=null,m={getDefaultCfg:function(){return{trigger:"mouseenter",activeState:"active",inactiveState:"inactive",resetSelected:!1,shouldClearStatusOnSecond:!1,shouldUpdate:function(){return!0}}},getEvents:function(){return"mouseenter"===this.get("trigger")?{"node:mouseenter":"setAllItemStates","combo:mouseenter":"setAllItemStates","node:mouseleave":"clearActiveState","combo:mouseleave":"clearActiveState"}:{"node:click":"setAllItemStates","combo:click":"setAllItemStates","canvas:click":"clearActiveState","node:touchstart":"setOnTouchStart","combo:touchstart":"setOnTouchStart","canvas:touchstart":"clearOnTouchStart"}},setOnTouchStart:function(t){var e=this;try{var i=t.originalEvent.touches,o=i[0],n=i[1];if(o&&n)return;t.preventDefault()}catch(t){}e.setAllItemStates(t)},clearOnTouchStart:function(t){var e=this;try{var i=t.originalEvent.touches,o=i[0],n=i[1];if(o&&n)return;t.preventDefault()}catch(t){}e.clearActiveState(t)},setAllItemStates:function(t){clearTimeout(this.timer),this.throttleSetAllItemStates(t,this)},clearActiveState:function(t){var e=this,i=this.shouldClearStatusOnSecond;i&&(v=null),this.timer=setTimeout((function(){e.throttleClearActiveState(t,e)}),50)},throttleSetAllItemStates:Object(o["throttle"])((function(t,e){var i=t.item,o=e.graph;if(o&&!o.destroyed&&(e.item=i,e.shouldUpdate(t.item,{event:t,action:"activate"},e))){var n=e.shouldClearStatusOnSecond,a=i.getModel().id;if(v===a&&n)return e.throttleClearActiveState(t,e),void(v=null);for(var r=e.activeState,s=e.inactiveState,d=o.getNodes(),c=o.getCombos(),l=o.getEdges(),h=o.get("vedges"),g=d.length,u=c.length,f=l.length,m=h.length,p=e.inactiveItems||{},y=e.activeItems||{},b=0;b<g;b++){var w=d[b],S=w.getID(),x=w.hasState("selected");e.resetSelected&&x&&o.setItemState(w,"selected",!1),y[S]&&(o.setItemState(w,r,!1),delete y[S]),s&&!p[S]&&(o.setItemState(w,s,!0),p[S]=w)}for(b=0;b<u;b++){var C=c[b],k=C.getID();x=C.hasState("selected");e.resetSelected&&x&&o.setItemState(C,"selected",!1),y[k]&&(o.setItemState(C,r,!1),delete y[k]),s&&!p[k]&&(o.setItemState(C,s,!0),p[k]=C)}for(b=0;b<f;b++){var E=l[b],D=E.getID();y[D]&&(o.setItemState(E,r,!1),delete y[D]),s&&!p[D]&&(o.setItemState(E,s,!0),p[D]=E)}for(b=0;b<m;b++){var I=h[b],O=I.getID();y[O]&&(o.setItemState(I,r,!1),delete y[O]),s&&!p[O]&&(o.setItemState(I,s,!0),p[O]=I)}if(i&&!i.destroyed){s&&(o.setItemState(i,s,!1),delete p[i.getID()]),y[i.getID()]||(o.setItemState(i,r,!0),y[i.getID()]=i);var M=i.getEdges(),B=M.length;for(b=0;b<B;b++){E=M[b],D=E.getID();var j=void 0;j=E.getSource()===i?E.getTarget():E.getSource();var L=j.getID();s&&p[L]&&(o.setItemState(j,s,!1),delete p[L]),y[L]||(o.setItemState(j,r,!0),y[L]=j),p[D]&&(o.setItemState(E,s,!1),delete p[D]),y[D]||(o.setItemState(E,r,!0),y[D]=E),E.toFront()}}e.activeItems=y,e.inactiveItems=p,n&&(v=i.getModel().id),o.emit("afteractivaterelations",{item:t.item,action:"activate"})}}),50,{trailing:!0,leading:!0}),throttleClearActiveState:Object(o["throttle"])((function(t,e){var i=e.get("graph");if(i&&!i.destroyed&&e.shouldUpdate(t.item,{event:t,action:"deactivate"},e)){var o=e.activeState,n=e.inactiveState,a=e.activeItems||{},r=e.inactiveItems||{};Object.values(a).filter((function(t){return!t.destroyed})).forEach((function(t){i.clearItemStates(t,o)})),Object.values(r).filter((function(t){return!t.destroyed})).forEach((function(t){i.clearItemStates(t,n)})),e.activeItems={},e.inactiveItems={},i.emit("afteractivaterelations",{item:t.item||e.get("item"),action:"deactivate"})}}),50,{trailing:!0,leading:!0})},p=Math.min,y=Math.max,b=Math.abs,w="shift",S=["drag","shift","ctrl","alt","control"],x={getDefaultCfg:function(){return{brushStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},selectedState:"selected",trigger:w,includeEdges:!0,includeCombos:!1,selectOnCombo:!1,selectedEdges:[],selectedNodes:[],selectedCombos:[]}},getEvents:function(){return S.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=w),"drag"===this.trigger?{dragstart:"onMouseDown",drag:"onMouseMove",dragend:"onMouseUp","canvas:click":"clearStates"}:{dragstart:"onMouseDown",drag:"onMouseMove",dragend:"onMouseUp","canvas:click":"clearStates",keyup:"onKeyUp",keydown:"onKeyDown"}},onMouseDown:function(t){var e=t.item,i=this.brush,o=this.selectOnCombo,n="combo"===(null===e||void 0===e?void 0:e.getType());n&&!o||!n&&e||("drag"===this.trigger||this.keydown)&&(this.selectedNodes&&0!==this.selectedNodes.length&&this.clearStates(),i||(i=this.createBrush()),this.originPoint={x:t.canvasX,y:t.canvasY},i.attr({width:0,height:0}),i.show(),this.dragging=!0)},onMouseMove:function(t){this.dragging&&("drag"===this.trigger||this.keydown)&&this.updateBrush(t)},onMouseUp:function(t){this.graph;(this.brush||this.dragging)&&("drag"===this.trigger||this.keydown)&&(this.brush.remove(!0),this.brush=null,this.getSelectedNodes(t),this.dragging=!1)},clearStates:function(){var t=this,e=t.graph,i=t.selectedState,o=e.findAllByState("node",i),n=e.findAllByState("edge",i),a=e.findAllByState("combo",i);o.forEach((function(t){return e.setItemState(t,i,!1)})),n.forEach((function(t){return e.setItemState(t,i,!1)})),a.forEach((function(t){return e.setItemState(t,i,!1)})),this.selectedNodes=[],this.selectedEdges=[],this.selectedCombos=[],this.onDeselect&&this.onDeselect(this.selectedNodes,this.selectedEdges,this.selectedCombos),e.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[],combos:[]},select:!1})},isBBoxCenterInRect:function(t,e,i,o,n){var a=t.getBBox();return a.centerX>=e&&a.centerX<=i&&a.centerY>=o&&a.centerY<=n},getSelectedNodes:function(t){var e=this,i=this,o=i.graph,n=i.originPoint,a=i.shouldUpdate,r=i.isBBoxCenterInRect,s=this.selectedState,d={x:t.x,y:t.y},c=o.getPointByCanvas(n.x,n.y),l=p(d.x,c.x),h=y(d.x,c.x),g=p(d.y,c.y),u=y(d.y,c.y),f=[],v=[];o.getNodes().forEach((function(t){if(t.isVisible()&&r(t,l,h,g,u)&&a(t,"select",e)){f.push(t);var i=t.getModel();v.push(i.id),o.setItemState(t,s,!0)}}));var m=[];this.includeEdges&&f.forEach((function(t){var i=t.getOutEdges();i.forEach((function(t){if(t.isVisible()){var i=t.getModel(),n=i.source,r=i.target;v.includes(n)&&v.includes(r)&&a(t,"select",e)&&(m.push(t),o.setItemState(t,e.selectedState,!0))}}))}));var b=[];this.includeCombos&&o.getCombos().forEach((function(t){if(t.isVisible()&&r(t,l,h,g,u)&&a(t,"select",e)){b.push(t);var i=t.getModel();v.push(i.id),o.setItemState(t,s,!0)}})),this.selectedEdges=m,this.selectedNodes=f,this.selectedCombos=b,this.onSelect&&this.onSelect(f,m,b),o.emit("nodeselectchange",{selectedItems:{nodes:f,edges:m,combos:b},select:!0})},createBrush:function(){var t=this,e=t.graph.get("canvas").addShape("rect",{attrs:t.brushStyle,capture:!1,name:"brush-shape"});return this.brush=e,this.delegate=e,e},updateBrush:function(t){var e=this.originPoint;this.brush.attr({width:b(t.canvasX-e.x),height:b(t.canvasY-e.y),x:p(t.canvasX,e.x),y:p(t.canvasY,e.y)})},onKeyDown:function(t){var e=t.key;if(e){var i=this.trigger.toLowerCase(),o=e.toLowerCase();this.keydown=o===i||"control"===o&&"ctrl"===i||"ctrl"===o&&"control"===i}},onKeyUp:function(){this.brush&&(this.brush.remove(!0),this.brush=null,this.dragging=!1),this.keydown=!1}},C="shift",k=["shift","ctrl","alt","control"],E={getDefaultCfg:function(){return{multiple:!0,trigger:C,selectedState:"selected",selectNode:!0,selectEdge:!1,selectCombo:!0}},getEvents:function(){var t=this;return k.indexOf(t.trigger.toLowerCase())>-1||(t.trigger=C),t.multiple?{"node:click":"onClick","combo:click":"onClick","edge:click":"onClick","canvas:click":"onCanvasClick",keyup:"onKeyUp",keydown:"onKeyDown"}:{"node:click":"onClick","combo:click":"onClick","edge:click":"onClick","canvas:click":"onCanvasClick"}},onClick:function(t){var e=this,i=t.item;if(i&&!i.destroyed){var n=i.getType(),a=e.graph,r=e.keydown,s=e.multiple,d=e.shouldUpdate,c=e.shouldBegin;if(c(t,e)){if(!r||!s){var l=a.findAllByState("node",e.selectedState).concat(a.findAllByState("edge",e.selectedState)).concat(a.findAllByState("combo",e.selectedState));Object(o["each"])(l,(function(t){t!==i&&a.setItemState(t,e.selectedState,!1)}))}var h=function(){switch(n){case"node":return e.selectNode;case"edge":return e.selectEdge;case"combo":return e.selectCombo;default:return!1}}();if(h)if(i.hasState(e.selectedState)){d(t,e)&&a.setItemState(i,e.selectedState,!1);g=a.findAllByState("node",e.selectedState),u=a.findAllByState("edge",e.selectedState),f=a.findAllByState("combo",e.selectedState);a.emit("nodeselectchange",{target:i,selectedItems:{nodes:g,edges:u,combos:f},select:!1})}else{d(t,e)&&a.setItemState(i,e.selectedState,!0);g=a.findAllByState("node",e.selectedState),u=a.findAllByState("edge",e.selectedState),f=a.findAllByState("combo",e.selectedState);a.emit("nodeselectchange",{target:i,selectedItems:{nodes:g,edges:u,combos:f},select:!0})}else{var g=a.findAllByState("node",e.selectedState),u=a.findAllByState("edge",e.selectedState),f=a.findAllByState("combo",e.selectedState);a.emit("nodeselectchange",{selectedItems:{nodes:g,edges:u,combos:f},select:!1})}}}},onCanvasClick:function(t){var e=this,i=this,n=i.graph,a=i.shouldBegin;if(a(t,this)){var r=n.findAllByState("node",this.selectedState);Object(o["each"])(r,(function(t){n.setItemState(t,e.selectedState,!1)}));var s=n.findAllByState("edge",this.selectedState);Object(o["each"])(s,(function(t){n.setItemState(t,e.selectedState,!1)}));var d=n.findAllByState("combo",this.selectedState);Object(o["each"])(d,(function(t){n.setItemState(t,e.selectedState,!1)})),n.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[],combos:[]},select:!1})}},onKeyDown:function(t){var e=this,i=t.key;i&&(i.toLowerCase()===this.trigger.toLowerCase()||"control"===i.toLowerCase()?e.keydown=!0:e.keydown=!1)},onKeyUp:function(){var t=this;t.keydown=!1}},D=i("e897"),I=i("31f1"),O=D["a"].transform,M=.05,B={getDefaultCfg:function(){return this.isFireFox="firefox"===Object(I["getBrowserName"])(),{sensitivity:2,minZoom:void 0,maxZoom:void 0,enableOptimize:!1,optimizeZoom:.1,fixSelectedItems:{fixAll:!1,fixLineWidth:!1,fixLabel:!1,fixState:"selected"},animate:!1,animateCfg:{duration:500}}},getEvents:function(){var t=this.fixSelectedItems;return t.fixState||(t.fixState="selected"),t.fixAll&&(t.fixLineWidth=!0,t.fixLabel=!0),{wheel:"onWheel",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd"}},onTouchStart:function(t){var e=t.originalEvent.touches,i=e[0],o=e[1];t.preventDefault(),o&&(this.shouldBegin&&!this.shouldBegin(t,this)||(this.startPoint={pageX:i.pageX,pageY:i.pageY},this.moveable=!0,o&&(this.endPoint={pageX:o.pageX,pageY:o.pageY}),this.originScale=this.graph.getZoom()||this.currentScale||1))},onTouchMove:function(t){if(this.moveable){t.preventDefault();var e=t.originalEvent.touches,i=e[0],o=e[1];if(o){this.endPoint||(this.endPoint={pageX:o.pageX,pageY:o.pageY});var n=function(t,e){return Math.hypot(e.x-t.x,e.y-t.y)},a=n({x:i.pageX,y:i.pageY},{x:o.pageX,y:o.pageY})/n({x:this.startPoint.pageX,y:this.startPoint.pageY},{x:this.endPoint.pageX,y:this.endPoint.pageY}),r=this.originScale*a;this.currentScale=r;var s=this.get("minZoom")||this.graph.get("minZoom"),d=this.get("maxZoom")||this.graph.get("maxZoom");if(!(r>d||r<s)){var c=this.get("animate"),l=this.get("animateCfg"),h=this.graph.get("canvas"),g=h.getPointByClient(t.clientX,t.clientY);this.graph.zoomTo(r,{x:g.x,y:g.y},c,l),this.graph.emit("wheelzoom",t)}}}},onTouchEnd:function(){this.moveable=!1,this.endPoint=null},onWheel:function(t){var e=this,i=this,n=i.graph,a=i.fixSelectedItems;if((!this.shouldBegin||this.shouldBegin(t,this))&&this.shouldUpdate(t,this)){t.preventDefault();var r=n.get("canvas"),s=r.getPointByClient(t.clientX,t.clientY),d=this.get("sensitivity"),c=n.getZoom(),l=c,h=c;l=this.isFireFox?t.deltaY>0||t.wheelDelta<0?1-M*d:1/(1-M*d):t.wheelDelta<0?1-M*d:1/(1-M*d),h=c*l;var g=this.get("minZoom")||n.get("minZoom"),u=this.get("maxZoom")||n.get("maxZoom");h>u?h=u:h<g&&(h=g);var f=this.get("enableOptimize");if(f){var v=this.get("optimizeZoom"),m=this.get("optimized"),p=n.getNodes(),y=n.getEdges(),b=p.length,w=y.length;if(!m){for(var S=0;S<b;S++){var x=p[S];if(!x.destroyed)for(var C=x.get("group").get("children"),k=C.length,E=0;E<k;E++){var D=C[E];D.destoryed||D.get("isKeyShape")||(D.set("ori-visibility",D.get("ori-visibility")||D.get("visible")),D.hide())}}for(var I=0;I<w;I++){var B=y[I];for(C=B.get("group").get("children"),k=C.length,E=0;E<k;E++){D=C[E];D.set("ori-visibility",D.get("ori-visibility")||D.get("visible")),D.hide()}}this.set("optimized",!0)}clearTimeout(this.get("timeout"));var j=setTimeout((function(){var t=n.getZoom(),i=e.get("optimized");if(i){e.set("optimized",!1);for(var o=0;o<b;o++){var a=p[o],r=a.get("group").get("children"),s=r.length;if(t<v){var d=a.getKeyShape(),c=d.get("ori-visibility");d.set("ori-visibility",void 0),c&&d.show()}else for(var l=0;l<s;l++){var h=r[l];c=h.get("ori-visibility");h.set("ori-visibility",void 0),!h.get("visible")&&c&&c&&h.show()}}for(var g=0;g<w;g++){var u=y[g];r=u.get("group").get("children"),s=r.length;if(t<v){d=u.getKeyShape(),c=d.get("ori-visibility");d.set("ori-visibility",void 0),c&&d.show()}else for(l=0;l<s;l++){h=r[l];if(!h.get("visible")){c=h.get("ori-visibility");h.set("ori-visibility",void 0),c&&h.show()}}}}}),100);this.set("timeout",j)}if(c<=1){var L=void 0,P=void 0;if(a.fixAll||a.fixLineWidth||a.fixLabel){L=n.findAllByState("node",a.fixState),P=n.findAllByState("edge",a.fixState);for(var T=c/h,A=L.length,W=0;W<A;W++){x=L[W];var _=x.getContainer(),z=x.getModel(),N=x.getOriginStyle(),U=x.getStateStyle(a.fixState),R=x.get("shapeFactory").getShape(z.type).getStateStyle(a.fixState,x)[a.fixState];if(a.fixAll){if(h<=1){var X=Object(o["clone"])(_.getMatrix());X||(X=[1,0,0,0,1,0,0,0,1]);var Y=x.getModel(),F=Y.x,K=Y.y;X=O(X,[["t",-F,-K],["s",T,T],["t",F,K]]),_.setMatrix(X)}}else for(C=_.get("children"),k=C.length,E=0;E<k;E++){D=C[E];var q=void 0,G=void 0;if(a.fixLabel){var V=D.get("type");if("text"===V){q=D.attr("fontSize")||12;var Z=U[D.get("name")],H=R[D.get("name")],J=Z?Z.fontSize:12,Q=H?H.fontSize:12,$=J||Q||12;if(h<=1&&D.attr("fontSize",$/h),G)break}}if(a.fixLineWidth&&D.get("isKeyShape")){G=D.attr("lineWidth")||0;var tt=U.lineWidth||R.lineWidth||N.lineWidth||0;if(h<=1&&D.attr("lineWidth",tt/h),q)break}}}for(var et=P.length,it=0;it<et;it++)for(B=P[it],_=B.getContainer(),C=_.get("children"),z=B.getModel(),U=B.getStateStyle(a.fixState),R=B.get("shapeFactory").getShape(z.type).getStateStyle(a.fixState,B)[a.fixState],k=C.length,E=0;E<k;E++){D=C[E],q=void 0,G=void 0;if(a.fixLabel||a.fixAll){V=D.get("type");if("text"===V){q=D.attr("fontSize")||12;Z=U[D.get("name")],H=R[D.get("name")],J=Z?Z.fontSize:12,Q=H?H.fontSize:12,$=J||Q||12;if(h<=1&&D.attr("fontSize",$/h),G)break}}if((a.fixLineWidth||a.fixAll)&&D.get("isKeyShape")){G=D.attr("lineWidth")||0;tt=U.lineWidth||R.lineWidth||1;if(h<=1&&D.attr("lineWidth",tt/h),q)break}}}}var ot=this.get("animate"),nt=this.get("animateCfg");n.zoomTo(h,{x:s.x,y:s.y},ot,nt),n.emit("wheelzoom",t)}}},j=i("7c8a"),L={onMouseEnter:function(t){var e=t.item;this.currentTarget=e,this.showTooltip(t),this.graph.emit("tooltipchange",{item:t.item,action:"show"})},onMouseMove:function(t){this.shouldUpdate(t,this)?this.currentTarget&&t.item===this.currentTarget&&this.updatePosition(t):this.hideTooltip()},onMouseLeave:function(t){this.shouldEnd(t,this)&&(this.hideTooltip(),this.graph.emit("tooltipchange",{item:this.currentTarget,action:"hide"}),this.currentTarget=null)},showTooltip:function(t){var e=this.container;if(t.item&&!t.item.destroyed){e||(e=this.createTooltip(this.graph.get("canvas")),this.container=e);var i=this.formatText(t.item.get("model"),t);e.innerHTML=i,Object(j["c"])(this.container,{visibility:"visible"}),this.updatePosition(t)}},hideTooltip:function(){Object(j["c"])(this.container,{visibility:"hidden"})},updatePosition:function(t){var e=this.get("shouldBegin"),i=this,o=i.width,n=i.height,a=i.container,r=i.graph;if(e(t,this)){var s=r.getPointByClient(t.clientX,t.clientY),d=r.getCanvasByPoint(s.x,s.y),c=d.x,l=d.y,h=a.getBoundingClientRect();c>o/2?c-=h.width:c+=this.offset,l>n/2?l-=h.height:l+=this.offset;var g="".concat(c,"px"),u="".concat(l,"px");Object(j["c"])(this.container,{left:g,top:u,visibility:"visible"})}else Object(j["c"])(a,{visibility:"hidden"})},createTooltip:function(t){var e=t.get("el");e.style.position="relative";var i=Object(j["b"])('<div class="g6-tooltip g6-'.concat(this.item,'-tooltip"></div>'));return e.parentNode.appendChild(i),Object(j["c"])(i,{position:"absolute",visibility:"visible"}),this.width=t.get("width"),this.height=t.get("height"),this.container=i,this.graph.get("tooltips").push(i),i}},P=Object(g["__assign"])({getDefaultCfg:function(){return{item:"node",offset:12,formatText:function(t){return t.label}}},getEvents:function(){return{"node:mouseenter":"onMouseEnter","node:mouseleave":"onMouseLeave","node:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave"}}},L),T=Object(g["__assign"])({getDefaultCfg:function(){return{item:"edge",offset:12,formatText:function(t){return"source: ".concat(t.source," target: ").concat(t.target)}}},getEvents:function(){return{"edge:mouseenter":"onMouseEnter","edge:mouseleave":"onMouseLeave","edge:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave"}}},L),A="click",W=["click","dblclick"],_={getDefaultCfg:function(){return{trigger:A,onChange:function(){}}},getEvents:function(){var t,e;return e=W.includes(this.trigger)?this.trigger:A,t={},t["node:".concat(e)]="onNodeClick",t.touchstart="onNodeClick",t},onNodeClick:function(t){var e=this;if("click"===this.trigger){if(this.timer)return clearTimeout(this.timer),void(this.timer=0);this.timer=setTimeout((function(){e.toggle(t),clearTimeout(e.timer),e.timer=0}),200)}else this.toggle(t)},toggle:function(t){var e=t.item;if(e){var i=this.graph.findDataById(e.get("id"));if(i){var o=i.children;if(o&&0!==o.length){var n=!i.collapsed;this.shouldBegin(t,n,this)&&(i.collapsed=n,e.getModel().collapsed=n,this.graph.emit("itemcollapsed",{item:t.item,collapsed:n}),this.shouldUpdate(t,n,this)&&(this.onChange(e,n,this),this.graph.layout()))}}}}},z=a["a"].calculationItemsBBox,N=function t(e,i){if(!1!==i(e)&&e){var n=e.get("combos");if(0===n.length)return!1;Object(o["each"])(n,(function(e){t(e,i)}))}},U={getDefaultCfg:function(){return{enableDelegate:!1,delegateStyle:{},onlyChangeComboSize:!1,activeState:"",selectedState:"selected",enableStack:!0}},getEvents:function(){return{"combo:mousedown":"onMouseDown","combo:dragstart":"onDragStart","combo:drag":"onDrag","combo:dragend":"onDragEnd","combo:drop":"onDrop","node:drop":"onNodeDrop","combo:dragenter":"onDragEnter","combo:dragleave":"onDragLeave"}},validationCombo:function(t){var e=t.item;if(!e||e.destroyed)return!1;if(!this.shouldUpdate(t,this))return!1;var i=e.getType();return"combo"===i},onMouseDown:function(t){this.origin={x:t.x,y:t.y}},onDragStart:function(t){var e=this,i=this.graph,o=t.item;if(this.currentShouldEnd=!0,this.validationCombo(t)){this.targets=[];var n=i.findAllByState("combo",this.selectedState),a=o.get("id"),r=n.filter((function(t){var e=t.get("id");return a===e}));0===r.length?this.targets.push(o):this.targets=n;var s=[];this.targets.forEach((function(t){var e=t.getModel(),i=e.x,o=e.y,n=e.id;s.push({x:i,y:o,id:n})})),this.set("beforeDragItems",s),this.activeState&&this.targets.map((function(t){var o=t.getModel();if(o.parentId){var n=i.findById(o.parentId);n&&i.setItemState(n,e.activeState,!0)}})),this.point={},this.originPoint={},this.currentItemChildCombos=[],N(o,(function(t){if(t.destroyed)return!1;var i=t.getModel();return e.currentItemChildCombos.push(i.id),!0}))}},onDrag:function(t){var e=this;if(this.origin&&this.validationCombo(t))if(this.enableDelegate)this.updateDelegate(t);else{if(this.activeState){var i=this.graph,n=t.item,a=n.getModel(),r=i.getCombos(),s=n.getBBox(),d=s.centerX,c=s.centerY,l=s.width,h=r.filter((function(t){var i=t.getModel();return a.parentId,i.id!==a.id&&!e.currentItemChildCombos.includes(i.id)}));h.map((function(t){var o=t.getBBox(),n=o.centerX,a=o.centerY,r=o.width,s=d-n,h=c-a,g=2*Math.sqrt(s*s+h*h);l+r-g>.8*l?i.setItemState(t,e.activeState,!0):i.setItemState(t,e.activeState,!1)}))}Object(o["each"])(this.targets,(function(i){e.updateCombo(i,t)})),this.onlyChangeComboSize&&this.updateParentCombos()}},updatePositions:function(t,e){var i=this;(this.enableDelegate||e)&&Object(o["each"])(this.targets,(function(o){i.updateCombo(o,t,e)}))},onDrop:function(t){var e=this,i=t.item;if(this.currentShouldEnd=this.shouldEnd(t,i,this),this.updatePositions(t,!this.currentShouldEnd),this.currentShouldEnd&&i&&this.targets&&!i.destroyed){var o=this.graph,n=i.getModel();this.targets.map((function(t){var a=t.getModel();a.parentId!==n.id?(e.activeState&&o.setItemState(i,e.activeState,!1),e.onlyChangeComboSize?o.updateCombo(t):o.updateComboTree(t,n.id,!1)):o.updateCombo(i)})),this.end(i,t),this.endComparison=!0}},onNodeDrop:function(t){var e=this;if(this.targets&&0!==this.targets.length){var i=this.graph,o=t.item,n=o.getModel().comboId,a=n?i.findById(n):void 0;if(this.currentShouldEnd=this.shouldEnd(t,a,this),this.updatePositions(t,!this.currentShouldEnd),this.currentShouldEnd){var r;if(n){if(this.activeState){var s=i.findById(n);i.setItemState(s,this.activeState,!1)}this.targets.map((function(t){e.onlyChangeComboSize?i.updateCombo(t):n!==t.getID()&&(r=i.findById(n),n!==t.getModel().parentId&&i.updateComboTree(t,n,!1))}))}else this.targets.map((function(t){if(e.onlyChangeComboSize)i.updateCombo(t);else{var o=t.getModel();o.comboId&&i.updateComboTree(t,void 0,!1)}}));this.endComparison=!0,this.end(r,t)}}},onDragEnter:function(t){if(this.origin&&this.validationCombo(t)){var e=t.item,i=this.graph;this.activeState&&i.setItemState(e,this.activeState,!0)}},onDragLeave:function(t){if(this.origin&&this.validationCombo(t)){var e=t.item,i=this.graph;this.activeState&&i.setItemState(e,this.activeState,!1)}},onDragEnd:function(t){if(this.targets&&0!==this.targets.length){var e=t.item;this.currentShouldEnd&&this.updatePositions(t);var i=this.getParentCombo(e.getModel().parentId),o=this.graph;i&&this.activeState&&o.setItemState(i,this.activeState,!1),this.end(void 0,t)}},end:function(t,e){var i=this;if(this.origin){var o=this.graph;if(this.delegateShape){var n=o.get("delegateGroup");n.clear(),this.delegateShape=null}if(t&&this.activeState&&o.setItemState(t,this.activeState,!1),!t){var a=o.get("enabledStack")&&this.enableStack,r={before:{nodes:[],edges:[],combos:[].concat(this.get("beforeDragItems"))},after:{nodes:[],edges:[],combos:[]}};this.targets.map((function(t){if(i.onlyChangeComboSize){o.updateCombo(t);var e=t.getModel(),n=e.x,s=e.y,d=e.id;r.after.combos.push({x:n,y:s,id:d}),o.pushStack("update",r)}else o.updateComboTree(t,void 0,a)}))}this.point=[],this.origin=null,this.originPoint=null,this.targets.length=0}},traverse:function(t,e,i){var n=this;if(void 0===i&&(i={}),!1!==e(t,i)&&t){var a=t.get("combos");Object(o["each"])(a,(function(t){n.traverse(t,e,i)}));var r=t.get("nodes");Object(o["each"])(r,(function(t){n.traverse(t,e,i)}))}},updateCombo:function(t,e,i){this.updateSingleItem(t,e,i);var o={};this.traverse(t,(function(t,e){return!t.destroyed&&(t.getEdges().forEach((function(t){return e[t.getID()]=t})),!0)}),o),Object.values(o).forEach((function(t){return t.refresh()}))},updateSingleItem:function(t,e,i){var o=this.origin,n=this.graph,a=t.getModel(),r=t.get("id");this.point[r]||(this.point[r]={x:a.x,y:a.y});var s=e.x-o.x+this.point[r].x,d=e.y-o.y+this.point[r].y;i&&(s+=o.x-e.x,d+=o.y-e.y),n.updateItem(t,{x:s,y:d},!1)},getParentCombo:function(t){var e=this.graph;if(t){var i=e.findById(t);if(i)return i}},updateDelegate:function(t){var e=this.graph;if(this.delegateShape){var i=t.x-this.origin.x+this.originPoint.minX,o=t.y-this.origin.y+this.originPoint.minY;this.delegateShape.attr({x:i,y:o})}else{var n=e.get("delegateGroup"),a=null;a=this.targets.length>1?z(this.targets):this.targets[0].getBBox();var r=a.x,s=a.y,d=a.width,c=a.height,l=a.minX,h=a.minY;this.originPoint={x:r,y:s,width:d,height:c,minX:l,minY:h};var f=Object(g["__assign"])(Object(g["__assign"])({},u["a"].delegateStyle),this.delegateStyle);this.delegateShape=n.addShape("rect",{attrs:Object(g["__assign"])({width:a.width,height:a.height,x:a.x,y:a.y},f),name:"combo-delegate-shape"}),this.delegateShape.set("capture",!1),this.delegate=this.delegateShape}},updateParentCombos:function(){var t=this,e=t.graph,i=t.targets,o={};null===i||void 0===i||i.forEach((function(t){var i=t.getModel().parentId;i&&(o[i]=e.findById(i))})),Object.values(o).forEach((function(t){t&&e.updateCombo(t)}))}},R="dblclick",X=["click","dblclick"],Y={getDefaultCfg:function(){return{trigger:R,relayout:!0}},getEvents:function(){var t,e;return e=X.includes(this.trigger)?this.trigger:R,t={},t["combo:".concat(e)]="onComboClick",t},onComboClick:function(t){var e=t.item,i=this,o=i.graph,n=i.relayout;if(e&&!e.destroyed&&"combo"===e.getType()){var a=e.getModel(),r=a.id;r&&(o.collapseExpandCombo(r),n&&o.get("layout")?o.layout():o.refreshPositions())}}},F=a["a"].isPolygonsIntersect,K=a["a"].pathToPoints,q="shift",G=["drag","shift","ctrl","alt","control"],V=function(t,e){var i,o=t.getKeyShape();if("path"===t.get("type"))i=K(o.attr("path"));else{var n=o.getCanvasBBox();i=[[n.minX,n.minY],[n.maxX,n.minY],[n.maxX,n.maxY],[n.minX,n.maxY]]}return F(e,i)},Z={getDefaultCfg:function(){return{delegateStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},shouldDeselect:void 0,selectedState:"selected",trigger:q,includeEdges:!0,selectedEdges:[],selectedNodes:[]}},getEvents:function(){return G.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=q),"drag"===this.trigger?{dragstart:"onDragStart",drag:"onDragMove",dragend:"onDragEnd","canvas:click":"clearStates"}:{dragstart:"onDragStart",drag:"onDragMove",dragend:"onDragEnd",keyup:"onKeyUp",keydown:"onKeyDown","canvas:click":"clearStates"}},onDragStart:function(t){var e=this.lasso,i=t.item;i||("drag"===this.trigger||this.keydown)&&(this.selectedNodes&&0!==this.selectedNodes.length&&this.clearStates("dragstart"),e||(e=this.createLasso()),this.dragging=!0,this.originPoint={x:t.x,y:t.y},this.points.push(this.originPoint),e.show())},onDragMove:function(t){this.dragging&&("drag"===this.trigger||this.keydown)&&(this.points.push({x:t.x,y:t.y}),this.updateLasso(t))},onDragEnd:function(t){(this.lasso||this.dragging)&&("drag"===this.trigger||this.keydown)&&(this.points.push(this.originPoint),this.getSelectedItems(),this.lasso.remove(!0),this.lasso=null,this.points=[],this.dragging=!1)},getLassoPath:function(){var t=this.points,e=[];return t.length&&(t.forEach((function(t,i){0===i?e.push(["M",t.x,t.y]):e.push(["L",t.x,t.y])})),e.push(["L",t[0].x,t[0].y])),e},clearStates:function(t){void 0===t&&(t="canvas:click");var e=this,i=e.graph,o=e.selectedState,n=e.shouldDeselect,a=i.findAllByState("node",o),r=i.findAllByState("edge",o);n&&!n({action:t,nodes:a,edges:r})||(a.forEach((function(t){return i.setItemState(t,o,!1)})),r.forEach((function(t){return i.setItemState(t,o,!1)}))),this.onDeselect&&this.onDeselect(this.selectedNodes,this.selectedEdges),this.selectedNodes=[],this.selectedEdges=[],i.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[]},select:!1})},getSelectedItems:function(){var t=this,e=this,i=e.graph,o=e.shouldUpdate,n=this.points.map((function(t){return[i.getCanvasByPoint(t.x,t.y).x,i.getCanvasByPoint(t.x,t.y).y]})),a=this.selectedState,r=[],s=[];i.getNodes().forEach((function(e){if(e.isVisible()&&V(e,n)&&o(e,"select",t)){r.push(e);var d=e.getModel();s.push(d.id),i.setItemState(e,a,!0)}}));var d=[];this.includeEdges&&r.forEach((function(e){var n=e.getOutEdges();n.forEach((function(e){if(e.isVisible()){var n=e.getModel(),a=n.source,r=n.target;s.includes(a)&&s.includes(r)&&o(e,"select",t)&&(d.push(e),i.setItemState(e,t.selectedState,!0))}}))})),this.selectedEdges=d,this.selectedNodes=r,this.onSelect&&this.onSelect(r,d),i.emit("nodeselectchange",{selectedItems:{nodes:r,edges:d},select:!0})},createLasso:function(){var t=this,e=t.graph.get("delegateGroup").addShape("path",{attrs:Object(g["__assign"])({path:[]},t.delegateStyle),capture:!1,name:"lasso-shape"});return this.lasso=e,this.delegate=e,this.points=[],e},updateLasso:function(t){var e=this;this.lasso.attr({path:e.getLassoPath()})},onKeyDown:function(t){var e=t.key;e&&(e.toLowerCase()===this.trigger.toLowerCase()?this.keydown=!0:this.keydown=!1)},onKeyUp:function(){this.lasso&&(this.lasso.remove(!0),this.lasso=null,this.points=[],this.dragging=!1),this.keydown=!1}},H="click",J=["click","drag"],Q=void 0,$=["shift","ctrl","control","alt","meta",void 0],tt={getDefaultCfg:function(){return{trigger:H,key:Q,edgeConfig:{},getEdgeConfig:void 0}},getEvents:function(){var t,e=this;return J.indexOf(e.trigger.toLowerCase())>-1||(e.trigger=H),e.key&&-1===$.indexOf(e.key.toLowerCase())&&(e.trigger=Q),"drag"===e.trigger?t={"node:dragstart":"onClick","combo:dragstart":"onClick",drag:"updateEndPoint","node:drop":"onClick","combo:drop":"onClick",dragend:"onDragEnd"}:"click"===e.trigger&&(t={"node:click":"onClick",mousemove:"updateEndPoint","edge:click":"cancelCreating","canvas:click":"cancelCreating","combo:click":"onClick"}),e.key&&(t.keydown="onKeyDown",t.keyup="onKeyUp"),t},onDragEnd:function(t){var e=this;if(!e.key||e.keydown){var i=t.item;i&&i.getID()!==e.source&&"node"===i.getType()||e.cancelCreating({item:e.edge,x:t.x,y:t.y})}},onClick:function(t){var e=this;if(!e.key||e.keydown){var i=t.item,n=e.graph,a=i.getModel(),r=e.getEdgeConfig;if(e.addingEdge&&e.edge){if(!e.shouldEnd(t,e))return;var s=void 0;s=r&&Object(o["isFunction"])(r)?r({source:e.source,target:a.id},e):e.edgeConfig;var d=Object(g["__assign"])({target:a.id},s);if(e.source===a.id&&(d.type="loop"),n.emit("beforecreateedge",{}),n.updateItem(e.edge,d,!1),n.get("enabledStack")){var c=Object(g["__assign"])(Object(g["__assign"])({},e.edge.getModel()),{itemType:"edge"}),l={};l.edges=[c],n.pushStack("add",{before:{},after:l})}n.emit("aftercreateedge",{edge:e.edge}),e.edge.getKeyShape().set("capture",!0),e.edge=null,e.addingEdge=!1}else{if(!e.shouldBegin(t,e))return;s=void 0;s=r&&Object(o["isFunction"])(r)?r({source:a.id,target:a.id},e):e.edgeConfig,e.edge=n.addItem("edge",Object(g["__assign"])({source:a.id,target:a.id},s),!1),e.source=a.id,e.addingEdge=!0,e.edge.getKeyShape().set("capture",!1)}}},updateEndPoint:function(t){var e=this;if(!e.key||e.keydown){e.edge&&e.edge.destroyed&&e.cancelCreating({item:e.edge});var i={x:t.x,y:t.y};e.graph.findById(e.source)?e.addingEdge&&e.edge&&e.graph.updateItem(e.edge,{target:i},!1):e.addingEdge=!1}},cancelCreating:function(t){var e,i,o=this;if(!o.key||o.keydown){var n=o.graph,a=t.item;return o.addingEdge&&(o.edge===a||(null===(i=null===(e=t.target)||void 0===e?void 0:e.isCanvas)||void 0===i?void 0:i.call(e)))?(o.edge&&!o.edge.destroyed&&n.removeItem(o.edge,!1),o.edge=null,void(o.addingEdge=!1)):void 0}},onKeyDown:function(t){var e=this,i=t.key;i&&(i.toLowerCase()===e.key.toLowerCase()?e.keydown=!0:e.keydown=!1)},onKeyUp:function(){var t=this;t.addingEdge&&t.edge&&(t.graph.removeItem(t.edge,!1),t.addingEdge=!1,t.edge=null),this.keydown=!1}},et="ctrl",it=["shift","ctrl","alt","control"],ot="1",nt={getDefaultCfg:function(){return{trigger:et,combinedKey:ot,functionName:"fitView",functionParams:[]}},getEvents:function(){return it.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=et),this.combinedKey===this.trigger&&(this.combinedKey=void 0),{keyup:"onKeyUp",keydown:"onKeyDown"}},onKeyDown:function(t){var e=t.key;if(e){var i=this.trigger.toLowerCase(),o=e.toLowerCase();this.triggerKeydown||(this.triggerKeydown=o===i||"control"===o&&"ctrl"===i||"ctrl"===o&&"control"===i);var n=this.graph;if(!n[this.functionName])return{};if(!this.triggerKeydown||this.combinedKey){var a=this.combinedKey.toLowerCase();this.triggerKeydown&&(o===a||"control"===o&&"ctrl"===a||"ctrl"===o&&"control"===a)&&(this.functionParams&&this.functionParams.length?n[this.functionName].apply(n,this.functionParams):n[this.functionName]())}else this.functionParams&&this.functionParams.length?n[this.functionName].apply(n,this.functionParams):n[this.functionName]()}},onKeyUp:function(){this.brush&&(this.brush.remove(!0),this.brush=null,this.dragging=!1),this.triggerKeydown=!1}},at=["shift","ctrl","alt","control","meta"],rt={getDefaultCfg:function(){return{direction:"both",enableOptimize:!1,zoomKey:"ctrl",scalableRange:0,allowDragOnItem:!0}},getEvents:function(){return this.zoomKey&&-1!==at.indexOf(this.zoomKey)||(this.zoomKey="ctrl"),{wheel:"onWheel"}},onWheel:function(t){var e=this;if(this.allowDrag(t)){var i=this.graph,o=Array.isArray(this.zoomKey)?[].concat(this.zoomKey):[this.zoomKey];o.includes("control")&&o.push("ctrl");var n=o.some((function(e){return t["".concat(e,"Key")]}));if(n){var a=i.get("canvas"),r=a.getPointByClient(t.clientX,t.clientY),s=i.getZoom();t.wheelDelta>0?s+=.05*s:s-=.05*s,i.zoomTo(s,{x:r.x,y:r.y})}else{var d=t.deltaX||t.movementX,c=t.deltaY||t.movementY;!c&&navigator.userAgent.indexOf("Firefox")>-1&&(c=125*-t.wheelDelta/3);var l=this.graph.get("width"),h=this.graph.get("height"),g=this.graph.get("canvas").getCanvasBBox(),u=this.scalableRange,f=this.scalableRange;u<1&&u>-1&&(u*=l,f*=h);var v=g.minX,m=g.maxX,p=g.minY,y=g.maxY;d>0?m<-u?d=0:m-d<-u&&(d=m+u):d<0&&(v>l+u?d=0:v-d>l+u&&(d=v-(l+u))),c>0?y<-f?c=0:y-c<-f&&(c=y+f):c<0&&(p>h+f?c=0:p-c>h+f&&(c=p-(h+f))),"x"===this.get("direction")?c=0:"y"===this.get("direction")&&(d=0),i.translate(-d,-c)}t.preventDefault();var b=this.get("enableOptimize");if(b){var w=this.get("optimizeZoom"),S=this.get("optimized"),x=i.getNodes(),C=i.getEdges(),k=x.length,E=C.length;if(!S){for(var D=0;D<k;D++){var I=x[D];if(!I.destroyed)for(var O=I.get("group").get("children"),M=O.length,B=0;B<M;B++){var j=O[B];j.destoryed||j.get("isKeyShape")||(j.set("ori-visibility",j.get("ori-visibility")||j.get("visible")),j.hide())}}for(var L=0;L<E;L++){var P=C[L];for(O=P.get("group").get("children"),M=O.length,B=0;B<M;B++){j=O[B];j.set("ori-visibility",j.get("ori-visibility")||j.get("visible")),j.hide()}}this.set("optimized",!0)}clearTimeout(this.get("timeout"));var T=setTimeout((function(){var t=i.getZoom(),o=e.get("optimized");if(o){e.set("optimized",!1);for(var n=0;n<k;n++){var a=x[n],r=a.get("group").get("children"),s=r.length;if(t<w){var d=a.getKeyShape(),c=d.get("ori-visibility");c&&d.show()}else for(var l=0;l<s;l++){var h=r[l];c=h.get("ori-visibility");!h.get("visible")&&c&&c&&h.show()}}for(var g=0;g<E;g++){var u=C[g];r=u.get("group").get("children"),s=r.length;if(t<w){d=u.getKeyShape(),c=d.get("ori-visibility");c&&d.show()}else for(l=0;l<s;l++){h=r[l];if(!h.get("visible")){c=h.get("ori-visibility");c&&h.show()}}}}}),100);this.set("timeout",T)}}},allowDrag:function(t){var e,i,n=t.target,a=n&&n.isCanvas&&n.isCanvas();if(Object(o["isBoolean"])(this.allowDragOnItem)&&!this.allowDragOnItem&&!a)return!1;if(Object(o["isObject"])(this.allowDragOnItem)){var r=this.allowDragOnItem,s=r.node,d=r.edge,c=r.combo,l=null===(i=null===(e=t.item)||void 0===e?void 0:e.getType)||void 0===i?void 0:i.call(e);if(!s&&"node"===l)return!1;if(!d&&"edge"===l)return!1;if(!c&&"combo"===l)return!1}return!0}},st={"drag-canvas":h,"zoom-canvas":B,"drag-node":f,"activate-relations":m,"brush-select":x,"click-select":E,"lasso-select":Z,tooltip:P,"edge-tooltip":T,"collapse-expand":_,"drag-combo":U,"collapse-expand-combo":Y,"create-edge":tt,"shortcuts-call":nt,"scroll-canvas":rt};Object(o["each"])(st,(function(t,e){Object(n["i"])(e,t)}))},"6d1e":function(t,e,i){"use strict";var o=i("666a"),n="rgb(95, 149, 255)",a="rgb(255, 255, 255)",r="rgb(0, 0, 0)",s=Object(o["getColorsWithSubjectColor"])(n,a);e["a"]={version:"0.8.23",rootContainerClassName:"root-container",nodeContainerClassName:"node-container",edgeContainerClassName:"edge-container",comboContainerClassName:"combo-container",delegateContainerClassName:"delegate-container",defaultLoopPosition:"top",nodeLabel:{style:{fill:"#000",fontSize:12,textAlign:"center",textBaseline:"middle"},offset:4},defaultNode:{type:"circle",style:{lineWidth:1,stroke:s.mainStroke,fill:s.mainFill},size:20,color:s.mainStroke,linkPoints:{size:8,lineWidth:1,fill:s.activeFill,stroke:s.activeStroke}},nodeStateStyles:{active:{fill:s.activeFill,stroke:s.activeStroke,lineWidth:2,shadowColor:s.mainStroke,shadowBlur:10},selected:{fill:s.selectedFill,stroke:s.selectedStroke,lineWidth:4,shadowColor:s.selectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{fill:s.highlightFill,stroke:s.highlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{fill:s.inactiveFill,stroke:s.inactiveStroke,lineWidth:1},disable:{fill:s.disableFill,stroke:s.disableStroke,lineWidth:1}},edgeLabel:{style:{fill:r,textAlign:"center",textBaseline:"middle",fontSize:12}},defaultEdge:{type:"line",size:1,style:{stroke:s.edgeMainStroke,lineAppendWidth:2},color:s.edgeMainStroke},edgeStateStyles:{active:{stroke:s.edgeActiveStroke,lineWidth:1},selected:{stroke:s.edgeSelectedStroke,lineWidth:2,shadowColor:s.edgeSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:s.edgeHighlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{stroke:s.edgeInactiveStroke,lineWidth:1},disable:{stroke:s.edgeDisableStroke,lineWidth:1}},comboLabel:{style:{fill:r,textBaseline:"middle",fontSize:12},refY:10,refX:10},defaultCombo:{type:"circle",style:{fill:s.comboMainFill,lineWidth:1,stroke:s.comboMainStroke,r:5,width:20,height:10},size:[20,5],color:s.comboMainStroke,padding:[25,20,15,20]},comboStateStyles:{active:{stroke:s.comboActiveStroke,lineWidth:1,fill:s.comboActiveFill},selected:{stroke:s.comboSelectedStroke,lineWidth:2,fill:s.comboSelectedFill,shadowColor:s.comboSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:s.comboHighlightStroke,lineWidth:2,fill:s.comboHighlightFill,"text-shape":{fontWeight:500}},inactive:{stroke:s.comboInactiveStroke,fill:s.comboInactiveFill,lineWidth:1},disable:{stroke:s.comboDisableStroke,fill:s.comboDisableFill,lineWidth:1}},delegateStyle:{fill:"#F3F9FF",fillOpacity:.5,stroke:"#1890FF",strokeOpacity:.9,lineDash:[5,5]},textWaterMarkerConfig:{width:150,height:100,compatible:!1,text:{x:0,y:60,lineHeight:20,rotate:20,fontSize:14,fontFamily:"Microsoft YaHei",fill:"rgba(0, 0, 0, 0.1)",baseline:"Middle"}},imageWaterMarkerConfig:{width:150,height:130,compatible:!1,image:{x:0,y:0,width:30,height:20,rotate:0}},waterMarkerImage:"https://gw.alipayobjects.com/os/s/prod/antv/assets/image/logo-with-text-73b8a.svg"}},"95c2":function(t,e,i){"use strict";var o=i("9ab4"),n=i("0519"),a=i.n(n),r=i("8937"),s=i("0e20"),d=i("adb8"),c=i("dba1"),l=s["a"].radialLayout,h=s["a"].traverseTree,g=function(t){function e(e){var i=t.call(this,e)||this;return i.layoutAnimating=!1,i.set("removeList",[]),i.set("layoutMethod",i.getLayout()),i}return Object(o["__extends"])(e,t),e.prototype.getLayout=function(){var t=this.get("layout");return t?"function"===typeof t?t:(t.type||(t.type="dendrogram"),t.direction||(t.direction="indented"===t.type?"LR":"TB"),t.radial?function(e){var i=a.a[t.type](e,t);return l(i),i}:function(e){return a.a[t.type](e,t)}):null},e.indexOfChild=function(t,e){var i=-1;return Object(r["each"])(t,(function(t,o){if(e===t.id)return i=o,!1})),i},e.prototype.getDefaultCfg=function(){var e=t.prototype.getDefaultCfg.call(this);return e.animate=!0,e},e.prototype.innerAddChild=function(t,e,i){var o=this,n=t.data;n&&(n.x=t.x,n.y=t.y,n.depth=t.depth);var a=o.addItem("node",n,!1);if(e){if(a.set("parent",e),i){var s=e.get("originAttrs");if(s)a.set("originAttrs",s);else{var d=e.getModel();a.set("originAttrs",{x:d.x,y:d.y})}}var c=e.get("children");c?c.push(a):e.set("children",[a]),o.addItem("edge",{source:e.get("id"),target:a.get("id"),id:"".concat(e.get("id"),":").concat(a.get("id"))},!1)}return Object(r["each"])(t.children||[],(function(t){o.innerAddChild(t,a,i)})),o.emit("afteraddchild",{item:a,parent:e}),a},e.prototype.innerUpdateChild=function(t,i,o){var n=this,a=n.findById(t.id);if(a){Object(r["each"])(t.children||[],(function(t){n.innerUpdateChild(t,a,o)}));var s,d,c=a.get("children");if(c){var l=c.length;if(l>0)for(var h=c.length-1;h>=0;h--){var g=c[h].getModel();-1===e.indexOfChild(t.children||[],g.id)&&(n.innerRemoveChild(g.id,{x:t.x,y:t.y},o),c.splice(h,1))}}a.get("originAttrs")&&(s=a.get("originAttrs").x,d=a.get("originAttrs").y);var u=a.getModel();o&&a.set("originAttrs",{x:u.x,y:u.y}),a.set("model",Object.assign(u,t.data)),s===t.x&&d===t.y||a.updatePosition({x:t.x,y:t.y})}else n.innerAddChild(t,i,o)},e.prototype.innerRemoveChild=function(t,e,i){var o=this,n=o.findById(t);if(n)if(Object(r["each"])(n.get("children"),(function(t){o.innerRemoveChild(t.getModel().id,e,i)})),i){var a=n.getModel();n.set("to",e),n.set("originAttrs",{x:a.x,y:a.y}),o.get("removeList").push(n)}else o.removeItem(n,!1)},e.prototype.changeData=function(t,e){void 0===e&&(e=!0);var i=this;this.getNodes().map((function(t){return i.clearItemStates(t)})),this.getEdges().map((function(t){return i.clearItemStates(t)})),e&&this.get("enabledStack")&&this.pushStack("changedata",{before:i.get("originData"),after:t||i.get("data")}),t?(i.data(t),i.render(!1)):i.layout(this.get("fitView"))},e.prototype.changeLayout=function(t){var e=this;e.updateLayout(t)},e.prototype.updateLayout=function(t,e,i,o){void 0===o&&(o=!0);var n=this;if(t&&(o&&this.get("enabledStack")&&this.pushStack("layout",{before:n.get("layout"),after:t}),n.set("layout",t),n.set("layoutMethod",n.getLayout()),n.layout(),e)){var a=i;a||(a="begin"===e?{x:0,y:0}:{x:this.getWidth()/2,y:this.getHeight()/2}),a=this.getPointByCanvas(a.x,a.y);var r=this.getGroup().getMatrix()||[1,0,0,0,1,0,0,0,1];a.x=a.x*r[0]+r[6],a.y=a.y*r[0]+r[7];var s=this.getGroup().getCanvasBBox(),d=s.minX,c=s.maxX,l=s.minY,h=s.maxY,g={x:(d+c)/2,y:(l+h)/2};"begin"===e&&(g.x=d,g.y=l),this.translate(a.x-g.x,a.y-g.y)}},e.prototype.refreshLayout=function(t){var e=this;e.layout(t)},e.prototype.layout=function(t){var e=this,i=this,o=i.get("data"),n=i.get("layoutMethod"),a=i.get("layout"),s=o;if(null===a||void 0===a?void 0:a.excludeInvisibles){o=Object(r["clone"])(i.get("data"));var d={};h(o,(function(t){var i=t.children;if(!(null===i||void 0===i?void 0:i.length))return!0;for(var o=i.length-1;o>=0;o--){var n=e.findById(i[o].id),a=n?!n.isVisible():!1===i[o].visible;a&&(d[t.id]=d[t.id]||[],d[t.id].push({idx:o,child:i.splice(o,1)[0]}))}})),s=n?n(o,i.get("layout")):o,h(s,(function(t){var e=d[t.id];if(null===e||void 0===e?void 0:e.length)for(var i=e.length-1;i>=0;i--){var o=e[i],n=o.idx,a=o.child;t.children.splice(n,0,a)}}))}else s=n?n(o,i.get("layout")):o;var c=i.get("animate");if(i.emit("beforerefreshlayout",{data:o,layoutData:s}),i.emit("beforelayout"),i.innerUpdateChild(s,void 0,c),t){var l=i.get("viewController");l.fitView()}c?i.layoutAnimate(s):(i.refresh(),i.paint()),i.emit("afterrefreshlayout",{data:o,layoutData:s}),i.emit("afterlayout")},e.prototype.addChild=function(t,e,i){void 0===i&&(i=!0);var o=this;o.emit("beforeaddchild",{model:t,parent:e}),Object(r["isString"])(e)||(e=e.get("id"));var n=o.findDataById(e);if(n){n.children||(n.children=[]),n.children.push(t);var a=o.findById(e);a.refresh(),o.changeData(void 0,i)}},e.prototype.updateChildren=function(t,e,i){void 0===i&&(i=!0);var o=this,n=o.findById(e);if(e&&n){var a=o.findDataById(e);a.children=t,n.refresh(),o.changeData(void 0,i)}},e.prototype.updateChild=function(t,i,o){void 0===o&&(o=!0);var n=this;if(i&&n.findById(i)){var a=n.findDataById(i),r=n.findById(t.id);if(a.children||(a.children=[]),r){var s=e.indexOfChild(a.children,t.id);s>-1&&(a.children[s]=t)}else a.children.push(t);var d=n.findById(i);null===d||void 0===d||d.refresh(),n.changeData(void 0,o)}else n.changeData(t,o)},e.prototype.removeChild=function(t,i){void 0===i&&(i=!0);var o,n=this,a=n.findById(t);if(o=a?null===a||void 0===a?void 0:a.get("parent"):n.getNodes().find((function(e){var i=e.getModel().children||[];return!!i.find((function(e){return e.id===t}))})),o&&!o.destroyed){var r=o.get("id"),s=n.findDataById(r),d=s&&s.children||[],c=e.indexOfChild(d,t);d.splice(c,1),o.refresh()}n.changeData(void 0,i)},e.prototype.findDataById=function(t,e){var i=this;if(e||(e=i.get("data")),t===e.id)return e;var o=null;return Object(r["each"])(e.children||[],(function(e){return e.id===t?(o=e,!1):(o=i.findDataById(t,e),!o&&void 0)})),o},e.prototype.layoutAnimate=function(t,e){var i=this,o=this.get("animateCfg");i.emit("beforeanimate",{data:t}),i.getEdges().forEach((function(t){var e=t.get("model");e.sourceAnchor||(e.sourceAnchor=t.get("sourceAnchorIndex"))})),this.get("canvas").animate((function(o){h(t,(function(n){var a=i.findById(n.id);if(a){var r=a.get("originAttrs"),s=a.get("model");if(r||(r={x:s.x,y:s.y},a.set("originAttrs",r)),e){var d=e(a,o,r,t);a.set("model",Object.assign(s,d))}else s.x=r.x+(n.x-r.x)*o,s.y=r.y+(n.y-r.y)*o}return!0})),Object(r["each"])(i.get("removeList"),(function(t){var e=t.getModel(),i=t.get("originAttrs"),n=t.get("to");e.x=i.x+(n.x-i.x)*o,e.y=i.y+(n.y-i.y)*o})),i.refreshPositions()}),{duration:o.duration,easing:o.ease,callback:function(){Object(r["each"])(i.getNodes(),(function(t){t.set("originAttrs",null)})),Object(r["each"])(i.get("removeList"),(function(t){i.removeItem(t,!1)})),i.set("removeList",[]),o.callback&&o.callback(),i.emit("afteranimate",{data:t})},delay:o.delay})},e.prototype.stopLayoutAnimate=function(){this.get("canvas").stopAnimate(),this.emit("layoutanimateend",{data:this.get("data")}),this.layoutAnimating=!1},e.prototype.isLayoutAnimating=function(){return this.layoutAnimating},e.prototype.render=function(t){void 0===t&&(t=!0);var e=this,i=e.get("data");if(!i||!Object(r["isObject"])(i)||!Object.keys(i).length)throw new Error("data must be defined first");e.clear(),t&&this.get("enabledStack")&&this.clearStack(),e.emit("beforerender"),e.layout(this.get("fitView")),e.emit("afterrender")},e.prototype.save=function(){return this.get("data")},e.prototype.data=function(e){t.prototype.data.call(this,e),this.set("originData",Object(d["a"])(e))},e}(c["a"]);e["a"]=g},dba1:function(t,e,i){"use strict";var o=i("9ab4"),n=i("53c8"),a=i("bfb1"),r=i("3822"),s=i("e897"),d=i("8937"),c=i("7c8a"),l=i("6d1e"),h=i("7e24"),g=r["h"].cloneEvent,u=r["h"].isViewportChanged,f=function(t){function e(e){var i=t.call(this,e)||this;return i.extendEvents=[],i.dragging=!1,i.mousedown=!1,i.preItem=null,i.destroy(),i.graph=e,i.destroyed=!1,i.initEvents(),i}return Object(o["__extends"])(e,t),e.prototype.initEvents=function(){var t=this,e=t.graph,i=t.extendEvents,o=void 0===i?[]:i,n=e.get("canvas"),a=n.get("el"),r=Object(d["wrapBehavior"])(this,"onCanvasEvents"),s=Object(d["wrapBehavior"])(this,"onExtendEvents"),l=Object(d["wrapBehavior"])(this,"onWheelEvent");n.off("*").on("*",r),this.canvasHandler=r,o.push(Object(c["a"])(a,"wheel",l)),"undefined"!==typeof window&&(o.push(Object(c["a"])(window,"keydown",s)),o.push(Object(c["a"])(window,"keyup",s)),o.push(Object(c["a"])(window,"focus",s))),this.resetHandler&&e.off("afterchangedata",this.resetHandler),this.resetHandler=Object(d["wrapBehavior"])(this,"resetStatus"),e.on("afterchangedata",this.resetHandler)},e.getItemRoot=function(t){while(t&&!t.get("item"))t=t.get("parent");return t},e.prototype.onCanvasEvents=function(t){var i=this,o=this.graph,n=o.get("canvas"),a=t.target,r=t.type;switch(r){case"drag":this.onCanvasEvents(Object.assign({},t,{type:"mousemove"}));break;case"dragend":this.onCanvasEvents(Object.assign({},t,{type:"mouseup"}));break;case"mousedown":this.mousedown=!0;break;case"mouseup":setTimeout((function(){return i.mousedown=!1}));break;case"click":if(!this.mousedown)return;break;default:break}t.canvasX=t.x,t.canvasY=t.y;var s={x:t.canvasX,y:t.canvasY},d=o.get("group"),c=d.getMatrix();if(c||(c=[1,0,0,0,1,0,0,0,1]),u(c)&&(s=o.getPointByClient(t.clientX,t.clientY)),t.x=s.x,t.y=s.y,t.currentTarget=o,a===n)return"mousemove"!==r&&"mouseleave"!==r||this.handleMouseMove(t,"canvas"),t.target=n,t.item=null,o.emit(r,t),void o.emit("canvas:".concat(r),t);var l=e.getItemRoot(a);if(l){var h=l.get("item");if(!h.destroyed){var g=h.getType();if(t.target=a,t.item=h,t.canvasX===t.x&&t.canvasY===t.y){var f=o.getCanvasByPoint(t.x,t.y);t.canvasX=f.x,t.canvasY=f.y}t.name&&!t.name.includes(":")?(o.emit("".concat(g,":").concat(r),t),o.emit(r,t)):t.name&&o.emit(t.name,t),"dragstart"===r&&(this.dragging=!0),"dragend"===r&&(this.dragging=!1),"mousemove"===r&&this.handleMouseMove(t,g)}}else o.emit(r,t)},e.prototype.onExtendEvents=function(t){this.graph.emit(t.type,t)},e.prototype.onWheelEvent=function(t){Object(d["isNil"])(t.wheelDelta)&&(t.wheelDelta=-t.detail),this.graph.emit("wheel",t)},e.prototype.handleMouseMove=function(t,e){var i=this,o=i.graph,n=i.preItem,a=o.get("canvas"),r=t.target===a?null:t.item;t=g(t),n&&n!==r&&!n.destroyed&&(t.item=n,this.emitCustomEvent(n.getType(),"mouseleave",t),this.dragging&&this.emitCustomEvent(n.getType(),"dragleave",t)),r&&n!==r&&(t.item=r,this.emitCustomEvent(e,"mouseenter",t),this.dragging&&this.emitCustomEvent(e,"dragenter",t)),this.preItem=r},e.prototype.emitCustomEvent=function(t,e,i){i.type=e,this.graph.emit("".concat(t,":").concat(e),i)},e.prototype.resetStatus=function(){this.mousedown=!1,this.dragging=!1,this.preItem=null},e.prototype.destroy=function(){var t=this,e=t.graph,i=t.canvasHandler,o=t.extendEvents,n=e.get("canvas");n.off("*",i),Object(d["each"])(o,(function(t){t.remove()})),this.resetStatus(),this.extendEvents.length=0,this.canvasHandler=null,this.resetHandler=null,this.destroyed=!0},e}(r["a"]),v=f,m=i("c5b7"),p=i("c7ce"),y=i("b062"),b=i("54cab");function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}var S=function(t){return setTimeout(t,16)},x=function(t){return clearTimeout(t)},C={requestAnimationFrame:function(t){var e="undefined"!==typeof window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame)||S;return e(t)},cancelAnimationFrame:function(t){var e="undefined"!==typeof window&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame)||x;return e(t)}},k=["fruchterman","gForce"],E=["force","grid","circular"],D=function(t){function e(e){var i=t.call(this,e)||this;return i.graph=e,i.layoutCfg=e.get("layout")||{},i.layoutType=i.getLayoutType(),i.worker=null,i.workerData={},i.initLayout(),i}return Object(o["__extends"])(e,t),e.prototype.initLayout=function(){},e.prototype.getWorker=function(){return this.worker||("undefined"===typeof Worker?this.worker=null:this.worker=Object(p["a"])(this.layoutCfg.workerScriptURL)),this.worker},e.prototype.stopWorker=function(){var t=this.workerData;this.worker&&(this.worker.terminate(),this.worker=null,t.requestId&&(C.cancelAnimationFrame(t.requestId),t.requestId=null),t.requestId2&&(C.cancelAnimationFrame(t.requestId2),t.requestId2=null))},e.prototype.execLayoutMethod=function(t,e){var i=this;return new Promise((function(n,a){return Object(o["__awaiter"])(i,void 0,void 0,(function(){var i,s,d,c,l,h,g,u,f,v;return Object(o["__generator"])(this,(function(o){switch(o.label){case 0:if(i=this.graph,!i||i.get("destroyed"))return[2];s=t.type,t.onLayoutEnd=function(){i.emit("aftersublayout",{type:s}),n()},s&&this.isGPU&&L(s)&&(s="".concat(s,"-gpu")),r["h"].isForce(s)?(d=t.onTick,c=t.animate,l=void 0===c&&("force"===s||"force2"===s),f=function(){d&&d(),(c||l)&&i.refreshPositions()},t.tick=f):"comboForce"!==s&&"comboCombined"!==s||(t.comboTrees=i.get("comboTrees")),h=!1;try{g=new m["a"][s](t),this.layoutMethods[e]&&this.layoutMethods[e].destroy(),this.layoutMethods[e]=g}catch(p){a()}return h=g.enableTick,h&&(u=t.onTick,f=function(){u&&u(),i.refreshPositions()},g.tick=f),v=this.filterLayoutData(this.data,t),j(v,e),g.init(v),i.emit("beforesublayout",{type:s}),[4,g.execute()];case 1:return o.sent(),g.isCustomLayout&&t.onLayoutEnd&&t.onLayoutEnd(),[2]}}))}))}))},e.prototype.updateLayoutMethod=function(t,e){var i=this;return new Promise((function(n,a){return Object(o["__awaiter"])(i,void 0,void 0,(function(){var i,a,s,d,c,l,h;return Object(o["__generator"])(this,(function(o){switch(o.label){case 0:return i=this.graph,a=null===e||void 0===e?void 0:e.type,e.onLayoutEnd=function(){i.emit("aftersublayout",{type:a}),n()},r["h"].isForce(a)&&(s=e.onTick,d=e.animate,c=void 0===d&&("force"===a||"force2"===a),l=function(){null===s||void 0===s||s(),(d||c)&&i.refreshPositions()},e.tick=l),h=this.filterLayoutData(this.data,e),t.init(h),t.updateCfg(e),i.emit("beforesublayout",{type:a}),[4,t.execute()];case 1:return o.sent(),t.isCustomLayout&&e.onLayoutEnd&&e.onLayoutEnd(),[2]}}))}))}))},e.prototype.layout=function(t){var e,i=this,n=this.graph;if(n&&!n.get("destroyed")){this.data=this.setDataFromGraph();var a=this.data,r=a.nodes,s=a.hiddenNodes;if(!r)return!1;var d=n.get("width"),c=n.get("height"),l={};Object.assign(l,{width:d,height:c,center:[d/2,c/2]},this.layoutCfg),this.layoutCfg=l;var h=l.type,g=!1;null===(e=this.layoutMethods)||void 0===e||e.forEach((function(t){var e;return g=!!(null===(e=t.nodes)||void 0===e?void 0:e.length)||g}));var u=this.destoryLayoutMethods();n.emit("beforelayout");var f=Promise.resolve();g&&h&&1===(null===u||void 0===u?void 0:u.length)&&u[0]===h?this.tweakInit():f=this.initPositions(l.center,r);var v=this.initPositions(l.center,s);v.then(),this.isGPU=P(l,h);var m=l.onLayoutEnd,p=l.layoutEndFormatted,y=l.adjust;if(p||(l.layoutEndFormatted=!0,l.onAllLayoutEnd=function(){return Object(o["__awaiter"])(i,void 0,void 0,(function(){return Object(o["__generator"])(this,(function(t){switch(t.label){case 0:return m&&m(r),this.refreshLayout(),y&&l.pipes?[4,this.adjustPipesBox(this.data,y)]:[3,2];case 1:t.sent(),this.refreshLayout(),t.label=2;case 2:return n.emit("afterlayout"),[2]}}))}))}),this.stopWorker(),l.workerEnabled&&this.layoutWithWorker(this.data,t))return!0;var b=!1;return l.type?(b=!0,f=f.then((function(){return Object(o["__awaiter"])(i,void 0,void 0,(function(){return Object(o["__generator"])(this,(function(t){switch(t.label){case 0:return[4,this.execLayoutMethod(l,0)];case 1:return[2,t.sent()]}}))}))}))):l.pipes&&(b=!0,l.pipes.forEach((function(t,e){f=f.then((function(){return Object(o["__awaiter"])(i,void 0,void 0,(function(){return Object(o["__generator"])(this,(function(i){switch(i.label){case 0:return[4,this.execLayoutMethod(t,e)];case 1:return[2,i.sent()]}}))}))}))}))),b?f.then((function(){l.onAllLayoutEnd&&l.onAllLayoutEnd(),t&&t()})).catch((function(t){})):(n.refreshPositions(),null===t||void 0===t||t()),!1}},e.prototype.tweakInit=function(){var t=this,e=t.data,i=t.graph,o=e.nodes,n=e.edges;if(null===o||void 0===o?void 0:o.length){var a={};o.forEach((function(t){var e=t.x,i=t.y;isNaN(e)||isNaN(i)||(a[t.id]={x:e,y:i},t.mass=t.mass||2)})),n.forEach((function(t){var e=t.source,i=t.target,o=a[e],n=a[i];!o&&n?a[e]={x:n.x+80*(Math.random()-.5),y:n.y+80*(Math.random()-.5)}:!n&&o&&(a[i]={x:o.x+80*(Math.random()-.5),y:o.y+80*(Math.random()-.5)})}));var r=i.get("width"),s=i.get("height");o.forEach((function(t){var e=a[t.id]||{x:r/2+20*(Math.random()-.5),y:s/2+20*(Math.random()-.5)};t.x=e.x,t.y=e.y}))}},e.prototype.initWithPreset=function(t,e){var i=this;return new Promise((function(n,a){return Object(o["__awaiter"])(i,void 0,void 0,(function(){var i,a,r,s,d,c,l;return Object(o["__generator"])(this,(function(o){switch(o.label){case 0:return i=this,a=i.layoutCfg,r=i.data,s=a.preset,(null===s||void 0===s?void 0:s.type)&&m["a"][null===s||void 0===s?void 0:s.type]?(d=P(s,s.type),c=d?"".concat(s.type,"-gpu"):s.type,l=new m["a"][c](s),delete a.preset,l.init(r),[4,l.execute()]):(null===e||void 0===e||e(),n(),[2,!1]);case 1:return o.sent(),null===t||void 0===t||t(),n(),[2,!0]}}))}))}))},e.prototype.layoutWithWorker=function(t,e){var i=this,o=this,n=o.layoutCfg,a=o.graph,r=this.getWorker(),s=this.workerData;if(!r)return!1;s.requestId=null,s.requestId2=null,s.currentTick=null,s.currentTickData=null,a.emit("beforelayout");var d=Promise.resolve(),c=!1;if(n.type)c=!0,d=d.then((function(){return i.runWebworker(r,t,n)}));else if(n.pipes){c=!0;for(var l=function(e){d=d.then((function(){return i.runWebworker(r,t,e)}))},h=0,g=n.pipes;h<g.length;h++){var u=g[h];l(u)}}return c&&d.then((function(){n.onAllLayoutEnd&&n.onAllLayoutEnd(),null===e||void 0===e||e()})).catch((function(t){})),!0},e.prototype.runWebworker=function(t,e,i){var o=this,n=this.isGPU,a=this.filterLayoutData(e,i),r=a.nodes,s=a.edges,d=document.createElement("canvas"),c=n&&"undefined"!==typeof window&&window.navigator&&!navigator["gpu"]&&"OffscreenCanvas"in window&&"transferControlToOffscreen"in d,l=M(i,(function(t){return"function"!==typeof t}));if(c){var h=d.transferControlToOffscreen();l.type="".concat(l.type,"-gpu"),t.postMessage({type:y["a"].GPURUN,nodes:r,edges:s,layoutCfg:l,canvas:h},[h])}else t.postMessage({type:y["a"].RUN,nodes:r,edges:s,layoutCfg:l});return new Promise((function(e,n){t.onmessage=function(t){o.handleWorkerMessage(e,n,t,a,i)}}))},e.prototype.handleWorkerMessage=function(t,e,i,o,n){var a=this,r=a.graph,s=a.workerData,d=i.data,c=d.type,l=function(){n.onTick&&n.onTick()};switch(c){case y["a"].TICK:s.currentTick=d.currentTick,s.currentTickData=d,s.requestId||(s.requestId=C.requestAnimationFrame((function(){O(o,d),r.refreshPositions(),l(),d.currentTick===d.totalTicks?t():s.currentTick===d.totalTicks&&(s.requestId2=C.requestAnimationFrame((function(){O(o,s.currentTickData),r.refreshPositions(),s.requestId2=null,l(),t()}))),s.requestId=null})));break;case y["a"].END:null==s.currentTick&&(O(o,d),t());break;case y["a"].GPUEND:null==s.currentTick&&(B(o,d),t());break;case y["a"].ERROR:e();break;default:e();break}},e.prototype.updateLayoutCfg=function(t){var e=this,i=this,n=i.graph,a=i.layoutMethods;if(n&&!n.get("destroyed")){var r=t.disableTriggerLayout,s=Object(o["__rest"])(t,["disableTriggerLayout"]),c=Object(d["mix"])({},this.layoutCfg,s);if(this.layoutCfg=c,!r)if(null===a||void 0===a?void 0:a.length){if(this.data=this.setDataFromGraph(),this.stopWorker(),!s.workerEnabled||!this.layoutWithWorker(this.data,null)){n.emit("beforelayout");var l=Promise.resolve(),h=!1;1===(null===a||void 0===a?void 0:a.length)?(h=!0,l=l.then((function(){return Object(o["__awaiter"])(e,void 0,void 0,(function(){return Object(o["__generator"])(this,(function(t){switch(t.label){case 0:return[4,this.updateLayoutMethod(a[0],c)];case 1:return[2,t.sent()]}}))}))}))):(null===a||void 0===a?void 0:a.length)&&(h=!0,a.forEach((function(t,i){var n=c.pipes[i];l=l.then((function(){return Object(o["__awaiter"])(e,void 0,void 0,(function(){return Object(o["__generator"])(this,(function(e){switch(e.label){case 0:return[4,this.updateLayoutMethod(t,n)];case 1:return[2,e.sent()]}}))}))}))}))),h&&l.then((function(){c.onAllLayoutEnd&&c.onAllLayoutEnd()})).catch((function(t){}))}}else this.layout()}},e.prototype.adjustPipesBox=function(t,e){var i=this;return new Promise((function(o){var n=t.nodes;(null===n||void 0===n?void 0:n.length)||o(),E.includes(e)||o();var a={center:i.layoutCfg.center,nodeSize:function(t){return Math.max(t.height,t.width)},preventOverlap:!0,onLayoutEnd:function(){}},r=i.getLayoutBBox(n),s=r.groupNodes,c=r.layoutNodes,l=Object(d["clone"])(c);a.onLayoutEnd=function(){null===c||void 0===c||c.forEach((function(t,e){var i,o,n,a=t.x-(null===(i=l[e])||void 0===i?void 0:i.x),r=t.y-(null===(o=l[e])||void 0===o?void 0:o.y);null===(n=s[e])||void 0===n||n.forEach((function(t){t.x+=a,t.y+=r}))})),o()};var h=new m["a"][e](a);h.layout({nodes:c})}))},e.prototype.destroy=function(){this.destoryLayoutMethods();var t=this.worker;t&&(t.terminate(),this.worker=null),this.destroyed=!0,this.graph.set("layout",void 0),this.layoutCfg=void 0,this.layoutType=void 0,this.layoutMethods=void 0,this.graph=null},e}(r["c"]),I=D;function O(t,e){for(var i=t.nodes,o=e.nodes,n=i.length,a=0;a<n;a++){var r=i[a];r.x=o[a].x,r.y=o[a].y}}function M(t,e){var i={};return t&&"object"===w(t)?(Object.keys(t).forEach((function(o){t.hasOwnProperty(o)&&e(t[o])&&(i[o]=t[o])})),i):t}function B(t,e){for(var i=t.nodes,o=e.vertexEdgeData,n=i.length,a=0;a<n;a++){var r=i[a],s=o[4*a],d=o[4*a+1];r.x=s,r.y=d}}function j(t,e){var i;if(null===(i=null===t||void 0===t?void 0:t.nodes)||void 0===i?void 0:i.length){var o=t.nodes;o.forEach((function(t){t.layoutOrder=e}))}}function L(t){return k.includes(t)}function P(t,e){var i=e;e&&"gpu"===e.split("-")[1]&&(i=e.split("-")[0],t.gpuEnabled=!0);var o=!1;return t.gpuEnabled&&(o=!0,Object(b["gpuDetector"])().webgl||(o=!1)),o&&!L(i)&&(o=!1),o}var T=s["a"].transform,A="svg",W=function(t){function e(e){var i=t.call(this,e)||this,o=i.get("defaultNode");return o||i.set("defaultNode",{type:"circle"}),o.type||(o.type="circle",i.set("defaultNode",o)),i.destroyed=!1,i}return Object(o["__extends"])(e,t),e.prototype.initLayoutController=function(){var t=new I(this);this.set({layoutController:t})},e.prototype.initEventController=function(){var t=new v(this);this.set({eventController:t})},e.prototype.initCanvas=function(){var t=this.get("container");if("string"===typeof t&&(t=document.getElementById(t),this.set("container",t)),!t)throw new Error("invalid container");var e=t.clientWidth,i=t.clientHeight,o=this.get("width")||e,r=this.get("height")||i;this.get("width")||this.get("height")||(this.set("width",e),this.set("height",i));var s,d=this.get("renderer");if(d===A)s=new a["Canvas"]({container:t,width:o,height:r});else{var c={container:t,width:o,height:r},l=this.get("pixelRatio");l&&(c.pixelRatio=l,window.devicePixelRatio=l),s=new n["Canvas"](c)}this.set("canvas",s)},e.prototype.initPlugins=function(){var t=this;Object(d["each"])(t.get("plugins"),(function(e){!e.destroyed&&e.initPlugin&&e.initPlugin(t)}))},e.prototype.downloadImageWatermark=function(t,e,i,n){return Object(o["__awaiter"])(this,void 0,void 0,(function(){var a,r,s;return Object(o["__generator"])(this,(function(o){switch(o.label){case 0:return a=t.style.backgroundImage,r=a.slice(5,a.length-2),s=new Image,s.src=r,[4,new Promise((function(t){s.onload=function(){var o=e.createPattern(s,"repeat");e.rect(0,0,i,n),e.fillStyle=o,e.fill(),t("")}}))];case 1:return o.sent(),[2]}}))}))},e.prototype.asyncToDataUrl=function(t,e,i,n,a,r){var s=this,d=document.querySelector(".g6-graph-watermarker"),c=this.get("canvas"),l=c.getRenderer(),h=r||c.get("el"),g="";t||(t="image/png"),setTimeout((function(){return Object(o["__awaiter"])(s,void 0,void 0,(function(){var r,s,c,u,f,v,m,p,y,b;return Object(o["__generator"])(this,(function(o){switch(o.label){case 0:return"svg"!==l?[3,1]:(r=h.cloneNode(!0),s=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),c=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",s),c.replaceChild(r,c.documentElement),u=(new XMLSerializer).serializeToString(c),g="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(u)),[3,4]);case 1:return f=void 0,v=h.getContext("2d"),m=n||this.get("width"),p=a||this.get("height"),y=void 0,d?[4,this.downloadImageWatermark(d,v,m,p)]:[3,3];case 2:o.sent(),o.label=3;case 3:if(e){b="undefined"!==typeof window?window.devicePixelRatio:1;try{f=v.getImageData(0,0,m*b,p*b),y=v.globalCompositeOperation,v.globalCompositeOperation="destination-over",v.fillStyle=e,v.fillRect(0,0,m,p)}catch(w){}}g=h.toDataURL(t),e&&(v.clearRect(0,0,m,p),v.putImageData(f,0,0),v.globalCompositeOperation=y),o.label=4;case 4:return i&&i(g),[2]}}))}))}),16)},e.prototype.toDataURL=function(t,e){var i=this.get("canvas"),o=i.getRenderer(),n=i.get("el");t||(t="image/png");var a="";if("svg"===o){var r=n.cloneNode(!0),s=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),d=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",s);d.replaceChild(r,d.documentElement);var c=(new XMLSerializer).serializeToString(d);a="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(c))}else{var l=void 0,h=n.getContext("2d"),g=Math.max(this.get("width"),500),u=Math.max(this.get("height"),500),f=void 0;if(e){var v="undefined"!==typeof window&&window.devicePixelRatio||1;try{l=h.getImageData(0,0,g*v,u*v),f=h.globalCompositeOperation,h.globalCompositeOperation="destination-over",h.fillStyle=e,h.fillRect(0,0,g,u)}catch(m){}}a=n.toDataURL(t),e&&(h.clearRect(0,0,g,u),h.putImageData(l,0,0),h.globalCompositeOperation=f)}return a},e.prototype.toFullDataURL=function(t,e,i){var o=this.get("group").getCanvasBBox(),r=o.height,s=o.width,l=this.get("renderer"),h=Object(c["b"])('<div id="virtual-image"></div>'),g=i?i.backgroundColor:void 0,u=i?i.padding:void 0;u?Object(d["isNumber"])(u)&&(u=[u,u,u,u]):u=[0,0,0,0];var f=r+u[0]+u[2],v=s+u[1]+u[3],m={container:h,height:f,width:v,quickHit:!0},p="svg"===l?new a["Canvas"](m):new n["Canvas"](m),y=this.get("group"),b=y.clone(),w=Object(d["clone"])(b.getMatrix());w||(w=[1,0,0,0,1,0,0,0,1]);var S=(o.maxX+o.minX)/2,x=(o.maxY+o.minY)/2;w=T(w,[["t",-S,-x],["t",s/2+u[3],r/2+u[0]]]),b.resetMatrix(),b.setMatrix(w),p.add(b);var C=p.get("el"),k="";e||(e="image/png"),setTimeout((function(){if("svg"===l){var i=C.cloneNode(!0),o=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),n=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",o);n.replaceChild(i,n.documentElement);var a=(new XMLSerializer).serializeToString(n);k="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(a))}else{var r=void 0,s=C.getContext("2d"),d=void 0;if(g){var c="undefined"!==typeof window?window.devicePixelRatio:1;try{r=s.getImageData(0,0,v*c,f*c),d=s.globalCompositeOperation,s.globalCompositeOperation="destination-over",s.fillStyle=g,s.fillRect(0,0,v,f)}catch(h){}}k=C.toDataURL(e),g&&(s.clearRect(0,0,v,f),s.putImageData(r,0,0),s.globalCompositeOperation=d)}t&&t(k)}),16)},e.prototype.downloadFullImage=function(t,e,i){var o=this,r=this.get("group").getCanvasBBox(),s=r.height,l=r.width,g=this.get("renderer"),u=Object(c["b"])('<div id="virtual-image"></div>'),f=document.querySelector(".g6-graph-watermarker"),v=i?i.backgroundColor:void 0,m=i?i.padding:void 0;m?Object(d["isNumber"])(m)&&(m=[m,m,m,m]):m=[0,0,0,0];var p=s+m[0]+m[2],y=l+m[1]+m[3];if(f){var b=this.get("graphWaterMarker").cfg||{},w=b.width,S=b.height;p=Math.ceil(p/S)*S,y=Math.ceil(y/w)*w}var x={container:u,height:p,width:y},C="svg"===g?new a["Canvas"](x):new n["Canvas"](x),k=this.get("group"),E=Object(h["a"])(k),D=Object(d["clone"])(E.getMatrix());D||(D=[1,0,0,0,1,0,0,0,1]);var I=(r.maxX+r.minX)/2,O=(r.maxY+r.minY)/2;D=T(D,[["t",-I,-O],["t",l/2+m[3],s/2+m[0]]]),E.resetMatrix(),E.setMatrix(D),C.add(E);var M=C.get("el");e||(e="image/png"),this.asyncToDataUrl(e,v,(function(i){var n=document.createElement("a"),a=(t||"graph")+("svg"===g?".svg":".".concat(e.split("/")[1]));o.dataURLToImage(i,g,n,a);var r=document.createEvent("MouseEvents");r.initEvent("click",!1,!1),n.dispatchEvent(r)}),y,p,M)},e.prototype.downloadImage=function(t,e,i){var o=this,n=this;n.stopAnimate();var a=n.get("canvas"),r=a.getRenderer();e||(e="image/png");var s=(t||"graph")+("svg"===r?".svg":".".concat(e.split("/")[1])),d=document.createElement("a");n.asyncToDataUrl(e,i,(function(t){o.dataURLToImage(t,r,d,s);var e=document.createEvent("MouseEvents");e.initEvent("click",!1,!1),d.dispatchEvent(e)}))},e.prototype.dataURLToImage=function(t,e,i,o){if(t&&"data:"!==t&&"undefined"!==typeof window)if(window.Blob&&window.URL&&"svg"!==e){var n=t.split(","),a="";if(n&&n.length>0){var r=n[0].match(/:(.*?);/);r&&r.length>=2&&(a=r[1])}var s=atob(n[1]),d=s.length,c=new Uint8Array(d);while(d--)c[d]=s.charCodeAt(d);var l=new Blob([c],{type:a});window.navigator.msSaveBlob?window.navigator.msSaveBlob(l,o):i.addEventListener("click",(function(){i.download=o,i.href=window.URL.createObjectURL(l)}))}else i.addEventListener("click",(function(){i.download=o,i.href=t}))},e.prototype.addPlugin=function(t){var e=this;t.destroyed||(e.get("plugins").push(t),t.initPlugin(e))},e.prototype.removePlugin=function(t){var e=this.get("plugins"),i=e.indexOf(t);i>=0&&(t.destroyPlugin(),e.splice(i,1))},e.prototype.setImageWaterMarker=function(t,e){void 0===t&&(t=l["a"].waterMarkerImage);var i=this.get("container");Object(d["isString"])(i)&&(i=document.getElementById(i)),i.style.position||(i.style.position="relative");var o=this.get("graphWaterMarker"),a=Object(d["deepMix"])({},l["a"].imageWaterMarkerConfig,e),r=a.width,s=a.height,c=a.compatible,h=a.image;if(!t){var g=c?i:document.querySelector(".g6-graph-watermarker");return g&&(g.style.cssText=void 0),void(o&&o.clear())}if(o)o.clear();else{var u={container:i,width:r,height:s,capture:!1},f=this.get("pixelRatio");f&&(u.pixelRatio=f,window.devicePixelRatio=f),o=new n["Canvas"](u),this.set("graphWaterMarker",o)}o.get("el").style.display="none";var v=o.get("context"),m=h.rotate,p=h.x,y=h.y;v.rotate(-m*Math.PI/180);var b=new Image;b.crossOrigin="anonymous",b.src=t,b.onload=function(){if(v.drawImage(b,p,y,h.width,h.height),v.rotate(m*Math.PI/180),c)i.style.cssText="background-image: url(".concat(o.get("el").toDataURL("image/png"),");background-repeat:repeat;");else{var t=document.querySelector(".g6-graph-watermarker");t||(t=document.createElement("div"),t.className="g6-graph-watermarker"),t.className="g6-graph-watermarker",o.destroyed||(t.style.cssText="background-image: url(".concat(o.get("el").toDataURL("image/png"),");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:-1;"),i.appendChild(t))}}},e.prototype.setTextWaterMarker=function(t,e){var i=this.get("container");Object(d["isString"])(i)&&(i=document.getElementById(i)),i.style.position||(i.style.position="relative");var o=this.get("graphWaterMarker"),a=Object(d["deepMix"])({},l["a"].textWaterMarkerConfig,e),r=a.width,s=a.height,c=a.compatible,h=a.text;if(!(null===t||void 0===t?void 0:t.length)){var g=c?i:document.querySelector(".g6-graph-watermarker");return g&&(g.style.cssText=void 0),void(o&&o.clear())}if(o)o.clear();else{var u={container:i,width:r,height:s,capture:!1},f=this.get("pixelRatio");f&&(u.pixelRatio=f,window.devicePixelRatio=f),o=new n["Canvas"](u),this.set("graphWaterMarker",o)}o.get("el").style.display="none";var v=o.get("context"),m=h.rotate,p=h.fill,y=h.fontFamily,b=h.fontSize,w=h.baseline,S=h.x,x=h.y,C=h.lineHeight;v.rotate(-m*Math.PI/180),v.font="".concat(b,"px ").concat(y),v.fillStyle=p,v.textBaseline=w;for(var k=Object(d["isString"])(t)?[t]:t,E=k.length-1;E>=0;E--)v.fillText(k[E],S,x+E*C);if(v.rotate(m*Math.PI/180),c)i.style.cssText="background-image: url(".concat(o.get("el").toDataURL("image/png"),");background-repeat:repeat;");else{var D=document.querySelector(".g6-graph-watermarker");D||(D=document.createElement("div"),D.className="g6-graph-watermarker"),D.style.cssText="background-image: url(".concat(o.get("el").toDataURL("image/png"),");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:99;"),i.appendChild(D)}},e.prototype.destroy=function(){var e,i,o,n;Object(d["each"])(this.get("plugins"),(function(t){t.destroyPlugin()}));var a=this.get("tooltips");if(a)for(var r=0;r<a.length;r++){var s=a[r];if(s){var c=s.parentElement;c&&c.removeChild(s)}}null===(e=this.get("eventController"))||void 0===e||e.destroy(),null===(i=this.get("layoutController"))||void 0===i||i.destroy(),null===(o=this.get("graphWaterMarker"))||void 0===o||o.destroy(),null===(n=document.querySelector(".g6-graph-watermarker"))||void 0===n||n.remove(),t.prototype.destroy.call(this)},e}(r["b"]);e["a"]=W}}]);