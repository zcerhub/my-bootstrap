(window["jsonpPaas4"]=window["jsonpPaas4"]||[]).push([["app~d7e22661"],{"0e04":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"g-page"},[t("el-page-header",{staticStyle:{"margin-bottom":"20px"},attrs:{content:"部署记录"},on:{back:e.goBack}}),t("search-form",{attrs:{searchConfig:e.searchConfig},on:{onSearch:e.onSearch}}),t("button-list",{attrs:{data:e.buttonList}}),t("tableView",{attrs:{loading:e.tableConfig.loading,operateObj:e.tableConfig.operate,columns:e.tableConfig.columns,tableData:e.tableConfig.tableData,isPage:e.tableConfig.isPage,total:e.tableConfig.pagination.totalCount,rowKey:"id",operateSlice:2,currentPage:e.tableConfig.pagination.pageNo,pageSize:e.tableConfig.pagination.pageSize},on:{"update:currentPage":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:current-page":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},changePage:e.changePage}})],1)},o=[],i=a("c7eb"),r=a("5530"),s=a("1da1"),c=a("23a6"),l=a("ec41"),d=a("ff51"),u={name:"deploy-record",components:{},mixins:[],props:{},data:function(){return{buttonList:[],searchConfig:{searchData:{cluster:"",machineIp:""},searchItem:[{prop:"cluster",label:"集群",type:"input"},{prop:"machineIp",label:"机器",type:"input"}],rules:{}},tableConfig:{loading:!1,pagination:{pageNo:1,pageSize:10,totalCount:0},tableData:[],columns:[{prop:"cluster",label:"集群"},{prop:"machineIp",label:"机器ip"},{prop:"machinePort",label:"机器端口"},{prop:"deployStatus",label:"部署状态"},{prop:"deployPath",label:"部署路径"},{prop:"content",label:"内容"},{prop:"detail",label:"详情"},{prop:"createDate",label:"部署时间"}],operate:{width:160,list:[]}},rowData:null}},computed:{},watch:{},created:function(){this.getList()},mounted:function(){},methods:{goBack:function(){this.$router.go(-1)},getList:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){var a,n,o;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableConfig.loading=!0,t.prev=1,a={pageNo:e.tableConfig.pagination.pageNo,pageSize:e.tableConfig.pagination.pageSize,requestObject:Object(r["a"])({componentType:"2"},e.searchConfig.searchData)},t.next=5,Object(c["f"])(a);case 5:n=t.sent,o=Object(l["a"])(n,"data.data"),e.tableConfig.tableData=Object(d["a"])(o)?o:[],e.tableConfig.pagination.totalCount=Object(l["a"])(n,"data.totalCount")||0,t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1);case 14:e.tableConfig.loading=!1;case 15:case"end":return t.stop()}}),t,null,[[1,11]])})))()},onSearch:function(e){this.tableConfig.pagination.pageNo=1,this.getList()},changePage:function(e,t){e&&(this.tableConfig.pagination.pageNo=e),t&&(this.tableConfig.pagination.pageNo=1,this.tableConfig.pagination.pageSize=t),this.getList()}}},p=u,h=a("2877"),f=Object(h["a"])(p,n,o,!1,null,"2d427a66",null);t["default"]=f.exports},2234:function(e,t,a){"use strict";a.r(t);a("99af"),a("b0c0");var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mode-page"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"main-content",attrs:{"element-loading-text":"加载中,请稍候......"}},[t("div",{staticClass:"main-left"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickAddNode}},[e._v("新增服务")]),t("el-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")]),!e.loading&&e.linksData.length>0?t("G6Dagre",{attrs:{"chart-data":e.chartData,height:"500px",width:"100%"},on:{"click-node":e.clickNode}}):t("el-empty",{attrs:{description:"暂无数据"}})],1),t("div",{staticClass:"main-right"},[t("el-descriptions",{staticClass:"margin-top",attrs:{title:"集群:".concat(e.baseInfo.name||""),column:2,size:"small"}},[t("template",{slot:"extra"},[t("el-button",{attrs:{type:"text",size:"small"},on:{click:e.refresh}},[e._v("刷新")])],1),e.currentNode?t("el-descriptions-item",{attrs:{label:"单元名称"}},[e._v(" "+e._s(e.currentNode.unitName)+" ")]):e._e()],2),e.currentNode?[t("el-descriptions",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingNode,expression:"loadingNode"}],staticClass:"mt-10",staticStyle:{"padding-top":"15px","border-top":"1px solid #c6c6c6"},attrs:{title:"服务:".concat(e.currentNode.value,":").concat(e.currentNode.port),column:2,size:"small"}},[t("el-descriptions-item",{attrs:{label:"运行状态",span:2,"label-style":{lineHeight:"28px"},"content-style":{lineHeight:"28px"}}},[e._v(" "+e._s(e._f("F_registerInstanceStatusOptions")(e.currentNode.status))+" "),"1"===e.currentNode.status?t("el-button",{staticClass:"ml-10",attrs:{size:"mini",round:"",plain:"",type:"danger"},on:{click:function(t){return e.clickStop()}}},[e._v(" 停止 ")]):t("el-button",{staticClass:"ml-10",attrs:{type:"primary",size:"mini",round:"",plain:""},on:{click:function(t){return e.clickStart()}}},[e._v(" 启动 ")])],1),t("el-descriptions-item",{attrs:{label:"部署路径"}},[t("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.currentNode.deployPath,expression:"currentNode.deployPath"}],attrs:{size:"mini"}},[e._v(e._s(e.currentNode.deployPath))])],1)],1),t("el-divider"),t("button-list",{attrs:{data:e.buttonList}})]:e._e()],2)]),e.addmasternode?t("DialogAddNode",{attrs:{"cluster-id":e.clusterId,"node-type":e.nodeType_add,"row-data":e.currentNode,refresh:e.refresh},model:{value:e.addmasternode,callback:function(t){e.addmasternode=t},expression:"addmasternode"}}):e._e(),e.startLogShow?t("DrawerPrismjsLog",{attrs:{show:e.startLogShow,rowData:e.currentNode},on:{"update:show":function(t){e.startLogShow=t}}}):e._e()],1)},o=[],i=a("c7eb"),r=a("1da1"),s=a("5530"),c=(a("14d9"),a("d3b7"),a("1bf2"),a("3ca3"),a("159b"),a("ddb0"),a("e749")),l=a("5370"),d=a("85cd"),u=a("4c3e"),p=a("ff51"),h=a("bc59"),f={filters:{F_registerInstanceStatusOptions:function(e){return Object(u["a"])(e,"registerInstanceStatusOptions")}},components:{G6Dagre:c["default"],DialogAddNode:d["default"],DrawerPrismjsLog:function(){return Promise.all([a.e("chunk-7ef164fc"),a.e("chunk-0c4b216e")]).then(a.bind(null,"c6aa"))}},data:function(){return{title:"",baseInfo:{},loading:!1,loadingNode:!1,buttonList:[{label:"移除服务",click:this.clickNodeDelete},{label:"服务日志",click:this.clickStartLog}],chartData:{edges:[],nodes:[]},addmasternode:!1,currentNode:null,currentQueryNode:m(),linksData:[],nodeType_add:0,startLogShow:!1}},computed:{clusterId:function(){return this.$route.query.id},query:function(){return this.$route.query}},created:function(){this.getDetail(),this.baseInfo.name=this.query.name,this.baseInfo.machineroomName=this.query.machineroomName,this.baseInfo.node=this.query.node},methods:{clickStartLog:function(){this.title="服务日志",this.startLogShow=!0},clickStart:function(){var e=this;this.title="启动日志",this.loadingNode=!0,Object(l["h"])({id:this.currentNode.id}).then((function(t){200===t.code&&(e.$message.success("启动成功"),e.startLogShow=!0)})).finally((function(){e.loadingNode=!1,e.refresh()})).catch((function(e){}))},clickStop:function(){var e=this;this.title="停止日志",this.loadingNode=!0,Object(l["g"])({id:this.currentNode.id}).then((function(t){200===t.code&&(e.$message.success("停止成功"),e.startLogShow=!0)})).finally((function(){e.loadingNode=!1,e.refresh()})).catch((function(e){}))},getDetail:function(){var e=this;this.loading=!0,this.currentNode=null,Object(l["f"])(this.$route.query.id).then((function(t){if(t){var a=Object(p["a"])(null===t||void 0===t?void 0:t.data)?t.data:[];e.linksData=a;var n=[],o=[];a.forEach((function(e){var t;"1"===e.isMaster?t="main":"0"===e.isMaster&&(t="cong");var a=Object(u["a"])(e.status,"registerInstanceStatusOptions",["value","fill"]);n.push(Object(s["a"])(Object(s["a"])({},e),{},{value:e.hostIp,comboId:t,label:"".concat(e.hostIp,":").concat(e.port),style:{fill:a}}))})),e.chartData.nodes=n,e.chartData.edges=o}})).catch((function(e){})).finally((function(){e.loading=!1}))},clickAddNode:function(){this.nodeType_add=0,this.addmasternode=!0},clickNodeDelete:function(){var e=this;return Object(r["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1!=e.currentNode.status){t.next=3;break}return e.clickConfirmDelete(),t.abrupt("return");case 3:return t.next=5,e.$confirm("确定要移除".concat(e.currentNode.hostIp,":").concat(e.currentNode.port,"吗?"),{type:"warning"}).catch((function(e){}));case 5:a=t.sent,"confirm"===a&&Object(l["b"])(e.currentNode.id).then((function(t){e.refresh(),e.$message.success("移除成功")})).catch((function(e){}));case 8:case"end":return t.stop()}}),t)})))()},clickConfirmDelete:function(){var e=this;return Object(r["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$confirm("节点正在运行,确认删除吗?","提示",{type:"warning"}).catch((function(){}));case 2:a=t.sent,"confirm"===a&&Object(l["c"])(e.currentNode.id).then((function(t){e.refresh(),e.$message.success("移除成功")})).catch((function(e){}));case 4:case"end":return t.stop()}}),t)})))()},clickNode:function(e){this.currentNode=e},refresh:function(){this.getDetail()}}};function m(e){var t={pid:"",usedMemory:"",usedCpuSys:"",keys:"",clients:"",expires:"",flags:""};return e&&Reflect.ownKeys(t).forEach((function(a){Object(h["a"])(e,a)&&(t[a]=e[a])})),Object.assign(t,e)}var g=f,b=(a("3724"),a("2877")),v=Object(b["a"])(g,n,o,!1,null,"12076c50",null);t["default"]=v.exports},2733:function(e,t,a){},"2a08":function(e,t,a){"use strict";a("5938")},3724:function(e,t,a){"use strict";a("44c4")},"39dd":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("search-form",{attrs:{searchConfig:e.searchConfig},on:{"enter-search":e.onEnterSearch,onSearch:e.onSearch}}),t("button-list",{attrs:{data:e.buttonList}}),t("tableView",{ref:"tableView",attrs:{loading:e.tableConfig.loading,operateObj:e.tableConfig.operate,columns:e.tableConfig.columns,tableData:e.tableConfig.tableData,total:e.tableConfig.pagination.total,rowKey:"id",isPage:e.tableConfig.isPage,currentPage:e.tableConfig.pagination.pageNo,pageSize:e.tableConfig.pagination.pageSize},on:{"update:currentPage":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:current-page":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},changePage:e.changePage,operate:e.getIndex}}),e.showAdd?t("AddAndEdit",{attrs:{rowData:e.rowData,refresh:e.getList},model:{value:e.showAdd,callback:function(t){e.showAdd=t},expression:"showAdd"}}):e._e(),e.showInit?t("DialogServiceInit",{attrs:{rowData:e.rowData,refresh:e.getList},model:{value:e.showInit,callback:function(t){e.showInit=t},expression:"showInit"}}):e._e(),e.showExample?t("DialogDockingExample",{attrs:{rowData:e.rowData},model:{value:e.showExample,callback:function(t){e.showExample=t},expression:"showExample"}}):e._e()],1)},o=[],i=a("ade3"),r=a("5530"),s=(a("7db0"),a("14d9"),a("b0c0"),a("d3b7"),a("99af"),function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:e.isEdit?"编辑":"新增",visible:e.show,size:"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",staticClass:"cluster-form",attrs:{"label-position":e.labelPosition,"label-width":"110px",model:e.formData,rules:e.rules}},[t("el-form-item",{attrs:{label:"服务集群名称",prop:"name"}},[t("el-input",{staticClass:"w-100",attrs:{placeholder:"请输入服务集群名称",maxlength:"30","show-word-limit":""},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),t("el-form-item",{attrs:{label:"地区",prop:"cityId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择地区"},on:{change:e.changeCityId},model:{value:e.formData.cityId,callback:function(t){e.$set(e.formData,"cityId",t)},expression:"formData.cityId"}},e._l(e.csMixCity,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"数据中心",prop:"roomId"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择数据中心"},on:{change:e.changeRoomId},model:{value:e.formData.roomId,callback:function(t){e.$set(e.formData,"roomId",t)},expression:"formData.roomId"}},e._l(e.roomList,(function(e){return t("el-option",{key:e.id,attrs:{label:"".concat(e.machineRoomName,"(").concat(e.machineRoomCode,")"),value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"数据源类型",prop:"dbType"}},[t("el-radio",{attrs:{label:"0"},model:{value:e.formData.dbType,callback:function(t){e.$set(e.formData,"dbType",t)},expression:"formData.dbType"}},[e._v("当前管控")]),t("el-radio",{attrs:{label:"1"},model:{value:e.formData.dbType,callback:function(t){e.$set(e.formData,"dbType",t)},expression:"formData.dbType"}},[e._v("自定义")])],1),"1"===e.formData.dbType?[t("el-form-item",{attrs:{label:"数据库地址",prop:"dbUrl"}},[t("el-input",{attrs:{type:"textarea",rows:4},model:{value:e.formData.dbUrl,callback:function(t){e.$set(e.formData,"dbUrl",t)},expression:"formData.dbUrl"}})],1),t("el-form-item",{attrs:{label:"数据库驱动",prop:"dbDriver"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择"},model:{value:e.formData.dbDriver,callback:function(t){e.$set(e.formData,"dbDriver",t)},expression:"formData.dbDriver"}},e._l(e.dictcommon_dbDriver,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"数据库用户名",prop:"dbUser"}},[t("el-input",{attrs:{placeholder:"数据库用户名","auto-complete":"new-password"},model:{value:e.formData.dbUser,callback:function(t){e.$set(e.formData,"dbUser",t)},expression:"formData.dbUser"}})],1),t("el-form-item",{attrs:{label:"数据库密码",prop:"dbPassword"}},[t("el-input",{attrs:{placeholder:"请输入数据库密码","auto-complete":"new-password","show-password":!0},model:{value:e.formData.dbPassword,callback:function(t){e.$set(e.formData,"dbPassword",t)},expression:"formData.dbPassword"}})],1)]:e._e()],2),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)}),c=[],l=a("c7eb"),d=a("1da1"),u=(a("b64b"),a("159b"),a("59b0")),p=a("1f97"),h=a("bc59"),f=a("ff51"),m=a("1b62"),g=a("934b"),b=a("80f3"),v=a("fbd2"),y=a("61f7"),w=a("4879"),D=m["a"].CommonSelectCreaterMix;function C(e){var t={id:"",name:"",cityId:"",roomId:"",dbType:"0",dbUrl:"",dbDriver:"",dbUser:"",dbPassword:"",ip:"",port:"",dbname:""};return e&&Object.keys(t).forEach((function(a){Object(h["a"])(e,a)&&(t[a]=e[a])})),t}var k={name:"AddAndEdit",components:{},mixins:[D(["csMixCity"])],model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:null},refresh:Function},data:function(){return{dict_unitType:w["g"],opts_units:[],dictcommon_dbDriver:b["b"].options,regTypeOptions:p["e"],loading:!1,roomList:[],labelPosition:"right",formData:C(),rules:{name:[{required:!0,message:"请输入服务集群名称",trigger:"blur"},{validator:y["e"],trigger:"blur"}],cityId:[{required:!0,message:"请选择地区",trigger:"change"}],roomId:[{required:!0,message:"请选择机房",trigger:"change"}],registerType:[{required:!0,message:"请选择注册中心类型",trigger:"change"}],registerAddress:[{required:!0,message:"请输入注册中心地址",trigger:"blur"}],dbType:[{required:!0,message:"请选择数据源类型",trigger:"blur"}],dbUrl:[{required:!0,message:"请输入数据库地址",trigger:"blur"}],dbDriver:[{required:!0,message:"请选择数据库驱动",trigger:"blur"}],dbUser:[{required:!0,message:"请输入数据库用户名",trigger:"blur"}],dbPassword:[{required:!0,message:"请输入数据库密码",trigger:"blur"}],ip:[{required:!0,message:"请输入数据库ip",trigger:"blur"}],port:[{required:!0,message:"请输入数据库端口",trigger:"blur"}],dbname:[{required:!0,message:"请输入数据库名",trigger:"blur"}]}}},computed:{isEdit:function(){var e;return Boolean(null===(e=this.rowData)||void 0===e?void 0:e.id)}},watch:{},created:function(){},mounted:function(){this.isEdit&&(this.formData=C(this.rowData),this.getRoom(),this.getUnits())},methods:{changeDriver:function(){var e=this.formData,t=e.ip,a=e.port,n=e.dbname,o=e.dbDriver;t&&a&&n?"com.mysql.cj.jdbc.Driver"===o?this.formData.dbUrl="jdbc:mysql://".concat(t,":").concat(a,"/").concat(n,"?autoReconnect=true&useUnicode=true&characterEncoding=utf-8&useSSL=false&serverTimezone=GMT%2B8"):"oracle.jdbc.driver.OracleDriver"===o?this.formData.dbUrl="jdbc:oracle:thin:@".concat(t,":").concat(a,":").concat(n):"dm.jdbc.driver.DmDriver"===o?this.formData.dbUrl="jdbc:dm://".concat(t,":").concat(a,"/").concat(n,"?useUnicode=true&characterEncoding=utf-8&useSSL=false"):"org.qianbase.Driver"===o?this.formData.dbUrl="jdbc:qianbase://".concat(t,":").concat(a,"/").concat(n):"org.mariadb.jdbc.Driver"===o?this.formData.dbUrl=" jdbc:mariadb://".concat(t,":").concat(a,"/").concat(n,"?autoReconnect=true&useUnicode=true&characterEncoding=utf-8&useSSL=false&serverTimezone=GMT%2B8"):"org.postgresql.Driver"===o&&(this.formData.dbUrl="jdbc:postgresql://".concat(t,":").concat(a,"/").concat(n)):this.formData.dbUrl=""},changeCityId:function(){this.roomList=[],this.formData.roomId="",this.opts_units=[],this.getRoom()},getRoom:function(){var e=this,t={cityId:this.formData.cityId};Object(v["d"])(t).then((function(t){e.roomList=Object(f["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]}))},changeRoomId:function(e){this.getUnits()},changeUnitType:function(){this.getUnits()},getUnits:function(){var e=this,t=this.formData,a=t.roomId,n=t.unitType;this.opts_units=[],a&&n&&Object(g["b"])({machineRoomId:a,unitType:n}).then((function(t){e.opts_units=Object(f["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).catch((function(e){}))},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate(function(){var t=Object(d["a"])(Object(l["a"])().mark((function t(a){var n;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a&&(n=Object(r["a"])({},e.formData),"0"===n.dbType&&(delete n.dbUrl,delete n.dbDriver,delete n.dbUser,delete n.dbPassword),e.loading=!0,e.isEdit?Object(u["k"])(n).then((function(t){200===t.code&&(e.$message({type:"success",message:t.msg}),e.$emit("change",!1),e.refresh())})):(delete n.id,Object(u["e"])(n).then((function(t){200===t.code&&(e.$message({type:"success",message:"新增成功"}),e.$emit("change",!1),e.refresh())})).catch((function(e){})).finally((function(){e.loading=!1}))));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},I=k,O=(a("9ee6"),a("2877")),S=Object(O["a"])(I,s,c,!1,null,"20169750",null),x=S.exports,j=(a("498a"),function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"服务初始化",visible:e.visible,size:"medium","append-to-body":!0,"close-on-click-modal":!1,loading:e.loading,loadingOptions:e.loadingOptions},on:{close:e.clickCancel}},[t("el-button",{on:{click:e.clickAdd}},[e._v("添加")]),t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"0",rules:e.rules}},[t("el-table",{attrs:{data:e.formData.tableData,"row-key":"id"}},[t("el-table-column",{attrs:{label:"机器信息",prop:"machineId",align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.$index,o=a.row;return[t("el-form-item",{key:"machineId"+n,attrs:{prop:"tableData."+n+".machineId",rules:e.rules.machineId}},[t("el-select",{staticStyle:{width:"100%"},attrs:{loading:e.machineListLoading,placeholder:"请选择机器",size:"mini",filterable:""},on:{change:function(t){return e.changeIp(t,o)}},model:{value:o.machineId,callback:function(t){e.$set(o,"machineId",t)},expression:"row.machineId"}},e._l(e.machineList,(function(a){return t("el-option",{key:a.id,staticClass:"el-option-box",attrs:{label:"".concat(a.hostIp,"(").concat(a.hostSshAccount,")"),value:a.id}},[t("ul",{staticClass:"el-option-ul-between"},[t("li",[e._v(e._s(a.hostIp))]),t("li",[e._v(e._s(a.hostSshAccount))])])])})),1)],1)]}}])}),t("el-table-column",{attrs:{label:"端口",prop:"port",align:"left",width:"160"},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.$index,o=a.row;return[t("el-form-item",{key:"port"+n,attrs:{label:"",prop:"tableData."+n+".port",rules:e.rules.port}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"mini","controls-position":"right",min:0,max:65535,placeholder:"端口"},model:{value:o.port,callback:function(t){e.$set(o,"port",t)},expression:"row.port"}})],1)]}}])}),t("el-table-column",{attrs:{label:"路径",prop:"deployPath",align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.$index,o=a.row;return[t("el-form-item",{key:"deployPath"+n,attrs:{prop:"tableData."+n+".deployPath",rules:e.rules.deployPath}},[t("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入路径",size:"mini"},model:{value:o.deployPath,callback:function(t){e.$set(o,"deployPath","string"===typeof t?t.trim():t)},expression:"row.deployPath"}})],1)]}}])}),t("el-table-column",{attrs:{label:"操作",prop:"actions",width:"80"},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.$index,o=a.row;return[t("el-form-item",[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.clickDelete(n,o)}}},[e._v("删除")])],1)]}}])})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)}),_=[],N=a("3835"),q=(a("d81d"),a("a434"),a("dd69"),a("5c8a")),$={components:{},model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:null},refresh:Function},data:function(){var e=this;return{machineListLoading:!1,machineList:[],props:{lazy:!0,lazyLoad:function(t,a){var n=t.level;switch(n){case 0:Object(g["b"])({machineRoomId:e.rowData.roomId,unitType:"1"}).then((function(e){var t=[];Object(f["a"])(null===e||void 0===e?void 0:e.data)&&(t=e.data.map((function(e){return{label:e.unitName,value:e.id}}))),a(t)})).catch((function(e){a([])}));break;case 1:Object(g["d"])(t.value).then((function(e){var t=[];Object(f["a"])(null===e||void 0===e?void 0:e.data)&&(t=e.data.map((function(e){return{label:"".concat(e.hostIp,"(").concat(e.hostSshAccount,")"),value:e.id,leaf:!0}}))),a(t)})).catch((function(e){a([])}))}}},formData:{tableData:[{deployPath:"",machineId:"",unitId:"",port:10001,hostIp:"",switch:!1,cascaders:[]}]},rules:{machineId:[{required:!0,message:"请选择机器",trigger:"change"}],port:[{required:!0,message:"请输入端口",trigger:"change"}],deployPath:[{required:!0,message:"请输入部署路径",trigger:"change"}]},loading:!1,loadingOptions:{text:""},opts_utils:[]}},computed:{visible:{get:function(){return this.show},set:function(e){this.$emit("change",!1)}}},watch:{},created:function(){},mounted:function(){this.getIps()},methods:{changeCascaders:function(e,t,a){var n=Object(N["a"])(e,2);t.unitId=n[0],t.machineId=n[1];var o=this.$refs["cascaderRef_".concat(a)],i=null===o||void 0===o?void 0:o.getCheckedNodes();if(i&&i.length>0){var r=i[0]||{},s=r.data,c=void 0===s?{}:s,l=(null===c||void 0===c?void 0:c.deploymentPath)||"";this.$set(t,"hostIp",c.hostIp),l?this.$set(t,"deployPath",l+"/seq-server"):this.$set(t,"deployPath","")}},changeUtil:function(){},getIps:function(){var e=this;this.machineListLoading=!0,Object(v["h"])().then((function(t){e.machineList=Object(f["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).catch((function(e){})).finally((function(){e.machineListLoading=!1}))},changeIp:function(e,t){var a=this.machineList.find((function(t){return t.id===e}));if(a){this.$set(t,"hostIp",a.hostIp);var n=a.deploymentPath;n?this.$set(t,"deployPath",n+"/seq-server"):this.$set(t,"deployPath","")}},clickAdd:function(){this.formData.tableData.push({deployPath:"",machineId:"",unitId:"",port:10001,hostIp:"",switch:!1,cascaders:[]})},clickDelete:function(e,t){this.formData.tableData.length>1?this.formData.tableData.splice(e,1):this.$message.warning("至少添加一条机器")},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){e.loading=!0,e.loadingOptions.text="正在进行环境检测,请稍后";var a=Object(q["a"])(e.formData.tableData);a.forEach((function(e){delete e.cascaders,e.switch||delete e.unitId,delete e.switch}));var n={clusterId:e.rowData.id,seqServiceNodeList:a};Object(u["a"])(n).then((function(t){200===t.code&&(e.loadingOptions.text="环境检测通过,正在进行初始化",e.loading=!0,Object(u["g"])(n).then((function(t){200===t.code&&(e.$message.success("初始化完毕"),e.$emit("change",!1),e.refresh())})).catch((function(t){e.loadingOptions.text=t,e.loading=!1})).finally((function(){e.loading=!1})))})).catch((function(t){e.loading=!1,e.loadingOptions.text=t}))}}))}}},L=$,P=Object(O["a"])(L,j,_,!1,null,"04646e1b",null),z=P.exports,E=a("ec41"),T=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"han-dialog-limit",attrs:{title:"对接示例",visible:e.visible,size:"medium","append-to-body":!0,"close-on-click-modal":!1,top:"10vh",width:"1000px"},on:{close:e.clickCancel}},[t("h3",[e._v(" 1.引入SDK "),t("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.formData.yaml1,expression:"formData.yaml1",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopySuccess,expression:"onCopySuccess",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onCopyError,expression:"onCopyError",arg:"error"}],attrs:{type:"text"}},[e._v(" 复制 ")])],1),t("yaml-editor",{staticClass:"yaml-editor",model:{value:e.formData.yaml1,callback:function(t){e.$set(e.formData,"yaml1",t)},expression:"formData.yaml1"}}),t("h3",[e._v(" 2.引入配置文件 "),t("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.formData.yaml2,expression:"formData.yaml2",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopySuccess,expression:"onCopySuccess",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onCopyError,expression:"onCopyError",arg:"error"}],attrs:{type:"text"}},[e._v(" 复制 ")])],1),t("yaml-editor",{staticClass:"yaml-editor",model:{value:e.formData.yaml2,callback:function(t){e.$set(e.formData,"yaml2",t)},expression:"formData.yaml2"}}),t("h3",[e._v(" 3.调用方法 "),t("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.formData.yaml3,expression:"formData.yaml3",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopySuccess,expression:"onCopySuccess",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onCopyError,expression:"onCopyError",arg:"error"}],attrs:{type:"text"}},[e._v(" 复制 ")])],1),t("yaml-editor",{staticClass:"yaml-editor",model:{value:e.formData.yaml3,callback:function(t){e.$set(e.formData,"yaml3",t)},expression:"formData.yaml3"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},R=[],U=a("08da"),A=a("a1ed"),B="\n<dependency>\n    <groupId>dap.paas</groupId>\n        <artifactId>dap-paas-spring-seq-client</artifactId>\n    <version>4.2-SNAPSHOT</version>\n</dependency>\n";function M(e){var t=e||{},a=(t.sdkName,t.serverName),n=void 0===a?"":a,o=t.serverUrls,i=void 0===o?"":o,r=t.tenantId,s="####序列SDK相关配置\n  dap:\n    #序列配置\n    sequence:\n      #客户端名称、应用名称\n      clientName: app-name\n      #集群名称\n      seqClusterName: ".concat(n,"\n      # 集群下所有server的地址信息\n      urls: ").concat(i,"\n      #租户编号\n      tenantId: ").concat(r);return s}var F='\n/**\n * 引入Client 类\n */\n@Autowired(required = false)\nprivate SequenceGeneratorClient sequenceGeneratorClient;\n\n/**\n *根据序列编号获取全局唯一ID序\n */\n@RequestMapping(value = "getSequenceCode/{seqCode}", method = RequestMethod.GET)\npublic String test(@PathVariable("seqCode") String seqCode) throws Exception {\n    String sequence = sequenceGeneratorClient.getStringSequence(seqCode);\n    return sequence;\n}\n\n/**\n *根据序列编号获取全局唯一ID序\n */\n@RequestMapping(value = "getBigIntegerSequence/{seqCode}", method = RequestMethod.GET)\npublic Object getBigIntegerSequence(@PathVariable("seqCode") String seqCode) throws Exception {\n    BigInteger sequence = sequenceGeneratorClient.getBigIntegerSequence(seqCode);\n    return sequence;\n}\n\n/**\n * 获取每日切换序列\n */\n@RequestMapping(value = "getDaySwitchSequence/{seqCode}", method = RequestMethod.GET)\npublic String getDaySwitchSequence(@PathVariable("seqCode") String seqCode) throws Exception {\n    String sequence = sequenceGeneratorClient.getDaySwitchSequence(seqCode, new Date());\n    return sequence;\n}\n\n/**\n * 雪花算法获取全局唯一id\n *\n * @return\n */\n@RequestMapping(value = "getSnowFlake", method = RequestMethod.GET)\npublic String getSnowFlake() {\n    String sequence = sequenceGeneratorClient.getSnowFlake();\n    return sequence;\n}\n\n',G={components:{YamlEditor:U["a"],JavaEditor:A["a"]},mixins:[],model:{prop:"show",event:"change"},props:{show:Boolean,rowData:{type:Object,default:null}},data:function(){return{formData:{yaml1:B,yaml2:M({tenantId:this.rowData.tenantId}),yaml3:F}}},computed:{visible:{get:function(){return this.show},set:function(e){this.$emit("change",!1)}}},watch:{},created:function(){this.getDetail()},mounted:function(){},methods:{getDetail:function(){var e,t,a=this;null!==(e=this.rowData)&&void 0!==e&&e.id&&Object(u["d"])(null===(t=this.rowData)||void 0===t?void 0:t.id).then((function(e){a.formData.yaml2=M(Object(r["a"])({tenantId:a.rowData.tenantId},e.data))})).catch((function(e){}))},clickCancel:function(){this.$emit("change",!1)},onCopySuccess:function(e){this.$message.success("复制成功")},onCopyError:function(e){this.$message.success("复制失败")}}},V=G,K=Object(O["a"])(V,T,R,!1,null,"1507c2d4",null),H=K.exports,W=Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])({mixins:[],components:{AddAndEdit:x,DialogServiceInit:z,DialogDockingExample:H}},"mixins",[]),"data",(function(){this.$createElement;return{clusterId:"",rowData:null,showAdd:!1,showInit:!1,showExample:!1,buttonList:[{label:"新增",type:"add",click:this.addInfo}],tableConfig:{loading:!1,pagination:{pageNo:1,pageSize:10,total:0},tableData:[],columns:[{prop:"name",label:"集群名称",align:"center"},{prop:"cityName",label:"省、市",align:"center"},{prop:"machineName",label:"数据中心",align:"center",render:function(e,t){var a=t.row;return e("span",[a.machineName,"(",a.machineRoomCode,")"])}},{prop:"node",label:"服务数量",align:"center"},{prop:"status",label:"集群状态",align:"center",render:function(e,t){var a=t.row,n=p["b"].find((function(e){return e.value===a.status}));return n?e("hubaryDot",{attrs:{text:n.label,status:n.status}}):e("span")}}],operate:{width:220,list:[{label:"服务初始化",id:"click_init",isShow:function(e){return 0==e.node}},{label:"服务管理",id:"click_manage",isShow:function(e){return e.node>0}},{label:"编辑",id:"edit"},{label:"删除",id:"delete"},{label:"一键启动",id:"start_up",isShow:function(e){return"0"===e.status}},{label:"一键停止",id:"stop",isShow:function(e){return"1"===e.status}},{label:"对接示例",id:"docking_example"}]}},searchConfig:{searchData:{name:""},searchItem:[{type:"input",label:"集群名称",prop:"name"}],rules:{}}}})),"computed",{}),"watch",{}),"mounted",(function(){this.onSearch()})),"methods",{onEnterSearch:function(e,t){},getList:function(){var e=this,t={pageSize:this.tableConfig.pagination.pageSize,pageNo:this.tableConfig.pagination.pageNo,requestObject:Object(r["a"])({},this.searchConfig.searchData)};this.tableConfig.loading=!0,Object(u["i"])(t).then((function(t){var a=Object(E["a"])(t,"data.data");e.tableConfig.tableData=Object(f["a"])(a)?a:[],e.tableConfig.pagination.total=Object(E["a"])(t,"data.totalCount")})).catch((function(e){})).finally((function(){e.tableConfig.loading=!1}))},addInfo:function(){this.showAdd=!0,this.rowData=null},clickDeployRecord:function(){this.$router.push({path:"/sequence-service-manage/deploy-record"})},onSearch:function(e){this.tableConfig.pagination.pageNo=1,this.getList()},changePage:function(e,t){e&&(this.tableConfig.pagination.pageNo=e),t&&(this.tableConfig.pagination.pageNo=1,this.tableConfig.pagination.pageSize=t),this.getList()},getIndex:function(e){var t=this,a=(e.index,e.row),n=e.operate;switch(this.clusterId=this.searchConfig.searchData.clusterId,this.rowData=a,n.id){case"edit":this.showAdd=!0;break;case"delete":this.$confirm("确定要删除【".concat(a.name,"】吗?"),{type:"warning"}).then((function(){Object(u["c"])(a.id).then((function(e){t.$message.success("删除成功"),t.getList()})).catch((function(e){}))})).catch((function(e){}));break;case"click_init":this.showInit=!0;break;case"click_manage":this.$router.push({path:"/sequence-service-manage/node-manage",query:{id:a.id,name:a.name,machineroomName:a.machineName,machineRoomId:a.roomId,node:a.node}});break;case"start_up":this.$confirm("确定要启动【".concat(a.name,"】吗?")).then((function(){var e={id:a.id};Object(u["j"])(e).then((function(e){200===e.code&&(t.$message.success("启动成功"),t.getList())})).catch((function(e){})).finally((function(){}))}));break;case"stop":this.$confirm("确定要停止【".concat(a.name,"】吗?")).then((function(){var e={id:a.id};Object(u["b"])(e).then((function(e){200===e.code&&(t.$message.success("停止成功"),t.getList())})).catch((function(e){})).finally((function(){}))}));break;case"docking_example":this.showExample=!0;break}}}),J=W,Q=Object(O["a"])(J,n,o,!1,null,"2ca95021",null);t["default"]=Q.exports},"44c4":function(e,t,a){},5938:function(e,t,a){},"7dbf":function(e,t,a){},"85cd":function(e,t,a){"use strict";a.r(t);a("99af"),a("498a");var n=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"新增服务",visible:e.visible,size:"small","append-to-body":!0,"close-on-click-modal":!1,loadingOptions:e.loadingOptions,loading:e.loading},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"120px",rules:e.rules}},[t("el-form-item",{attrs:{label:"机器",prop:"machineId"}},[t("el-select",{staticClass:"w-100",attrs:{loading:e.machineListLoading,size:"mini",placeholder:"请选择机器",filterable:""},on:{change:e.changeIp},model:{value:e.formData.machineId,callback:function(t){e.$set(e.formData,"machineId",t)},expression:"formData.machineId"}},e._l(e.machineList,(function(a){return t("el-option",{key:a.id,staticClass:"el-option-box",attrs:{label:"".concat(a.hostIp,"(").concat(a.hostSshAccount,")"),value:a.id}},[t("ul",{staticClass:"el-option-ul-between"},[t("li",[e._v(e._s(a.hostIp))]),t("li",[e._v(e._s(a.hostSshAccount))])])])})),1)],1),t("el-form-item",{attrs:{label:"节点端口",prop:"port"}},[t("el-input-number",{staticClass:"w-100",attrs:{size:"mini","controls-position":"right",min:1e3,max:65535,placeholder:"端口"},model:{value:e.formData.port,callback:function(t){e.$set(e.formData,"port",t)},expression:"formData.port"}})],1),t("el-form-item",{attrs:{label:"部署路径"}},[t("el-input",{staticClass:"w-100",attrs:{placeholder:"请输入部署路径",size:"mini"},model:{value:e.formData.deployPath,callback:function(t){e.$set(e.formData,"deployPath","string"===typeof t?t.trim():t)},expression:"formData.deployPath"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},o=[],i=a("c7eb"),r=a("1da1"),s=a("5530"),c=a("3835"),l=(a("7db0"),a("d81d"),a("a9e3"),a("d3b7"),a("dd69"),a("fbd2")),d=a("5370"),u=a("934b"),p=a("ff51"),h={components:{},model:{prop:"show",event:"change"},props:{show:Boolean,refresh:Function,rowData:{type:Object,default:function(){return{}}},clusterId:{type:String,default:void 0},nodeType:{type:Number,default:void 0}},data:function(){return{cascaders:[],formData:{machineId:"",deployPath:"",port:10001,hostIp:"",unitId:""},machineListLoading:!1,machineList:[],rules:{machineId:[{required:!0,trigger:"change",message:"请选择节点"}],unitId:[{required:!0,trigger:"change",message:"请选择单元"}],port:[{required:!0,trigger:"blur",message:"请输入端口"}]},options:[],loading:!1,loadingOptions:{text:""},props:{lazy:!0,lazyLoad:this.lazyLoad}}},computed:{visible:{get:function(){return this.show},set:function(e){this.$emit("change",!1)}},machineRoomId:function(){return this.$route.query.machineRoomId}},watch:{},created:function(){},mounted:function(){this.getIps()},methods:{changeCascaders:function(e){var t=Object(c["a"])(e,2);this.formData.unitId=t[0],this.formData.machineId=t[1];var a=this.$refs.cascaderRef,n=null===a||void 0===a?void 0:a.getCheckedNodes();if(n&&n.length>0){var o=n[0]||{},i=o.data,r=void 0===i?{}:i,s=(null===r||void 0===r?void 0:r.deploymentPath)||"";this.formData.hostIp=(null===r||void 0===r?void 0:r.hostIp)||"",s?this.$set(this.formData,"deployPath",s+"/seq-server"):this.$set(this.formData,"deployPath","")}},getIps:function(){var e=this;this.machineListLoading=!0,Object(l["h"])().then((function(t){e.machineList=Object(p["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).catch((function(e){})).finally((function(){e.machineListLoading=!1}))},changeIp:function(e){var t=this.machineList.find((function(t){return t.id===e})),a=(null===t||void 0===t?void 0:t.deploymentPath)||"";this.formData.hostIp=(null===t||void 0===t?void 0:t.hostIp)||"",a?this.$set(this.formData,"deployPath",a+"/seq-server"):this.$set(this.formData,"deployPath","")},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){e.loading=!0,e.loadingOptions.text="正在进行环境检测,请稍后";var a=Object(s["a"])({clusterId:e.clusterId},e.formData);a.switch||delete a.unitId,Object(d["a"])(a).then((function(t){200===t.code&&(e.loadingOptions.text="环境检测通过,正在进行初始化",e.loading=!0,Object(d["e"])(a).then((function(t){200===t.code&&(e.$message.success("初始化完毕"),e.$emit("change",!1),e.refresh())})).catch((function(t){e.loadingOptions.text=t,e.loading=!1})).finally((function(){e.loading=!1})))})).catch((function(t){e.loading=!1,e.loadingOptions.text=t}))}}))},lazyLoad:function(e,t){var a=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var o,r,c,l;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:o=e.level,r=[],n.t0=o,n.next=0===n.t0?7:1===n.t0?18:29;break;case 7:return n.prev=7,n.next=10,Object(u["b"])({machineRoomId:a.machineRoomId,unitType:"1"});case 10:c=n.sent,Object(p["a"])(null===c||void 0===c?void 0:c.data)&&(r=c.data.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{label:e.unitName,value:e.id})}))),n.next=17;break;case 14:n.prev=14,n.t1=n["catch"](7);case 17:return n.abrupt("break",29);case 18:return n.prev=18,n.next=21,Object(u["d"])(e.value);case 21:l=n.sent,Object(p["a"])(null===l||void 0===l?void 0:l.data)&&(r=l.data.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{label:"".concat(e.hostIp,"(").concat(e.hostSshAccount,")"),value:e.id,leaf:!0})}))),n.next=28;break;case 25:n.prev=25,n.t2=n["catch"](18);case 28:return n.abrupt("break",29);case 29:t(r);case 30:case"end":return n.stop()}}),n,null,[[7,14],[18,25]])})))()}}},f=h,m=(a("e39e"),a("2877")),g=Object(m["a"])(f,n,o,!1,null,"dbd1b2f0",null);t["default"]=g.exports},"9ee6":function(e,t,a){"use strict";a("2733")},aa32:function(e,t,a){"use strict";a.r(t);a("b0c0");var n=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{attrs:{model:e.searchData,rules:e.rules}},[t("el-form-item",{attrs:{label:"集群"}},[t("el-select",{attrs:{placeholder:"请选择集群"},on:{change:e.changeClusterId},model:{value:e.searchData.clusterId,callback:function(t){e.$set(e.searchData,"clusterId",t)},expression:"searchData.clusterId"}},e._l(e.clusterList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),t("el-row",e._l(e.list,(function(a,n){return t("el-col",{key:n,attrs:{span:8}},[t("div",{staticClass:"top-box"},[t("img",{attrs:{src:a.src,alt:"",width:"35"}}),t("ul",[t("li",{staticClass:"top-item-value",style:{color:a.color}},[e._v(" "+e._s(e.topData[a.value])+" ")]),t("li",{staticClass:"top-item-label"},[e._v(e._s(a.label))])])])])})),1),e.clusterCards&&e.clusterCards.length>0?t("el-row",{attrs:{gutter:20}},e._l(e.clusterCards,(function(a){return t("el-col",{key:a.id,staticClass:"mb-20",attrs:{span:6}},[t("div",{staticClass:"item-card"},[t("el-tag",{staticClass:"item-card-status",attrs:{size:"small",type:e.getTagType(a.status)}},[e._v(e._s(e._f("F_clusterStatusOptions")(a.status)))]),t("header",{staticClass:"mb-20"},[t("span",{staticClass:"item-title"},[e._v(e._s(e.getClusterName(a.clusterId)||"--"))])]),t("el-descriptions",{attrs:{column:1,size:"medium",labelStyle:{width:"100px",color:"#999"}}},[t("el-descriptions-item",{attrs:{label:"服务器IP"}},[e._v(e._s(a.hostIp)+" ")]),t("el-descriptions-item",{attrs:{label:"端口"}},[e._v(e._s(a.port)+" ")]),t("el-descriptions-item",{attrs:{label:"部署路径"}},[e._v(e._s(a.deployPath)+" ")])],1)],1)])})),1):t("el-empty",{attrs:{"image-size":220}})],1)},o=[],i=(a("d3b7"),a("1bf2"),a("159b"),a("e8b2")),r=a("ec41"),s=a("bc59"),c=a("1f97"),l=(a("6871"),a("ff51")),d=a("2143"),u={name:"sequence-service-monitor",components:{},mixins:[],props:{},filters:{F_clusterStatusOptions:function(e){return Object(c["c"])(e,"clusterStatusOptions")}},data:function(){return{searchData:{clusterId:""},rules:{},clusterList:[],list:[{iconClass:"clusterConfiguration",label:"服务总数",src:a("e796"),value:"cluster",color:"#1d70f5"},{icon:"el-icon-circle-check",label:"正常服务",src:a("e18b"),value:"normal",color:"#67c23a"},{icon:"el-icon-circle-close",label:"异常服务",src:a("1fe8"),value:"abnormal",color:"#f56c6c"}],topData:p(),clusterCards:[]}},computed:{},watch:{},created:function(){this.getCluster()},mounted:function(){},methods:{getClusterName:function(e){return Object(c["c"])(e,this.clusterList,["id","name"])},getCluster:function(){var e=this;Object(d["a"])().then((function(t){var a=Object(l["a"])(null===t||void 0===t?void 0:t.data)?t.data:[];e.clusterList=a,a.length>0&&(e.changeClusterId(a[0].id),e.searchData.clusterId=a[0].id)})).catch((function(e){}))},changeClusterId:function(e){var t=this;e&&Object(d["b"])(e).then((function(e){var a;Object(i["a"])(e.data)&&(t.topData=p(e.data)),t.clusterCards=null!==(a=Object(r["a"])(e,"data.seqServiceNodeList"))&&void 0!==a?a:[]})).catch((function(e){}))},getTagType:function(e){return Object(c["c"])(e,"clusterStatusOptions",["value","type"])}}};function p(e){var t="-",a={cluster:t,normal:t,abnormal:t},n=["serviceTotal","normalServiceTotal","exceptionServiceTotal"];return e&&Reflect.ownKeys(a).forEach((function(o,i){var r;Object(s["a"])(e,n[i])&&(a[o]=null!==(r=e[n[i]])&&void 0!==r?r:t)})),a}var h=u,f=(a("2a08"),a("2877")),m=Object(f["a"])(h,n,o,!1,null,"af137334",null);t["default"]=m.exports},e39e:function(e,t,a){"use strict";a("7dbf")},e749:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{style:{height:e.height,width:e.width},attrs:{id:"mountNode"}})},o=[],i=(a("cb29"),a("a15b"),a("7c3e")),r={name:"g6-dagre",components:{},mixins:[],props:{width:{type:String,default:"100%"},height:{type:String,default:"100%"},chartData:{type:Object,default:function(){return{nodes:[],edges:[]}}}},data:function(){return{graph:null}},computed:{},watch:{},created:function(){},mounted:function(){this.initDagre(),window.addEventListener("resize",this.resize)},destroyed:function(){window.removeEventListener("resize",this.resize),this.graph=null},methods:{initDagre:function(){var e=this,t=this.chartData;i["a"].registerNode("sql",{drawShape:function(e,t){var a=t.addShape("rect",{attrs:{x:-75,y:-25,width:150,height:50,radius:10,stroke:"#5B8FF9",lineWidth:1,fill:e.style.fill},name:"rect-shape"});return a}},"single-node");var a=1===t.nodes.length,n=new i["a"].Graph({container:"mountNode",fitView:!0,pixelRatio:2,maxZoom:a?3:10,layout:{type:"grid",begin:[20,20],nodeSize:150,preventOverlap:!0},animate:!0,defaultNode:{type:"sql",style:{stroke:"#C4E3B2",radius:7},labelCfg:{style:{fill:"#000",fontSize:14}}},comboStateStyles:{selected:{shadowBlur:1,lineWidth:1}},nodeStateStyles:{selected:{shadowColor:"#1d70f5",shadowBlur:10,lineWidth:2,cursor:"pointer"}},modes:{default:["drag-canvas","zoom-canvas","click-select",{type:"tooltip",formatText:function(e){var t=[];return t.join("\n")},offset:30}]}});n.data(t),n.render(),n.fitView(),this.graph=n,n.on("node:click",(function(t){t.target;var a=t.item,n=a.getModel();e.$emit("click-node",n)}))},resize:function(){var e=this.$el,t=e.offsetHeight,a=e.offsetWidth;this.graph.changeSize(a,t)}}},s=r,c=a("2877"),l=Object(c["a"])(s,n,o,!1,null,"ec535cd8",null);t["default"]=l.exports}}]);