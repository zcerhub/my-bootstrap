(window["jsonpPaas4"]=window["jsonpPaas4"]||[]).push([["app~a2f37677"],{"0122":function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var o=i("9ab4"),r=i("6855"),n=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.item=i.item,o.canvasX=i.canvasX,o.canvasY=i.canvasY,o.wheelDelta=i.wheelDelta,o.detail=i.detail,o}return Object(o["__extends"])(e,t),e}(r["Event"])},3822:function(t,e,i){"use strict";i.d(e,"d",(function(){return ct["a"]})),i.d(e,"g",(function(){return ct["c"]})),i.d(e,"f",(function(){return ct["b"]})),i.d(e,"l",(function(){return ft})),i.d(e,"j",(function(){return mt})),i.d(e,"b",(function(){return st})),i.d(e,"h",(function(){return dt["a"]})),i.d(e,"k",(function(){return yt})),i.d(e,"i",(function(){return vt})),i.d(e,"c",(function(){return ut})),i.d(e,"a",(function(){return lt})),i.d(e,"e",(function(){return bt}));var o=i("3e1e"),r=i("9ab4"),n=i("7fa2"),a=i("e897"),s=i("8937"),c=i("97b1"),d=i("adc7"),h=i("df64"),g=i("2e0c"),u=i("28d5"),p=function(){function t(t){this.graph=t,this.destroyed=!1,this.modes=t.get("modes")||{default:[]},this.formatModes(),this.mode=t.get("defaultMode")||"default",this.currentBehaves=[],this.setMode(this.mode)}return t.prototype.formatModes=function(){var t=this.modes;Object(s["each"])(t,(function(t){Object(s["each"])(t,(function(e,i){Object(s["isString"])(e)&&(t[i]={type:e})}))}))},t.prototype.setBehaviors=function(t){var e,i=this.graph,o=this.modes[t],r=[];Object(s["each"])(o||[],(function(t){var o=u["a"].getBehavior(t.type||t);o&&(e=new o(t),e&&(e.bind(i),r.push(e)))})),this.currentBehaves=r},t.mergeBehaviors=function(t,e){return Object(s["each"])(e,(function(e){t.indexOf(e)<0&&(Object(s["isString"])(e)&&(e={type:e}),t.push(e))})),t},t.filterBehaviors=function(t,e){var i=[];return t.forEach((function(t){var o="";o=Object(s["isString"])(t)?t:t.type,e.indexOf(o)<0&&i.push(t)})),i},t.prototype.setMode=function(t){var e=this,i=e.modes,o=e.graph,r=t,n=i[r];n&&(o.emit("beforemodechange",{mode:t}),Object(s["each"])(this.currentBehaves,(function(t){t.delegate&&t.delegate.remove(),t.unbind(o)})),this.setBehaviors(r),o.emit("aftermodechange",{mode:t}),this.mode=t)},t.prototype.getMode=function(){return this.mode},t.prototype.manipulateBehaviors=function(e,i,o){var r,n=this;if(r=Object(s["isArray"])(e)?e:[e],Object(s["isArray"])(i))return Object(s["each"])(i,(function(e){n.modes[e]?n.modes[e]=o?t.mergeBehaviors(n.modes[e]||[],r):t.filterBehaviors(n.modes[e]||[],r):o&&(n.modes[e]=r)})),this;var a=i;return i||(a=this.mode),this.modes[a]||o&&(this.modes[a]=r),this.modes[a]=o?t.mergeBehaviors(this.modes[a]||[],r):t.filterBehaviors(this.modes[a]||[],r),this.formatModes(),this.setMode(this.mode),this},t.prototype.updateBehavior=function(t,e,i){Object(s["isString"])(t)&&(t={type:t});var o=[];if(i&&i!==this.mode&&"default"!==i){if(o=this.modes[i],!o||!o.length)return this;var r=o.length;for(a=0;a<r;a++){c=o[a];if(c.type===t.type||c===t.type)return c===t.type&&(c={type:c}),Object.assign(c,e),o[a]=c,this}}else{if(o=this.currentBehaves,!o||!o.length)return this;for(var n=o.length,a=0;a<n;a++){var c=o[a];if(c.type===t.type)return c.updateCfg(e),this}}return this},t.prototype.destroy=function(){this.graph=null,this.modes=null,this.currentBehaves=null,this.destroyed=!0},t}(),l=p,f=i("6618"),y=i("14f7"),m=i("2974"),v=function(){function t(t){this.destroyed=!1,this.graph=t,this.destroyed=!1}return t.prototype.getViewCenter=function(){var t=this.getFormatPadding(),e=this.graph,i=this.graph.get("width"),o=e.get("height");return{x:(i-t[1]-t[3])/2+t[3],y:(o-t[0]-t[2])/2+t[0]}},t.prototype.fitCenter=function(t,e){var i,o=this.graph,r=o.get("group"),n=o.getNodes();if(n.length>o.get("optimizeThreshold")){var a=1/0,s=1/0,c=-1/0,h=-1/0;n.forEach((function(t){var e=t.getModel(),i=e.x,o=e.y;a>i&&(a=i),s>o&&(s=o),c<i&&(c=i),h<o&&(h=o)}));var g=r.getMatrix()||[1,0,0,0,1,0,0,0,1],u=Object(d["applyMatrix"])({x:a,y:s},g),p=u.x,l=u.y,f=Object(d["applyMatrix"])({x:c,y:h},g),y=f.x,m=f.y;i={minX:p,maxX:y,minY:l,maxY:m,width:y-p,height:m-l,x:p,y:l}}else i=r.getCanvasBBox();if(0!==i.width&&0!==i.height){var v=this.getViewCenter(),b={x:i.x+i.width/2,y:i.y+i.height/2};o.translate(v.x-b.x,v.y-b.y,t,e)}},t.prototype.animatedFitView=function(t,e,i,o,r,n,a,s){var c=this.graph;i=i||{duration:500,easing:"easeCubic"};var h=[1,0,0,0,1,0,0,0,1],g=o.x+r.x-n.x-o.minX,u=o.y+r.y-n.y-o.minY;if(!Object(f["isNaN"])(g)&&!Object(f["isNaN"])(u)){var p=Object(y["transform"])(h,[["t",g,u]]);if(s){var l=c.get("minZoom"),v=c.get("maxZoom"),b=a;l&&a<l?b=l:v&&a>v&&(b=v);var x=Object(y["transform"])(p,[["t",-r.x,-r.y],["s",b,b],["t",r.x,r.y]]),O=Object(m["getAnimateCfgWithCallback"])({animateCfg:i,callback:function(){t.setMatrix(x),c.emit("viewportchange",{action:"translate",matrix:p}),c.emit("viewportchange",{action:"zoom",matrix:x})}});t.stopAnimate(),t.setMatrix(e),t.animate((function(t){return{matrix:Object(d["lerpArray"])(e,x,t)}}),O)}else{var j=Object(m["getAnimateCfgWithCallback"])({animateCfg:i,callback:function(){c.emit("viewportchange",{action:"translate",matrix:p})}});t.animate((function(t){return{matrix:Object(d["lerpArray"])(e,p,t)}}),j)}}},t.prototype.fitView=function(t,e){var i,o=this.graph,r=this.getFormatPadding(),n=o.get("width"),a=o.get("height"),s=o.get("group"),c=s.getMatrix()||[1,0,0,0,1,0,0,0,1];s.resetMatrix();var d=o.getNodes();if(d.length>o.get("optimizeThreshold")){var h=1/0,g=1/0,u=-1/0,p=-1/0;d.forEach((function(t){var e=t.getModel(),i=e.x,o=e.y;h>i&&(h=i),g>o&&(g=o),u<i&&(u=i),p<o&&(p=o)})),i={minX:h,maxX:u,minY:g,maxY:p,width:u-h,height:p-g,x:h,y:g}}else i=s.getCanvasBBox();if(0!==i.width&&0!==i.height){var l=this.getViewCenter(),y={x:i.x+i.width/2,y:i.y+i.height/2},m=(n-r[1]-r[3])/i.width,v=(a-r[0]-r[2])/i.height,b=m;if(m>v&&(b=v),t)this.animatedFitView(s,c,e,i,l,y,b,!0);else{var x=l.x-y.x,O=l.y-y.y;if(Object(f["isNaN"])(x)||Object(f["isNaN"])(O))return;o.translate(x,O),o.zoom(b,l)}}},t.prototype.fitViewByRules=function(t,e,i){var o,r=t.onlyOutOfViewPort,n=void 0!==r&&r,a=t.direction,s=void 0===a?"both":a,c=t.ratioRule,d=void 0===c?"min":c,h=this.graph,g=this.getFormatPadding(),u=h.get("width"),p=h.get("height"),l=h.get("group"),f=l.getMatrix()||[1,0,0,0,1,0,0,0,1];l.resetMatrix();var y=h.getNodes();if(y.length>h.get("optimizeThreshold")){var m=1/0,v=1/0,b=-1/0,x=-1/0;y.forEach((function(t){var e=t.getModel(),i=e.x,o=e.y;m>i&&(m=i),v>o&&(v=o),b<i&&(b=i),x<o&&(x=o)})),o={minX:m,maxX:b,minY:v,maxY:x,width:b-m,height:x-v,x:m,y:v}}else o=l.getCanvasBBox();if(0!==o.width&&0!==o.height){var O,j=this.getViewCenter(),S={x:o.x+o.width/2,y:o.y+o.height/2},C=(u-g[1]-g[3])/o.width,I=(p-g[0]-g[2])/o.height;if(O="x"===s?C:"y"===s?I:"max"===d?Math.max(C,I):Math.min(C,I),n&&(O=O<1?O:1),e)this.animatedFitView(l,f,i,o,j,S,O,!0);else{var B=h.getZoom(),M=B*O,T=h.get("minZoom");M<T&&(M=T),h.translate(j.x-S.x,j.y-S.y),h.zoomTo(M,j)}}},t.prototype.getFormatPadding=function(){var t=this.graph.get("fitViewPadding");return Object(f["formatPadding"])(t)},t.prototype.focusPoint=function(t,e,i){var o=this,n=this.getViewCenter(),a=this.getPointByCanvas(n.x,n.y),s=this.graph.get("group").getMatrix();if(s||(s=[1,0,0,0,1,0,0,0,1]),e){var c=(a.x-t.x)*s[0],d=(a.y-t.y)*s[4],h=0,g=0,u=0,p=0;this.graph.get("canvas").animate((function(t){u=c*t,p=d*t,o.graph.translate(u-h,p-g),h=u,g=p}),Object(r["__assign"])({},i))}else this.graph.translate((a.x-t.x)*s[0],(a.y-t.y)*s[4])},t.prototype.getPointByCanvas=function(t,e){var i=this.graph.get("group").getMatrix();i||(i=[1,0,0,0,1,0,0,0,1]);var o=Object(d["invertMatrix"])({x:t,y:e},i);return o},t.prototype.getPointByClient=function(t,e){var i=this.graph.get("canvas"),o=i.getPointByClient(t,e);return this.getPointByCanvas(o.x,o.y)},t.prototype.getClientByPoint=function(t,e){var i=this.graph.get("canvas"),o=this.getCanvasByPoint(t,e),r=i.getClientByPoint(o.x,o.y);return{x:r.x,y:r.y}},t.prototype.getCanvasByPoint=function(t,e){var i=this.graph.get("group").getMatrix();return i||(i=[1,0,0,0,1,0,0,0,1]),Object(d["applyMatrix"])({x:t,y:e},i)},t.prototype.focus=function(t,e,i){if(Object(s["isString"])(t)&&(t=this.graph.findById(t)),t){var o=0,r=0;if(t.getType&&"edge"===t.getType()){var n=t.getSource().get("group").getMatrix(),a=t.getTarget().get("group").getMatrix();n&&a?(o=(n[6]+a[6])/2,r=(n[7]+a[7])/2):(n||a)&&(o=n?n[6]:a[6],r=n?n[7]:a[7])}else{var c=t.get("group"),d=c.getMatrix();d||(d=[1,0,0,0,1,0,0,0,1]),o=d[6],r=d[7]}this.focusPoint({x:o,y:r},e,i)}},t.prototype.focusItems=function(t,e,i,o){if(t.length){var r=this.graph,n=this.getFormatPadding(),a=r.get("width"),s=r.get("height"),c=r.get("group"),d=c.getMatrix()||[1,0,0,0,1,0,0,0,1];c.resetMatrix();for(var h={x:0,y:0,minX:Number.MAX_SAFE_INTEGER,minY:Number.MAX_SAFE_INTEGER,maxX:Number.MIN_SAFE_INTEGER,maxY:Number.MIN_SAFE_INTEGER,width:0,height:0},g=0,u=t;g<u.length;g++){var p=u[g],l=p.getBBox();l.minX<h.minX&&(h.minX=l.minX),l.minY<h.minY&&(h.minY=l.minY),l.maxX>h.maxX&&(h.maxX=l.maxX),l.maxY>h.maxY&&(h.maxY=l.maxY)}if(h.x=h.minX,h.y=h.minY,h.width=h.maxX-h.minX,h.height=h.maxY-h.minY,0!==h.width&&0!==h.height){var f=this.getViewCenter(),y={x:h.x+h.width/2,y:h.y+h.height/2},m=(a-n[1]-n[3])/h.width,v=(s-n[0]-n[2])/h.height,b=m;m>v&&(b=v),i?this.animatedFitView(c,d,o,h,f,y,b,e):(r.translate(f.x-y.x,f.y-y.y),e&&r.zoom(b,f))}}},t.prototype.changeSize=function(t,e){var i=this.graph;if(!Object(s["isNumber"])(t)||!Object(s["isNumber"])(e))throw Error("invalid canvas width & height, please make sure width & height type is number");i.set({width:t,height:e});var o=i.get("canvas");o.changeSize(t,e);var r=i.get("plugins");r.forEach((function(t){t.get("gridContainer")&&t.positionInit()}))},t.prototype.destroy=function(){this.graph=null,this.destroyed=!1},t}(),b=v,x=i("1924"),O="bboxCache",j="bboxCanvasCache",S=function(){function t(t){this._cfg={},this.destroyed=!1,this.optimize=!1;var e={id:void 0,type:"item",model:{},group:void 0,animate:!1,visible:!0,locked:!1,event:!0,keyShape:void 0,states:[]};this._cfg=Object.assign(e,this.getDefaultCfg(),t);var i=this.get("model"),o=i.id,r=this.get("type");"undefined"===typeof o?o=Object(f["uniqueId"])(r):"string"!==typeof o&&(o=String(o)),this.get("model").id=o,this.set("id",o);var n=t.group;n&&(n.set("item",this),n.set("id",o)),this.init(),this.draw();var a=i.shape||i.type||("edge"===r?"line":"circle"),c=this.get("shapeFactory");if(c&&c[a]){var d=c[a].options;if(d&&d.stateStyles){var h=this.get("styles")||i.stateStyles;h=Object(s["deepMix"])({},d.stateStyles,h),this.set("styles",h)}}}return t.prototype.calculateBBox=function(){var t=this.get("keyShape"),e=this.get("group"),i=Object(m["getBBox"])(t,e);return i.x=i.minX,i.y=i.minY,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY,i.centerX=(i.minX+i.maxX)/2,i.centerY=(i.minY+i.maxY)/2,i},t.prototype.calculateCanvasBBox=function(){var t=this.get("keyShape"),e=this.get("group"),i=Object(m["getBBox"])(t,e);return i.x=i.minX,i.y=i.minY,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY,i.centerX=(i.minX+i.maxX)/2,i.centerY=(i.minY+i.maxY)/2,i},t.prototype.drawInner=function(){var t=this,e=t.get("shapeFactory"),i=t.get("group"),o=t.get("model");i.clear();var r=o.visible;if(void 0===r||r||t.changeVisibility(r),e){t.updatePosition(o);var n=t.getShapeCfg(o),a=n.type,s=e.draw(a,n,i);s&&(t.set("keyShape",s),s.set("isKeyShape",!0),s.set("draggable",!0)),this.setOriginStyle(),this.set("currentShape",a),this.restoreStates(e,a)}},t.prototype.setOriginStyle=function(){var t=this.get("group"),e=t.get("children"),i=this.getKeyShape(),o=this,r=i.get("name");if(this.get("originStyle")){var n=this.get("originStyle");r&&!n[r]&&(n[r]={});var a=this.getCurrentStatesStyle(),c=function(t){var i=e[t],c=i.get("name"),d=i.attr();if(c&&c!==r){var h=a[c];n[c]||(n[c]={}),h?Object.keys(d).forEach((function(t){var e=d[t];e!==h[t]&&(n[c][t]=e)})):n[c]="image"!==i.get("type")?Object(s["clone"])(d):o.getShapeStyleByName(c)}else{var g=i.attr(),u={};Object.keys(a).forEach((function(t){var e=a[t];t!==r&&Object(s["isPlainObject"])(e)||(u[t]=e)})),Object.keys(g).forEach((function(t){var e=g[t];u[t]!==e&&(r?n[r][t]=e:n[t]=e)}))}};for(h=0;h<e.length;h++)c(h);delete n.path,delete n.matrix,delete n.x,delete n.y,n[r]&&(delete n[r].x,delete n[r].y,delete n[r].matrix,delete n[r].path),o.set("originStyle",n)}else{for(var d={},h=0;h<e.length;h++){var g=e[h],u=g.get("type"),p=g.get("name");if(p&&p!==r)d[p]="image"!==u?Object(s["clone"])(g.attr()):o.getShapeStyleByName(p),"text"===u&&d[p]&&(delete d[p].x,delete d[p].y,delete d[p].matrix);else{var l=o.getShapeStyleByName();if(delete l.path,delete l.matrix,r)if(p)d[r]=l;else{var y=Object(f["uniqueId"])("shape");g.set("name",y),t["shapeMap"][y]=g,d[y]="image"!==u?Object(s["clone"])(g.attr()):o.getShapeStyleByName(p)}else Object.assign(d,l)}}o.set("originStyle",d)}},t.prototype.restoreStates=function(t,e){var i=this,o=i.get("states");Object(s["each"])(o,(function(o){t.setState(e,o,!0,i)}))},t.prototype.init=function(){var t=x["a"].getFactory(this.get("type"));this.set("shapeFactory",t)},t.prototype.get=function(t){return this._cfg[t]},t.prototype.set=function(t,e){Object(s["isPlainObject"])(t)?this._cfg=Object(r["__assign"])(Object(r["__assign"])({},this._cfg),t):this._cfg[t]=e},t.prototype.getDefaultCfg=function(){return{}},t.prototype.clearCache=function(){this.set(O,null),this.set(j,null)},t.prototype.beforeDraw=function(){},t.prototype.afterDraw=function(){},t.prototype.afterUpdate=function(){},t.prototype.draw=function(){this.beforeDraw(),this.drawInner(),this.afterDraw()},t.prototype.getShapeStyleByName=function(t){var e,i=this.get("group");if(e=t?i["shapeMap"][t]||i.find((function(e){return e.get("name")===t})):this.getKeyShape(),e){var o={};return Object(s["each"])(e.attr(),(function(t,e){("img"!==e||Object(s["isString"])(t))&&(o[e]=t)})),o}return{}},t.prototype.getShapeCfg=function(t,e){var i=this.get("styles");if(i){var o=t;return o.style=Object(r["__assign"])(Object(r["__assign"])({},i),t.style),o}return t},t.prototype.getStateStyle=function(t){var e=this.get("styles"),i=e&&e[t];return i},t.prototype.getOriginStyle=function(){return this.get("originStyle")},t.prototype.getCurrentStatesStyle=function(){var t=this,e={},i=t.getStates();return i&&i.length?(Object(s["each"])(t.getStates(),(function(i){e=Object.assign(e,t.getStateStyle(i))})),e):this.get("originStyle")},t.prototype.setState=function(t,e){var i=this.get("states"),o=this.get("shapeFactory"),r=t,n=t;Object(s["isString"])(e)&&(r="".concat(t,":").concat(e),n="".concat(t,":"));var a=i;if(Object(s["isBoolean"])(e)){var c=i.indexOf(n);if(e){if(c>-1)return;i.push(r)}else c>-1&&i.splice(c,1)}else if(Object(s["isString"])(e)){var d=i.filter((function(t){return t.includes(n)}));d.length>0&&this.clearStates(d),a=a.filter((function(t){return!t.includes(n)})),a.push(r),this.set("states",a)}if(o){var h=this.get("model"),g=h.type;o.setState(g,t,e,this)}},t.prototype.clearStates=function(t){var e=this,i=e.getStates(),o=e.get("shapeFactory"),r=e.get("model"),n=r.type;t||(t=i),Object(s["isString"])(t)&&(t=[t]);var a=i.filter((function(e){return-1===t.indexOf(e)}));e.set("states",a),t.forEach((function(t){o.setState(n,t,!1,e)}))},t.prototype.setOptimize=function(t){this.optimize=t},t.prototype.getContainer=function(){return this.get("group")},t.prototype.getKeyShape=function(){return this.get("keyShape")},t.prototype.getModel=function(){return this.get("model")},t.prototype.getType=function(){return this.get("type")},t.prototype.getID=function(){return this.get("id")},t.prototype.isItem=function(){return!0},t.prototype.getStates=function(){return this.get("states")},t.prototype.hasState=function(t){var e=this.getStates();return e.indexOf(t)>=0},t.prototype.refresh=function(t){var e=this.get("model");this.updatePosition(e),this.updateShape(t),this.afterUpdate(),this.clearCache()},t.prototype.getUpdateType=function(t){},t.prototype.update=function(t,e){void 0===e&&(e=void 0);var i=this.get("model");if("move"===e)this.updatePosition(t);else{var o=i.visible,r=t.visible;o!==r&&void 0!==r&&this.changeVisibility(r);var n={x:i.x,y:i.y};t.x=isNaN(+t.x)?i.x:+t.x,t.y=isNaN(+t.y)?i.y:+t.y;var a=this.get("styles");if(t.stateStyles){var c=t.stateStyles;Object(s["mix"])(a,c),delete t.stateStyles}Object.assign(i,t),n.x===t.x&&n.y===t.y||this.updatePosition(t),this.updateShape(e)}this.afterUpdate(),this.clearCache()},t.prototype.updateShape=function(t){var e=this.get("shapeFactory"),i=this.get("model"),o=i.type;if(e.shouldUpdate(o)&&o===this.get("currentShape")){var r=this.getShapeCfg(i,t);e.baseUpdate(o,r,this,t),"move"!==t&&this.setOriginStyle()}else this.draw();this.restoreStates(e,o)},t.prototype.updatePosition=function(t){var e=this.get("model"),i=isNaN(+t.x)?+e.x:+t.x,o=isNaN(+t.y)?+e.y:+t.y,r=this.get("group");if(isNaN(i)||isNaN(o))return!1;e.x=i,e.y=o;var n=r.getMatrix();return(!n||n[6]!==i||n[7]!==o)&&(r.resetMatrix(),Object(d["translate"])(r,{x:i,y:o}),this.clearCache(),!0)},t.prototype.getBBox=function(){var t=this.get(O);return t||(t=this.calculateBBox(),this.set(O,t)),t},t.prototype.getCanvasBBox=function(){var t=this.get(j);return t||(t=this.calculateCanvasBBox(),this.set(j,t)),t},t.prototype.toFront=function(){var t=this.get("group");t.toFront()},t.prototype.toBack=function(){var t=this.get("group");t.toBack()},t.prototype.show=function(){this.changeVisibility(!0)},t.prototype.hide=function(){this.changeVisibility(!1)},t.prototype.changeVisibility=function(t){var e=this.get("group");t?e.show():e.hide(),this.set("visible",t)},t.prototype.isVisible=function(){return this.get("visible")},t.prototype.enableCapture=function(t){var e=this.get("group");e&&e.set("capture",t)},t.prototype.destroy=function(){if(!this.destroyed){var t=this.get("animate"),e=this.get("group");t&&e.stopAnimate(),e["shapeMap"]={},this.clearCache(),e.remove(),this._cfg=null,this.destroyed=!0}},t}(),C=S,I={source:"start",target:"end"},B="Node",M="Point",T="Anchor",k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r["__extends"])(e,t),e.prototype.getDefaultCfg=function(){return{type:"edge",sourceNode:null,targetNode:null,startPoint:null,endPoint:null,linkCenter:!1}},e.prototype.setEnd=function(t,e){var i=I[t]+M,o=t+B,r=this.get(o);r&&!r.destroyed&&r.removeEdge(this),Object(s["isPlainObject"])(e)?(this.set(i,e),this.set(o,null)):e&&(e.addEdge(this),this.set(o,e),this.set(i,null))},e.prototype.getLinkPoint=function(t,e,i){var o=I[t]+M,r=t+B,n=this.get(o);if(!n){var a=this.get(r),c=t+T,d=this.getPrePoint(t,i),h=e[c];Object(s["isNil"])(h)||(n=a.getLinkPointByAnchor(h)),n=n||a.getLinkPoint(d),Object(s["isNil"])(n.index)||this.set("".concat(t,"AnchorIndex"),n.index)}return n},e.prototype.getPrePoint=function(t,e){if(e&&e.length){var i="source"===t?0:e.length-1;return e[i]}var o="source"===t?"target":"source";return this.getEndPoint(o)},e.prototype.getEndPoint=function(t){var e=t+B,i=I[t]+M,o=this.get(e);return o&&!o.destroyed?o.get("model"):this.get(i)},e.prototype.getControlPointsByCenter=function(t){var e=this.getEndPoint("source"),i=this.getEndPoint("target"),o=this.get("shapeFactory"),r=t.type;return o.getControlPoints(r,{startPoint:e,endPoint:i})},e.prototype.getEndCenter=function(t){var e=t+B,i=I[t]+M,o=this.get(e);if(o){var r=o.getBBox();return{x:r.centerX,y:r.centerY}}return this.get(i)},e.prototype.init=function(){t.prototype.init.call(this),this.setSource(this.get("source")),this.setTarget(this.get("target"))},e.prototype.getShapeCfg=function(e,i){var o=this,r=o.get("linkCenter"),n=(null===i||void 0===i?void 0:i.includes("move"))?e:t.prototype.getShapeCfg.call(this,e);if(r)n.startPoint=o.getEndCenter("source"),n.endPoint=o.getEndCenter("target");else{var a=n.controlPoints||o.getControlPointsByCenter(n);n.startPoint=o.getLinkPoint("source",e,a),n.endPoint=o.getLinkPoint("target",e,a)}return n.sourceNode=o.get("sourceNode"),n.targetNode=o.get("targetNode"),n},e.prototype.getModel=function(){var t=this.get("model"),e=this.get("source".concat(B)),i=this.get("target".concat(B));return e?delete t["source".concat(B)]:t.source=this.get("start".concat(M)),i?delete t["target".concat(B)]:t.target=this.get("end".concat(M)),Object(s["isString"])(t.source)||Object(s["isPlainObject"])(t.source)||(t.source=t.source.getID()),Object(s["isString"])(t.target)||Object(s["isPlainObject"])(t.target)||(t.target=t.target.getID()),t},e.prototype.setSource=function(t){this.setEnd("source",t),this.set("source",t)},e.prototype.setTarget=function(t){this.setEnd("target",t),this.set("target",t)},e.prototype.getSource=function(){return this.get("source")},e.prototype.getTarget=function(){return this.get("target")},e.prototype.updatePosition=function(){return!1},e.prototype.update=function(t,e){void 0===e&&(e=void 0);var i=this.get("model"),o=i.visible,r=t.visible;o!==r&&void 0!==r&&this.changeVisibility(r);var n=this.get("source"),a=this.get("target");if(n&&!n.destroyed&&a&&!a.destroyed){var c=this.get("styles");if(t.stateStyles){var d=t.stateStyles;Object(s["mix"])(c,d),delete t.stateStyles}Object.assign(i,t),this.updateShape(e),this.afterUpdate(),this.clearCache()}},e.prototype.destroy=function(){var e=this.get("source".concat(B)),i=this.get("target".concat(B));e&&!e.destroyed&&e.removeEdge(this),i&&!i.destroyed&&i.removeEdge(this),t.prototype.destroy.call(this)},e}(C),w=k,E="anchorPointsCache",N="bboxCache",P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r["__extends"])(e,t),e.prototype.getNearestPoint=function(t,e){for(var i=0,o=t[0],r=Object(d["distance"])(t[0],e),n=0;n<t.length;n++){var a=t[n],s=Object(d["distance"])(a,e);s<r&&(o=a,r=s,i=n)}return o.anchorIndex=i,o},e.prototype.getDefaultCfg=function(){return{type:"node",edges:[]}},e.prototype.getEdges=function(){return this.get("edges")},e.prototype.getInEdges=function(){var t=this;return this.get("edges").filter((function(e){return e.get("target")===t}))},e.prototype.getOutEdges=function(){var t=this;return this.get("edges").filter((function(e){return e.get("source")===t}))},e.prototype.getNeighbors=function(t){var e=this,i=this.get("edges");if("target"===t){var o=function(t){return t.getSource()===e};return i.filter(o).map((function(t){return t.getTarget()}))}if("source"===t){var r=function(t){return t.getTarget()===e};return i.filter(r).map((function(t){return t.getSource()}))}var n=function(t){return t.getSource()===e?t.getTarget():t.getSource()};return i.map(n)},e.prototype.getLinkPointByAnchor=function(t){var e=this.getAnchorPoints();return e[t]},e.prototype.getLinkPoint=function(t){var e,i,o=this.get("keyShape"),r=o.get("type"),n=this.get("type"),a=this.getBBox();"combo"===n?(e=a.centerX||(a.maxX+a.minX)/2,i=a.centerY||(a.maxY+a.minY)/2):(e=a.centerX,i=a.centerY);var s,c=this.getAnchorPoints();switch(r){case"circle":s=Object(d["getCircleIntersectByPoint"])({x:e,y:i,r:a.width/2},t);break;case"ellipse":s=Object(d["getEllipseIntersectByPoint"])({x:e,y:i,rx:a.width/2,ry:a.height/2},t);break;default:s=Object(d["getRectIntersectByPoint"])(a,t)}var h=s;return c.length&&(h||(h=t),h=this.getNearestPoint(c,h)),h||(h={x:e,y:i}),h},e.prototype.getAnchorPoints=function(){var t=this.get(E);if(!t){t=[];var e=this.get("shapeFactory"),i=this.getBBox(),o=this.get("model"),r=this.getShapeCfg(o),n=o.type,a=e.getAnchorPoints(n,r)||[];Object(s["each"])(a,(function(e,o){var r={x:i.minX+e[0]*i.width,y:i.minY+e[1]*i.height,anchorIndex:o};t.push(r)})),this.set(E,t)}return t},e.prototype.addEdge=function(t){this.get("edges").push(t)},e.prototype.lock=function(){this.set("locked",!0)},e.prototype.unlock=function(){this.set("locked",!1)},e.prototype.hasLocked=function(){return this.get("locked")},e.prototype.removeEdge=function(t){var e=this.getEdges(),i=e.indexOf(t);i>-1&&e.splice(i,1)},e.prototype.clearCache=function(){this.set(N,null),this.set(E,null)},e.prototype.getUpdateType=function(t){var e,i,o,r,n;if(t){var a=!Object(s["isNil"])(t.x),c=!Object(s["isNil"])(t.y),d=Object.keys(t);if(1===d.length&&(a||c)||2===d.length&&a&&c)return"move";if(Object(s["isNumber"])(t.x)||Object(s["isNumber"])(t.y)||t.type||t.anchorPoints||t.size||(null===t||void 0===t?void 0:t.style)&&((null===(e=null===t||void 0===t?void 0:t.style)||void 0===e?void 0:e.r)||(null===(i=null===t||void 0===t?void 0:t.style)||void 0===i?void 0:i.width)||(null===(o=null===t||void 0===t?void 0:t.style)||void 0===o?void 0:o.height)||(null===(r=null===t||void 0===t?void 0:t.style)||void 0===r?void 0:r.rx)||(null===(n=null===t||void 0===t?void 0:t.style)||void 0===n?void 0:n.ry)))return"bbox|label";var h=d.includes("label")||d.includes("labelCfg");return h?"style|label":"style"}},e.prototype.setState=function(e,i){var o=this;this.optimize?t.prototype.setState.call(this,e,i):this.runWithBBoxAffected((function(){return t.prototype.setState.call(o,e,i)}))},e.prototype.clearStates=function(e){var i=this;this.optimize?t.prototype.clearStates.call(this,e):this.runWithBBoxAffected((function(){return t.prototype.clearStates.call(i,e)}))},e.prototype.runWithBBoxAffected=function(t){var e=["r","width","height","rx","ry","lineWidth"],i=this.getKeyShape().attr(),o={};Object.keys(this.getKeyShape().attr()).forEach((function(t){e.includes(t)&&(o[t]=i[t])})),t();for(var r=this.getKeyShape().attr(),n=0;n<e.length;n++){var a=e[n];if(r[a]!==o[a]){this.clearCache(),this.getEdges().forEach((function(t){return t.refresh()}));break}}},e}(C),_=P,A="bboxCache",X="bboxCanvasCache",Y="sizeCache",V="anchorPointsCache",z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(r["__extends"])(e,t),e.prototype.getDefaultCfg=function(){return{type:"combo",nodes:[],edges:[],combos:[]}},e.prototype.getShapeCfg=function(t){var e=this.get("styles"),i=this.get("bbox");if(e&&i){var o=t,n=Object(s["isNumber"])(t.size)?[t.size,t.size]:t.size,a=Object(s["isNumber"])(t.fixSize)?[t.fixSize,t.fixSize]:t.fixSize,c=n||a||g["a"].defaultCombo.size,d={r:(Math.max(i.width,i.height)||Math.max(c[0],c[1]))/2,width:i.width||c[0],height:i.height||c[1]};o.style=Object(r["__assign"])(Object(r["__assign"])(Object(r["__assign"])({},e),t.style),d);var h=t.padding||g["a"].defaultCombo.padding;return Object(s["isNumber"])(h)?(d.r+=h,d.width+=2*h,d.height+=2*h):(d.r=d.r+Math.max.apply(Math,h),d.width+=h[1]+h[3]||2*h[1],d.height+=h[0]+h[2]||2*h[0]),this.set(Y,d),o}return t},e.prototype.calculateCanvasBBox=function(){if(!this.destroyed){var t=this.get("keyShape"),e=this.get("group"),i=this.get(A)||{},o=i.x,r=i.x,n=this.get(Y),a=Object(m["getBBox"])(t,e);if(a.centerX=(a.minX+a.maxX)/2,a.centerY=(a.minY+a.maxY)/2,n){n.width=Math.max(n.width,a.width),n.height=Math.max(n.height,a.height),this.set(Y,n);var s=t.get("type");"circle"===s?(a.width=2*n.r,a.height=2*n.r):(a.width=n.width,a.height=n.height),a.minX=a.centerX-a.width/2,a.minY=a.centerY-a.height/2,a.maxX=a.centerX+a.width/2,a.maxY=a.centerY+a.height/2}else a.width=a.maxX-a.minX,a.height=a.maxY-a.minY,a.centerX=(a.minX+a.maxX)/2,a.centerY=(a.minY+a.maxY)/2;return a.x=a.minX,a.y=a.minY,a.x===o&&a.y===r||this.set(V,null),a}},e.prototype.getChildren=function(){var t=this;return{nodes:t.getNodes(),combos:t.getCombos()}},e.prototype.getNodes=function(){var t=this;return t.get("nodes")},e.prototype.getCombos=function(){var t=this;return t.get("combos")},e.prototype.addChild=function(t){var e=this,i=t.getType();switch(i){case"node":e.addNode(t);break;case"combo":e.addCombo(t);break;default:return!1}return!0},e.prototype.addCombo=function(t){var e=this;return e.get("combos").push(t),!0},e.prototype.addNode=function(t){var e=this;return e.get("nodes").push(t),!0},e.prototype.removeChild=function(t){var e=this,i=t.getType();switch(i){case"node":e.removeNode(t);break;case"combo":e.removeCombo(t);break;default:return!1}return!0},e.prototype.removeCombo=function(t){if(t){var e=this.getCombos(),i=e.indexOf(t);return i>-1&&(e.splice(i,1),!0)}},e.prototype.removeNode=function(t){if(t){var e=this.getNodes(),i=e.indexOf(t);return i>-1&&(e.splice(i,1),!0)}},e.prototype.getUpdateType=function(t){},e.prototype.getBBox=function(){this.set(X,null);var t=this.calculateCanvasBBox();return t},e.prototype.clearCache=function(){this.set(A,null),this.set(X,null),this.set(V,null)},e.prototype.destroy=function(){if(!this.destroyed){var t=this.get("animate"),e=this.get("group");t&&e.stopAnimate(),e["shapeMap"]={},this.clearCache(),this.set(Y,null),this.set("bbox",null),e.remove(),this._cfg=null,this.destroyed=!0}},e}(_),F=z,D="node",L="edge",G="vedge",U="combo",Z="default",R="Mapper",H="stateStyles",K=function(){function t(t){var e=this;this.edgeToBeUpdateMap={},this.throttleRefresh=Object(s["throttle"])((function(t){var i=e.graph;if(i&&!i.get("destroyed")){var o=e.edgeToBeUpdateMap;if(o){var r=Object.values(o);r.length&&(r.forEach((function(t){var e=t.edge;if(e&&!e.destroyed){var i=e.getSource(),o=e.getTarget();i&&!i.destroyed&&o&&!o.destroyed&&e.refresh(t.updateType)}})),e.edgeToBeUpdateMap={})}}}),16,{trailing:!0,leading:!0}),this.graph=t,this.destroyed=!1}return t.prototype.addItem=function(t,e){var i=this.graph,o=t===G?L:t,r=i.get("".concat(o,"Group"))||i.get("group"),n=Object(s["upperFirst"])(o),a=null,c=i.get(o+Object(s["upperFirst"])(H))||{},d=i.get(Z+n);e[H]&&(c=e[H]),d&&Object(s["each"])(d,(function(t,i){Object(s["isObject"])(t)&&!Object(s["isArray"])(t)?e[i]=Object(s["deepMix"])({},t,e[i]):Object(s["isArray"])(t)?e[i]=e[i]||Object(s["clone"])(d[i]):e[i]=e[i]||d[i]}));var h=i.get(o+R);if(h){var g=h(e);g[H]&&(c=g[H],delete g[H]),Object(s["each"])(g,(function(t,i){Object(s["isObject"])(t)&&!Object(s["isArray"])(t)?e[i]=Object(s["deepMix"])({},e[i],t):e[i]=g[i]||e[i]}))}if(i.emit("beforeadditem",{type:t,model:e}),t===L||t===G){var u=void 0,p=void 0;if(u=e.source,p=e.target,u&&Object(s["isString"])(u)&&(u=i.findById(u)),p&&Object(s["isString"])(p)&&(p=i.findById(p)),!u||!p)return;u.getType&&"combo"===u.getType()&&(e.isComboEdge=!0),p.getType&&"combo"===p.getType()&&(e.isComboEdge=!0),a=new w({model:e,source:u,target:p,styles:c,linkCenter:i.get("linkCenter"),group:r.addGroup()})}else if(t===D)a=new _({model:e,styles:c,group:r.addGroup()});else if(t===U){var l=e.children,f=Object(m["getComboBBox"])(l,i),y=void 0,v=void 0;if(isNaN(f.x)?isNaN(e.x)&&(y=100*Math.random()):y=f.x,isNaN(f.y)?isNaN(e.y)&&(v=100*Math.random()):v=f.y,isNaN(e.x)||isNaN(e.y))e.x=y,e.y=v;else{var b=e.x-y,x=e.y-v;this.updateComboSucceeds(e.id,b,x,l)}var O=r.addGroup();O.setZIndex(e.depth),a=new F({model:e,styles:c,animate:i.get("animate"),bbox:e.collapsed?Object(m["getComboBBox"])([],i):f,group:O}),e.collapsed||"circle"!==a.getKeyShape().get("type")||(f.width=Math.hypot(f.height,f.width),f.height=f.width,a.set("bbox",f),a.refresh());var j=a.getModel();(l||[]).forEach((function(t){var e=i.findById(t.id);a.addChild(e),t.depth=j.depth+2}))}if(a)return a.setOptimize(i.getNodes().length>i.get("optimizeThreshold")),i.get("".concat(t,"s")).push(a),i.get("itemMap")[a.get("id")]=a,i.emit("afteradditem",{item:a,model:e}),a},t.prototype.updateItem=function(t,e){var i,o,n=this,a=this.graph;if(Object(s["isString"])(t)&&(t=a.findById(t)),t&&!t.destroyed){var c="";t.getType&&(c=t.getType());var d=a.get(c+R),h=t.getModel(),g=h.x,u=h.y,p=t.getUpdateType(e);if(d){var l=Object(s["deepMix"])({},h,e),f=d(l),y=Object(s["deepMix"])({},h,f,e);f[H]&&(t.set("styles",y[H]),delete y[H]),Object(s["each"])(y,(function(t,i){e[i]=t}))}else Object(s["each"])(e,(function(t,i){h[i]&&Object(s["isObject"])(t)&&!Object(s["isArray"])(t)&&(e[i]=Object(r["__assign"])(Object(r["__assign"])({},h[i]),e[i]))}));if(a.emit("beforeupdateitem",{item:t,cfg:e}),c===L){if(e.source){var m=e.source;Object(s["isString"])(m)&&(m=a.findById(m)),t.setSource(m)}if(e.target){var v=e.target;Object(s["isString"])(v)&&(v=a.findById(v)),t.setTarget(v)}t.update(e)}else if(c===D){t.update(e,p);var b=t.getEdges();"move"===p?Object(s["each"])(b,(function(t){n.edgeToBeUpdateMap[t.getID()]={edge:t,updateType:p},n.throttleRefresh()})):(null===p||void 0===p?void 0:p.includes("bbox"))&&Object(s["each"])(b,(function(t){t.refresh(p)}))}else if(c===U){if(t.update(e,p),!isNaN(e.x)||!isNaN(e.y)){var x=e.x-g||0,O=e.y-u||0;this.updateComboSucceeds(h.id,x,O)}var j=t.getEdges(),S=(null===p||void 0===p?void 0:p.includes("bbox"))||"move"===p;if(S&&c===U){var C=t.get("shapeFactory"),I=h.type||"circle",B=void 0===h.animate||void 0===e.animate?null===(o=null===(i=C[I])||void 0===i?void 0:i.options)||void 0===o?void 0:o.animate:h.animate||e.animate;B?setTimeout((function(){if(t&&!t.destroyed){var e=t.getKeyShape();e&&!e.destroyed&&Object(s["each"])(j,(function(t){t&&!t.destroyed&&t.refresh()}))}}),201):Object(s["each"])(j,(function(t){t.refresh()}))}}t.setOptimize(a.getNodes().length>a.get("optimizeThreshold")),a.emit("afterupdateitem",{item:t,cfg:e})}},t.prototype.updateCombo=function(t,e,i){var o,r,n=this,a=this.graph;if(Object(s["isString"])(t)&&(t=a.findById(t)),t&&!t.destroyed){var c=t.getModel(),d=Object(m["getComboBBox"])(e,a,t),h=d.x,g=d.y;t.set("bbox",d);var u=h,p=g;i?(u=isNaN(c.x)?h:c.x,p=isNaN(c.y)?g:c.y):(u=isNaN(h)?c.x:h,p=isNaN(g)?c.y:g),t.update({x:u,y:p});var l=t.get("shapeFactory"),f=c.type||"circle",y=void 0===c.animate?null===(r=null===(o=l[f])||void 0===o?void 0:o.options)||void 0===r?void 0:r.animate:c.animate;y?setTimeout((function(){if(t&&!t.destroyed){var e=t.getKeyShape();e&&!e.destroyed&&(t.getShapeCfg(c),n.updateComboEdges(t))}}),201):this.updateComboEdges(t)}},t.prototype.updateComboEdges=function(t){for(var e,i,o=t.getEdges()||[],r=0;r<o.length;r++){var n=o[r];(null===n||void 0===n?void 0:n.destroyed)||(null===(e=null===n||void 0===n?void 0:n.getSource())||void 0===e?void 0:e.destroyed)||(null===(i=null===n||void 0===n?void 0:n.getTarget())||void 0===i?void 0:i.destroyed)||n.refresh()}},t.prototype.collapseCombo=function(t,e){void 0===e&&(e=!0);var i=this.graph;Object(s["isString"])(t)&&(t=i.findById(t));var o=t.getChildren();o.nodes.forEach((function(t){i.hideItem(t,e)})),o.combos.forEach((function(t){i.hideItem(t,e)}))},t.prototype.updateComboSucceeds=function(t,e,i,o){var r=this;void 0===o&&(o=[]);var n=this.graph;if(e||i){var a=o;if(!(null===a||void 0===a?void 0:a.length)){var s=n.get("comboTrees");null===s||void 0===s||s.forEach((function(e){Object(m["traverseTree"])(e,(function(e){return e.id!==t||(a=e.children,!1)}))}))}null===a||void 0===a||a.forEach((function(t){var o=n.findById(t.id);if(o){var a=o.getModel();r.updateItem(t.id,{x:(a.x||0)+e,y:(a.y||0)+i})}}))}},t.prototype.expandCombo=function(t,e){void 0===e&&(e=!0);var i=this.graph;Object(s["isString"])(t)&&(t=i.findById(t));var o=t.getChildren(),r=new Set;o.nodes.forEach((function(t){i.showItem(t,e),t.getEdges().forEach((function(t){return r.add(t)}))})),o.combos.forEach((function(t){t.getModel().collapsed?t.show():i.showItem(t,e),t.getEdges().forEach((function(t){return r.add(t)}))})),r.forEach((function(t){return t.refresh()}))},t.prototype.removeItem=function(t){var e=this,i=this.graph;if(Object(s["isString"])(t)&&(t=i.findById(t)),t&&!t.destroyed){var o=Object(s["clone"])(t.getModel()),r="";t.getType&&(r=t.getType()),i.emit("beforeremoveitem",{item:o,type:r});var n=i.get("".concat(r,"s")),a=n.indexOf(t);if(a>-1&&n.splice(a,1),r===L){var c=i.get("v".concat(r,"s")),d=c.indexOf(t);d>-1&&c.splice(d,1)}var h=t.get("id"),g=i.get("itemMap");delete g[h];var u=i.get("comboTrees"),p=t.get("id");if(r===D){var l=t.getModel().comboId;if(u&&l){var f=u,y=!1;u.forEach((function(t){y||Object(m["traverseTree"])(t,(function(t){if(t.id===p&&f){var e=f.indexOf(t);return f.splice(e,1),y=!0,!1}return f=t.children,!0}))}))}for(var v=t.getEdges(),b=v.length-1;b>=0;b--)i.removeItem(v[b],!1);l&&i.updateCombo(l)}else if(r===U){var x,O=t.getModel().parentId,j=!1;(u||[]).forEach((function(t){j||Object(m["traverseTree"])(t,(function(t){return t.id!==p||(x=t,j=!0,!1)}))})),x.removed=!0,x&&x.children&&x.children.forEach((function(t){e.removeItem(t.id)}));for(v=t.getEdges(),b=v.length;b>=0;b--)i.removeItem(v[b],!1);O&&i.updateCombo(O)}t.destroy(),i.emit("afterremoveitem",{item:o,type:r})}},t.prototype.setItemState=function(t,e,i){var o=this.graph,r=e;Object(s["isString"])(i)&&(r="".concat(e,":").concat(i)),t.hasState(r)===i&&i||Object(s["isString"])(i)&&t.hasState(r)||(o.emit("beforeitemstatechange",{item:t,state:r,enabled:i}),t.setState(e,i),o.autoPaint(),o.emit("afteritemstatechange",{item:t,state:r,enabled:i}))},t.prototype.priorityState=function(t,e){var i=this.graph,o=t;Object(s["isString"])(t)&&(o=i.findById(t)),this.setItemState(o,e,!1),this.setItemState(o,e,!0)},t.prototype.clearItemStates=function(t,e){var i=this.graph;Object(s["isString"])(t)&&(t=i.findById(t)),i.emit("beforeitemstatesclear",{item:t,states:e}),t.clearStates(e),i.emit("afteritemstatesclear",{item:t,states:e})},t.prototype.refreshItem=function(t){var e=this.graph;Object(s["isString"])(t)&&(t=e.findById(t)),e.emit("beforeitemrefresh",{item:t}),t.refresh(),e.emit("afteritemrefresh",{item:t})},t.prototype.addCombos=function(t,e){var i=this,o=this.graph;(t||[]).forEach((function(t){Object(m["traverseTreeUp"])(t,(function(t){var o;return e.forEach((function(e){e.id===t.id&&(e.children=t.children,e.depth=t.depth,o=e)})),o&&i.addItem("combo",o),!0}))}));var r=o.get("comboGroup");r&&r.sort()},t.prototype.changeItemVisibility=function(t,e){var i=this,o=this.graph;if(Object(s["isString"])(t)&&(t=o.findById(t)),t){if(o.emit("beforeitemvisibilitychange",{item:t,visible:e}),t.changeVisibility(e),t.getType&&t.getType()===D){var r=t.getEdges();Object(s["each"])(r,(function(t){(!e||t.get("source").isVisible()&&t.get("target").isVisible())&&i.changeItemVisibility(t,e)}))}else if(t.getType&&t.getType()===U){var n=o.get("comboTrees"),a=t.get("id"),c=[],d=!1;(n||[]).forEach((function(t){d||t.children&&0!==t.children.length&&Object(m["traverseTree"])(t,(function(t){return t.id!==a||(c=t.children,d=!0,!1)}))})),c&&(!e||e&&!t.getModel().collapsed)&&c.forEach((function(t){var r=o.findById(t.id);i.changeItemVisibility(r,e)}));r=t.getEdges();Object(s["each"])(r,(function(t){(!e||t.get("source").isVisible()&&t.get("target").isVisible())&&i.changeItemVisibility(t,e)}))}return o.emit("afteritemvisibilitychange",{item:t,visible:e}),t}},t.prototype.destroy=function(){this.graph=null,this.destroyed=!0},t}(),W=K,q=function(){function t(t){this.graph=t,this.destroyed=!1}return t.prototype.updateState=function(t,e,i){var o=this.graph.get("states"),r=e;Object(s["isString"])(i)&&(r="".concat(e,":").concat(i)),o[r]||(o[r]=[]),i?o[r].push(t):o[r]=o[r].filter((function(e){return e!==t})),this.graph.set("states",o),this.graph.emit("graphstatechange",{states:o})},t.prototype.updateStates=function(t,e,i){var o=this.graph.get("states"),r=Object(s["isString"])(e)?[e]:e;r.forEach((function(e){var r=e;o[r]||(o[r]=[]),Object(s["isString"])(i)&&(r="".concat(e,":").concat(i)),i?o[r].push(t):o[r]=o[r].filter((function(e){return e!==t}))})),this.graph.set("states",o),this.graph.emit("graphstatechange",{states:e})},t.prototype.destroy=function(){this.graph=null,this.destroyed=!0},t}(),J=q,Q=i("2ef1"),$=i("ae60"),tt=i("737c"),et=i("e003"),it=function(){function t(t,e){this.cfg=Object(s["deepMix"])(this.getDefaultCfg(),e),this.graph=t,this.id=this.cfg.id,this.group=this.cfg.group,this.members=this.cfg.members.map((function(e){return Object(s["isString"])(e)?t.findById(e):e})),this.nonMembers=this.cfg.nonMembers.map((function(e){return Object(s["isString"])(e)?t.findById(e):e})),this.setPadding(),this.setType(),this.path=this.calcPath(this.members,this.nonMembers),this.render()}return t.prototype.getDefaultCfg=function(){return{id:"g6-hull",type:"round-convex",members:[],nonMembers:[],style:{fill:"lightblue",stroke:"blue",opacity:.2},padding:10}},t.prototype.setPadding=function(){var t=this.members.length&&this.members[0].getKeyShape().getCanvasBBox().width/2;this.padding=this.cfg.padding>0?this.cfg.padding+t:10+t,this.cfg.bubbleCfg={nodeR0:this.padding-t,nodeR1:this.padding-t,morphBuffer:this.padding-t}},t.prototype.setType=function(){this.type=this.cfg.type,this.members.length<3&&(this.type="round-convex"),"round-convex"!==this.type&&"smooth-convex"!==this.type&&"bubble"!==this.type&&(this.type="round-convex")},t.prototype.calcPath=function(t,e){var i,o,r;switch(this.type){case"round-convex":i=Object(tt["a"])(t),r=Object($["roundedHull"])(i.map((function(t){return[t.x,t.y]})),this.padding),o=Object(Q["b"])(r);break;case"smooth-convex":i=Object(tt["a"])(t),2===i.length?(r=Object($["roundedHull"])(i.map((function(t){return[t.x,t.y]})),this.padding),o=Object(Q["b"])(r)):i.length>2&&(r=Object($["paddedHull"])(i.map((function(t){return[t.x,t.y]})),this.padding),o=Object($["getClosedSpline"])(r));break;case"bubble":i=Object(et["a"])(t,e,this.cfg.bubbleCfg),o=i.length>=2&&Object($["getClosedSpline"])(i);break;default:}return o},t.prototype.render=function(){this.group.addShape("path",{attrs:Object(r["__assign"])({path:this.path},this.cfg.style),id:this.id,name:this.cfg.id,capture:!1}),this.group.toBack()},t.prototype.addMember=function(t){if(t){Object(s["isString"])(t)&&(t=this.graph.findById(t)),this.members.push(t);var e=this.nonMembers.indexOf(t);return e>-1&&this.nonMembers.splice(e,1),this.updateData(this.members,this.nonMembers),!0}},t.prototype.addNonMember=function(t){if(t){Object(s["isString"])(t)&&(t=this.graph.findById(t)),this.nonMembers.push(t);var e=this.members.indexOf(t);return e>-1&&this.members.splice(e,1),this.updateData(this.members,this.nonMembers),!0}},t.prototype.removeMember=function(t){if(t){Object(s["isString"])(t)&&(t=this.graph.findById(t));var e=this.members.indexOf(t);return e>-1&&(this.members.splice(e,1),this.updateData(this.members,this.nonMembers),!0)}},t.prototype.removeNonMember=function(t){if(t){Object(s["isString"])(t)&&(t=this.graph.findById(t));var e=this.nonMembers.indexOf(t);return e>-1&&(this.nonMembers.splice(e,1),this.updateData(this.members,this.nonMembers),!0)}},t.prototype.updateData=function(t,e){var i=this;this.group.findById(this.id).remove(),t&&(this.members=t.map((function(t){return Object(s["isString"])(t)?i.graph.findById(t):t}))),e&&(this.nonMembers=e.map((function(t){return Object(s["isString"])(t)?i.graph.findById(t):t}))),this.path=this.calcPath(this.members,this.nonMembers),this.render()},t.prototype.updateStyle=function(t){var e=this.group.findById(this.id);e.attr(Object(r["__assign"])({},t))},t.prototype.updateCfg=function(t){var e=this;this.cfg=Object(s["deepMix"])(this.cfg,t),this.id=this.cfg.id,this.group=this.cfg.group,t.members&&(this.members=this.cfg.members.map((function(t){return Object(s["isString"])(t)?e.graph.findById(t):t}))),t.nonMembers&&(this.nonMembers=this.cfg.nonMembers.map((function(t){return Object(s["isString"])(t)?e.graph.findById(t):t}))),this.setPadding(),this.setType(),this.path=this.calcPath(this.members,this.nonMembers),this.render()},t.prototype.contain=function(t){var e,i,o=this;e=Object(s["isString"])(t)?this.graph.findById(t):t;var r=e.getKeyShape();if("path"===e.get("type"))i=Object($["pathToPoints"])(r.attr("path"));else{var n=r.getCanvasBBox();i=[[n.minX,n.minY],[n.maxX,n.minY],[n.maxX,n.maxY],[n.minX,n.maxY]]}return i=i.map((function(t){var e=o.graph.getPointByCanvas(t[0],t[1]);return[e.x,e.y]})),Object(d["isPolygonsIntersect"])(i,Object($["pathToPoints"])(this.path))},t.prototype.destroy=function(){this.group.remove(),this.cfg=null},t}(),ot=it,rt=a["a"].transform,nt="node",at=function(t){function e(e){var i=t.call(this)||this;return i.sortCombos=Object(s["debounce"])((function(){var t=i.get("comboSorted");if(i&&!i.destroyed&&!t){i.set("comboSorted",!0);var e=[],o={},r=i.get("comboTrees");(r||[]).forEach((function(t){Object(m["traverseTree"])(t,(function(t){return e[t.depth]?e[t.depth].push(t.id):e[t.depth]=[t.id],o[t.id]=t.depth,!0}))}));var n=i.getEdges().concat(i.get("vedges"));(n||[]).forEach((function(t){var i=t.getModel(),r=o[i.source]||0,n=o[i.target]||0,a=Math.max(r,n);e[a]?e[a].push(i.id):e[a]=[i.id]})),e.forEach((function(t){if(t&&t.length)for(var e=t.length-1;e>=0;e--){var o=i.findById(t[e]);o&&o.toFront()}}))}}),500,!1),i.cfg=Object(s["deepMix"])(i.getDefaultCfg(),e),i.init(),i.animating=!1,i.destroyed=!1,i.cfg.enabledStack&&(i.undoStack=new c["Stack"](i.cfg.maxStep),i.redoStack=new c["Stack"](i.cfg.maxStep)),i}return Object(r["__extends"])(e,t),e.prototype.init=function(){this.initCanvas();var t=new b(this),e=new l(this),i=new W(this),o=new J(this);this.set({viewController:t,modeController:e,itemController:i,stateController:o}),this.initLayoutController(),this.initEventController(),this.initGroups(),this.initPlugins()},e.prototype.initGroups=function(){var t=this.get("canvas");if(t){var e=t.get("el"),i=(e||{}).id,o=void 0===i?"g6":i,r=t.addGroup({id:"".concat(o,"-root"),className:g["a"].rootContainerClassName});if(this.get("groupByTypes")){var n=r.addGroup({id:"".concat(o,"-edge"),className:g["a"].edgeContainerClassName}),a=r.addGroup({id:"".concat(o,"-node"),className:g["a"].nodeContainerClassName}),s=r.addGroup({id:"".concat(o,"-combo"),className:g["a"].comboContainerClassName});s.toBack(),this.set({nodeGroup:a,edgeGroup:n,comboGroup:s})}var c=r.addGroup({id:"".concat(o,"-delegate"),className:g["a"].delegateContainerClassName});this.set({delegateGroup:c}),this.set("group",r)}},e.prototype.getDefaultCfg=function(){return{container:void 0,width:void 0,height:void 0,renderer:"canvas",modes:{},plugins:[],data:{},fitViewPadding:10,minZoom:.02,maxZoom:10,event:!0,groupByTypes:!0,directed:!1,autoPaint:!0,nodes:[],edges:[],combos:[],vedges:[],itemMap:{},linkCenter:!1,defaultNode:{},defaultEdge:{},nodeStateStyles:{},edgeStateStyles:{},states:{},animate:!1,animateCfg:{onFrame:void 0,duration:500,easing:"easeLinear"},callback:void 0,enabledStack:!1,maxStep:10,tooltips:[],optimizeThreshold:1e3}},e.prototype.set=function(t,e){return Object(s["isPlainObject"])(t)?this.cfg=Object(r["__assign"])(Object(r["__assign"])({},this.cfg),t):this.cfg[t]=e,"enabledStack"!==t||!e||this.undoStack||this.redoStack||(this.undoStack=new c["Stack"](this.cfg.maxStep),this.redoStack=new c["Stack"](this.cfg.maxStep)),this},e.prototype.get=function(t){var e;return null===(e=this.cfg)||void 0===e?void 0:e[t]},e.prototype.getGroup=function(){return this.get("group")},e.prototype.getContainer=function(){return this.get("container")},e.prototype.getMinZoom=function(){return this.get("minZoom")},e.prototype.setMinZoom=function(t){return this.set("minZoom",t)},e.prototype.getMaxZoom=function(){return this.get("maxZoom")},e.prototype.setMaxZoom=function(t){return this.set("maxZoom",t)},e.prototype.getWidth=function(){return this.get("width")},e.prototype.getHeight=function(){return this.get("height")},e.prototype.clearItemStates=function(t,e){Object(s["isString"])(t)&&(t=this.findById(t));var i=this.get("itemController");e||(e=t.get("states")),i.clearItemStates(t,e);var o=this.get("stateController");o.updateStates(t,e,!1)},e.prototype.node=function(t){"function"===typeof t&&this.set("nodeMapper",t)},e.prototype.edge=function(t){"function"===typeof t&&this.set("edgeMapper",t)},e.prototype.combo=function(t){"function"===typeof t&&this.set("comboMapper",t)},e.prototype.findById=function(t){return this.get("itemMap")[t]},e.prototype.find=function(t,e){var i,o=this.get("".concat(t,"s"));return Object(s["each"])(o,(function(t,o){if(e(t,o))return i=t,i})),i},e.prototype.findAll=function(t,e){var i=[];return Object(s["each"])(this.get("".concat(t,"s")),(function(t,o){e(t,o)&&i.push(t)})),i},e.prototype.findAllByState=function(t,e,i){return i?this.findAll(t,(function(t){return t.hasState(e)&&i(t)})):this.findAll(t,(function(t){return t.hasState(e)}))},e.prototype.translate=function(t,e,i,o){var r=this,n=this.get("group"),a=Object(s["clone"])(n.getMatrix());if(a||(a=[1,0,0,0,1,0,0,0,1]),i){var c=Object(m["getAnimateCfgWithCallback"])({animateCfg:o,callback:function(){return r.emit("viewportchange",{action:"translate",matrix:n.getMatrix()})}});Object(d["move"])(n,{x:n.getCanvasBBox().x+t,y:n.getCanvasBBox().y+e},i,c||{duration:500,easing:"easeCubic"})}else a=rt(a,[["t",t,e]]),n.setMatrix(a),this.emit("viewportchange",{action:"translate",matrix:a}),this.autoPaint()},e.prototype.moveTo=function(t,e,i,o){var r=this.get("group");Object(d["move"])(r,{x:t,y:e},i,o||{duration:500,easing:"easeCubic"}),this.emit("viewportchange",{action:"move",matrix:r.getMatrix()})},e.prototype.fitView=function(t,e,i,o){t&&this.set("fitViewPadding",t);var r=this.get("viewController");e?r.fitViewByRules(e,i,o):r.fitView(i,o),this.autoPaint()},e.prototype.fitCenter=function(t,e){var i=this.get("viewController");i.fitCenter(t,e),this.autoPaint()},e.prototype.addBehaviors=function(t,e){var i=this.get("modeController");return i.manipulateBehaviors(t,e,!0),this},e.prototype.removeBehaviors=function(t,e){var i=this.get("modeController");return i.manipulateBehaviors(t,e,!1),this},e.prototype.updateBehavior=function(t,e,i){var o=this.get("modeController");return o.updateBehavior(t,e,i),this},e.prototype.zoom=function(t,e,i,o){var r=this,n=this.get("group"),a=Object(s["clone"])(n.getMatrix())||[1,0,0,0,1,0,0,0,1],c=this.get("minZoom"),h=this.get("maxZoom"),g=this.getZoom()||1,u=g*t,p=t,l=!1;if(c&&u<c?(p=c/g,l=!0):h&&u>h&&(p=h/g,l=!0),a=rt(a,e?[["t",-e.x,-e.y],["s",p,p],["t",e.x,e.y]]:[["s",p,p]]),i){var f=Object(s["clone"])(n.getMatrix());f||(f=[1,0,0,0,1,0,0,0,1]);var y=f[0],v=y*p,b=Object(m["getAnimateCfgWithCallback"])({animateCfg:o,callback:function(){return r.emit("viewportchange",{action:"zoom",matrix:n.getMatrix()})}});n.animate((function(t){if(1===t)f=a;else{var i=Object(d["lerp"])(y,v,t)/f[0];f=rt(f,e?[["t",-e.x,-e.y],["s",i,i],["t",e.x,e.y]]:[["s",i,i]])}return{matrix:f}}),b)}else n.setMatrix(a),this.emit("viewportchange",{action:"zoom",matrix:a}),this.autoPaint();return!l},e.prototype.zoomTo=function(t,e,i,o){var r=t/this.getZoom();return this.zoom(r,e,i,o)},e.prototype.focusItem=function(t,e,i){var o=this.get("viewController"),r=!1;e?r=!0:void 0===e&&(r=this.get("animate"));var n={};i?n=i:void 0===i&&(n=this.get("animateCfg")),o.focus(t,r,n),this.autoPaint()},e.prototype.focusItems=function(t,e,i,o){var r=this.get("viewController");r.focusItems(t,e,i,o)},e.prototype.autoPaint=function(){this.get("autoPaint")&&this.paint()},e.prototype.paint=function(){this.emit("beforepaint"),this.get("canvas").draw(),this.emit("afterpaint")},e.prototype.getPointByClient=function(t,e){var i=this.get("viewController");return i.getPointByClient(t,e)},e.prototype.getClientByPoint=function(t,e){var i=this.get("viewController");return i.getClientByPoint(t,e)},e.prototype.getPointByCanvas=function(t,e){var i=this.get("viewController");return i.getPointByCanvas(t,e)},e.prototype.getCanvasByPoint=function(t,e){var i=this.get("viewController");return i.getCanvasByPoint(t,e)},e.prototype.getGraphCenterPoint=function(){var t=this.get("group").getCanvasBBox();return{x:(t.minX+t.maxX)/2,y:(t.minY+t.maxY)/2}},e.prototype.getViewPortCenterPoint=function(){return this.getPointByCanvas(this.get("width")/2,this.get("height")/2)},e.prototype.showItem=function(t,e){void 0===e&&(e=!0);var i=this.get("itemController"),o=i.changeItemVisibility(t,!0);if(e&&this.get("enabledStack")){var r=o.getID(),n=o.getType(),a={},s={};switch(n){case"node":a.nodes=[{id:r,visible:!1}],s.nodes=[{id:r,visible:!0}];break;case"edge":a.nodes=[{id:r,visible:!1}],s.edges=[{id:r,visible:!0}];break;case"combo":a.nodes=[{id:r,visible:!1}],s.combos=[{id:r,visible:!0}];break;default:break}this.pushStack("visible",{before:a,after:s})}},e.prototype.hideItem=function(t,e){void 0===e&&(e=!0);var i=this.get("itemController"),o=i.changeItemVisibility(t,!1);if(e&&this.get("enabledStack")){var r=o.getID(),n=o.getType(),a={},s={};switch(n){case"node":a.nodes=[{id:r,visible:!0}],s.nodes=[{id:r,visible:!1}];break;case"edge":a.nodes=[{id:r,visible:!0}],s.edges=[{id:r,visible:!1}];break;case"combo":a.nodes=[{id:r,visible:!0}],s.combos=[{id:r,visible:!1}];break;default:break}this.pushStack("visible",{before:a,after:s})}},e.prototype.refreshItem=function(t){var e=this.get("itemController");e.refreshItem(t)},e.prototype.setAutoPaint=function(t){var e=this;e.set("autoPaint",t);var i=e.get("canvas");i.set("autoDraw",t)},e.prototype.remove=function(t,e){void 0===e&&(e=!0),this.removeItem(t,e)},e.prototype.removeItem=function(t,e){void 0===e&&(e=!0);var i=t;if(Object(s["isString"])(t)&&(i=this.findById(t)),!i&&Object(s["isString"])(t));else if(i){var o="";if(i.getType&&(o=i.getType()),e&&this.get("enabledStack")){var n=Object(r["__assign"])(Object(r["__assign"])({},i.getModel()),{itemType:o}),a={};switch(o){case"node":a.nodes=[n],a.edges=[];for(var c=i.getEdges(),d=c.length-1;d>=0;d--)a.edges.push(Object(r["__assign"])(Object(r["__assign"])({},c[d].getModel()),{itemType:"edge"}));break;case"edge":a.edges=[n];break;case"combo":a.combos=[n];break;default:break}this.pushStack("delete",{before:a,after:{}})}if("node"===o){var h=i.getModel();h.comboId&&this.updateComboTree(i,void 0,!1)}var g=this.get("itemController");if(g.removeItem(i),"combo"===o){var u=Object(m["reconstructTree"])(this.get("comboTrees"));this.set("comboTrees",u)}}},e.prototype.innerAddItem=function(t,e,i){if(!Object(h["b"])(t,e))return!1;if(!e.id||!this.findById(e.id)){var o,n=this.get("comboTrees")||[];if("combo"===t){var a=this.get("itemMap"),c=!1;if(n.forEach((function(n){c||Object(m["traverseTreeUp"])(n,(function(n){if(e.parentId===n.id){c=!0;var s=Object(r["__assign"])({id:e.id,depth:n.depth+2},e);n.children?n.children.push(s):n.children=[s],e.depth=s.depth,o=i.addItem(t,e)}var d=a[n.id];return c&&d&&d.getType&&"combo"===d.getType()&&i.updateCombo(d,n.children),!0}))})),!c){var d=Object(r["__assign"])({id:e.id,depth:0},e);e.depth=d.depth,n.push(d),o=i.addItem(t,e)}this.set("comboTrees",n),e.collapsed&&(this.collapseCombo(o,!1),this.updateCombo(o))}else if("node"===t&&Object(s["isString"])(e.comboId)&&n){var g=this.findById(e.comboId);g&&g.getType&&g.getType(),o=i.addItem(t,e);var u=this.get("itemMap"),p=!1,l=!1;n.forEach((function(t){l||p||Object(m["traverseTreeUp"])(t,(function(t){if(t.id===e.id)return l=!0,!1;if(e.comboId===t.id&&!l){p=!0;var o=Object(s["clone"])(e);o.itemType="node",t.children?t.children.push(o):t.children=[o],o.depth=t.depth+1}return p&&u[t.id].getType&&"combo"===u[t.id].getType()&&i.updateCombo(u[t.id],t.children),!0}))}))}else o=i.addItem(t,e);if("node"===t&&e.comboId||"combo"===t&&e.parentId){g=this.findById(e.comboId||e.parentId);g&&g.getType&&"combo"===g.getType()&&g.addChild(o)}return o}},e.prototype.addItem=function(t,e,i,o){void 0===i&&(i=!0),void 0===o&&(o=!0);var n=this.get("comboSorted");this.set("comboSorted",n&&!o);var a=this.get("itemController"),s=this.innerAddItem(t,e,a);if(!1===s||!0===s)return s;var c=this.get("combos");if(c&&c.length>0&&this.sortCombos(),this.autoPaint(),i&&this.get("enabledStack")){var d=Object(r["__assign"])(Object(r["__assign"])({},s.getModel()),{itemType:t}),h={};switch(t){case"node":h.nodes=[d];break;case"edge":h.edges=[d];break;case"combo":h.combos=[d];break;default:break}this.pushStack("add",{before:{},after:h})}return s},e.prototype.addItems=function(t,e,i){void 0===t&&(t=[]),void 0===e&&(e=!0),void 0===i&&(i=!0);var o=this.get("comboSorted");this.set("comboSorted",o&&!i);for(var n=this.get("itemController"),a=[],s=0;s<t.length;s++){var c=t[s];"edge"!==c.type&&"vedge"!==c.type?a.push(this.innerAddItem(c.type,c.model,n)):a.push(void 0)}for(s=0;s<t.length;s++){c=t[s];"edge"!==c.type&&"vedge"!==c.type||(a[s]=this.innerAddItem(c.type,c.model,n))}if(i){var d=this.get("combos");d&&d.length>0&&this.sortCombos()}if(this.autoPaint(),e&&this.get("enabledStack")){var h={nodes:[],edges:[],combos:[]};for(s=0;s<t.length;s++){var g=t[s].type,u=a[s];if(u&&!0!==u){var p=Object(r["__assign"])(Object(r["__assign"])({},u.getModel()),{itemType:g});switch(g){case"node":h.nodes.push(p);break;case"edge":h.edges.push(p);break;case"combo":h.combos.push(p);break;default:break}}}this.pushStack("addItems",{before:{},after:h})}return a},e.prototype.add=function(t,e,i,o){return void 0===i&&(i=!0),void 0===o&&(o=!0),this.addItem(t,e,i,o)},e.prototype.updateItem=function(t,e,i){var o=this;void 0===i&&(i=!0);var n,a=this.get("itemController");n=Object(s["isString"])(t)?this.findById(t):t;var c,d=i&&this.get("enabledStack");d&&(c=Object(s["clone"])(n.getModel()));var h="";n.getType&&(h=n.getType());var g=Object(r["__spreadArray"])([],n.getStates(),!0);if("combo"===h&&Object(s["each"])(g,(function(t){return o.setItemState(n,t,!1)})),a.updateItem(n,e),"combo"===h&&Object(s["each"])(g,(function(t){return o.setItemState(n,t,!0)})),d){var u={nodes:[],edges:[],combos:[]},p={nodes:[],edges:[],combos:[]},l=Object(r["__assign"])({id:c.id},e);switch(h){case"node":u.nodes.push(c),p.nodes.push(l);break;case"edge":u.edges.push(c),p.edges.push(l);break;case"combo":u.combos.push(c),p.combos.push(l);break;default:break}this.pushStack("update",{before:u,after:p})}},e.prototype.update=function(t,e,i){void 0===i&&(i=!0),this.updateItem(t,e,i)},e.prototype.setItemState=function(t,e,i){Object(s["isString"])(t)&&(t=this.findById(t));var o=this.get("itemController");o.setItemState(t,e,i);var r=this.get("stateController");r.updateState(t,e,i)},e.prototype.priorityState=function(t,e){var i=this.get("itemController");i.priorityState(t,e)},e.prototype.data=function(t){Object(h["a"])(t),this.set("data",t)},e.prototype.render=function(){var t=this;this.set("comboSorted",!1);var e=this.get("data");if(this.get("enabledStack")&&this.clearStack(),!e)throw new Error("data must be defined first");var i=e.nodes,o=void 0===i?[]:i,r=e.edges,n=void 0===r?[]:r,a=e.combos,s=void 0===a?[]:a;if(this.clear(!0),this.emit("beforerender"),t.addItems(o.map((function(t){return{type:"node",model:t}})),!1,!1),0!==(null===s||void 0===s?void 0:s.length)){var c=Object(m["plainCombosToTrees"])(s,o);this.set("comboTrees",c),t.addCombos(s)}t.addItems(n.map((function(t){return{type:"edge",model:t}})),!1,!1);var d=t.get("animate");(t.get("fitView")||t.get("fitCenter"))&&t.set("animate",!1);var h=t.get("layoutController");if(h){if(h.layout(g),this.destroyed)return}else g();function g(){(t.get("comboTrees")||[]).forEach((function(e){Object(m["traverseTreeUp"])(e,(function(e){var i=t.findById(e.id);return"combo"===i.getType()&&e.collapsed&&(t.collapseCombo(e.id,!1),t.updateCombo(i)),!0}))})),t.get("fitView")?t.fitView():t.get("fitCenter")&&t.fitCenter(),t.autoPaint(),t.emit("afterrender"),(t.get("fitView")||t.get("fitCenter"))&&t.set("animate",d),setTimeout((function(){var e;null===(e=t.getCombos())||void 0===e||e.forEach((function(t){t.set("animate",!0)}))}),0)}if(!this.get("groupByTypes"))if(s&&0!==s.length)this.sortCombos();else if(e.nodes&&e.edges&&e.nodes.length<e.edges.length){var u=this.getNodes();u.forEach((function(t){t.toFront()}))}else{var p=this.getEdges();p.forEach((function(t){t.toBack()}))}},e.prototype.read=function(t){this.data(t),this.render()},e.prototype.diffItems=function(t,e,i){var o,r=this,n=this.get("itemMap");Object(s["each"])(i,(function(i){if(o=n[i.id],o){if(r.get("animate")&&t===nt){var a=o.getContainer().getMatrix();a||(a=[1,0,0,0,1,0,0,0,1]),o.set("originAttrs",{x:a[6],y:a[7]})}r.updateItem(o,i,!1)}else o=r.addItem(t,i,!1);o&&e["".concat(t,"s")].push(o)}))},e.prototype.changeData=function(t,e){var i,o=this;void 0===e&&(e=!0);var r=this,n=t||r.get("data");if(!Object(h["a"])(n))return this;this.emit("beforechangedata"),e&&this.get("enabledStack")&&this.pushStack("changedata",{before:r.save(),after:n}),this.set("comboSorted",!1),this.removeHulls(),this.getNodes().map((function(t){return r.clearItemStates(t)})),this.getEdges().map((function(t){return r.clearItemStates(t)}));var a=this.get("canvas"),c=a.get("localRefresh");a.set("localRefresh",!1),r.get("data")||(r.data(n),r.render());var d=this.get("itemMap"),g={nodes:[],edges:[]},u=n.combos;if(u){var p=Object(m["plainCombosToTrees"])(u,n.nodes);this.set("comboTrees",p)}else this.set("comboTrees",[]);this.diffItems("node",g,n.nodes),Object(s["each"])(d,(function(t,e){d[e].getModel().depth=0,t.getType&&"edge"===t.getType()||(t.getType&&"combo"===t.getType()?(delete d[e],t.destroy()):g.nodes.indexOf(t)<0&&(delete d[e],r.remove(t,!1)))}));for(var l=this.getCombos(),f=l.length,y=f-1;y>=0;y--)l[y].destroyed&&l.splice(y,1);u&&(r.addCombos(u),this.get("groupByTypes")||this.sortCombos()),this.diffItems("edge",g,n.edges),Object(s["each"])(d,(function(t,e){(!t.getType||"node"!==t.getType()&&"combo"!==t.getType())&&g.edges.indexOf(t)<0&&(delete d[e],r.remove(t,!1))})),(this.get("comboTrees")||[]).forEach((function(t){Object(m["traverseTreeUp"])(t,(function(t){var e=o.findById(t.id);return"combo"===e.getType()&&t.collapsed&&o.collapseCombo(t.id,!1),!0}))})),this.set({nodes:g.nodes,edges:g.edges});var v=(this.get("layout")||{}).relayoutAtChangeData,b=void 0===v||v,x=this.get("layoutController");return b&&x&&(x.changeData((function(){setTimeout((function(){var t;null===(t=r.getCombos())||void 0===t||t.forEach((function(t){t.set("animate",!0)}))}),0)})),r.get("animate")&&!x.getLayoutType()?(r.positionsAnimate(),null===(i=r.getCombos())||void 0===i||i.forEach((function(t){return t.set("animate",!0)}))):r.autoPaint()),setTimeout((function(){a.set("localRefresh",c)}),16),this.set("data",n),this.emit("afterchangedata"),this},e.prototype.addCombos=function(t){var e=this,i=e.get("comboTrees"),o=this.get("itemController");o.addCombos(i,t)},e.prototype.createCombo=function(t,e,i){var o=this;void 0===i&&(i=!0);var r=this.get("itemController");this.set("comboSorted",!1);var n,a="";if(t){if(Object(s["isString"])(t))a=t,n={id:t};else{if(a=t.id,!a)return;n=t}var c=i&&this.get("enabledStack"),d={nodes:[],combos:[]};c&&e.forEach((function(t){var e=o.findById(t),i=e.getType();if("node"===i||"combo"===i){var r=e.getModel();d["".concat(i,"s")].push({id:t,parentId:"node"===i?r.comboId:r.parentId})}}));var h=this.get("comboTrees"),g=new Set(e),u=new Map;h&&(h.forEach((function(t){Object(m["traverseTreeUp"])(t,(function(t,e,i){if(g.has(t.id)){if(e){var n=o.findById(e.id),a=o.findById(t.id);e.children.splice(i,1),n.removeChild(a),r.updateCombo(n,e.children)}"combo"===t.itemType&&u.set(t.id,t)}return!0}))})),h=h.filter((function(t){return!g.has(t.id)})),this.set("comboTrees",h));var p={nodes:[],combos:[]},l=e.map((function(t){var e=o.findById(t),i=e.getModel(),r="";e.getType&&(r=e.getType());var n=u.get(t)||{id:e.getID(),itemType:r};return"combo"===r?(n.parentId=a,i.parentId=a):"node"===r&&(n.comboId=a,i.comboId=a),c&&p["".concat(r,"s")].push({id:i.id,parentId:a}),n}));n.children=l,this.addItem("combo",n,!1),this.set("comboSorted",!1),h&&(h.forEach((function(t){Object(m["traverseTree"])(t,(function(t){return t.id!==a||(t.itemType="combo",t.children=l,!1)}))})),this.sortCombos()),c&&(p.combos.push(n),this.pushStack("createCombo",{before:d,after:p}));var f=this.findById(a);!f.getModel().parentId&&f.getChildren().combos.length&&this.updateComboTree(f,void 0,!1),setTimeout((function(){f.set("animate",!0)}),0)}},e.prototype.uncombo=function(t,e){var i,o,r=this;void 0===e&&(e=!0);var n=this,a=t;if(Object(s["isString"])(t)&&(a=this.findById(t)),a&&(!a.getType||"combo"===a.getType())){var c=a.getModel(),d=a.getModel().parentId,h=n.get("comboTrees");h||(h=[]);var g,u=this.get("itemMap"),p=a.get("id"),l=[],f=this.get("combos"),y=this.findById(d),v=e&&this.get("enabledStack"),b={};if(v&&(b=Object(s["clone"])(c),b.children=[]),h.forEach((function(t){g||Object(m["traverseTreeUp"])(t,(function(t){var e;if(t.id===p){g=t;var i=a.getEdges().map((function(t){return t.getID()}));i.forEach((function(t){r.removeItem(t,!1)}));var o=f.indexOf(a);f.splice(o,1),delete u[p];var n=Object(s["clone"])(a.getModel());a.destroy(),r.emit("afterremoveitem",{item:n,type:"combo"})}if(d&&g&&t.id===d){y.removeCombo(a),l=t.children;o=l.indexOf(g);return-1!==o&&l.splice(o,1),null===(e=g.children)||void 0===e||e.forEach((function(t){var e=r.findById(t.id),i=e.getModel();e.getType&&"combo"===e.getType()?(t.parentId=d,delete t.comboId,i.parentId=d,delete i.comboId):e.getType&&"node"===e.getType()&&(t.comboId=d,i.comboId=d),y.addChild(e),l.push(t)})),r.updateCombo(y),!1}return!0}))})),!d&&g){var x=h.indexOf(g);h.splice(x,1),null===(i=g.children)||void 0===i||i.forEach((function(t){t.parentId=void 0;var e=r.findById(t.id).getModel();delete e.parentId,delete e.comboId,"node"!==t.itemType&&h.push(t)}))}if(v){var O={nodes:[],combos:[]},j={nodes:[],combos:[]};null===(o=g.children)||void 0===o||o.forEach((function(t){var e=r.findById(t.id),i=e.getType();"node"!==i&&"combo"!==i||(O["".concat(i,"s")].push({id:t.id,parentId:p}),j["".concat(i,"s")].push({id:t.id,parentId:d}))})),O.combos.push(b),this.pushStack("uncombo",{before:O,after:j})}}},e.prototype.updateCombos=function(t){var e=this;void 0===t&&(t=!1);var i=this,o=this.get("comboTrees"),n=i.get("itemController"),a=i.get("itemMap");(o||[]).forEach((function(i){Object(m["traverseTreeUp"])(i,(function(i){var o;if(!i)return!0;var c=a[i.id];if("combo"===(null===(o=null===c||void 0===c?void 0:c.getType)||void 0===o?void 0:o.call(c))){var d=Object(r["__spreadArray"])([],c.getStates(),!0);Object(s["each"])(d,(function(t){return e.setItemState(c,t,!1)})),n.updateCombo(c,i.children,t),Object(s["each"])(d,(function(t){return e.setItemState(c,t,!0)}))}return!0}))})),i.sortCombos()},e.prototype.updateCombo=function(t){var e,i=this,o=this,n=t;if(Object(s["isString"])(t)&&(n=this.findById(t)),n&&(!n.getType||"combo"===n.getType())){e=n.get("id");var a=this.get("comboTrees"),c=o.get("itemController"),d=o.get("itemMap");(a||[]).forEach((function(t){Object(m["traverseTreeUp"])(t,(function(t){if(!t)return!0;var o=d[t.id];if(e===t.id&&o&&o.getType&&"combo"===o.getType()){var n=Object(r["__spreadArray"])([],o.getStates(),!0);Object(s["each"])(n,(function(t){o.getStateStyle(t)&&i.setItemState(o,t,!1)})),c.updateCombo(o,t.children),Object(s["each"])(n,(function(t){o.getStateStyle(t)&&i.setItemState(o,t,!0)})),e&&(e=t.parentId)}return!0}))}))}},e.prototype.updateComboTree=function(t,e,i){void 0===i&&(i=!0);var o,r=this;this.set("comboSorted",!1),o=Object(s["isString"])(t)?r.findById(t):t;var n=o.getModel(),a=n.comboId||n.parentId,c="";if(o.getType&&(c=o.getType()),e&&"combo"===c){var d,h=this.get("comboTrees"),g=!0;if((h||[]).forEach((function(t){d||Object(m["traverseTree"])(t,(function(t){if(!d)return t.id===o.getID()&&(d=t),!0}))})),Object(m["traverseTree"])(d,(function(t){return t.id!==e||(g=!1,!1)})),!g)return}if(i&&this.get("enabledStack")){var u={},p={};"combo"===c?(u.combos=[{id:n.id,parentId:n.parentId}],p.combos=[{id:n.id,parentId:e}]):"node"===c&&(u.nodes=[{id:n.id,parentId:n.comboId}],p.nodes=[{id:n.id,parentId:e}]),this.pushStack("updateComboTree",{before:u,after:p})}if(n.parentId||n.comboId){var l=this.findById(n.parentId||n.comboId);l&&l.removeChild(o)}if("combo"===c?n.parentId=e:"node"===c&&(n.comboId=e),e){var f=this.findById(e);f&&f.addChild(o)}if(a){f=this.findById(a);f&&f.removeChild(o)}var y=Object(m["reconstructTree"])(this.get("comboTrees"),n.id,e);this.set("comboTrees",y),this.updateCombos()},e.prototype.save=function(){var t=[],e=[],i=[];return Object(s["each"])(this.get("nodes"),(function(e){t.push(e.getModel())})),Object(s["each"])(this.get("edges"),(function(t){e.push(t.getModel())})),Object(s["each"])(this.get("combos"),(function(t){i.push(t.getModel())})),{nodes:t,edges:e,combos:i}},e.prototype.changeSize=function(t,e){var i=this.get("viewController");return i.changeSize(t,e),this},e.prototype.refresh=function(){var t=this;if(t.emit("beforegraphrefresh"),t.get("animate"))t.positionsAnimate();else{var e=t.get("nodes"),i=t.get("edges"),o=t.get("edges");Object(s["each"])(e,(function(t){t.refresh()})),Object(s["each"])(i,(function(t){t.refresh()})),Object(s["each"])(o,(function(t){t.refresh()}))}t.emit("aftergraphrefresh"),t.autoPaint()},e.prototype.getNodes=function(){return this.get("nodes")},e.prototype.getEdges=function(){return this.get("edges")},e.prototype.getCombos=function(){return this.get("combos")},e.prototype.getComboChildren=function(t){if(Object(s["isString"])(t)&&(t=this.findById(t)),t&&(!t.getType||"combo"===t.getType()))return t.getChildren()},e.prototype.positionsAnimate=function(t){var e=this;e.emit("beforeanimate");var i=e.get("animateCfg"),o=i.onFrame,r=t?e.getNodes().concat(e.getCombos()):e.getNodes(),n=r.map((function(t){var e=t.getModel();return{id:e.id,x:e.x,y:e.y}}));e.stopAnimate();var a=e.get("canvas");e.animating=!0,setTimeout((function(){a.animate((function(i){Object(s["each"])(n,(function(t){var r=e.findById(t.id);if(r&&!r.destroyed){var n=r.get("originAttrs"),a=r.get("model"),s=r.getContainer().getMatrix();if(void 0!==n&&null!==n||(s&&(n={x:s[6],y:s[7]}),r.set("originAttrs",n||0)),o){var c=o(r,i,t,n||{x:0,y:0});r.set("model",Object.assign(a,c))}else n?(a.x=n.x+(t.x-n.x)*i,a.y=n.y+(t.y-n.y)*i):(a.x=t.x,a.y=t.y)}})),e.refreshPositions(t)}),{duration:i.duration,easing:i.easing,callback:function(){Object(s["each"])(r,(function(t){t.set("originAttrs",null)})),i.callback&&i.callback(),e.emit("afteranimate"),e.animating=!1}})}),0)},e.prototype.refreshPositions=function(t){var e=this;e.emit("beforegraphrefreshposition");var i,o=e.get("nodes"),r=e.get("edges"),n=e.get("vedges"),a=e.get("combos"),c={},d=function(t){Object(s["each"])(t,(function(t){i=t.getModel();var e=t.get("originAttrs");if(!e||i.x!==e.x||i.y!==e.y){var o=t.updatePosition({x:i.x,y:i.y});c[i.id]=o,i.comboId&&(c[i.comboId]=c[i.comboId]||o),i.parentId&&(c[i.parentId]=c[i.parentId]||o)}}))};d(a),d(o),a&&0!==a.length&&(t?(d(a),e.updateCombos()):e.updateCombos()),Object(s["each"])(r,(function(t){var e=t.getSource().getModel(),i=t.getTarget();if(!Object(s["isPlainObject"])(i)){var o=i.getModel();(c[e.id]||c[o.id]||t.getModel().isComboEdge)&&t.refresh()}})),Object(s["each"])(n,(function(t){t.refresh()})),e.emit("aftergraphrefreshposition"),e.autoPaint()},e.prototype.stopAnimate=function(){var t=this.get("canvas"),e=t.cfg.timeline;e&&e.stopAllAnimations()},e.prototype.isAnimating=function(){return this.animating},e.prototype.getZoom=function(){var t=this.get("group").getMatrix();return t?t[0]:1},e.prototype.getCurrentMode=function(){var t=this.get("modeController");return t.getMode()},e.prototype.setMode=function(t){var e=this.get("modeController");return e.setMode(t),this},e.prototype.clear=function(t){var e;return void 0===t&&(t=!1),null===(e=this.get("canvas"))||void 0===e||e.clear(),this.initGroups(),this.set({itemMap:{},nodes:[],edges:[],vedges:[],groups:[],combos:[],comboTrees:[]}),t||this.emit("afterrender"),this},e.prototype.updateLayout=function(t,e,i,o){var n=this;void 0===t&&(t={}),void 0===o&&(o=!0);var a=this.get("layoutController");if(Object(s["isString"])(t)&&(t={type:t}),e){var c=i;c||(c="begin"===e?{x:0,y:0}:{x:this.getWidth()/2,y:this.getHeight()/2}),c=this.getPointByCanvas(c.x,c.y);var d=["force","gForce","fruchterman","force2"];d.includes(t.type)||!t.type&&d.includes(null===a||void 0===a?void 0:a.layoutType)?t.center=[c.x,c.y]:this.once("afterlayout",(function(t){var i=n.getGroup().getMatrix()||[1,0,0,0,1,0,0,0,1];c.x=c.x*i[0]+i[6],c.y=c.y*i[0]+i[7];var o=n.getGroup().getCanvasBBox(),r=o.minX,a=o.maxX,s=o.minY,d=o.maxY,h={x:(r+a)/2,y:(s+d)/2};"begin"===e&&(h.x=r,h.y=s),n.translate(c.x-h.x,c.y-h.y)}))}var h=Object(r["__assign"])({},this.get("layout")),g={};Object.assign(g,h,t),t.pipes&&!t.type?delete g.type:!t.pipes&&g.type&&delete g.pipes,this.set("layout",g),a&&(a.isLayoutTypeSame(g)&&g.gpuEnabled===h.gpuEnabled?a.updateLayoutCfg(g):a.changeLayout(g),o&&this.get("enabledStack")&&this.pushStack("layout",{before:h,after:g}))},e.prototype.destroyLayout=function(){var t=this.get("layoutController");null===t||void 0===t||t.destroyLayout()},e.prototype.layout=function(){var t,e=this.get("layoutController"),i=this.get("layout");i&&e&&(i.workerEnabled?e.layout():(null===(t=e.layoutMethods)||void 0===t?void 0:t.length)?e.relayout(!0):e.layout())},e.prototype.collapseCombo=function(t,e){var i=this;if(void 0===e&&(e=!0),!this.destroyed&&(Object(s["isString"])(t)&&(t=this.findById(t)),t)){this.emit("beforecollapseexpandcombo",{action:"collapse",item:t});var o=t.getModel(),r=this.get("itemController");r.collapseCombo(t,e),o.collapsed=!0;var n=this.getEdges().concat(this.get("vedges")),a=[],c=this.get("comboTrees"),d=!1;(c||[]).forEach((function(t){d||Object(m["traverseTree"])(t,(function(t){if(d&&t.depth<=o.depth)return!1;if(o.id===t.id&&(d=!0),d){var e=i.findById(t.id);e&&e.getType&&"combo"===e.getType()&&(a=a.concat(e.getNodes()),a=a.concat(e.getCombos()))}return!0}))}));var h={};n.forEach((function(t){var e=t.getModel(),r=e.isVEdge,n=e.size,s=void 0===n?1:n;if(!t.isVisible()||r){var c,d=t.getSource(),g=t.getTarget(),u=null;if(d.getModel().id===o.id||a.includes(d)&&!a.includes(g)?(u=g,c=!1):(g.getModel().id===o.id||!a.includes(d)&&a.includes(g))&&(u=d,c=!0),u){if(r)return void i.removeItem(t,!1);var p=u.getModel();while(!u.isVisible()){var l=p.parentId,f=p.comboId,y=l||f;if(u=i.findById(y),!u||!y)return;p=u.getModel()}var m=p.id,v=c?{source:m,target:o.id,size:s,isVEdge:!0}:{source:o.id,target:m,size:s,isVEdge:!0},b="".concat(v.source,"-").concat(v.target);if(h[b])return void(h[b].size+=s);h[b]=v}}})),this.addItems(Object.values(h).map((function(t){return{type:"vedge",model:t}})),!1),this.emit("aftercollapseexpandcombo",{action:"collapse",item:t})}},e.prototype.expandCombo=function(t,e){var i=this;if(void 0===e&&(e=!0),Object(s["isString"])(t)&&(t=this.findById(t)),t&&(!t.getType||"combo"===t.getType())){this.emit("beforecollapseexpandcombo",{action:"expand",item:t});var o=t.getModel(),r=this.get("itemController");r.expandCombo(t,e),o.collapsed=!1;var n=this.getEdges().concat(this.get("vedges")),a=[],c=this.get("comboTrees"),d=!1;(c||[]).forEach((function(t){d||Object(m["traverseTree"])(t,(function(t){if(d&&t.depth<=o.depth)return!1;if(o.id===t.id&&(d=!0),d){var e=i.findById(t.id);e&&e.getType&&"combo"===e.getType()&&(a=a.concat(e.getNodes()),a=a.concat(e.getCombos()))}return!0}))}));var h={};n.forEach((function(t){if(!t.isVisible()||t.getModel().isVEdge){var e,r=t.getSource(),n=t.getTarget(),s=r.get("id"),c=n.get("id"),d=null;if(s===o.id||a.includes(r)&&!a.includes(n)?(d=n,e=!1):c===o.id||!a.includes(r)&&a.includes(n)?(d=r,e=!0):a.includes(r)&&a.includes(n)&&r.isVisible()&&n.isVisible()&&t.show(),d){var g=t.getModel(),u=g.isVEdge,p=g.size,l=void 0===p?1:p;if(u)return void i.removeItem(t,!1);var f=d.getModel();while(!d.isVisible()){var y=f.parentId,m=f.comboId,v=y||m;if(d=i.findById(v),!d||!v)return;f=d.getModel()}var b=f.id,x=e?n:r,O=x.getModel();while(!x.isVisible()){var j=O.parentId,S=O.comboId,C=j||S;if(x=i.findById(C),!x||!C)return;if(O.comboId===o.id||O.parentId===o.id)break;O=x.getModel()}var I=O.id;if(b){var B=e?{source:b,target:I,isVEdge:!0,size:l}:{source:I,target:b,isVEdge:!0,size:l},M="".concat(B.source,"-").concat(B.target);if(h[M])return void(h[M].size+=l);h[M]=B}}}})),this.addItems(Object.values(h).map((function(t){return{type:"vedge",model:t}})),!1),this.emit("aftercollapseexpandcombo",{action:"expand",item:t})}},e.prototype.collapseExpandCombo=function(t,e){if(void 0===e&&(e=!0),Object(s["isString"])(t)&&(t=this.findById(t)),t&&(!t.getType||"combo"===t.getType())){var i=t.getModel(),o=this.findById(i.parentId);while(o){var r=o.getModel();if(r.collapsed)return void(o=void 0);o=this.findById(r.parentId)}var n=i.collapsed;n?this.expandCombo(t,e):this.collapseCombo(t,e),this.updateCombo(t)}},e.prototype.getNeighbors=function(t,e){var i=t;return Object(s["isString"])(t)&&(i=this.findById(t)),i.getNeighbors(e)},e.prototype.getNodeDegree=function(t,e,i){void 0===e&&(e=void 0),void 0===i&&(i=!1);var o=t;Object(s["isString"])(t)&&(o=this.findById(t));var r=this.get("degrees");r&&!i||(r=Object(c["getDegree"])(this.save()),this.set("degrees",r));var n=r[o.getID()],a=0;if(!n)return 0;switch(e){case"in":a=n.inDegree;break;case"out":a=n.outDegree;break;case"all":a=n;break;default:a=n.degree;break}return a},e.prototype.getUndoStack=function(){return this.undoStack},e.prototype.getRedoStack=function(){return this.redoStack},e.prototype.getStackData=function(){return this.get("enabledStack")?{undoStack:this.undoStack.toArray(),redoStack:this.redoStack.toArray()}:null},e.prototype.clearStack=function(){this.get("enabledStack")&&(this.undoStack.clear(),this.redoStack.clear(),this.emit("stackchange",{undoStack:this.undoStack,redoStack:this.redoStack}))},e.prototype.pushStack=function(t,e,i){if(void 0===t&&(t="update"),void 0===i&&(i="undo"),this.get("enabledStack")){var o=e?Object(s["clone"])(e):{before:{},after:Object(s["clone"])(this.save())};"redo"===i?this.redoStack.push({action:t,data:o}):this.undoStack.push({action:t,data:o}),this.emit("stackchange",{action:t,stackType:i,undoStack:this.undoStack,redoStack:this.redoStack})}},e.prototype.getAdjMatrix=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=this.get("directed"));var i=this.get("adjMatrix");return i&&t||(i=Object(c["getAdjMatrix"])(this.save(),e),this.set("adjMatrix",i)),i},e.prototype.getShortestPathMatrix=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=this.get("directed"));var i=this.get("adjMatrix"),o=this.get("shortestPathMatrix");return i&&t||(i=Object(c["getAdjMatrix"])(this.save(),e),this.set("adjMatrix",i)),o&&t||(o=Object(c["floydWarshall"])(this.save(),e),this.set("shortestPathMatrix",o)),o},e.prototype.on=function(e,i,o){return t.prototype.on.call(this,e,i,o)},e.prototype.destroy=function(){var t,e,i,o,r;this.emit("beforedestroy"),this.clear(),this.clearStack(),null===(t=this.get("itemController"))||void 0===t||t.destroy(),null===(e=this.get("modeController"))||void 0===e||e.destroy(),null===(i=this.get("viewController"))||void 0===i||i.destroy(),null===(o=this.get("stateController"))||void 0===o||o.destroy(),null===(r=this.get("canvas"))||void 0===r||r.destroy(),this.cfg=null,this.destroyed=!0,this.redoStack=null,this.undoStack=null,this.emit("afterdestroy")},e.prototype.createHull=function(t){if(t.members&&!(t.members.length<1)){var e=this.get("hullGroup"),i=this.get("hullMap");if(i||(i={},this.set("hullMap",i)),e&&!e.get("destroyed")||(e=this.get("group").addGroup({id:"hullGroup"}),e.toBack(),this.set("hullGroup",e)),i[t.id])return i[t.id];var o=e.addGroup({id:"".concat(t.id,"-container")}),n=new ot(this,Object(r["__assign"])(Object(r["__assign"])({},t),{group:o})),a=n.id;return i[a]=n,n}},e.prototype.getHulls=function(){return this.get("hullMap")},e.prototype.getHullById=function(t){return this.get("hullMap")[t]},e.prototype.removeHull=function(t){var e,i;i=Object(s["isString"])(t)?this.getHullById(t):t,null===(e=this.get("hullMap"))||void 0===e||delete e[i.id],i.destroy()},e.prototype.removeHulls=function(){var t=this.getHulls();t&&Object.keys(t).length&&(Object.keys(t).forEach((function(e){var i=t[e];i.destroy()})),this.set("hullMap",{}))},e}(n["a"]),st=at,ct=i("edbf"),dt=i("492a"),ht=i("8fa6"),gt=function(){function t(t){this.graph=t,this.layoutCfg=t.get("layout")||{},this.layoutType=this.getLayoutType(),this.layoutMethods=[],this.initLayout()}return t.prototype.initLayout=function(){},t.prototype.getLayoutType=function(){return this.getLayoutCfgType(this.layoutCfg)},t.prototype.getLayoutCfgType=function(t){var e=t.type;if(e)return e;var i=t.pipes;return Array.isArray(i)?i.map((function(t){return(null===t||void 0===t?void 0:t.type)||""})):null},t.prototype.isLayoutTypeSame=function(t){var e=this.getLayoutCfgType(t),i=Array.isArray(this.layoutType),o=Array.isArray(e);return i&&o?this.layoutType.every((function(t,i){return t===e[i]})):!Array.isArray(e)&&!Array.isArray(this.layoutType)&&(null===t||void 0===t?void 0:t.type)===this.layoutType},t.prototype.refreshLayout=function(){var t=this,e=t.graph,i=t.layoutType,o=t.layoutCfg,r=void 0===o?{}:o;if(e){var n=r.animate,a=void 0===n&&("force"===i||"force2"===i),s=Object(ht["isForce"])(i)&&(n||a);e.get("animate")&&!s?e.positionsAnimate("comboCombined"===i):e.refreshPositions("comboCombined"===i)}},t.prototype.changeLayout=function(t){var e=t.disableTriggerLayout,i=Object(r["__rest"])(t,["disableTriggerLayout"]);this.layoutCfg=i,this.layoutType=i.type||this.layoutType,e||this.layout()},t.prototype.changeData=function(t){this.layout(t)},t.prototype.destoryLayoutMethods=function(){var t=this.layoutMethods,e=[];return null===t||void 0===t||t.forEach((function(t){var i,o=null===(i=t.getType)||void 0===i?void 0:i.call(t);o&&e.push(o),t.destroy()})),this.layoutMethods=[],e},t.prototype.destroyLayout=function(){this.destoryLayoutMethods();var t=this.graph;t&&!t.get("destroyed")&&t.set("layout",void 0),this.layoutCfg=void 0,this.layoutType=void 0,this.layoutMethods=void 0},t.prototype.setDataFromGraph=function(){for(var t,e=[],i=[],o=[],r=[],n=[],a=[],s=[],c=this.graph.getNodes(),d=this.graph.getEdges(),h=this.graph.getCombos(),g=c.length,u=0;u<g;u++){var p=c[u];if(p&&!p.destroyed){var l=p.getModel();p.isVisible()?e.push(l):i.push(l)}}var f=d.length;for(u=0;u<f;u++){var y=d[u];if(y&&!y.destroyed){l=y.getModel();y.isVisible()?l.isComboEdge?n.push(l):o.push(l):r.push(l)}}var m=h.length;for(u=0;u<m;u++){var v=h[u];if(!v.destroyed){l=v.getModel();v.isVisible()?a.push(l):s.push(l)}}return{nodes:e,hiddenNodes:i,edges:o,hiddenEdges:r,combos:a,hiddenCombos:s,comboEdges:n,vedges:null===(t=this.graph.get("vedges"))||void 0===t?void 0:t.map((function(t){return t.getModel()}))}},t.prototype.relayout=function(t){var e=this,i=this,o=i.graph,r=i.layoutMethods,n=i.layoutCfg;if(o&&!o.get("destroyed")){var a=Promise.resolve();if(t){this.data=this.setDataFromGraph();var s=this.data.nodes;if(!s)return!1;a=this.initPositions(n.center,s)}o.emit("beforelayout"),null===r||void 0===r||r.forEach((function(t,i){var o=n[i]||n;a=a.then((function(){var t,a=e.execLayoutMethod(o,i);return i===r.length-1&&(null===(t=n.onAllLayoutEnd)||void 0===t||t.call(n)),a}))}))}},t.prototype.filterLayoutData=function(t,e){var i,o,n=t.nodes,a=t.edges,c=Object(r["__rest"])(t,["nodes","edges"]);if(!n)return t;i=Object(s["isFunction"])(null===e||void 0===e?void 0:e.nodesFilter)?e.nodesFilter:function(){return!0};var d=n.filter(i);if(Object(s["isFunction"])(null===e||void 0===e?void 0:e.edgesFilter))o=e.edgesFilter;else{var h=d.reduce((function(t,e){return t[e.id]=!0,t}),{});o=function(t){return h[t.source]&&h[t.target]}}return Object(r["__assign"])({nodes:d,edges:a.filter(o)},c)},t.prototype.getLayoutBBox=function(t){var e=this.graph,i=Object(s["groupBy"])(e.getNodes(),(function(t){return t.getModel().layoutOrder})),o=Object.values(i).map((function(t){var e=Object(f["calculationItemsBBox"])(t);return e.size=[e.width,e.height],e})),r=Object.values(Object(s["groupBy"])(t,"layoutOrder"));return{groupNodes:r,layoutNodes:o}},t.prototype.layoutAnimate=function(){},t.prototype.moveToZero=function(){var t=this.graph,e=t.get("data"),i=e.nodes;if(void 0!==i[0].x&&null!==i[0].x&&!Object(f["isNaN"])(i[0].x)){for(var o=[0,0],r=i.length,n=0;n<r;n++){var a=i[n];o[0]+=a.x,o[1]+=a.y}o[0]/=i.length,o[1]/=i.length;for(n=0;n<r;n++){a=i[n];a.x-=o[0],a.y-=o[1]}}},t.prototype.initPositions=function(t,e){var i;return Object(r["__awaiter"])(this,void 0,void 0,(function(){var o,n,a;return Object(r["__generator"])(this,(function(r){return o=this.graph,(null===e||void 0===e?void 0:e.length)?(n=e.filter((function(t){return Object(f["isNaN"])(t.x)||Object(f["isNaN"])(t.y)})),a=n?n.length:0,a?[2,null===(i=this.initWithPreset)||void 0===i?void 0:i.call(this,(function(){}),(function(){var e=.85*o.get("width"),i=.85*o.get("height"),r=Math.ceil(Math.sqrt(a)*(e/i)),s=Math.ceil(a/r),c=e/(r-1),d=i/(s-1);isFinite(c)&&c||(c=0),isFinite(d)&&c||(d=0);for(var h=t[0]-e/2,g=t[1]-i/2,u=0;u<a;u++){var p=n[u];Object(f["isNaN"])(+p.x)&&(!1,p.x=u%r*c+h),Object(f["isNaN"])(+p.y)&&(!1,p.y=Math.floor(u/r)*d+g)}}))]:[2]):[2,Promise.resolve()]}))}))},t.prototype.destroy=function(){this.graph=null,this.destoryLayoutMethods(),this.destroyed=!0},t}(),ut=gt,pt=function(){function t(t){this.graph=t,this.destroyed=!1,this.initEvents()}return t}(),lt=pt,ft=(i("1de4"),ct["c"].registerNode),yt=ct["c"].registerEdge,mt=ct["c"].registerCombo,vt=o["a"].registerBehavior,bt=g["a"];g["a"].version,dt["a"],ct["c"],ct["c"].registerNode,ct["c"].registerEdge,ct["c"].registerCombo,o["a"].registerBehavior,ct["a"],ct["b"]},"4b02":function(t,e,i){"use strict";i("0122")}}]);