(window["jsonpPaas4"]=window["jsonpPaas4"]||[]).push([["app~57d2f11d"],{"0159":function(e){e.exports=JSON.parse("{}")},"0b3a":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{style:{height:e.height,width:e.width},attrs:{id:"mountNode"}})},i=[],o=(a("99af"),a("b0c0"),a("d3b7"),a("4d63"),a("c607"),a("ac1f"),a("2c3e"),a("00b4"),a("25f0"),a("159b"),a("7c3e")),r={name:"g6-dagre",components:{},mixins:[],props:{width:{type:String,default:"100%"},height:{type:String,default:"100%"},chartData:{type:Object,default:function(){return{nodes:[],edges:[]}}}},data:function(){return{graph:null}},computed:{clusterMode:function(){return this.$route.query.clusterMode}},watch:{},created:function(){},mounted:function(){this.initDagre(),window.addEventListener("resize",this.resize)},destroyed:function(){window.removeEventListener("resize",this.resize),this.graph=null},methods:{initDagre:function(){var e=this,t=this.chartData;o["a"].registerNode("sql",{drawShape:function(e,t){var a=t.addShape("rect",{attrs:{x:-75,y:-25,width:150,height:50,radius:10,stroke:"#5B8FF9",lineWidth:1,fill:e.status?"#67C23A":"#F56C6C"},name:"rect-shape"});return a}},"single-node");var a={container:"mountNode",fitView:!0,pixelRatio:2,groupByTypes:!1,defaultNode:{type:"sql",style:{stroke:"#C4E3B2",radius:7},labelCfg:{style:{fill:"#000",fontSize:14}}},defaultCombo:{type:"rect"},comboStateStyles:{selected:{shadowBlur:1,lineWidth:1}},defaultEdge:{type:"polyline",style:{radius:20,offset:45,endArrow:!0,lineWidth:2,stroke:"#C2C8D5"}},nodeStateStyles:{selected:{shadowColor:"#1d70f5",shadowBlur:10,lineWidth:2,cursor:"pointer"}},modes:{default:["drag-canvas","zoom-canvas","click-select",{type:"tooltip",formatText:function(e){var t='<div style="border: 1px solid #e2e2e2;\n                  border-radius: 4px;\n                  font-size: 12px;\n                  color: #545454;\n                  background-color: rgba(255, 255, 255, 0.9);\n                  padding: 10px 8px;\n                  box-shadow: rgb(174, 174, 174) 0px 0px 10px;"\n                  >'.concat(e.name,"</div>");return t},offset:30}]}};"dleger"!==this.clusterMode&&(a.layout={type:"dagre",nodesep:50,controlPoints:!0,sortByCombo:!0,ranksepFunc:function(e){return"RocketMQ_NameSrv"===e.instanceType?100:10}});var n=new o["a"].Graph(a);n.data(t),n.render(),n.fitView(),this.graph=n,n.on("node:click",(function(t){t.target;var a=t.item,n=a.getModel();e.$emit("click-node",n)}))},resize:function(){var e=this.$el,t=e.offsetHeight,a=e.offsetWidth;this.graph.changeSize(a,t)}}},l=r,s=(a("6709"),a("2877")),c=Object(s["a"])(l,n,i,!1,null,"48b51991",null);t["default"]=c.exports},"0b82":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{style:{height:e.height,width:e.width},attrs:{id:"mountNode"}})},i=[],o=a("ade3"),r=(a("a15b"),a("7c3e")),l={name:"g6-dagre",components:{},mixins:[],props:{width:{type:String,default:"100%"},height:{type:String,default:"100%"},chartData:{type:Object,default:function(){return{nodes:[],edges:[]}}}},data:function(){return{graph:null}},computed:{},watch:{},created:function(){},mounted:function(){this.initDagre(),window.addEventListener("resize",this.resize)},destroyed:function(){window.removeEventListener("resize",this.resize),this.graph=null},methods:{initDagre:function(){var e=this,t=this.chartData;r["a"].registerNode("sql",{drawShape:function(e,t){var a=t.addShape("rect",{attrs:{x:-75,y:-25,width:150,height:50,radius:10,stroke:"#5B8FF9",lineWidth:1,fill:"Running"===e.status||"good"===e.status?"#67C23A":"#F56C6C"},name:"rect-shape"});return a}},"single-node");var a=new r["a"].Graph(Object(o["a"])(Object(o["a"])(Object(o["a"])({container:"mountNode",fitView:!0,pixelRatio:2,layout:{type:"dagre",nodesep:50,controlPoints:!0,sortByCombo:!0,ranksepFunc:function(e){return"RocketMQ_NameSrv"===e.instanceType?100:10}},groupByTypes:!1,defaultNode:{type:"sql",style:{stroke:"#C4E3B2",radius:7},labelCfg:{style:{fill:"#000",fontSize:14}}},defaultCombo:{type:"rect"},comboStateStyles:{selected:{shadowBlur:1,lineWidth:1}},defaultEdge:{type:"polyline",style:{radius:20,offset:45,endArrow:!0,lineWidth:2,stroke:"#C2C8D5"}}},"comboStateStyles",{selected:{shadowBlur:1,lineWidth:1}}),"nodeStateStyles",{selected:{shadowColor:"#1d70f5",shadowBlur:10,lineWidth:2,cursor:"pointer"}}),"modes",{default:["drag-canvas","zoom-canvas","click-select",{type:"tooltip",formatText:function(e){var t=[];return t.join("\n")},offset:30}]}));a.data(t),a.render(),a.fitView(),this.graph=a,a.on("node:click",(function(t){t.target;var a=t.item,n=a.getModel();e.$emit("click-node",n)}))},resize:function(){var e=this.$el,t=e.offsetHeight,a=e.offsetWidth;this.graph.changeSize(a,t)}}},s=l,c=a("2877"),d=Object(c["a"])(s,n,i,!1,null,"0e9960f6",null);t["default"]=d.exports},"19ae":function(e,t,a){},"1af9":function(e,t,a){"use strict";a.r(t);a("99af"),a("b0c0"),a("498a");var n=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:e.isDleger?"添加Broker":"添加主节点",visible:e.visible,loading:e.loading,size:e.isDleger?"medium":"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"100px",rules:e.rules}},[t("el-form-item",{attrs:{label:"名称",prop:"instanceName"}},[t("el-input",{attrs:{size:"mini"},model:{value:e.formData.instanceName,callback:function(t){e.$set(e.formData,"instanceName",t)},expression:"formData.instanceName"}})],1),e.isDleger?t("el-form-item",{attrs:{label:"节点数量",prop:"nodeLimit"}},[t("el-input-number",{staticClass:"w-100",attrs:{size:"mini","controls-position":"right",min:1,max:20,placeholder:"请输入节点数量"},on:{change:e.changeNodeLimit},model:{value:e.formData.nodeLimit,callback:function(t){e.$set(e.formData,"nodeLimit",t)},expression:"formData.nodeLimit"}})],1):e._e(),e._l(e.formData.list,(function(a,n){return t("div",{key:n,class:{"while-box":e.isDleger}},[t("el-row",[t("el-col",{attrs:{span:e.isDleger?16:24}},[t("el-form-item",{attrs:{label:"主机 ".concat(e.isDleger?n+1:""),prop:"list.".concat(n,".machineId"),rules:e.rules.machineId}},[t("el-select",{staticClass:"w-100",attrs:{size:"mini",placeholder:"请选择主机"},on:{change:function(t){return e.changeIp(t,a)}},model:{value:a.machineId,callback:function(t){e.$set(a,"machineId",t)},expression:"current.machineId"}},e._l(e.machineList,(function(a){return t("el-option",{key:a.id,staticClass:"el-option-box",attrs:{label:"".concat(a.address,"(").concat(a.account,")"),value:a.id}},[t("ul",{staticClass:"el-option-ul-between"},[t("li",[e._v(e._s(a.address))]),t("li",[e._v(e._s(a.account))])])])})),1)],1)],1),t("el-col",{attrs:{span:e.isDleger?8:24}},[t("el-form-item",{attrs:{label:"端口 ".concat(e.isDleger?n+1:""),prop:"list.".concat(n,".port"),rules:e.rules.port}},[t("el-input-number",{staticClass:"w-100",attrs:{size:"mini","controls-position":"right",min:0,max:65535,placeholder:"端口"},model:{value:a.port,callback:function(t){e.$set(a,"port",t)},expression:"current.port"}})],1)],1)],1),t("el-form-item",{attrs:{label:"部署路径 ".concat(e.isDleger?n+1:""),prop:"list.".concat(n,".deployPath"),rules:e.rules.deployPath}},[t("el-input",{staticClass:"w-100",attrs:{placeholder:"请输入部署路径",size:"mini"},model:{value:a.deployPath,callback:function(t){e.$set(a,"deployPath","string"===typeof t?t.trim():t)},expression:"current.deployPath"}})],1),t("el-form-item",{attrs:{label:"配置模板".concat(e.isDleger?n+1:""),prop:"list.".concat(n,".configTemplateId")}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择配置模板"},model:{value:a.configTemplateId,callback:function(t){e.$set(a,"configTemplateId",t)},expression:"current.configTemplateId"}},e._l(e.opts_brokerTemplate,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"运行内存",prop:"list.".concat(n,".jvmParam"),rules:e.rules.jvmParam}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择运行内存","allow-create":"",filterable:""},model:{value:a.jvmParam,callback:function(t){e.$set(a,"jvmParam",t)},expression:"current.jvmParam"}},e._l(e.opts_startupTemplate,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)}))],2),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},i=[],o=a("5530"),r=(a("cb29"),a("7db0"),a("d81d"),a("d3b7"),a("33b0")),l=a("3775"),s=a("082f"),c=a("49bb"),d=a("61f7"),u=a("ff51"),p=a("c88b"),m={components:{},mixins:[],model:{prop:"show",event:"change"},props:{show:Boolean,refresh:Function,rowData:{type:Object,default:function(){return{}}},clusterId:String},data:function(){return{opts_startupTemplate:c["i"],opts_brokerTemplate:[],formData:{instanceName:"",nodeLimit:1,list:[{machineId:"",deployPath:"",port:0,configTemplateId:"",jvmParam:""}]},machineList:[],rules:{jvmParam:[{required:!0,validator:d["h"],trigger:"change"}],instanceName:[{required:!0,trigger:"blur",message:"请输入名称"}],machineId:[{required:!0,trigger:["change","blur"],message:"请选择主机"}],deployPath:[{required:!0,trigger:"blur",message:"请输入部署路径"}],port:[{required:!0,trigger:"blur",message:"请输入端口"}]},options:[],loading:!1}},computed:{visible:{get:function(){return this.show},set:function(e){this.$emit("change",!1)}},isDleger:function(){return"dleger"===this.$route.query.clusterMode}},watch:{},created:function(){this.getIps(),this.getBrokerConfigTemplate()},mounted:function(){},methods:{getBrokerConfigTemplate:function(){var e=this,t={moduleType:"ROCKRTMQ_NAME_BROKER",componentType:"ROCKETMQ"};Object(s["c"])(t).then((function(t){e.opts_brokerTemplate=Object(u["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]}))},getIps:function(){var e=this;Object(l["i"])(this.clusterId).then((function(t){e.machineList=Object(u["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).catch((function(e){}))},changeIp:function(e,t){var a,n=this.machineList.find((function(t){return t.id===e}));this.$set(t,"deployPath",null!==(a=null===n||void 0===n?void 0:n.path)&&void 0!==a?a:"")},changeNodeLimit:function(e){Object(p["a"])(e)&&(this.formData.list=new Array(e).fill(0).map((function(){return{machineId:"",deployPath:"",port:0}})))},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){var a=e.isDleger?"RocketMQ_Dleger":"RocketMQ_Broker",n=e.formData,i=n.instanceName,l=n.list,s=l.map((function(t){return Object(o["a"])({clusterId:e.clusterId,instanceName:i,instanceType:a},t)}));e.loading=!0,Object(r["a"])(s).then((function(t){t&&200===t.code&&(e.$message.success("新增成功"),e.$emit("change",!1),e.refresh())})).finally((function(){e.loading=!1}))}}))}}},f=m,h=(a("51bc"),a("2877")),b=Object(h["a"])(f,n,i,!1,null,"4fea082a",null);t["default"]=b.exports},2983:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"operation-log"},[t("div",{staticClass:"top-bar"},[t("el-descriptions",{attrs:{title:"",column:4,size:"medium"}},[t("el-descriptions-item",{attrs:{label:"节点名称"}},[e._v(e._s(e.podName))])],1),t("el-button",{staticClass:"back-button",on:{click:e.goPage}},[e._v("返回")])],1),t("tableView",{ref:"tableView",attrs:{loading:e.tableConfig.loading,operateObj:e.tableConfig.operate,columns:e.tableConfig.columns,tableData:e.tableConfig.tableData,isPage:!1,rowKey:"id"}})],1)},i=[],o=(a("d3b7"),a("a4ed")),r=a("ec41"),l=a("ff51"),s=a("ed08"),c={filters:{},components:{},data:function(){this.$createElement;return{rowData:null,tableConfig:{loading:!1,pagination:{pageNo:1,pageSize:10,total:0},columns:[{prop:"component",label:"组件",align:"center",render:function(e,t){var a=t.row;return e("span",[a.source.component])}},{prop:"reason",label:"原因",align:"center"},{prop:"type",label:"操作类型",align:"center"},{prop:"message",label:"消息",align:"center",width:500},{prop:"lastTimestamp",label:"操作时间",align:"center",width:150,format:function(e){return e?Object(s["d"])(e):""}}],operate:{width:220,list:[]}}}},created:function(){this.getList()},watch:{},computed:{clusterId:function(){return this.$route.query.clusterId},agentId:function(){return this.$route.query.agentId},namespace:function(){return this.$route.query.namespace},podName:function(){return this.$route.query.podName}},methods:{goPage:function(){this.$router.go(-1)},getList:function(){var e=this;this.tableConfig.loading=!0,Object(o["b"])({agentId:this.agentId,namespace:this.namespace,podName:this.podName}).then((function(t){var a=Object(r["a"])(t,"data.items");e.tableConfig.tableData=Object(l["a"])(a)?a:[]})).finally((function(){e.tableConfig.loading=!1}))},onSearch:function(){this.tableConfig.pagination.pageNo=1,this.getList()},changePage:function(e,t){e&&(this.tableConfig.pagination.pageNo=e),t&&(this.tableConfig.pagination.pageNo=1,this.tableConfig.pagination.pageSize=t),this.getList()}}},d=c,u=(a("a523"),a("2877")),p=Object(u["a"])(d,n,i,!1,null,"4b43d26e",null);t["default"]=p.exports},"2fe8":function(e,t,a){"use strict";a.r(t);a("a4d3"),a("e01a");var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"main"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),t("el-table-column",{attrs:{prop:"key",label:"参数项",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[""==a.row.description&&a.row.description?t("span",[e._v(e._s(a.row.key))]):t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:a.row.description,placement:"top-start",disabled:!0}},[t("span",[e._v(e._s(a.row.key))])])]}}])}),t("el-table-column",{attrs:{prop:"title",label:"中文名称",width:"200",align:"center"}}),t("el-table-column",{attrs:{label:"参数值"},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.row;return[t("div",["radio"===n.type?t("span",[t("el-radio-group",{model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"row.value"}},e._l(n.options,(function(a){return t("el-radio",{key:a.id,attrs:{label:a.value}},[e._v(e._s(a.label))])})),1)],1):e._e(),"input"===n.type?t("span",["int"===n.dataType?t("el-input",{attrs:{type:"number",min:0,size:"mini",disabled:Boolean(n.readonly)},model:{value:n.value,callback:function(t){e.$set(n,"value",e._n(t))},expression:"row.value"}}):t("el-input",{attrs:{size:"mini",disabled:Boolean(n.readonly)},model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"row.value"}})],1):e._e(),"select"===n.type?t("el-select",{staticStyle:{width:"100%"},attrs:{"allow-create":"",filterable:""},model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"row.value"}},e._l(n.options,(function(a){return t("el-option",{key:a.id,attrs:{label:a.label,value:a.value}},[e._v(e._s(a.label))])})),1):e._e()],1)]}}])})],1),t("footer",{staticClass:"mt-10",staticStyle:{"padding-bottom":"100px"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.confirmSave}},[e._v("保存")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},i=[],o=a("c7eb"),r=a("1da1"),l=(a("99af"),a("d81d"),a("b0c0"),a("d3b7"),a("159b"),a("53ae")),s=a("ade3"),c=a("49bb"),d=[{keyAlias:"listenPort",key:"listenPort",title:"监听端口",options:"",type:"input",elementType:"文本框",readonly:1,description:"",dataType:"int",value:9876,default:9876,example:""},{keyAlias:"clusterTest",key:"clusterTest",title:"是否开启集群测试",options:[{label:"是",value:1},{label:"否",value:0}],type:"radio",elementType:"是/否 按钮",readonly:0,description:"",dataType:"",value:0,default:0,example:"0，1"},{keyAlias:"orderMessageEnable",key:"orderMessageEnable",title:"是否支持顺序消息",options:[{label:"是",value:1},{label:"否",value:0}],type:"radio",elementType:"是/否 按钮",readonly:0,description:"",dataType:"",value:0,default:0,example:"0，1"},{keyAlias:"serverWorkerThreads",key:"serverWorkerThreads",title:"业务线程池线程个数",options:"",type:"input",elementType:"文本框",readonly:0,description:"",dataType:"int",value:8,default:8,example:"[1,...]"},{keyAlias:"serverCallbackExecutorThreads",key:"serverCallbackExecutorThreads",title:"异步回调线程池线程数量",options:"",type:"input",elementType:"文本框",readonly:0,description:"",dataType:"int",value:0,default:0,example:"[0,...]"},{keyAlias:"serverSelectorThreads",key:"serverSelectorThreads",title:"IO 线程池线程个数",options:"",type:"input",elementType:"文本框",readonly:0,description:"",dataType:"int",value:3,default:3,example:"[1,...]"},{keyAlias:"serverOnewaySemaphoreValue",key:"serverOnewaySemaphoreValue",title:"单向发送消息最大并发度",options:"",type:"input",elementType:"文本框",readonly:0,description:"",dataType:"int",value:256,default:256,example:"[1,...]"},{keyAlias:"serverAsyncSemaphoreValue",key:"serverAsyncSemaphoreValue",title:"异步发送消息最大并发度",options:"",type:"input",elementType:"文本框",readonly:0,description:"",dataType:"int",value:64,default:64,example:"[1,...]"},{keyAlias:"serverChannelMaxIdleTimeSeconds",key:"serverChannelMaxIdleTimeSeconds",title:"网络连接最大空闲时间（秒）",options:"",type:"input",elementType:"文本框",readonly:0,description:"",dataType:"int",value:120,default:120,example:"[1,...]"},{keyAlias:"serverSocketSndBufSize",key:"serverSocketSndBufSize",title:"socket 发送缓存区大小",options:"",type:"input",elementType:"文本框",readonly:0,description:"",dataType:"int",value:65535,default:65535,example:"[1,...]"},{keyAlias:"serverSocketRcvBufSize",key:"serverSocketRcvBufSize",title:"socket 接收缓存区大小",options:"",type:"input",elementType:"文本框",readonly:0,description:"",dataType:"int",value:65535,default:65535,example:"[1,...]"},{keyAlias:"serverPooledByteBufAllocatorEnable",key:"serverPooledByteBufAllocatorEnable",title:"ByteBuffer是否开启缓存",options:[{label:"是",value:1},{label:"否",value:0}],type:"radio",elementType:"是/否 按钮",readonly:0,description:"",dataType:"",value:0,default:0,example:"0，1"},{keyAlias:"useEpollNativeSelectorValue",key:"useEpollNativeSelectorValue",title:"是否启用 Epoll IO",options:[{label:"是",value:1},{label:"否",value:0}],type:"radio",elementType:"是/否 按钮",readonly:0,description:"",dataType:"",value:0,default:0,example:"0，1"},{keyAlias:"kvConfigPath",key:"kvConfigPath",title:"kv配置文件路径",options:"",type:"input",elementType:"文本框",readonly:0,description:"",dataType:"String",value:"$user.home/namesrv/kvConfig.json",default:"$user.home/namesrv/kvConfig.json",example:""},Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({key:"jvmParam",title:"启动内存参数",options:"",type:"select"},"options",c["i"]),"elementType",""),"description",""),"dataType",""),"value","-Xms4g -Xmx4g -Xmn1g"),"default",""),"example","")],u=[{key:"listenPort",title:"监听端口",options:"",type:"input",elementType:"文本框",description:"",dataType:"int",value:9876,default:9876,readonly:1,example:""},{key:"brokerName",title:"broker名称（主从一致）",options:"",type:"input",elementType:"文本框",description:"",dataType:"string",value:"",default:"",example:""},{key:"brokerRole",title:"broker角色（Dledger模式无效）",options:[{label:"SYNC_MASTER",value:"SYNC_MASTER"},{label:"ASYNC_MASTER",value:"ASYNC_MASTER"},{label:"SLAVE",value:"SLAVE"}],type:"radio",elementType:"SYNC_MASTER/ASYNC_MASTER/SLAVE 按钮",description:"",dataType:"string",value:"SYNC_MASTER",default:"SYNC_MASTER",example:"SYNC_MASTER,ASYNC_MASTER,SLAVE"},{key:"flushDiskType",title:"消息刷盘方式",options:[{label:"ASYNC_FLUSH",value:"ASYNC_FLUSH"},{label:"SYNC_FLUSH",value:"SYNC_FLUSH"}],type:"radio",elementType:"ASYNC_FLUSH/SYNC_FLUSH 按钮",description:"",dataType:"string",value:"SYNC_FLUSH",default:"SYNC_FLUSH",example:"ASYNC_FLUSH，SYNC_FLUSH"},Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({key:"autoCreateTopicEnable",title:"是否自动创建默认topic",options:"",type:"radio"},"options",[{label:"是",value:1},{label:"否",value:0}]),"elementType","是/否 按钮"),"description",""),"dataType","int"),"value",0),"default",0),"example","0，1"),{key:"autoCreateSubscriptionGroup",title:"是否自动创建topic的订阅组",options:[{label:"是",value:1},{label:"否",value:0}],type:"radio",elementType:"是/否 按钮",description:"",dataType:"int",value:1,default:0,example:"0，1"},{key:"deleteWhen",title:"持久化消息清理时间点",options:"",type:"input",elementType:"文本框",description:"",dataType:"int",value:4,default:4,example:"[1,…24]"},{key:"fileReservedTime",title:"持久化消息保留时间（小时）",options:"",type:"input",elementType:"文本框",description:"",dataType:"int",value:48,default:48,example:"[1,...]"},{key:"mapedFileSizeCommitLog",title:"单个commitLog文件大小",options:"",type:"input",elementType:"文本框",description:"",dataType:"int",value:1073741824,default:1073741824,example:"[1,...]"},{key:"diskMaxUsedSpaceRatio",title:"磁盘使用率阀值（%）",options:"",type:"input",elementType:"文本框",description:"",dataType:"int",value:88,default:88,example:"[1,...]"},{key:"storePathRootDir",title:"持久化消息存储根路径",options:"",type:"input",elementType:"文本框",description:"",dataType:"string",value:"$user.home/broker/store/",default:"$user.home/broker/store/",example:"[1,...]"},{key:"storePathCommitLog",title:"commitLog文件存储路径",options:"",type:"input",elementType:"文本框",description:"",dataType:"string",value:"$user.home/broker/store/commitlog/",default:"$user.home/broker/store/commitlog/",example:"0，1"},{key:"sendMessageThreadPoolNums",title:"处理消息发送线程数量",options:"",type:"input",elementType:"文本框",description:"",dataType:"int",value:64,default:64,example:"[1,...]"},{key:"pullMessageThreadPoolNums",title:"处理消息拉取线程数量",options:"",type:"input",elementType:"文本框",description:"",dataType:"int",value:64,default:64,example:"[1,...]"},{key:"maxMessageSize",title:"消息体最大限制",options:"",type:"input",elementType:"文本框",description:"",dataType:"int",value:65536,default:65536,example:"[1,...]"},{key:"brokerIP1",title:"broker发布的IP",options:"",type:"input",elementType:"文本框",description:"",dataType:"string",value:"本机ip",default:"本机ip",example:""},{key:"brokerIP2",title:"从节点连接的IP",options:"",type:"input",elementType:"文本框",description:"",dataType:"string",value:"本机ip",default:"本机ip",example:""},Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({key:"enableDlegerCommitLog",title:"是否开启Dledger模式",options:"",type:"radio"},"options",[{label:"是",value:1},{label:"否",value:0}]),"elementType","是/否 按钮"),"description",""),"dataType","int"),"value",0),"default",0),"example","0，1"),{key:"dlegerGroup",title:"Dledger组名称",options:"",type:"input",elementType:"文本框",description:"",dataType:"string",value:"",default:"",example:""},{key:"dlegerSelfId",title:"Dledger节点ID",options:"",type:"input",elementType:"文本框",description:"",dataType:"string",value:"",default:"",example:""},{key:"dlegerPeers",title:"Dledger组成员名称和地址",options:"",type:"input",elementType:"文本框",description:"",dataType:"string",value:"",default:"",example:""},{key:"transactionTimeOut",title:"事务消息超时时间（ms）",options:"",type:"input",elementType:"文本框",description:"",dataType:"int",value:6e3,default:6e3,example:""},{key:"flushCommitLogThoroughInterval",title:"Commitlog刷盘间隔（ms)",options:"",type:"input",elementType:"文本框",description:"",dataType:"int",value:1e4,default:1e4,example:""},{key:"waitTimeMillsInSendQueue",title:"发送队列最大等待时间(ms)",options:"",type:"input",elementType:"文本框",description:"",dataType:"int",value:200,default:200,example:""},Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({key:"slaveReadEnable",title:"从节点是否可读",options:"",type:"radio"},"options",[{label:"是",value:1},{label:"否",value:0}]),"elementType","是/否 按钮"),"description",""),"dataType","int"),"value",0),"default",0),"example","0，1"),Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({key:"jvmParam",title:"启动内存参数",options:"",type:"select"},"options",c["i"]),"elementType",""),"description",""),"dataType",""),"value","-Xms4g -Xmx4g -Xmn1g"),"default",""),"example","")],p=a("ec41"),m=a("e8b2"),f=a("bc59"),h={name:"rocket-config-params",components:{},data:function(){return{fileList:[],tableData:[],flag:1,loading:!1,id:""}},computed:{clusterId:function(){return this.$route.query.clusterId},clusterNodeId:function(){return this.$route.query.clusterNodeId},instanceType:function(){return this.$route.query.instanceType}},created:function(){var e=this;return Object(r["a"])(Object(o["a"])().mark((function t(){return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return"RocketMQ_NameSrv"===e.instanceType?e.tableData=d:e.tableData=u,t.next=3,e.getDetail();case 3:case"end":return t.stop()}}),t)})))()},mounted:function(){},methods:{getDetail:function(){var e=this;this.loading=!0,Object(l["c"])(this.clusterNodeId).then((function(t){var a=Object(p["a"])(t,"data"),n=Object(m["a"])(a)?a:{};e.id=n.id,e.tableData.forEach((function(t){Object(f["a"])(n,t.key)&&e.$set(t,"value",n[t.key]||t.default)}))})).catch((function(e){})).finally((function(){e.loading=!1}))},clickCancel:function(){this.$router.go(-1)},confirmSave:function(){var e=this,t={id:this.id};this.tableData.map((function(e){t[e.key]=e.value})),this.loading=!0;var a=l["a"];"RocketMQ_NameSrv"===this.instanceType&&(a=l["b"]),a(t).then((function(t){200===t.code&&(e.$message.success("保存成功"),e.getDetail())})).catch((function(e){})).finally((function(){e.loading=!1}))},downLoad:function(){},beforeUpload:function(e){var t=e.name.split(".")[1];return"xls"==t||"xlsx"==t||(this.$message.error("请上传xl或者xlsx格式的文件"),!1)},handleRemove:function(e,t){},handlePreview:function(e){},handleExceed:function(e,t){this.$message.warning("当前限制选择 3 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},beforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},handleSuccess:function(e,t,a){this.$message.success("上传成功")}}},b=h,g=(a("ba53"),a("2877")),v=Object(g["a"])(b,n,i,!1,null,"69bb1d4a",null);t["default"]=v.exports},"300a":function(e,t,a){},3837:function(e,t,a){"use strict";a("300a")},"3ec1":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"name-container"},[t("el-tabs",{model:{value:e.deployMode,callback:function(t){e.deployMode=t},expression:"deployMode"}},[t("el-tab-pane",{attrs:{label:"虚机部署",name:"2"}}),t("el-tab-pane",{attrs:{label:"容器部署",name:"1"}})],1),"2"===e.deployMode?t("ClusterNormal"):e._e(),"1"===e.deployMode?t("ClusterContainer"):e._e()],1)},i=[],o=(a("14d9"),a("bf6d")),r=a("d8df"),l={filters:{},components:{ClusterContainer:o["default"],ClusterNormal:r["default"]},computed:{deployMode:{get:function(){return this.$route.query.deployMode},set:function(e){this.$router.push({query:{deployMode:e}})}}},watch:{},data:function(){return{}},beforeMount:function(){this.$route.query.deployMode||(this.deployMode="2")},created:function(){},mounted:function(){this.activeMode=this.$route.query.deployMode?this.$route.query.deployMode:"2"},methods:{}},s=l,c=a("2877"),d=Object(c["a"])(s,n,i,!1,null,"dde02a54",null);t["default"]=d.exports},"4fe2":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this;e._self._c;return e._m(0)},i=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"main"},[t("div",{attrs:{id:"terminal-container"}})])}],o=(a("21a6"),a("abb2"),a("fcf3")),r=a("47d0"),l=a("a4ed"),s=a("ec41"),c={name:"my-xterm",components:{},props:{updateTime:{type:String,default:null},terminalData:{type:String,default:null},rowData:{type:Object,default:null}},data:function(){return{terminal:{pid:1,name:"terminal",scrollback:1e4},term:null,socket:null}},mounted:function(){this.initTerm()},beforeDestroy:function(){this.term.dispose()},clickCancel:function(){this.startLogShow=!1},methods:{initTerm:function(){var e=document.getElementById("terminal-container"),t=new o["Terminal"](this.terminal),a=new r["FitAddon"];t.loadAddon(a),t.open(e),a.fit(),t.focus(),this.term=t,this.getLogDetail()},getLogDetail:function(){var e=this;Object(l["h"])({agentId:this.rowData.agentId,namespace:this.rowData.namespace,podName:this.rowData.podName}).then((function(t){var a=Object(s["a"])(t,"data");e.term.write(a)}))}}},d=c,u=(a("667b"),a("2877")),p=Object(u["a"])(d,n,i,!1,null,"5d227e48",null);t["default"]=p.exports},"50e57":function(e,t,a){},"51bc":function(e,t,a){"use strict";a("50e57")},"56e2":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"g-page"},[t("div",[t("el-button",{attrs:{button:""},on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")])],1),t("tableView",{attrs:{isPage:!1,loading:e.tableConfig.loading,columns:e.tableConfig.columns,tableData:e.tableConfig.tableData,rowKey:"id"},on:{sortChange:e.sortChange}})],1)},i=[],o=(a("d3b7"),a("33b0")),r=a("ec41"),l=a("ff51"),s=a("d66c"),c={name:"multiple-center-settings",components:{},mixins:[],props:{},data:function(){this.$createElement;return{tableConfig:{loading:!1,tableData:[],columns:[{prop:"clusterName",label:"集群名称",sortable:!0},{prop:"brokerName",label:"broker名称",width:"160px"},{prop:"brokerNumber",label:"编号",render:function(e,t){var a=t.row;return e("span",[a.brokerNumber,"(","0"===a.brokerNumber?"master":"salve",")"])}},{prop:"ip",label:"地址"},{prop:"version",label:"版本"},{prop:"putTPS",label:"生产消息TPS"},{prop:"getTPS",label:"消费消息TPS"},{prop:"yesterdayPut",label:"昨日生产总数"},{prop:"yesterdayGet",label:"昨日消费总数"},{prop:"todayPut",label:"今天生产总数"},{prop:"todayGet",label:"今天消费总数"}],operate:{width:220,list:[]}},rowData:null}},computed:{query:function(){return this.$route.query}},watch:{},created:function(){this.getList()},mounted:function(){},methods:{getList:function(){var e=this,t=this.query.clusterId,a=this.query.nameserverAddr;this.tableConfig.loading=!0,Object(o["g"])({clusterId:t,nameserverAddr:a}).then((function(t){var a=Object(r["a"])(t,"data");e.tableConfig.tableData=Object(l["a"])(a)?a:[]})).catch((function(e){})).finally((function(){e.tableConfig.loading=!1}))},sortChange:function(e,t,a){var n=this.tableConfig.tableData,i=Object(s["a"])(n,(function(e){return e.clusterName}));"descending"===a&&(i=i.reverse()),this.tableConfig.tableData=i}}},d=c,u=a("2877"),p=Object(u["a"])(d,n,i,!1,null,"3c5e00b7",null);t["default"]=p.exports},"5b51":function(e,t,a){"use strict";a.r(t);a("99af"),a("498a");var n=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:e.isDleger?"添加Broker":"添加从节点",visible:e.visible,loading:e.loading,size:e.isDleger?"medium":"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"100px",rules:e.rules}},[t("el-form-item",{attrs:{label:"名称",prop:"instanceName"}},[t("el-input",{attrs:{size:"mini",disabled:""},model:{value:e.formData.instanceName,callback:function(t){e.$set(e.formData,"instanceName",t)},expression:"formData.instanceName"}})],1),e.isDleger?t("el-form-item",{attrs:{label:"节点数量",prop:"nodeLimit"}},[t("el-input-number",{staticClass:"w-100",attrs:{size:"mini","controls-position":"right",min:1,max:20,placeholder:"请输入节点数量"},on:{change:e.changeNodeLimit},model:{value:e.formData.nodeLimit,callback:function(t){e.$set(e.formData,"nodeLimit",t)},expression:"formData.nodeLimit"}})],1):e._e(),e._l(e.formData.list,(function(a,n){return t("div",{key:n,class:{"while-box":e.isDleger}},[t("el-row",[t("el-col",{attrs:{span:e.isDleger?16:24}},[t("el-form-item",{attrs:{label:"主机 ".concat(e.isDleger?n+1:""),prop:"list.".concat(n,".machineId"),rules:e.rules.machineId}},[t("el-select",{staticClass:"w-100",attrs:{size:"mini",placeholder:"请选择主机"},on:{change:function(t){return e.changeIp(t,a)}},model:{value:a.machineId,callback:function(t){e.$set(a,"machineId",t)},expression:"current.machineId"}},e._l(e.machineList,(function(a){return t("el-option",{key:a.id,staticClass:"el-option-box",attrs:{label:"".concat(a.address,"(").concat(a.account,")"),value:a.id}},[t("ul",{staticClass:"el-option-ul-between"},[t("li",[e._v(e._s(a.address))]),t("li",[e._v(e._s(a.account))])])])})),1)],1)],1),t("el-col",{attrs:{span:e.isDleger?8:24}},[t("el-form-item",{attrs:{label:"端口 ".concat(e.isDleger?n+1:""),prop:"list.".concat(n,".port"),rules:e.rules.port}},[t("el-input-number",{staticClass:"w-100",attrs:{size:"mini","controls-position":"right",min:0,max:65535,placeholder:"端口"},model:{value:a.port,callback:function(t){e.$set(a,"port",t)},expression:"current.port"}})],1)],1)],1),t("el-form-item",{attrs:{label:"部署路径 ".concat(e.isDleger?n+1:""),prop:"list.".concat(n,".deployPath"),rules:e.rules.deployPath}},[t("el-input",{staticClass:"w-100",attrs:{placeholder:"请输入部署路径",size:"mini"},model:{value:a.deployPath,callback:function(t){e.$set(a,"deployPath","string"===typeof t?t.trim():t)},expression:"current.deployPath"}})],1),t("el-form-item",{attrs:{label:"运行内存",prop:"list.".concat(n,".jvmParam"),rules:e.rules.jvmParam}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择运行内存","allow-create":"",filterable:""},model:{value:a.jvmParam,callback:function(t){e.$set(a,"jvmParam",t)},expression:"current.jvmParam"}},e._l(e.opts_startupTemplate,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)}))],2),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},i=[],o=a("5530"),r=(a("cb29"),a("7db0"),a("d81d"),a("d3b7"),a("33b0")),l=a("3775"),s=a("49bb"),c=a("61f7"),d=a("ff51"),u=a("c88b"),p={components:{},mixins:[],model:{prop:"show",event:"change"},props:{show:Boolean,refresh:Function,rowData:{type:Object,default:function(){return{}}},clusterId:String},data:function(){return{opts_startupTemplate:s["i"],formData:{instanceName:"",nodeLimit:1,list:[{machineId:"",deployPath:"",port:0,jvmParam:""}]},machineList:[],rules:{jvmParam:[{required:!0,validator:c["h"],trigger:"change"}],instanceName:[{required:!0,trigger:"blur",message:"请输入名称"}],machineId:[{required:!0,trigger:["change","blur"],message:"请选择主机"}],deployPath:[{required:!0,trigger:"blur",message:"请输入部署路径"}],port:[{required:!0,trigger:"blur",message:"请输入端口"}]},options:[],loading:!1}},computed:{visible:{get:function(){return this.show},set:function(e){this.$emit("change",!1)}},isDleger:function(){return"dleger"===this.$route.query.clusterMode}},watch:{},created:function(){this.getIps()},mounted:function(){this.formData.instanceName=this.rowData.instanceName},methods:{getIps:function(){var e=this;Object(l["i"])(this.clusterId).then((function(t){e.machineList=Object(d["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).catch((function(e){}))},changeIp:function(e,t){var a,n=this.machineList.find((function(t){return t.id===e}));this.$set(t,"deployPath",null!==(a=null===n||void 0===n?void 0:n.path)&&void 0!==a?a:"")},changeNodeLimit:function(e){Object(u["a"])(e)&&(this.formData.list=new Array(e).fill(0).map((function(){return{machineId:"",deployPath:"",port:0}})))},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){var a=e.isDleger?"RocketMQ_Dleger":"RocketMQ_Broker",n=e.formData,i=n.instanceName,l=n.list,s=l.map((function(t){return Object(o["a"])({clusterId:e.clusterId,instanceName:i,instanceType:a},t)}));e.loading=!0,Object(r["a"])(s).then((function(t){t&&200===t.code&&(e.$message.success("新增成功"),e.$emit("change",!1),e.refresh())})).finally((function(){e.loading=!1}))}}))}}},m=p,f=(a("9e28"),a("2877")),h=Object(f["a"])(m,n,i,!1,null,"050287dd",null);t["default"]=h.exports},6678:function(e,t,a){},"667b":function(e,t,a){"use strict";a("d62d")},6709:function(e,t,a){"use strict";a("6678")},"7c4b":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"operation-log"},[t("el-page-header",{staticClass:"mb-20",attrs:{content:"操作日志"},on:{back:e.goPage}}),t("el-descriptions",{attrs:{title:"",column:4,size:"medium"}},[t("el-descriptions-item",{attrs:{label:"地址"}},[e._v(e._s(e.ip))]),t("el-descriptions-item",{attrs:{label:"节点名称"}},[e._v(e._s(e.instanceName))])],1),t("tableView",{ref:"tableView",attrs:{loading:e.tableConfig.loading,operateObj:e.tableConfig.operate,columns:e.tableConfig.columns,tableData:e.tableConfig.tableData,total:e.tableConfig.pagination.totalCount,rowKey:"id",currentPage:e.tableConfig.pagination.pageNo,pageSize:e.tableConfig.pagination.pageSize},on:{"update:currentPage":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:current-page":function(t){return e.$set(e.tableConfig.pagination,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tableConfig.pagination,"pageSize",t)},changePage:e.changePage}})],1)},i=[],o=(a("d3b7"),a("7034")),r=a("ec41"),l=a("ff51"),s={filters:{},components:{},data:function(){return{rowData:null,tableConfig:{loading:!1,pagination:{pageNo:1,pageSize:10,total:0},columns:[{prop:"operateUser",label:"用户",align:"center",width:100},{prop:"type",label:"操作类型",align:"center",width:100},{prop:"logStatus",label:"操作结果",align:"center",width:100},{prop:"logContent",label:"日志内容",align:"left"},{prop:"operateTime",label:"操作时间",align:"center",width:150}],operate:{width:220,list:[]}}}},created:function(){this.getList()},watch:{},computed:{clusterId:function(){return this.$route.query.clusterId},clusterNodeId:function(){return this.$route.query.clusterNodeId},instanceName:function(){return this.$route.query.instanceName},ip:function(){return this.$route.query.ip},port:function(){return this.$route.query.port}},methods:{goPage:function(){this.$router.go(-1)},getList:function(){var e=this,t={pageNo:this.tableConfig.pagination.pageNo,pageSize:this.tableConfig.pagination.pageSize,requestObject:{clientId:this.clusterNodeId}};this.tableConfig.loading=!0,Object(o["a"])(t).then((function(t){var a,n=Object(r["a"])(t,"data.data");e.tableConfig.tableData=Object(l["a"])(n)?n:[],e.tableConfig.pagination.totalCount=null!==(a=Object(r["a"])(t,"data.totalCount"))&&void 0!==a?a:0})).finally((function(){e.tableConfig.loading=!1}))},onSearch:function(){this.tableConfig.pagination.pageNo=1,this.getList()},changePage:function(e,t){e&&(this.tableConfig.pagination.pageNo=e),t&&(this.tableConfig.pagination.pageNo=1,this.tableConfig.pagination.pageSize=t),this.getList()}}},c=s,d=a("2877"),u=Object(d["a"])(c,n,i,!1,null,"0a5ddbd0",null);t["default"]=u.exports},"7ef9":function(e,t,a){"use strict";a("8b5f")},"8a02":function(e,t,a){"use strict";a.r(t);a("14d9");var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mode-page"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"main-content",attrs:{"element-loading-text":"加载中,请稍候......"}},[t("div",{staticClass:"main-left"},[t("el-button",{attrs:{type:"primary"},on:{click:e.nameServerCheck}},[e._v(" 集群状态检测 ")]),t("el-button",{attrs:{type:"primary"},on:{click:e.getContainerPod}},[e._v(" 刷新 ")]),t("el-button",{on:{click:function(t){return e.$router.push({path:"/rocketmq/clusterManagement/index",query:{deployMode:"1"}})}}},[e._v("返回")]),!e.loading&&e.linksData.length>0?t("G6Dagre",{staticClass:"canvas-box",attrs:{chartData:e.chartData,height:"500px",width:"100%"},on:{"click-node":e.clickNode}}):t("el-empty",{attrs:{description:"暂无数据"}})],1),t("div",{staticClass:"main-right"},[t("el-descriptions",{staticClass:"margin-top",attrs:{title:e.baseInfo.clusterName,column:2,size:"small"}},[t("el-descriptions-item",{attrs:{label:"模式"}},[t("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.baseInfo.clusterMode,expression:"baseInfo.clusterMode"}],attrs:{size:"mini"}},[e._v(e._s(this.$route.query.clusterMode))])],1)],1),e.currentNode?[t("el-descriptions",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingNode,expression:"loadingNode"}],staticClass:"mt-10",staticStyle:{"padding-top":"15px","border-top":"1px solid #c6c6c6"},attrs:{title:e.currentNode.label,column:2,size:"small"}},[t("el-descriptions-item",{attrs:{label:"运行状态",span:2,labelStyle:{lineHeight:"28px"},contentStyle:{lineHeight:"28px"}}},[e._v(" "+e._s(e.currentNode.status?"正常":"异常")+" ")])],1),"RocketMQ_NameSrv"===e.currentNode.instanceType?t("el-button",{attrs:{type:"text"},on:{click:e.clickMontiorCluster}},[e._v("集群监控")]):e._e(),t("el-divider"),t("button-list",{attrs:{data:e.buttonList}})]:e._e()],2)]),e.addmasternode?t("DialogAddNode",{attrs:{clusterId:e.clusterId,nodeType:e.nodeType_add,rowData:e.currentNode,refresh:e.refresh},model:{value:e.addmasternode,callback:function(t){e.addmasternode=t},expression:"addmasternode"}}):e._e(),e.brokerShow?t("RocketmqBrokerAdd",{attrs:{clusterId:e.clusterId,nodeType:e.nodeType_add,rowData:e.currentNode,refresh:e.refresh},model:{value:e.brokerShow,callback:function(t){e.brokerShow=t},expression:"brokerShow"}}):e._e(),e.nodeShow?t("RocketmqNodeAdd",{attrs:{clusterId:e.clusterId,nodeType:e.nodeType_add,rowData:e.currentNode,refresh:e.refresh},model:{value:e.nodeShow,callback:function(t){e.nodeShow=t},expression:"nodeShow"}}):e._e(),e.startLogShow?t("el-dialog-limit",{attrs:{title:"启动日志",visible:e.startLogShow,size:"medium"},on:{"update:visible":function(t){e.startLogShow=t},close:e.clickCancel}},[t("InstancesStartLogContainer",{ref:"terminaRef",attrs:{updateTime:"updateTime",rowData:e.rowData},on:{changeTime:e.changeTime}})],1):e._e(),e.stateStopShow?t("el-dialog-limit",{attrs:{title:"确定要停止吗？",visible:e.stateStopShow,size:"small"},on:{"update:visible":function(t){e.stateStopShow=t},close:e.stopclickCancel}},[t("span",{staticStyle:{"margin-right":"10px"}},[e._v(" 请选择节点停止方式：")]),t("el-select",{model:{value:e.force,callback:function(t){e.force=t},expression:"force"}},[t("el-option",{attrs:{value:0,label:"普通停止"}}),t("el-option",{attrs:{value:1,label:"强制停止"}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.stopclickCancel}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.stopLoading},on:{click:e.instanceStop}},[e._v("确定")])],1)],1):e._e()],1)},i=[],o=a("2909"),r=a("ade3"),l=(a("99af"),a("4de4"),a("7db0"),a("caad"),a("a15b"),a("d81d"),a("b0c0"),a("a9e3"),a("d3b7"),a("1bf2"),a("2532"),a("3ca3"),a("159b"),a("ddb0"),a("0b3a")),s=a("33b0"),c=a("98c7"),d=a("f662"),u=a("1af9"),p=a("5b51"),m=a("ec41"),f=a("bc59"),h=a("5530"),b=a("d4ec"),g=a("bee2"),v=(a("13d5"),function(){function e(t){Object(b["a"])(this,e),Object(r["a"])(this,"links",[]),Object(r["a"])(this,"combos",[]),Object(r["a"])(this,"combo_NameServer",{id:"A",label:"NameServer",style:{x:0,fill:"#fff",stroke:"#C4E3B2",lineWidth:1,shadowBlur:0,radius:7}}),Object(r["a"])(this,"combo_Broker",{id:"B",label:"Broker",width:200,style:{fill:"#fff",stroke:"#C4E3B2",lineWidth:1,shadowBlur:0,radius:7}}),Object(r["a"])(this,"combo_Dleger",{id:"C",label:"Dledger",style:{fill:"#fff",stroke:"#C4E3B2",lineWidth:1,shadowBlur:0,radius:7}}),Object(r["a"])(this,"combo_DlegerChild",{style:{fill:"#fff",stroke:"#C4E3B2",lineWidth:1,shadowBlur:0,radius:7}}),this.links=[],this.combos=[],this.nameServer=this.getNameServer(t),this.brokerNode=this.getBroker(t),this.broker_master=this.getBroker_master(t),this.dlegerNode=this.getDleger(t),this.data=Array.isArray(t)?t:[]}return Object(g["a"])(e,[{key:"getNameServer",value:function(e){return e.filter((function(e){return"RocketMQ_NameSrv"===e.instanceType}))}},{key:"getBroker",value:function(e){return e.filter((function(e){return"RocketMQ_Broker"===e.instanceType}))}},{key:"getDleger",value:function(e){return e.filter((function(e){return"RocketMQ_Dleger"===e.instanceType}))}},{key:"getBroker_master",value:function(e){return e.filter((function(e){return"master"===e.role&&"RocketMQ_Broker"===e.instanceType}))}},{key:"convertNameServer",value:function(){this.nameServer.length&&this.combos.push(this.combo_NameServer)}},{key:"convertBroker",value:function(){var e=this;this.broker_master.length>0&&this.nameServer.length>0&&this.links.push({source:this.nameServer[0].id,target:this.broker_master[0].id,style:{endArrow:!1,lineWidth:0}}),this.brokerNode.forEach((function(t){var a=e.broker_master.find((function(e){return"slave"===t.role&&e.masterIndex===t.masterIndex}));null!==a&&void 0!==a&&a.id&&e.links.push({source:a.id,target:t.id})})),this.broker_master.length&&this.combos.push(this.combo_Broker)}},{key:"convertDleger",value:function(){var e,t=this,a=this.dlegerNode.map((function(e){return Object(h["a"])(Object(h["a"])({id:e.comboId},t.combo_DlegerChild),{},{parentId:"C"})})),n=y(a);n.length&&this.combos.push(this.combo_Dleger),(e=this.combos).push.apply(e,Object(o["a"])(n))}}])}());function y(e){var t={};return e.reduce((function(e,a){return t[a.id]?e:(t[a.id]=!0,[].concat(Object(o["a"])(e),[a]))}),[])}var k=a("4fe2"),S={components:{G6Dagre:l["default"],DialogAddNode:d["default"],RocketmqBrokerAdd:u["default"],RocketmqNodeAdd:p["default"],InstancesStartLogContainer:k["default"]},data:function(){return Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])({force:0,stateStopShow:!1,stopLoading:!1,terminalData:"",instanceTerminal:null,updateTime:"",startLogShow:!1,baseInfo:{},loading:!1,loadingNode:!1,buttonList:[{label:"容器事件日志",click:this.clickLog},{label:"启动日志",click:this.clickStartLog}],chartData:{edges:[],nodes:[],combos:[]},addmasternode:!1,currentNode:null,currentQueryNode:_(),linksData:[]},"loading",!1),"nodeType_add",0),"loadingBtn",!1),"brokerShow",!1),"nodeShow",!1)},computed:{clusterId:function(){return this.$route.query.id},agentId:function(){return this.$route.query.agentId},namespace:function(){return this.$route.query.namespace},query:function(){return this.$route.query},clusterMode:function(){return this.$route.query.clusterMode}},created:function(){this.baseInfo.clusterName=this.query.clusterName,this.baseInfo.clusterMode=this.query.clusterMode,this.baseInfo.machineRoomName=this.query.machineRoomName,this.getContainerPod()},mounted:function(){},methods:{clickMontiorCluster:function(){this.currentNode.podIP&&this.currentNode.containerPort&&this.$router.push({path:"/rocketmq/clusterManagement/rocketmq-cluster-montioring",query:{clusterId:this.clusterId,nameserverAddr:"".concat(this.currentNode.podIP,":").concat(this.currentNode.containerPort)}})},nameServerCheck:function(){var e=this,t=this.linksData.filter((function(e){return"RocketMQ_NameSrv"===e.instanceType})).map((function(e){return"".concat(e.podIP,":").concat(e.containerPort)})).join(";"),a=this.linksData.filter((function(e){return"RocketMQ_Broker"===e.instanceType&&"master"===e.role})).map((function(e){return"".concat(e.podIP,":").concat(e.containerPort)})).join(";");Object(c["j"])({clusterId:this.clusterId,context:t,brokerAddrs:a}).then((function(t){e.$message({dangerouslyUseHTMLString:!0,message:t.data,type:"success"})}))},changeTime:function(e){this.updateTime=e},clickCancel:function(){this.startLogShow=!1},getContainerPod:function(){var e=this;this.loading=!0;var t=Object(c["h"])(this.clusterId),a=Object(c["f"])(this.clusterId);Promise.all([t,a]).then((function(t){var a=Object(m["a"])(t[0],"data.items"),n=Object(m["a"])(t[1],"data.items"),i=[],r=a.map((function(e,t){var a=Object(m["a"])(e,"metadata.name"),n=Object(m["a"])(e,"status.podIP"),i=Object(m["a"])(e,"status.phase"),o=Object(m["a"])(e,"spec.containers[0].ports"),r=Object(m["a"])(e,"spec.containers[0].ports[0].containerPort"),l=Object(m["a"])(e,"status.conditions"),s=l.find((function(e){return"Ready"===e.type})),c=!(!s||"True"!==(null===s||void 0===s?void 0:s.status));return{id:a,label:n?"".concat(n,":").concat(r):"".concat(i),value:a,name:a,comboId:"A",status:c,podIP:n,containerPort:r,ports:o.map((function(e){return e.containerPort})),instanceType:"RocketMQ_NameSrv",role:"NameServer",x:190*t+87,y:37}}));n.forEach((function(t,a){var n=Object(m["a"])(t,"metadata.name"),o=Object(m["a"])(t,"status.podIP"),r=Object(m["a"])(t,"spec.containers[0].ports[0].containerPort"),l=Object(m["a"])(t,"status.phase"),s=Object(m["a"])(t,"status.conditions",[]),c=s.find((function(e){return"Ready"===e.type})),d=!(!c||"True"!==(null===c||void 0===c?void 0:c.status)),u=n.split("broker-")[1];if("master-slave"===e.clusterMode){var p=u[0],f=0;u.includes("slave")&&(f=Number(u.split("slave-")[1][0])),i.push({id:n,comboId:"B",name:n,podIP:o,containerPort:r,label:o?"".concat(o,":").concat(r):"".concat(l),value:n,status:d,instanceType:"RocketMQ_Broker",role:u.includes("master")?"master":"slave",masterIndex:p,slaveIndex:f})}if("dleger"===e.clusterMode){var h=u.split("-"),b=h[0],g=h[1]||0;i.push({id:n,comboId:"combo"+b,name:n,podIP:o,containerPort:r,label:o?"".concat(o,":").concat(r):"".concat(l),value:n,status:d,instanceType:"RocketMQ_Dleger",masterIndex:b,slaveIndex:g,y:100*g+190,x:200*b+97})}}));var l=[].concat(Object(o["a"])(r),i),s=new v(l);s.convertNameServer(),"dleger"===e.clusterMode?s.convertDleger():s.convertBroker(),e.linksData=l,e.chartData.nodes=l,e.chartData.edges=s.links,e.chartData.combos=s.combos})).finally((function(){e.loading=!1}))},clickAddNode:function(){this.nodeType_add=0,this.addmasternode=!0},clickAddBroker:function(){this.nodeType_add=1,this.brokerShow=!0},clickSlave:function(){this.nodeType_add=1,this.nodeShow=!0},clickConfigParams:function(){this.$router.push({path:"/rocketmq/clusterManagement/rocketmq-config-params",query:{clusterId:this.clusterId,clusterNodeId:this.currentNode.id,instanceType:this.currentNode.instanceType}})},clickStartLog:function(){this.startLogShow=!0,this.rowData={agentId:this.agentId,namespace:this.namespace,podName:this.currentNode.name}},clickLog:function(){this.$router.push({path:"/rocketmq/clusterManagement/rocketmq-log-management-container",query:{agentId:this.agentId,namespace:this.namespace,podName:this.currentNode.name}})},clickNodeDelete:function(){var e=this;this.$confirm("确定要移除".concat(this.currentNode.label,"吗?"),{type:"warning"}).then((function(t){e.removeNodeDeleteFile()})).catch((function(e){}))},removeNodeDeleteFile:function(){var e=this;this.$confirm("移除节点的同时是否删除本地文件?",{type:"warning",cancelButtonText:"否",confirmButtonText:"是",showClose:!1,beforeClose:function(t,a,n){var i={instanceId:e.currentNode.id,removeData:"0"};"confirm"===t?(i.removeData="1",a.confirmButtonLoading=!0,a.confirmButtonText="执行中..."):(a.cancelButtonLoading=!0,a.cancelButtonText="执行中..."),Object(s["c"])(i).then((function(t){200===t.code&&(e.$message.success("移除成功"),e.refresh())})).catch((function(e){})).finally((function(){n(),a.cancelButtonLoading=!1,a.confirmButtonLoading=!1}))}})},clickNode:function(e){this.currentNode=e,this.loadingBtn=!1},refresh:function(){this.getDetail()},clickStartAndStop:function(e,t){var a=this;t?this.$confirm("确定要启动【".concat(e.label,"】吗?")).then((function(){a.loadingBtn=!0,Object(s["h"])(e.id).then((function(e){200===e.code&&(a.$message.success(e.data),a.refresh())})).catch((function(e){})).finally((function(){a.loadingBtn=!1}))})):this.stateStopShow=!0},stopclickCancel:function(){this.stateStopShow=!1},instanceStop:function(){var e=this;this.stopLoading=!0,Object(s["b"])({force:this.force,instanceId:this.currentNode.id}).then((function(t){e.$message.success(t.data),e.stateStopShow=!1,e.refresh()})).finally((function(){e.stopLoading=!1}))}}};function _(e){var t={pid:"",usedMemory:"",usedCpuSys:"",keys:"",clients:"",expires:"",flags:""};return e&&Reflect.ownKeys(t).forEach((function(a){Object(f["a"])(e,a)&&(t[a]=e[a])})),Object.assign(t,e)}var N=S,w=(a("3837"),a("2877")),C=Object(w["a"])(N,n,i,!1,null,"6197c76e",null);t["default"]=C.exports},"8a95":function(e,t,a){},"8b5f":function(e,t,a){},9533:function(e,t,a){},"9e28":function(e,t,a){"use strict";a("8a95")},a523:function(e,t,a){"use strict";a("19ae")},a82a:function(e,t,a){"use strict";a.r(t);a("14d9");var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mode-page"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"main-content",attrs:{"element-loading-text":"加载中,请稍候......"}},[t("div",{staticClass:"main-left"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickAddNode}},[e._v(" 添加NameServer ")]),t("el-button",{attrs:{type:"primary"},on:{click:e.clickAddBroker}},[e._v(e._s("dleger"===e.query.clusterMode?"添加Broker":"添加主节点"))]),t("el-button",{on:{click:function(t){return e.$router.push({path:"/rocketmq/clusterManagement/index",query:{deployMode:"2"}})}}},[e._v("返回")]),!e.loading&&e.linksData.length>0?t("G6Dagre",{staticClass:"canvas-box",attrs:{chartData:e.chartData,height:"500px",width:"100%"},on:{"click-node":e.clickNode}}):t("el-empty",{attrs:{description:"暂无数据"}})],1),t("div",{staticClass:"main-right"},[t("el-descriptions",{staticClass:"margin-top",attrs:{title:e.baseInfo.clusterName,column:2,size:"small"}},[t("template",{slot:"extra"},[t("el-button",{attrs:{type:"text",size:"small"},on:{click:e.refresh}},[e._v("刷新")])],1),t("el-descriptions-item",{attrs:{label:"模式"}},[t("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.baseInfo.clusterMode,expression:"baseInfo.clusterMode"}],attrs:{size:"mini"}},[e._v(e._s(this.$route.query.clusterMode))])],1),t("el-descriptions-item",{attrs:{label:"机房"}},[e._v(" "+e._s(this.$route.query.machineRoomName)+" ")])],2),e.currentNode?[t("el-descriptions",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingNode,expression:"loadingNode"}],staticClass:"mt-10",staticStyle:{"padding-top":"15px","border-top":"1px solid #c6c6c6"},attrs:{title:e.currentNode.label,column:2,size:"small"}},[t("el-descriptions-item",{attrs:{label:"节点类型",span:2}},[e._v(" "+e._s(e.currentNode.instanceType)+" ")]),t("el-descriptions-item",{attrs:{label:"角色",span:2}},[t("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.currentNode.role,expression:"currentNode.role"}],attrs:{size:"mini"}},[e._v(e._s(e.currentNode.role))])],1),t("el-descriptions-item",{attrs:{label:"运行状态",span:2,labelStyle:{lineHeight:"28px"},contentStyle:{lineHeight:"28px"}}},[e._v(" "+e._s("good"===e.currentNode.status?"正常":"异常")+" "),"good"===e.currentNode.status?t("el-button",{staticClass:"ml-10",attrs:{size:"mini",round:"",loading:e.loadingBtn,plain:"",type:"danger"},on:{click:function(t){return e.clickStartAndStop(e.currentNode,!1)}}},[e._v(" 停止 ")]):"bad"===e.currentNode.status?t("el-button",{staticClass:"ml-10",attrs:{type:"primary",size:"mini",loading:e.loadingBtn,round:"",plain:""},on:{click:function(t){return e.clickStartAndStop(e.currentNode,!0)}}},[e._v(" 启动 ")]):e._e()],1),t("el-descriptions-item",{attrs:{label:"部署路径",span:2}},[e._v(" "+e._s(e.currentNode.deployPath)+" ")]),t("el-descriptions-item",{attrs:{label:"节点名称",span:2}},[e._v(" "+e._s(e.currentNode.instanceName)+" ")])],1),t("el-divider"),t("button-list",{attrs:{data:e.buttonList}})]:e._e()],2)]),e.addmasternode?t("DialogAddNode",{attrs:{clusterId:e.clusterId,nodeType:e.nodeType_add,rowData:e.currentNode,refresh:e.refresh},model:{value:e.addmasternode,callback:function(t){e.addmasternode=t},expression:"addmasternode"}}):e._e(),e.brokerShow?t("RocketmqBrokerAdd",{attrs:{clusterId:e.clusterId,nodeType:e.nodeType_add,rowData:e.currentNode,refresh:e.refresh},model:{value:e.brokerShow,callback:function(t){e.brokerShow=t},expression:"brokerShow"}}):e._e(),e.nodeShow?t("RocketmqNodeAdd",{attrs:{clusterId:e.clusterId,nodeType:e.nodeType_add,rowData:e.currentNode,refresh:e.refresh},model:{value:e.nodeShow,callback:function(t){e.nodeShow=t},expression:"nodeShow"}}):e._e(),e.startLogShow?t("DrawerPrismjsLog",{attrs:{show:e.startLogShow,rowData:e.currentNode},on:{"update:show":function(t){e.startLogShow=t}}}):e._e(),e.stateStopShow?t("el-dialog-limit",{attrs:{title:"确定要停止吗？",visible:e.stateStopShow,size:"small"},on:{"update:visible":function(t){e.stateStopShow=t},close:e.stopclickCancel}},[t("span",{staticStyle:{"margin-right":"10px"}},[e._v(" 请选择节点停止方式：")]),t("el-select",{model:{value:e.force,callback:function(t){e.force=t},expression:"force"}},[t("el-option",{attrs:{value:0,label:"普通停止"}}),t("el-option",{attrs:{value:1,label:"强制停止"}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.stopclickCancel}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.stopLoading},on:{click:e.instanceStop}},[e._v("确定")])],1)],1):e._e(),e.deployVisible?t("el-dialog-limit",{attrs:{title:"日志信息",visible:e.deployVisible,size:"medium"},on:{"update:visible":function(t){e.deployVisible=t},close:e.logClickCancel}},[t("my-xterm",{ref:"xterm",attrs:{terminal:e.terminal,socketUrl:e.socketUrl}})],1):e._e()],1)},i=[],o=a("5530"),r=a("ade3"),l=(a("d3b7"),a("1bf2"),a("3ca3"),a("159b"),a("ddb0"),a("0b82")),s=a("33b0"),c=a("f662"),d=a("1af9"),u=a("5b51"),p=a("ff51"),m=a("bc59"),f=a("d4ec"),h=a("bee2"),b=(a("4de4"),a("7db0"),function(){function e(t){Object(f["a"])(this,e),Object(r["a"])(this,"links",[]),Object(r["a"])(this,"combos",[]),Object(r["a"])(this,"combo_NameServer",{id:"A",label:"NameServer",style:{fill:"#fff",stroke:"#C4E3B2",lineWidth:1,shadowBlur:0,radius:7}}),Object(r["a"])(this,"combo_Broker",{id:"B",label:"Broker",style:{fill:"#fff",stroke:"#C4E3B2",lineWidth:1,shadowBlur:0,radius:7}}),Object(r["a"])(this,"combo_Dleger",{id:"C",label:"Dledger",style:{fill:"#fff",stroke:"#C4E3B2",lineWidth:1,shadowBlur:0,radius:7}}),this.links=[],this.combos=[],this.nameServer=this.getNameServer(t),this.broker_master=this.getBroker_master(t),this.dleger_master=this.getDleger_master(t),this.data=Array.isArray(t)?t:[]}return Object(h["a"])(e,[{key:"getNameServer",value:function(e){return e.filter((function(e){return"RocketMQ_NameSrv"===e.instanceType}))}},{key:"getBroker_master",value:function(e){return e.filter((function(e){return"master"===e.role&&"RocketMQ_Broker"===e.instanceType}))}},{key:"getDleger_master",value:function(e){return e.filter((function(e){return"master"===e.role&&"RocketMQ_Dleger"===e.instanceType}))}},{key:"convertBroker",value:function(){var e=this,t=!1,a=!1;this.broker_master.length>0&&(this.nameServer.length>0&&this.links.push({source:this.nameServer[0].id,target:this.broker_master[0].id,style:{endArrow:!1,lineWidth:0}}),a=!0),this.data.forEach((function(a){if("RocketMQ_NameSrv"===a.instanceType&&(t=!0),"slave"===a.role&&"RocketMQ_Broker"===a.instanceType){var n=e.broker_master.find((function(e){return e.instanceName===a.instanceName}));null!==n&&void 0!==n&&n.id&&e.links.push({source:n.id,target:a.id})}})),t&&this.combos.push(this.combo_NameServer),a&&this.combos.push(this.combo_Broker)}},{key:"convertDleger",value:function(){var e=this,t=!1,a=!1;this.dleger_master.length>0&&(this.nameServer.length>0&&this.links.push({source:this.nameServer[0].id,target:this.dleger_master[0].id,style:{endArrow:!1,lineWidth:0}}),a=!0),this.data.forEach((function(a){if("RocketMQ_NameSrv"===a.instanceType&&(t=!0),"slave"===a.role&&"RocketMQ_Dleger"===a.instanceType){var n=e.dleger_master.find((function(e){return e.instanceName===a.instanceName}));null!==n&&void 0!==n&&n.id&&e.links.push({source:n.id,target:a.id})}})),t&&this.combos.push(this.combo_NameServer),a&&this.combos.push(this.combo_Dleger)}}])}()),g=a("2b0e"),v={components:{G6Dagre:l["default"],DialogAddNode:c["default"],RocketmqBrokerAdd:d["default"],RocketmqNodeAdd:u["default"],DrawerPrismjsLog:Object(g["defineAsyncComponent"])((function(){return Promise.all([a.e("chunk-7ef164fc"),a.e("RocketmqStartLog~84203689")]).then(a.bind(null,"39d6"))}))},data:function(){var e=this;return Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])({deployVisible:!1,terminal:{pid:1,name:"terminal"},socketUrl:"",force:0,stateStopShow:!1,stopLoading:!1,terminalData:"",instanceTerminal:null,startLogShow:!1,baseInfo:{},loading:!1,loadingNode:!1,buttonList:[{label:"添加从节点",click:this.clickSlave,get hidden(){var t;return"dleger"===e.query.clusterMode||"master"!==(null===(t=e.currentNode)||void 0===t?void 0:t.role)}},{label:"移除节点",click:this.clickNodeDelete},{label:"配置项",click:this.clickConfigParams},{label:"操作日志",click:this.clickLog},{label:"启动日志",click:this.clickStartLog}],chartData:{edges:[],nodes:[],combos:[]},addmasternode:!1,currentNode:null,currentQueryNode:y(),linksData:[]},"loading",!1),"nodeType_add",0),"loadingBtn",!1),"brokerShow",!1),"nodeShow",!1)},computed:{clusterId:function(){return this.$route.query.id},query:function(){return this.$route.query},clusterMode:function(){return this.$route.query.clusterMode},machineRoomName:function(){return this.$route.query.machineRoomName}},created:function(){this.getDetail(),this.baseInfo.clusterName=this.query.clusterName,this.baseInfo.clusterMode=this.query.clusterMode,this.baseInfo.machineRoomName=this.query.machineRoomName},mounted:function(){},methods:{logClickCancel:function(){this.deployVisible=!1},socketStart:function(e){this.socketUrl="/echo?logId=".concat(e.id),this.deployVisible=!0},clickCancel:function(){this.startLogShow=!1},getDetail:function(){var e=this;this.loading=!0,this.currentNode=null,Object(s["d"])(this.$route.query.id).then((function(t){if(t){var a=Object(p["a"])(null===t||void 0===t?void 0:t.data)?t.data:[];e.linksData=a;var n=[];a.forEach((function(e){var t=void 0;"RocketMQ_NameSrv"===e.instanceType?t="A":"RocketMQ_Broker"===e.instanceType?t="B":"RocketMQ_Dleger"===e.instanceType&&(t="C"),n.push(Object(o["a"])(Object(o["a"])({},e),{},{value:e.address,label:e.address,comboId:t,name:e.instanceName}))}));var i=new b(n);"dleger"===e.query.clusterMode?i.convertDleger():i.convertBroker(),e.chartData.nodes=n,e.chartData.edges=i.links,e.chartData.combos=i.combos}})).catch((function(e){})).finally((function(){e.loading=!1}))},clickAddNode:function(){this.nodeType_add=0,this.addmasternode=!0},clickAddBroker:function(){this.nodeType_add=1,this.brokerShow=!0},clickSlave:function(){this.nodeType_add=1,this.nodeShow=!0},clickConfigParams:function(){this.$router.push({path:"/rocketmq/clusterManagement/rocketmq-config-params",query:{clusterId:this.clusterId,clusterNodeId:this.currentNode.id,instanceType:this.currentNode.instanceType}})},clickStartLog:function(){this.startLogShow=!0},clickLog:function(){this.$router.push({path:"/rocketmq/clusterManagement/rocketmq-log-management",query:{clusterId:this.clusterId,clusterNodeId:this.currentNode.id,instanceName:this.currentNode.instanceName,ip:this.currentNode.address,port:this.currentNode.port}})},clickNodeDelete:function(){var e=this;this.$confirm("确定要移除".concat(this.currentNode.label,"吗?"),{type:"warning"}).then((function(t){e.removeNodeDeleteFile()})).catch((function(e){}))},removeNodeDeleteFile:function(){var e=this;this.$confirm("移除节点的同时是否删除本地文件?",{type:"warning",cancelButtonText:"否",confirmButtonText:"是",showClose:!1,beforeClose:function(t,a,n){var i={instanceId:e.currentNode.id,removeData:"0"};"confirm"===t?(i.removeData="1",a.confirmButtonLoading=!0,a.confirmButtonText="执行中..."):(a.cancelButtonLoading=!0,a.cancelButtonText="执行中..."),Object(s["c"])(i).then((function(t){200===t.code&&(e.$message.success("移除成功"),e.refresh())})).catch((function(e){})).finally((function(){n(),a.cancelButtonLoading=!1,a.confirmButtonLoading=!1}))}})},clickNode:function(e){this.currentNode=e,this.loadingBtn=!1},refresh:function(){this.getDetail()},clickStartAndStop:function(e,t){var a=this;t?this.$confirm("确定要启动【".concat(e.label,"】吗?")).then((function(){a.loadingBtn=!0,Object(s["h"])(e.id).then((function(e){200===e.code&&(a.$message.success(e.data),a.refresh())})).catch((function(e){})).finally((function(){a.loadingBtn=!1})),a.socketStart({id:a.clusterId})})):this.stateStopShow=!0},stopclickCancel:function(){this.stateStopShow=!1},instanceStop:function(){var e=this;this.stopLoading=!0,Object(s["b"])({force:this.force,instanceId:this.currentNode.id}).then((function(t){e.$message.success(t.data),e.stateStopShow=!1,e.refresh()})).finally((function(){e.stopLoading=!1})),this.socketStart({id:this.clusterId})}}};function y(e){var t={pid:"",usedMemory:"",usedCpuSys:"",keys:"",clients:"",expires:"",flags:""};return e&&Reflect.ownKeys(t).forEach((function(a){Object(m["a"])(e,a)&&(t[a]=e[a])})),Object.assign(t,e)}var k=v,S=(a("dccda"),a("2877")),_=Object(S["a"])(k,n,i,!1,null,"61764de2",null);t["default"]=_.exports},ba53:function(e,t,a){"use strict";a("dea0")},d62d:function(e,t,a){},dccda:function(e,t,a){"use strict";a("9533")},dea0:function(e,t,a){},f662:function(e,t,a){"use strict";a.r(t);a("99af"),a("b0c0"),a("498a");var n=function(){var e=this,t=e._self._c;return t("el-dialog-limit",{attrs:{title:"新增NameServer",visible:e.visible,loading:e.loading,size:"small","append-to-body":!0,"close-on-click-modal":!1},on:{close:e.clickCancel}},[t("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"80px",rules:e.rules}},[t("el-form-item",{attrs:{label:"名称",prop:"instanceName"}},[t("el-input",{attrs:{size:"mini"},model:{value:e.formData.instanceName,callback:function(t){e.$set(e.formData,"instanceName",t)},expression:"formData.instanceName"}})],1),t("el-form-item",{attrs:{label:"主机",prop:"machineId"}},[t("el-select",{staticClass:"w-100",attrs:{size:"mini",placeholder:"请选择主机"},on:{change:e.changeIp},model:{value:e.formData.machineId,callback:function(t){e.$set(e.formData,"machineId",t)},expression:"formData.machineId"}},e._l(e.machineList,(function(a){return t("el-option",{key:a.id,staticClass:"el-option-box",attrs:{label:"".concat(a.address,"(").concat(a.account,")"),value:a.id}},[t("ul",{staticClass:"el-option-ul-between"},[t("li",[e._v(e._s(a.address))]),t("li",[e._v(e._s(a.account))])])])})),1)],1),t("el-form-item",{attrs:{label:"端口",prop:"port"}},[t("el-input-number",{staticClass:"w-100",attrs:{size:"mini","controls-position":"right",min:0,max:65535,placeholder:"端口"},model:{value:e.formData.port,callback:function(t){e.$set(e.formData,"port",t)},expression:"formData.port"}})],1),t("el-form-item",{attrs:{label:"部署路径",prop:"deployPath"}},[t("el-input",{staticClass:"w-100",attrs:{placeholder:"请输入部署路径",size:"mini"},model:{value:e.formData.deployPath,callback:function(t){e.$set(e.formData,"deployPath","string"===typeof t?t.trim():t)},expression:"formData.deployPath"}})],1),t("el-form-item",{attrs:{label:"配置模板",prop:"configTemplateId"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择配置模板"},model:{value:e.formData.configTemplateId,callback:function(t){e.$set(e.formData,"configTemplateId",t)},expression:"formData.configTemplateId"}},e._l(e.opts_serverTemplate,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"运行内存",prop:"jvmParam"}},[t("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择运行内存","allow-create":"",filterable:""},model:{value:e.formData.jvmParam,callback:function(t){e.$set(e.formData,"jvmParam",t)},expression:"formData.jvmParam"}},e._l(e.opts_startupTemplate,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.clickConfirm}},[e._v("确定")]),t("el-button",{on:{click:e.clickCancel}},[e._v("取消")])],1)],1)},i=[],o=a("5530"),r=(a("7db0"),a("d3b7"),a("33b0")),l=a("3775"),s=a("082f"),c=a("49bb"),d=a("61f7"),u=a("ff51"),p={components:{},mixins:[],model:{prop:"show",event:"change"},props:{show:Boolean,refresh:Function,rowData:{type:Object,default:function(){return{}}},clusterId:String},data:function(){return{opts_startupTemplate:c["i"],formData:{instanceName:"",machineId:"",deployPath:"",port:0,configTemplateId:"",jvmParam:""},opts_serverTemplate:[],machineList:[],rules:{jvmParam:[{required:!0,validator:d["h"],trigger:"change"}],instanceName:[{required:!0,trigger:"blur",message:"请输入名称"}],machineId:[{required:!0,trigger:["change","blur"],message:"请选择主机"}],deployPath:[{required:!0,trigger:"blur",message:"请输入部署路径"}],port:[{required:!0,trigger:"blur",message:"请输入端口"}]},options:[],loading:!1}},computed:{visible:{get:function(){return this.show},set:function(e){this.$emit("change",!1)}}},watch:{},created:function(){this.getIps(),this.getServerConfigTemplate()},mounted:function(){},methods:{getServerConfigTemplate:function(){var e=this,t={moduleType:"ROCKRTMQ_NAME_SERVER",componentType:"ROCKETMQ"};Object(s["c"])(t).then((function(t){e.opts_serverTemplate=Object(u["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]}))},getIps:function(){var e=this;Object(l["i"])(this.clusterId).then((function(t){e.machineList=Object(u["a"])(null===t||void 0===t?void 0:t.data)?t.data:[]})).catch((function(e){}))},changeIp:function(e){var t,a=this.machineList.find((function(t){return t.id===e}));this.formData.deployPath=null!==(t=null===a||void 0===a?void 0:a.path)&&void 0!==t?t:""},clickCancel:function(){this.$refs.formRef.resetFields(),this.$emit("change",!1)},clickConfirm:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){var a=[Object(o["a"])({clusterId:e.clusterId,instanceType:"RocketMQ_NameSrv"},e.formData)];e.loading=!0,Object(r["a"])(a).then((function(t){t&&200===t.code&&(e.$message.success("新增成功"),e.$emit("change",!1),e.refresh())})).finally((function(){e.loading=!1}))}}))}}},m=p,f=(a("7ef9"),a("2877")),h=Object(f["a"])(m,n,i,!1,null,"3ebd5c37",null);t["default"]=h.exports}}]);